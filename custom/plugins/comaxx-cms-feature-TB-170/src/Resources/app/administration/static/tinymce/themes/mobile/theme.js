!function(){"use strict";var n,e,t,r,o,i,u,c,a,f,s,l,d,m,g,p,h,v,b,y,x,S,w=function(){return(w=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function O(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&0>e.indexOf(r)&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)0>e.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function k(n,e,t){if(t||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)(r||!(o in e))&&(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return n.concat(r||Array.prototype.slice.call(e))}var T=function(n){var e=typeof n;return null===n?"null":"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e},C=function(n){return function(e){return T(e)===n}},E=function(n){return function(e){return typeof e===n}},M=function(n){return function(e){return n===e}},D=C("string"),_=C("object"),R=C("array"),F=M(null),I=E("boolean"),V=M(void 0),B=function(n){return null!=n},A=E("function"),H=E("number"),N=function(){},P=function(n,e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n(e.apply(null,t))}},z=function(n){return function(){return n}},j=function(n){return n},L=function(n,e){return n===e};function $(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}var G=function(n){return function(e){return!n(e)}},U=function(n){return function(){throw Error(n)}},W=function(n){return n()},X=z(!1),q=z(!0),K=function(){return Y},Y={fold:function(n,e){return n()},isSome:X,isNone:q,getOr:j,getOrThunk:c=function(n){return n()},getOrDie:function(n){throw Error(n||"error: getOrDie called on none.")},getOrNull:z(null),getOrUndefined:z(void 0),or:j,orThunk:c,map:K,each:N,bind:K,exists:X,forall:q,filter:function(){return K()},toArray:function(){return[]},toString:z("none()")},J=function(n){var e=z(n),t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},isSome:q,isNone:X,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return J(e(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?o:Y},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},Q={some:J,none:K,from:function(n){return null==n?Y:J(n)}},Z=function(n){var e,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,e=n.apply(null,r)),e}},nn=function(n,e,t,r){var o=n.isiOS()&&!0===/ipad/i.test(t),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||r("(pointer:coarse)"),a=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!a,s=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(t);return{isiPad:z(o),isiPhone:z(i),isTablet:z(a),isPhone:z(f),isTouch:z(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:z(s),isDesktop:z(!f&&!a&&!s)}},ne=Array.prototype.slice,nt=Array.prototype.indexOf,nr=Array.prototype.push,no=function(n,e){return nt.call(n,e)>-1},ni=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1},nu=function(n,e){for(var t=n.length,r=Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o)}return r},nc=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},na=function(n,e){for(var t=n.length-1;t>=0;t--)e(n[t],t)},nf=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r)&&t.push(i)}return t},ns=function(n,e,t){return na(n,function(n,r){t=e(t,n,r)}),t},nl=function(n,e,t){return nc(n,function(n,r){t=e(t,n,r)}),t},nd=function(n,e,t){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(e(i,r))return Q.some(i);if(t(i,r))break}return Q.none()},nm=function(n,e){return nd(n,e,X)},ng=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return Q.some(t);return Q.none()},np=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!R(n[t]))throw Error("Arr.flatten item "+t+" was not an array, input: "+n);nr.apply(e,n[t])}return e},nh=function(n,e){return np(nu(n,e))},nv=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0},nb=function(n){var e=ne.call(n,0);return e.reverse(),e},ny=function(n,e){return nf(n,function(n){return!no(e,n)})},nx=function(n){return[n]},nS=function(n,e){var t=ne.call(n,0);return t.sort(e),t},nw=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return Q.none()},nO=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}},nk=function(n,e){var t=nO(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return nC(r(1),r(2))},nT=function(){return nC(0,0)},nC=function(n,e){return{major:n,minor:e}},nE={nu:nC,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?nT():nk(n,t)},unknown:nT},nM=function(n,e){var t=String(e).toLowerCase();return nm(n,function(n){return n.search(t)})},nD=function(n,e){var t=function(n){var e=typeof n;return"string"===e||"number"===e};return n.replace(/\$\{([^{}]*)\}/g,function(n,r){var o=e[r];return t(o)?o.toString():n})},n_=function(n,e){return -1!==n.indexOf(e)},nR=function(n,e){var t;return t=n.length-e.length,""===e||n.length>=e.length&&n.substr(t,t+e.length)===e},nF=(a=/^\s+|\s+$/g,function(n){return n.replace(a,"")}),nI=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,nV=function(n){return function(e){return n_(e,n)}},nB=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return n_(n,"edge/")&&n_(n,"chrome")&&n_(n,"safari")&&n_(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nI],search:function(n){return n_(n,"chrome")&&!n_(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return n_(n,"msie")||n_(n,"trident")}},{name:"Opera",versionRegexes:[nI,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:nV("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:nV("firefox")},{name:"Safari",versionRegexes:[nI,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(n_(n,"safari")||n_(n,"mobile/"))&&n_(n,"applewebkit")}}],nA=[{name:"Windows",search:nV("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return n_(n,"iphone")||n_(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:nV("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:nV("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:nV("linux"),versionRegexes:[]},{name:"Solaris",search:nV("sunos"),versionRegexes:[]},{name:"FreeBSD",search:nV("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:nV("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],nH={browsers:z(nB),oses:z(nA)},nN="Edge",nP="Chrome",nz="Opera",nj="Firefox",nL="Safari",n$=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:r(nN),isChrome:r(nP),isIE:r("IE"),isOpera:r(nz),isFirefox:r(nj),isSafari:r(nL)}},nG={unknown:function(){return n$({current:void 0,version:nE.unknown()})},nu:n$,edge:z(nN),chrome:z(nP),ie:z("IE"),opera:z(nz),firefox:z(nj),safari:z(nL)},nU="Windows",nW="Android",nX="Linux",nq="Solaris",nK="FreeBSD",nY="ChromeOS",nJ=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:r(nU),isiOS:r("iOS"),isAndroid:r(nW),isOSX:r("OSX"),isLinux:r(nX),isSolaris:r(nq),isFreeBSD:r(nK),isChromeOS:r(nY)}},nQ={unknown:function(){return nJ({current:void 0,version:nE.unknown()})},nu:nJ,windows:z(nU),ios:z("iOS"),android:z(nW),linux:z(nX),osx:z("OSX"),solaris:z(nq),freebsd:z(nK),chromeos:z(nY)},nZ={detect:function(n,e,t){var r=nH.browsers(),o=nH.oses(),i=e.bind(function(n){return nw(n.brands,function(n){var e=n.brand.toLowerCase();return nm(r,function(n){var t;return e===((t=n.brand)===null||void 0===t?void 0:t.toLowerCase())}).map(function(e){return{current:e.name,version:nE.nu(parseInt(n.version,10),0)}})})}).orThunk(function(){return nM(r,n).map(function(e){var t=nE.detect(e.versionRegexes,n);return{current:e.name,version:t}})}).fold(nG.unknown,nG.nu),u=nM(o,n).map(function(e){var t=nE.detect(e.versionRegexes,n);return{current:e.name,version:t}}).fold(nQ.unknown,nQ.nu),c=nn(u,i,n,t);return{browser:i,os:u,deviceType:c}}},n0=function(n){return window.matchMedia(n).matches},n1=Z(function(){return nZ.detect(navigator.userAgent,Q.from(navigator.userAgentData),n0)}),n2=function(){return n1()},n9=z("touchstart"),n3=z("touchmove"),n5=z("touchend"),n4=z("mousedown"),n6=z("mousemove"),n8=z("mouseup"),n7=z("mouseover"),en=z("keydown"),ee=z("keyup"),et=z("input"),er=z("change"),eo=z("click"),ei=z("transitionend"),eu=z("selectstart"),ec=function(n){return z("alloy."+n)},ea={tap:ec("tap")},ef=ec("focus"),es=ec("blur.post"),el=ec("paste.post"),ed=ec("receive"),em=ec("execute"),eg=ec("focus.item"),ep=ea.tap,eh=ec("longpress"),ev=ec("system.init"),eb=ec("system.attached"),ey=ec("system.detached"),ex=ec("focusmanager.shifted"),eS=ec("highlight"),ew=ec("dehighlight"),eO=function(n,e){eE(n,n.element,e,{})},ek=function(n,e,t){eE(n,n.element,e,t)},eT=function(n){eO(n,em())},eC=function(n,e,t){eE(n,e,t,{})},eE=function(n,e,t,r){var o=w({target:e},r);n.getSystem().triggerEvent(t,e,o)},eM=function(n,e,t,r){n.getSystem().triggerEvent(t,e,r.event)},eD=function(n,e){n.getSystem().triggerFocus(e,n.element)},e_=function(n){if(null==n)throw Error("Node cannot be null or undefined");return{dom:n}},eR={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||t.childNodes.length>1)throw console.error("HTML does not have a single root node",n),Error("HTML must have a single root node");return e_(t.childNodes[0])},fromTag:function(n,e){return e_((e||document).createElement(n))},fromText:function(n,e){return e_((e||document).createTextNode(n))},fromDom:e_,fromPoint:function(n,e,t){return Q.from(n.dom.elementFromPoint(e,t)).map(e_)}},eF=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw Error("Browser lacks native selectors")},eI=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},eV=function(n,e){var t=void 0===e?document:e.dom;return eI(t)?[]:nu(t.querySelectorAll(n),eR.fromDom)},eB=function(n,e){var t=void 0===e?document:e.dom;return eI(t)?Q.none():Q.from(t.querySelector(n)).map(eR.fromDom)},eA=function(n,e){return n.dom===e.dom};"undefined"!=typeof window?window:Function("return this;")();var eH=function(n){return n.dom.nodeName.toLowerCase()},eN=function(n){return function(e){return e.dom.nodeType===n}},eP=eN(1),ez=eN(3),ej=eN(9),eL=eN(11),e$=function(n){return eR.fromDom(n.dom.ownerDocument)},eG=function(n){return ej(n)?n:e$(n)},eU=function(n){return Q.from(n.dom.parentNode).map(eR.fromDom)},eW=function(n,e){for(var t=A(e)?e:X,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=eR.fromDom(i);if(o.push(u),!0===t(u))break;r=i}return o},eX=function(n){return nu(n.dom.childNodes,eR.fromDom)},eq=function(n,e){var t=n.dom.childNodes;return Q.from(t[e]).map(eR.fromDom)},eK=function(n,e){eU(n).each(function(t){t.dom.insertBefore(e.dom,n.dom)})},eY=function(n,e){Q.from(n.dom.nextSibling).map(eR.fromDom).fold(function(){eU(n).each(function(n){eQ(n,e)})},function(n){eK(n,e)})},eJ=function(n,e){eq(n,0).fold(function(){eQ(n,e)},function(t){n.dom.insertBefore(e.dom,t.dom)})},eQ=function(n,e){n.dom.appendChild(e.dom)},eZ=function(n,e,t){eq(n,t).fold(function(){eQ(n,e)},function(n){eK(n,e)})},e0=function(n,e){nc(e,function(e){eQ(n,e)})},e1=function(n){n.dom.textContent="",nc(eX(n),function(n){e2(n)})},e2=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},e9=function(n){return eL(n)&&B(n.dom.host)},e3=A(Element.prototype.attachShadow)&&A(Node.prototype.getRootNode),e5=z(e3),e4=e3?function(n){return eR.fromDom(n.dom.getRootNode())}:eG,e6=function(n){var e=e4(n);return e9(e)?Q.some(e):Q.none()},e8=function(n){if(e5()&&B(n.target)){var e=eR.fromDom(n.target);if(eP(e)&&e7(e)&&n.composed&&n.composedPath){var t,r=n.composedPath();if(r){return 0<(t=r).length?Q.some(t[0]):Q.none()}}}return Q.from(n.target)},e7=function(n){return B(n.dom.shadowRoot)},tn=function(n){var e=ez(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t=e.ownerDocument;return e6(eR.fromDom(e)).fold(function(){return t.body.contains(e)},function(n){var e;return tn((e=n,eR.fromDom(e.dom.host)))})},te=function(){return tt(eR.fromDom(document))},tt=function(n){var e=n.dom.body;if(null==e)throw Error("Body is not available yet");return eR.fromDom(e)},tr=function(n){eO(n,ey()),nc(n.components(),tr)},to=function(n){nc(n.components(),to),eO(n,eb())},ti=function(n,e){eQ(n.element,e.element)},tu=function(n){nc(n.components(),function(n){return e2(n.element)}),e1(n.element),n.syncComponents()},tc=function(n,e){var t=n.components();tu(n),nc(ny(t,e),function(e){tr(e),n.getSystem().removeFromWorld(e)}),nc(e,function(e){e.getSystem().isConnected()?ti(n,e):(n.getSystem().addToWorld(e),ti(n,e),tn(n.element)&&to(e)),n.syncComponents()})},ta=function(n,e){tf(n,e,eQ)},tf=function(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),tn(n.element)&&to(e),n.syncComponents()},ts=function(n){tr(n),e2(n.element),n.getSystem().removeFromWorld(n)},tl=function(n){var e=eU(n.element).bind(function(e){return n.getSystem().getByDom(e).toOptional()});ts(n),e.each(function(n){n.syncComponents()})},td=function(n,e){tm(n,e,eY)},tm=function(n,e,t){t(n,e.element),nc(eX(e.element),function(n){e.getByDom(n).each(to)})},tg=function(n){nc(eX(n.element),function(e){n.getByDom(e).each(tr)}),e2(n.element)},tp=Object.keys,th=Object.hasOwnProperty,tv=function(n,e){for(var t=tp(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i)}},tb=function(n,e){return ty(n,function(n,t){return{k:t,v:e(n,t)}})},ty=function(n,e){var t={};return tv(n,function(n,r){var o=e(n,r);t[o.k]=o.v}),t},tx=function(n,e){var t,r={};return t=function(n,e){r[e]=n},tv(n,function(n,r){(e(n,r)?t:N)(n,r)}),r},tS=function(n,e){var t=[];return tv(n,function(n,r){t.push(e(n,r))}),t},tw=function(n,e){for(var t=tp(n),r=0,o=t.length;r<o;r++){var i=t[r],u=n[i];if(e(u,i,n))return Q.some(u)}return Q.none()},tO=function(n,e){return tk(n,e)?Q.from(n[e]):Q.none()},tk=function(n,e){return th.call(n,e)},tT=function(n,e){return tk(n,e)&&void 0!==n[e]&&null!==n[e]},tC=function(n,e,t){if(D(t)||I(t)||H(t))n.setAttribute(e,t+"");else throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),Error("Attribute value was not simple")},tE=function(n,e,t){tC(n.dom,e,t)},tM=function(n,e){var t=n.dom;tv(e,function(n,e){tC(t,e,n)})},tD=function(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t},t_=function(n,e){return Q.from(tD(n,e))},tR=function(n,e){var t=n.dom;return!!t&&!!t.hasAttribute&&t.hasAttribute(e)},tF=function(n,e){n.dom.removeAttribute(e)},tI=function(n,e){var t=tD(n,e);return void 0===t||""===t?[]:t.split(" ")},tV=function(n,e,t){var r=tI(n,e).concat([t]);return tE(n,e,r.join(" ")),!0},tB=function(n,e,t){var r=nf(tI(n,e),function(n){return n!==t});return r.length>0?tE(n,e,r.join(" ")):tF(n,e),!1},tA=function(n){return void 0!==n.dom.classList},tH=function(n,e){tA(n)?n.dom.classList.add(e):tV(n,"class",e)},tN=function(n){0===(tA(n)?n.dom.classList:tI(n,"class")).length&&tF(n,"class")},tP=function(n,e){tA(n)?n.dom.classList.remove(e):tB(n,"class",e),tN(n)},tz=function(n,e){return tA(n)&&n.dom.classList.contains(e)},tj=function(n,e,t){tP(n,t),tH(n,e)},tL=Object.freeze({__proto__:null,toAlpha:function(n,e,t){tj(n.element,e.alpha,e.omega)},toOmega:function(n,e,t){tj(n.element,e.omega,e.alpha)},isAlpha:function(n,e,t){return tz(n.element,e.alpha)},isOmega:function(n,e,t){return tz(n.element,e.omega)},clear:function(n,e,t){tP(n.element,e.alpha),tP(n.element,e.omega)}}),t$=function(n){return{isValue:q,isError:X,getOr:z(n),getOrThunk:z(n),getOrDie:z(n),or:function(e){return t$(n)},orThunk:function(e){return t$(n)},fold:function(e,t){return t(n)},map:function(e){return t$(e(n))},mapError:function(e){return t$(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return Q.some(n)}}},tG=function(n){return{isValue:X,isError:q,getOr:j,getOrThunk:function(n){return n()},getOrDie:function(){return U(String(n))()},or:j,orThunk:function(n){return n()},fold:function(e,t){return e(n)},map:function(e){return tG(n)},mapError:function(e){return tG(e(n))},each:N,bind:function(e){return tG(n)},exists:X,forall:q,toOptional:Q.none}},tU={value:t$,error:tG,fromOption:function(n,e){return n.fold(function(){return tG(e)},t$)}};(f=b||(b={}))[f.Error=0]="Error",f[f.Value=1]="Value";var tW=function(n,e,t){return n.stype===b.Error?e(n.serror):t(n.svalue)},tX=function(n){return{stype:b.Value,svalue:n}},tq=function(n){return{stype:b.Error,serror:n}},tK={fromResult:function(n){return n.fold(tq,tX)},toResult:function(n){return tW(n,tU.error,tU.value)},svalue:tX,partition:function(n){var e=[],t=[];return nc(n,function(n){tW(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},serror:tq,bind:function(n,e){return n.stype===b.Value?e(n.svalue):n},bindError:function(n,e){return n.stype===b.Error?e(n.serror):n},map:function(n,e){return n.stype===b.Value?{stype:b.Value,svalue:e(n.svalue)}:n},mapError:function(n,e){return n.stype===b.Error?{stype:b.Error,serror:e(n.serror)}:n},fold:tW},tY=function(n,e,t,r){return{tag:"field",key:n,newKey:e,presence:t,prop:r}},tJ=function(n,e,t){switch(n.tag){case"field":return e(n.key,n.newKey,n.presence,n.prop);case"custom":return t(n.newKey,n.instantiator)}},tQ=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)tk(i,u)&&(r[u]=n(r[u],i[u]))}return r}},tZ=tQ(function(n,e){return _(n)&&_(e)?tZ(n,e):e}),t0=tQ(function(n,e){return e}),t1=function(){return{tag:"required",process:{}}},t2=function(n){return{tag:"defaultedThunk",process:n}},t9=function(n){return t2(z(n))},t3=function(){return{tag:"option",process:{}}},t5=function(n){return{tag:"mergeWithThunk",process:n}},t4=function(n){return P(tK.serror,np)(n)},t6={consolidateObj:function(n,e){var t,r=tK.partition(n);return r.errors.length>0?t4(r.errors):(t=r.values).length>0?tK.svalue(tZ(e,t0.apply(void 0,t))):tK.svalue(e)},consolidateArr:function(n){var e=tK.partition(n);return e.errors.length>0?t4(e.errors):tK.svalue(e.values)}},t8=function(n){return _(n)&&tp(n).length>100?" removed due to size":JSON.stringify(n,null,2)},t7=function(n,e){return tK.serror([{path:n,getErrorInfo:e}])},rn=function(n){return{extract:function(e,t){return tK.bindError(n(t),function(n){return t7(e,z(n))})},toString:z("val")}},re=rn(tK.svalue),rt=function(n,e,t,r){return r(tO(n,e).getOrThunk(function(){return t(n)}))},rr=function(n,e,t,r,o){var i,u=function(n){return o.extract(e.concat([r]),n)},c=function(n){return n.fold(function(){return tK.svalue(Q.none())},function(n){var t=o.extract(e.concat([r]),n);return tK.map(t,Q.some)})};switch(n.tag){case"required":return tO(t,r).fold(function(){return t7(e,function(){return'Could not find valid *required* value for "'+r+'" in '+t8(t)})},u);case"defaultedThunk":return rt(t,r,n.process,u);case"option":return c(tO(t,r));case"defaultedOptionThunk":return i=n.process,c(tO(t,r).map(function(n){return!0===n?i(t):n}));case"mergeWithThunk":return rt(t,r,z({}),function(e){return u(tZ(n.process(t),e))})}},ro=function(n,e,t){for(var r={},o=[],i=0;i<t.length;i++)tJ(t[i],function(t,i,u,c){var a=rr(u,n,e,t,c);tK.fold(a,function(n){o.push.apply(o,n)},function(n){r[i]=n})},function(n,t){r[n]=t(e)});return o.length>0?tK.serror(o):tK.svalue(r)},ri=function(n){var e=ru(n),t=ns(n,function(n,e){return tJ(e,function(e){var t;return tZ(n,((t={})[e]=!0,t))},z(n))},{});return{extract:function(n,r){var o=nf(I(r)?[]:tp(tx(r,B)),function(n){return!tT(t,n)});return 0===o.length?e.extract(n,r):t7(n,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"})},toString:e.toString}},ru=function(n){return{extract:function(e,t){return ro(e,t,n)},toString:function(){return"obj{\n"+nu(n,function(n){return tJ(n,function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},rc=function(n,e){var t=function(e,t){var r;return(r=rn(n),{extract:function(n,e){var t=nu(e,function(e,t){return r.extract(n.concat(["["+t+"]"]),e)});return t6.consolidateArr(t)},toString:function(){return"array("+r.toString()+")"}}).extract(e,t)};return{extract:function(n,r){var o=t(n,tp(r));return tK.bind(o,function(t){return ru(nu(t,function(n){return tY(n,n,t1(),e)})).extract(n,r)})},toString:function(){return"setOf("+e.toString()+")"}}},ra=z(re),rf=rn(function(n){var e=typeof n;return A(n)?tK.svalue(n):tK.serror("Expected type: function but got: "+e)}),rs=function(n){return rn(function(e){return n(e).fold(tK.serror,tK.svalue)})},rl=function(n,e){return rc(function(e){return tK.fromResult(n(e))},e)},rd=function(n,e,t){var r=e.extract([n],t);return tK.mapError(r,function(n){return{input:t,errors:n}})},rm=function(n,e,t){return tK.toResult(rd(n,e,t))},rg=function(n){return n.fold(function(n){throw Error(rh(n))},j)},rp=function(n,e,t){return rg(rm(n,e,t))},rh=function(n){var e;return"Errors: \n"+nu((e=n.errors).length>10?e.slice(0,10).concat([{path:[],getErrorInfo:z("... (only showing first ten failures)")}]):e,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}).join("\n")+"\n\nInput object: "+t8(n.input)},rv=function(n,e){var t;return t=tb(e,ru),{extract:function(e,r){return tO(r,n).fold(function(){return t7(e,function(){return'Choice schema did not contain choice key: "'+n+'"'})},function(n){return tO(t,n).fold(function(){return t7(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+t8(t)})},function(t){return t.extract(e.concat(["branch: "+n]),r)})})},toString:function(){return"chooseOn("+n+"). Possible values: "+tp(t)}}},rb=function(n,e){return{tag:"custom",newKey:n,instantiator:e}},ry=function(n){return tY(n,n,t1(),ra())},rx=function(n,e){return tY(n,n,t1(),e)},rS=function(n,e){return tY(n,n,t1(),ru(e))},rw=function(n){return tY(n,n,t3(),ra())},rO=function(n,e){return tY(n,n,t3(),e)},rk=function(n,e){return rO(n,ru(e))},rT=function(n,e){return rO(n,ri(e))},rC=function(n,e){return tY(n,n,t9(e),ra())},rE=function(n,e,t){return tY(n,n,t9(e),t)},rM=[ry("alpha"),ry("omega")],rD={generate:function(n){if(!R(n))throw Error("cases must be an array");if(0===n.length)throw Error("there must be at least one case");var e=[],t={};return nc(n,function(r,o){var i=tp(r);if(1!==i.length)throw Error("one and only one name per case");var u=i[0],c=r[u];if(void 0!==t[u])throw Error("duplicate key detected:"+u);if("cata"===u)throw Error("cannot have a case named cata (sorry)");if(!R(c))throw Error("case arguments must be an array");e.push(u),t[u]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t.length;if(i!==c.length)throw Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);return{fold:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length!==n.length)throw Error("Wrong number of arguments to fold. Expected "+n.length+", got "+e.length);return e[o].apply(null,t)},match:function(n){var r=tp(n);if(e.length!==r.length)throw Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+r.join(","));if(!nv(e,function(n){return no(r,n)}))throw Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+e.join(", "));return n[u].apply(null,t)},log:function(n){console.log(n,{constructors:e,constructor:u,params:t})}}}}),t}};rD.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var r_=function(n){var e=[],t=[];return nc(n,function(n){n.fold(function(n){e.push(n)},function(n){t.push(n)})}),{errors:e,values:t}},rR=function(n,e){var t={};return tv(n,function(n,r){no(e,r)||(t[r]=n)}),t},rF=function(n,e){var t;return(t={})[n]=e,t},rI=function(n){var e={};return nc(n,function(n){e[n.key]=n.value}),e},rV=function(n,e){return rF(n,e)},rB=function(n){return rI(n)},rA=function(n,e){var t,r,o=r_(n);return o.errors.length>0?(t=o.errors,tU.error(np(t))):0===(r=o.values).length?tU.value(e):tU.value(tZ(e,t0.apply(void 0,r)))},rH=function(n,e,t){return void 0===t&&(t=L),n.exists(function(n){return t(n,e)})},rN=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},rP=function(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.isSome())return Q.none();e.push(r.getOrDie())}return Q.some(e)},rz=function(n){return A(n)?n:X},rj=function(n,e,t){for(var r=n.dom,o=rz(t);r.parentNode;){r=r.parentNode;var i=eR.fromDom(r),u=e(i);if(u.isSome())return u;if(o(i))break}return Q.none()},rL=function(n,e,t){var r=e(n),o=rz(t);return r.orThunk(function(){return o(n)?Q.none():rj(n,e,o)})},r$=function(n,e){return eA(n.element,e.event.target)},rG={can:q,abort:X,run:N},rU=function(n){if(!tT(n,"can")&&!tT(n,"abort")&&!tT(n,"run"))throw Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return w(w({},rG),n)},rW=function(n){return rB(n)},rX=function(n,e){return{key:n,value:rU({abort:e})}},rq=function(n,e){return{key:n,value:rU({run:e})}},rK=function(n,e,t){return{key:n,value:rU({run:function(n,r){e.apply(void 0,[n,r].concat(t))}})}},rY=function(n){return function(e){return{key:n,value:rU({run:function(n,t){r$(n,t)&&e(n,t)}})}}},rJ=function(n,e,t){var r=e.partUids[t];return rq(n,function(e,t){e.getSystem().getByUid(r).each(function(e){eM(e,e.element,n,t)})})},rQ=function(n){return rq(n,function(n,e){e.cut()})},rZ=rY(eb()),r0=rY(ey()),r1=rY(ev()),r2=(s=em(),function(n){return rq(s,n)}),r9=function(n,e,t){var r=t.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:r3(u.slice(0,1).concat(u.slice(3)))}},n},r3=function(n){return nu(n,function(n){return nR(n,"/*")?n.substring(0,n.length-2):n})},r5=function(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:r3(i)}},n},r4=function(n,e){var t=e.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:r3(i.slice(1))}},n},r6=function(n){return{classes:V(n.classes)?[]:n.classes,attributes:V(n.attributes)?{}:n.attributes,styles:V(n.styles)?{}:n.styles}},r8=function(n,e,t){return r1(function(r,o){t(r,n,e)})},r7=function(n){return{key:n,value:void 0}},on=function(n,e,t,r,o,i,u){var c=function(n){return tT(n,t)?n[t]():Q.none()},a=tb(o,function(n,e){var r;return r9(function(e){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var u=[e].concat(o);return e.config({name:z(t)}).fold(function(){throw Error("We could not find any behaviour configuration for: "+t+". Using API: "+r)},function(t){var r=Array.prototype.slice.call(u,1);return n.apply(void 0,[e,t.config,t.state].concat(r))})},r=e,n)}),f=tb(i,function(n,e){return r5(n,e)}),s=w(w(w({},f),a),{revoke:$(r7,t),config:function(e){var r=rp(t+"-config",n,e);return{key:t,value:{config:r,me:s,configAsRaw:Z(function(){return rp(t+"-config",n,e)}),initialConfig:e,state:u}}},schema:z(e),exhibit:function(n,e){var t,o,i;return(t=c(n),o=tO(r,"exhibit"),t.isSome()&&o.isSome()?Q.some((i=t.getOrDie(),o.getOrDie()(e,i.config,i.state))):Q.none()).getOrThunk(function(){return r6({})})},name:z(t),handlers:function(n){return c(n).map(function(n){return tO(r,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return s},oe={init:function(){return ot({readState:z("No State required")})}},ot=function(n){return n},or=function(n){return rB(n)},oo=ri([ry("fields"),ry("name"),rC("active",{}),rC("apis",{}),rC("state",oe),rC("extra",{})]),oi=function(n){var e,t,r,o,i,u,c=rp("Creating behaviour: "+n.name,oo,n);return e=c.fields,t=c.name,r=c.active,o=c.apis,i=c.extra,u=c.state,on(ri(e),rk(t,[rT("config",e)]),t,r,o,i,u)},ou=ri([ry("branchKey"),ry("branches"),ry("name"),rC("active",{}),rC("apis",{}),rC("state",oe),rC("extra",{})]),oc=z(void 0),oa=oi({fields:rM,name:"swapping",apis:tL}),of=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},os=function(n){return n.dom.focus()},ol=function(n){return n.dom.blur()},od=function(n){var e=e4(n).dom;return n.dom===e.activeElement},om=function(n){return void 0===n&&(n=eR.fromDom(document)),Q.from(n.dom.activeElement).map(eR.fromDom)},og=function(n){return om(e4(n)).filter(function(e){return n.dom.contains(e.dom)})},op=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),oh=tinymce.util.Tools.resolve("tinymce.ThemeManager"),ov=function(n){var e=document.createElement("a");e.target="_blank",e.href=n.href,e.rel="noreferrer noopener";var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(t),document.body.removeChild(e)},ob=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],oy=["undo","bold","italic","link","image","bullist","styleselect"],ox="formatChanged",oS="orientationChanged",ow="dropupDismissed",oO=function(n,e){var t=(e||document).createElement("div");return t.innerHTML=n,eX(eR.fromDom(t))},ok=function(n){return n.dom.innerHTML},oT=function(n,e){var t=e$(n).dom,r=eR.fromDom(t.createDocumentFragment());e0(r,oO(e,t)),e1(n),eQ(n,r)},oC=function(n){var e=eR.fromTag("div");return eQ(e,eR.fromDom(n.dom.cloneNode(!0))),ok(e)},oE=function(n){var e;return e9(n)?"#shadow-root":oC((e=n,eR.fromDom(e.dom.cloneNode(!1))))},oM=Object.freeze({__proto__:null,events:function(n){return rW([rq(ed(),function(e,t){var r=n.channels,o=tp(r);nc(t.universal?o:nf(o,function(n){return no(t.channels,n)}),function(n){var o=r[n],i=o.schema,u=rp("channel["+n+"] data\nReceiver: "+oE(e.element),i,t.data);o.onReceive(e,u)})})])}}),oD="unknown";(l=y||(y={}))[l.STOP=0]="STOP",l[l.NORMAL=1]="NORMAL",l[l.LOGGING=2]="LOGGING";var o_=of({}),oR=function(n,e){var t=[],r=new Date().getTime();return{logEventCut:function(n,e,r){t.push({outcome:"cut",target:e,purpose:r})},logEventStopped:function(n,e,r){t.push({outcome:"stopped",target:e,purpose:r})},logNoParent:function(n,e,r){t.push({outcome:"no-parent",target:e,purpose:r})},logEventNoHandlers:function(n,e){t.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,r){t.push({outcome:"response",purpose:r,target:e})},write:function(){var o=new Date().getTime();no(["mousemove","mouseover","mouseout",ev()],n)||console.log(n,{event:n,time:o-r,target:e.dom,sequence:nu(t,function(n){return no(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+oE(n.target)+")":n.outcome})})}}},oF=function(n,e,t){switch(tO(o_.get(),n).orThunk(function(){return nw(tp(o_.get()),function(e){return n.indexOf(e)>-1?Q.some(o_.get()[e]):Q.none()})}).getOr(y.NORMAL)){case y.NORMAL:return t(oA());case y.LOGGING:var r=oR(n,e),o=t(r);return r.write(),o;case y.STOP:return!0}},oI=["alloy/data/Fields","alloy/debugging/Debugging"],oV=function(){var n=Error();return void 0!==n.stack?nm(n.stack.split("\n"),function(n){return n.indexOf("alloy")>0&&!ni(oI,function(e){return n.indexOf(e)>-1})}).getOr(oD):oD},oB=function(n,e,t){return oF(n,e,t)},oA=z({logEventCut:N,logEventStopped:N,logNoParent:N,logEventNoHandlers:N,logEventResponse:N,write:N}),oH=z([ry("menu"),ry("selectedMenu")]),oN=z([ry("item"),ry("selectedItem")]);z(ru(oN().concat(oH())));var oP=z(ru(oN())),oz=rS("initSize",[ry("numColumns"),ry("numRows")]),oj=function(n,e,t){return oV(),tY(e,e,t,rs(function(n){return tU.value(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)})}))},oL=function(n){return oj("onHandler",n,t9(N))},o$=function(n){return oj("onKeyboardHandler",n,t9(Q.none))},oG=function(n){return oj("onHandler",n,t1())},oU=function(n){return oj("onKeyboardHandler",n,t1())},oW=function(n,e){return rb(n,z(e))},oX=function(n){return rb(n,j)},oq=z(oz),oK=oi({fields:[rx("channels",rl(tU.value,ri([oG("onReceive"),rC("schema",ra())])))],name:"receiving",active:oM}),oY=function(n,e,t){var r=e.aria;r.update(n,r,t.get())},oJ=function(n,e,t){e.toggleClass.each(function(e){t.get()?tH(n.element,e):tP(n.element,e)})},oQ=function(n,e,t){o1(n,e,t,!t.get())},oZ=function(n,e,t){t.set(!0),oJ(n,e,t),oY(n,e,t)},o0=function(n,e,t){t.set(!1),oJ(n,e,t),oY(n,e,t)},o1=function(n,e,t,r){(r?oZ:o0)(n,e,t)},o2=function(n,e,t){o1(n,e,t,e.selected)},o9=Object.freeze({__proto__:null,onLoad:o2,toggle:oQ,isOn:function(n,e,t){return t.get()},on:oZ,off:o0,set:o1}),o3=Object.freeze({__proto__:null,exhibit:function(){return r6({})},events:function(n,e){var t=r2(function(t){oQ(t,n,e)}),r=r8(n,e,o2);return rW(np([n.toggleOnExecute?[t]:[],[r]]))}}),o5=function(n,e,t){tE(n.element,"aria-expanded",t)},o4=oi({fields:[rC("selected",!1),rw("toggleClass"),rC("toggleOnExecute",!0),rE("aria",{mode:"none"},rv("mode",{pressed:[rC("syncWithExpanded",!1),oW("update",function(n,e,t){tE(n.element,"aria-pressed",t),e.syncWithExpanded&&o5(n,e,t)})],checked:[oW("update",function(n,e,t){tE(n.element,"aria-checked",t)})],expanded:[oW("update",o5)],selected:[oW("update",function(n,e,t){tE(n.element,"aria-selected",t)})],none:[oW("update",N)]}))],name:"toggling",active:o3,apis:o9,state:{init:function(){var n=of(!1);return{get:function(){return n.get()},set:function(e){return n.set(e)},clear:function(){return n.set(!1)},readState:function(){return n.get()}}}}}),o6=function(n,e){return oK.config({channels:rV(ox,{onReceive:function(t,r){r.command===n&&e(t,r.state)}})})},o8=function(n){return oK.config({channels:rV(oS,{onReceive:n})})},o7=function(n,e){return{key:n,value:{onReceive:e}}},ie="tinymce-mobile",it=function(n){return ie+"-"+n},ir=function(){var n=function(n,e){e.stop(),eT(n)};return[rq(eo(),n),rq(ep(),n),rQ(n9()),rQ(n4())]},io=function(n,e){e.ignore||(os(n.element),e.onFocus(n))},ii=Object.freeze({__proto__:null,focus:io,blur:function(n,e){e.ignore||ol(n.element)},isFocused:function(n){return od(n.element)}}),iu=Object.freeze({__proto__:null,exhibit:function(n,e){return r6(e.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(n){return rW([rq(ef(),function(e,t){io(e,n),t.stop()})].concat(n.stopMousedown?[rq(n4(),function(n,e){e.event.prevent()})]:[]))}}),ic=oi({fields:[oL("onFocus"),rC("stopMousedown",!1),rC("ignore",!1)],name:"focusing",active:iu,apis:ii}),ia=function(n){return void 0!==n.style&&A(n.style.getPropertyValue)},is=function(n,e,t){if(!D(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),Error("CSS value must be a string: "+t);ia(n)&&n.style.setProperty(e,t)},il=function(n,e){ia(n)&&n.style.removeProperty(e)},id=function(n,e,t){is(n.dom,e,t)},im=function(n,e){var t=n.dom;tv(e,function(n,e){is(t,e,n)})},ig=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||tn(n)?r:ip(t,e)},ip=function(n,e){return ia(n)?n.style.getPropertyValue(e):""},ih=function(n,e){var t=ip(n.dom,e);return Q.from(t).filter(function(n){return n.length>0})},iv=function(n,e){il(n.dom,e),rH(t_(n,"style").map(nF),"")&&tF(n,"style")},ib=function(n){return n.dom.offsetWidth},iy=function(n,e){var t=function(t){var r=e(t);return r<=0||null===r?parseFloat(ig(t,n))||0:r},r=function(n,e){return nl(e,function(e,t){var r=ig(n,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:function(e,t){if(!H(t)&&!t.match(/^[0-9]+$/))throw Error(n+".set accepts only positive integer values. Value was "+t);var r=e.dom;ia(r)&&(r.style[n]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(n,e,t){var o=r(n,t);return e>o?e-o:0}}},ix=iy("height",function(n){var e=n.dom;return tn(n)?e.getBoundingClientRect().height:e.offsetHeight}),iS=function(n){return ix.get(n)},iw=function(n,e){return eV(e,n)};function iO(n,e,t,r,o){return n(t,r)?Q.some(t):A(o)&&o(t)?Q.none():e(t,r,o)}var ik=function(n,e,t){for(var r=n.dom,o=A(t)?t:X;r.parentNode;){r=r.parentNode;var i=eR.fromDom(r);if(e(i))return Q.some(i);if(o(i))break}return Q.none()},iT=function(n,e){var t=function(n){for(var r=0;r<n.childNodes.length;r++){var o=eR.fromDom(n.childNodes[r]);if(e(o))return Q.some(o);var i=t(n.childNodes[r]);if(i.isSome())return i}return Q.none()};return t(n.dom)},iC=function(n){return eB(n)},iE=function(n,e,t){return ik(n,function(n){return eF(n,e)},t)},iM=function(n,e){return eB(e,n)},iD=function(n,e,t){return iO(function(n,e){return eF(n,e)},iE,n,e,t)},i_=[9],iR=[13],iF=[27],iI=[32],iV=[37],iB=[38],iA=[39],iH=[40],iN=function(n,e,t){var r=nb(n.slice(0,e)),o=nb(n.slice(e+1));return nm(r.concat(o),t)},iP=function(n,e,t){return nm(nb(n.slice(0,e)),t)},iz=function(n,e,t){var r=n.slice(0,e);return nm(n.slice(e+1).concat(r),t)},ij=function(n,e,t){return nm(n.slice(e+1),t)},iL=function(n){return function(e){return no(n,e.raw.which)}},i$=function(n){return function(e){return nv(n,function(n){return n(e)})}},iG=function(n){return!0===n.raw.shiftKey},iU=function(n){return!0===n.raw.ctrlKey},iW=G(iG),iX=function(n,e){return{matches:n,classification:e}},iq=function(n,e,t,r){var o=n+e;return o>r?t:o<t?r:o},iK=function(n,e,t){return Math.min(Math.max(n,e),t)},iY=function(n,e,t,r){nc(iw(n.element,"."+e.highlightClass),function(t){ni(r,function(n){return n.element===t})||(tP(t,e.highlightClass),n.getSystem().getByDom(t).each(function(t){e.onDehighlight(n,t),eO(t,ew())}))})},iJ=function(n,e,t,r){iY(n,e,t,[r]),iQ(n,e,t,r)||(tH(r.element,e.highlightClass),e.onHighlight(n,r),eO(r,eS()))},iQ=function(n,e,t,r){return tz(r.element,e.highlightClass)},iZ=function(n,e,t,r){var o=iw(n.element,"."+e.itemClass);return Q.from(o[r]).fold(function(){return tU.error(Error("No element found with index "+r))},n.getSystem().getByDom)},i0=function(n,e,t){return iM(n.element,"."+e.itemClass).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},i1=function(n,e,t){var r=iw(n.element,"."+e.itemClass);return(r.length>0?Q.some(r[r.length-1]):Q.none()).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},i2=function(n,e,t,r){var o=iw(n.element,"."+e.itemClass);return ng(o,function(n){return tz(n,e.highlightClass)}).bind(function(e){var t=iq(e,r,0,o.length-1);return n.getSystem().getByDom(o[t]).toOptional()})},i9=function(n,e,t){return rN(nu(iw(n.element,"."+e.itemClass),function(e){return n.getSystem().getByDom(e).toOptional()}))},i3=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return iY(n,e,t,[])},dehighlight:function(n,e,t,r){iQ(n,e,t,r)&&(tP(r.element,e.highlightClass),e.onDehighlight(n,r),eO(r,ew()))},highlight:iJ,highlightFirst:function(n,e,t){i0(n,e).each(function(r){iJ(n,e,t,r)})},highlightLast:function(n,e,t){i1(n,e).each(function(r){iJ(n,e,t,r)})},highlightAt:function(n,e,t,r){iZ(n,e,t,r).fold(function(n){throw n},function(r){iJ(n,e,t,r)})},highlightBy:function(n,e,t,r){nm(i9(n,e),r).each(function(r){iJ(n,e,t,r)})},isHighlighted:iQ,getHighlighted:function(n,e,t){return iM(n.element,"."+e.highlightClass).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},getFirst:i0,getLast:i1,getPrevious:function(n,e,t){return i2(n,e,t,-1)},getNext:function(n,e,t){return i2(n,e,t,1)},getCandidates:i9}),i5=oi({fields:[ry("highlightClass"),ry("itemClass"),oL("onHighlight"),oL("onDehighlight")],name:"highlighting",apis:i3}),i4=function(n,e,t){e.exists(function(n){return t.exists(function(e){return eA(e,n)})})||ek(n,ex(),{prevFocus:e,newFocus:t})},i6=function(){var n=function(n){return og(n.element)};return{get:n,set:function(e,t){var r=n(e);e.getSystem().triggerFocus(t,e.element);var o=n(e);i4(e,r,o)}}},i8=function(){var n=function(n){return i5.getHighlighted(n).map(function(n){return n.element})};return{get:n,set:function(e,t){var r=n(e);e.getSystem().getByDom(t).fold(N,function(n){i5.highlight(e,n)});var o=n(e);i4(e,r,o)}}};(d=x||(x={})).OnFocusMode="onFocus",d.OnEnterOrSpaceMode="onEnterOrSpace",d.OnApiMode="onApi";var i7=function(n,e,t,r,o){var i=function(n,e,t,r,o){var i,u;return(i=t(n,e,r,o),u=e.event,nm(i,function(n){return n.matches(u)}).map(function(n){return n.classification})).bind(function(t){return t(n,e,r,o)})},u={schema:function(){return n.concat([rC("focusManager",i6()),rE("focusInside","onFocus",rs(function(n){return no(["onFocus","onEnterOrSpace","onApi"],n)?tU.value(n):tU.error("Invalid value for focusInside")})),oW("handler",u),oW("state",e),oW("sendFocusIn",o)])},processKey:i,toEvents:function(n,e){var u=n.focusInside!==x.OnFocusMode?Q.none():o(n).map(function(t){return rq(ef(),function(r,o){t(r,n,e),o.stop()})}),c=function(t,r){var i=iL(iI.concat(iR))(r.event);n.focusInside===x.OnEnterOrSpaceMode&&i&&r$(t,r)&&o(n).each(function(o){o(t,n,e),r.stop()})},a=[rq(en(),function(r,o){i(r,o,t,n,e).fold(function(){c(r,o)},function(n){o.stop()})}),rq(ee(),function(t,o){i(t,o,r,n,e).each(function(n){o.stop()})})];return rW(u.toArray().concat(a))}};return u},un=function(n){var e=[rw("onEscape"),rw("onEnter"),rC("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),rC("firstTabstop",0),rC("useTabstopAt",q),rw("visibilitySelector")].concat([n]),t=function(n,e){return iS(n.visibilitySelector.bind(function(n){return iD(e,n)}).getOr(e))>0},r=function(n,e){var r=nf(iw(n.element,e.selector),function(n){return t(e,n)});return Q.from(r[e.firstTabstop])},o=function(n,e,t){r(n,e).each(function(t){e.focusManager.set(n,t)})},i=function(n,e,r,o){var i=iw(n.element,r.selector);return r.focusManager.get(n).bind(function(n){return iD(n,r.selector)}).bind(function(e){return ng(i,$(eA,e)).bind(function(e){return o(i,e,function(n){return t(r,n)&&r.useTabstopAt(n)}).fold(function(){return r.cyclic?Q.some(!0):Q.none()},function(e){return r.focusManager.set(n,e),Q.some(!0)})})})},u=z([iX(i$([iG,iL(i_)]),function(n,e,t){var r=t.cyclic?iN:iP;return i(n,e,t,r)}),iX(iL(i_),function(n,e,t){var r=t.cyclic?iz:ij;return i(n,e,t,r)}),iX(iL(iF),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),iX(i$([iW,iL(iR)]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),c=z([]);return i7(e,oe.init,u,c,function(){return Q.some(o)})},ue=un(rb("cyclic",X)),ut=un(rb("cyclic",q)),ur=function(n){return"input"===eH(n)&&"radio"!==tD(n,"type")||"textarea"===eH(n)},uo=function(n,e,t){return ur(t)&&iL(iI)(e.event)?Q.none():(eC(n,t,em()),Q.some(!0))},ui=function(n,e){return Q.some(!0)},uu=[rC("execute",uo),rC("useSpace",!1),rC("useEnter",!0),rC("useControlEnter",!1),rC("useDown",!1)],uc=function(n,e,t){return t.execute(n,e,n.element)},ua=i7(uu,oe.init,function(n,e,t,r){var o=t.useSpace&&!ur(n.element)?iI:[],i=t.useEnter?iR:[],u=t.useDown?iH:[];return[iX(iL(o.concat(i).concat(u)),uc)].concat(t.useControlEnter?[iX(i$([iU,iL(iR)]),uc)]:[])},function(n,e,t,r){return t.useSpace&&!ur(n.element)?[iX(iL(iI),ui)]:[]},function(){return Q.none()}),uf=function(n){var e=of(Q.none()),t=function(){return e.get().each(n)};return{clear:function(){t(),e.set(Q.none())},isSet:function(){return e.get().isSome()},get:function(){return e.get()},set:function(n){t(),e.set(Q.some(n))}}},us=function(){var n=uf(function(n){return n.destroy()});return w(w({},n),{run:function(e){return n.get().each(e)}})},ul=function(){var n=uf(N);return w(w({},n),{on:function(e){return n.get().each(e)}})},ud=function(){var n=ul();return ot({readState:function(){return n.get().map(function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,t){n.set({numRows:e,numColumns:t})},getNumRows:function(){return n.get().map(function(n){return n.numRows})},getNumColumns:function(){return n.get().map(function(n){return n.numColumns})}})},um=Object.freeze({__proto__:null,flatgrid:ud,init:function(n){return n.state(n)}}),ug=function(n,e){return function(t){return"rtl"===up(t)?e:n}},up=function(n){return"rtl"===ig(n,"direction")?"rtl":"ltr"},uh=function(n){return function(e,t,r,o){return ux(n(e.element),e,t,r,o)}},uv=function(n,e){return uh(ug(n,e))},ub=function(n,e){return uh(ug(e,n))},uy=function(n){return function(e,t,r,o){return ux(n,e,t,r,o)}},ux=function(n,e,t,r,o){return r.focusManager.get(e).bind(function(t){return n(e.element,t,r,o)}).map(function(n){return r.focusManager.set(e,n),!0})},uS=function(n){var e;return!((e=n.dom).offsetWidth<=0&&e.offsetHeight<=0)},uw=function(n,e,t){var r;return ng(r=nf(iw(n,t),uS),function(n){return eA(n,e)}).map(function(n){return{index:n,candidates:r}})},uO=function(n,e){return ng(n,function(n){return eA(e,n)})},uk=function(n,e,t,r){return r(Math.floor(e/t),e%t).bind(function(e){var r=e.row*t+e.column;return r>=0&&r<n.length?Q.some(n[r]):Q.none()})},uT=function(n,e,t,r,o){return uk(n,e,r,function(e,i){var u=iq(i,o,0,(e===t-1?n.length-e*r:r)-1);return Q.some({row:e,column:u})})},uC=function(n,e,t,r,o){return uk(n,e,r,function(e,i){var u=iq(e,o,0,t-1),c=iK(i,0,(u===t-1?n.length-u*r:r)-1);return Q.some({row:u,column:c})})},uE=[ry("selector"),rC("execute",uo),o$("onEscape"),rC("captureTab",!1),oq()],uM=function(n,e,t){iM(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},uD=function(n){return function(e,t,r,o){return uw(e,t,r.selector).bind(function(e){return n(e.candidates,e.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}},u_=function(n,e,t){return t.captureTab?Q.some(!0):Q.none()},uR=uD(function(n,e,t,r){return uT(n,e,t,r,-1)}),uF=uD(function(n,e,t,r){return uT(n,e,t,r,1)}),uI=uD(function(n,e,t,r){return uC(n,e,t,r,-1)}),uV=uD(function(n,e,t,r){return uC(n,e,t,r,1)}),uB=i7(uE,ud,z([iX(iL(iV),uv(uR,uF)),iX(iL(iA),ub(uR,uF)),iX(iL(iB),uy(uI)),iX(iL(iH),uy(uV)),iX(i$([iG,iL(i_)]),u_),iX(i$([iW,iL(i_)]),u_),iX(iL(iF),function(n,e,t){return t.onEscape(n,e)}),iX(iL(iI.concat(iR)),function(n,e,t,r){return t.focusManager.get(n).bind(function(n){return iD(n,t.selector)}).bind(function(r){return t.execute(n,e,r)})})]),z([iX(iL(iI),ui)]),function(){return Q.some(uM)}),uA=function(n,e,t,r){var o=function(n,e,t){var i,u=iq(e,r,0,t.length-1);return u===n?Q.none():"button"===eH(i=t[u])&&"disabled"===tD(i,"disabled")?o(n,u,t):Q.from(t[u])};return uw(n,t,e).bind(function(n){var e=n.index;return o(e,e,n.candidates)})},uH=[ry("selector"),rC("getInitial",Q.none),rC("execute",uo),o$("onEscape"),rC("executeOnMove",!1),rC("allowVertical",!0)],uN=function(n,e,t){return t.focusManager.get(n).bind(function(n){return iD(n,t.selector)}).bind(function(r){return t.execute(n,e,r)})},uP=function(n,e,t){e.getInitial(n).orThunk(function(){return iM(n.element,e.selector)}).each(function(t){e.focusManager.set(n,t)})},uz=function(n,e,t){return uA(n,t.selector,e,-1)},uj=function(n,e,t){return uA(n,t.selector,e,1)},uL=function(n){return function(e,t,r,o){return n(e,t,r,o).bind(function(){return r.executeOnMove?uN(e,t,r):Q.some(!0)})}},u$=function(n,e,t){return t.onEscape(n,e)},uG=z([iX(iL(iI),ui)]),uU=i7(uH,oe.init,function(n,e,t,r){var o=iV.concat(t.allowVertical?iB:[]),i=iA.concat(t.allowVertical?iH:[]);return[iX(iL(o),uL(uv(uz,uj))),iX(iL(i),uL(ub(uz,uj))),iX(iL(iR),uN),iX(iL(iI),uN),iX(iL(iF),u$)]},uG,function(){return Q.some(uP)}),uW=function(n,e,t){return Q.from(n[e]).bind(function(n){return Q.from(n[t]).map(function(n){return{rowIndex:e,columnIndex:t,cell:n}})})},uX=function(n,e,t,r){var o=iq(t,r,0,n[e].length-1);return uW(n,e,o)},uq=function(n,e,t,r){var o=iq(t,r,0,n.length-1),i=iK(e,0,n[o].length-1);return uW(n,o,i)},uK=function(n,e,t,r){var o=iK(t+r,0,n[e].length-1);return uW(n,e,o)},uY=function(n,e,t,r){var o=iK(t+r,0,n.length-1),i=iK(e,0,n[o].length-1);return uW(n,o,i)},uJ=[rS("selectors",[ry("row"),ry("cell")]),rC("cycles",!0),rC("previousSelector",Q.none),rC("execute",uo)],uQ=function(n,e,t){e.previousSelector(n).orThunk(function(){var t=e.selectors;return iM(n.element,t.cell)}).each(function(t){e.focusManager.set(n,t)})},uZ=function(n,e){return function(t,r,o){var i=o.cycles?n:e;return iD(r,o.selectors.row).bind(function(n){return uO(iw(n,o.selectors.cell),r).bind(function(e){var r=iw(t,o.selectors.row);return uO(r,n).bind(function(n){return i(nu(r,function(n){return iw(n,o.selectors.cell)}),n,e).map(function(n){return n.cell})})})})}},u0=uZ(function(n,e,t){return uX(n,e,t,-1)},function(n,e,t){return uK(n,e,t,-1)}),u1=uZ(function(n,e,t){return uX(n,e,t,1)},function(n,e,t){return uK(n,e,t,1)}),u2=uZ(function(n,e,t){return uq(n,t,e,-1)},function(n,e,t){return uY(n,t,e,-1)}),u9=uZ(function(n,e,t){return uq(n,t,e,1)},function(n,e,t){return uY(n,t,e,1)}),u3=z([iX(iL(iV),uv(u0,u1)),iX(iL(iA),ub(u0,u1)),iX(iL(iB),uy(u2)),iX(iL(iH),uy(u9)),iX(iL(iI.concat(iR)),function(n,e,t){return og(n.element).bind(function(r){return t.execute(n,e,r)})})]),u5=z([iX(iL(iI),ui)]),u4=i7(uJ,oe.init,u3,u5,function(){return Q.some(uQ)}),u6=[ry("selector"),rC("execute",uo),rC("moveOnTab",!1)],u8=function(n,e,t){return t.focusManager.get(n).bind(function(r){return t.execute(n,e,r)})},u7=function(n,e,t){iM(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},cn=function(n,e,t){return uA(n,t.selector,e,-1)},ce=function(n,e,t){return uA(n,t.selector,e,1)},ct=z([iX(iL(iB),uy(cn)),iX(iL(iH),uy(ce)),iX(i$([iG,iL(i_)]),function(n,e,t,r){return t.moveOnTab?uy(cn)(n,e,t,r):Q.none()}),iX(i$([iW,iL(i_)]),function(n,e,t,r){return t.moveOnTab?uy(ce)(n,e,t,r):Q.none()}),iX(iL(iR),u8),iX(iL(iI),u8)]),cr=z([iX(iL(iI),ui)]),co=i7(u6,oe.init,ct,cr,function(){return Q.some(u7)}),ci=i7([o$("onSpace"),o$("onEnter"),o$("onShiftEnter"),o$("onLeft"),o$("onRight"),o$("onTab"),o$("onShiftTab"),o$("onUp"),o$("onDown"),o$("onEscape"),rC("stopSpaceKeyup",!1),rw("focusIn")],oe.init,function(n,e,t){return[iX(iL(iI),t.onSpace),iX(i$([iW,iL(iR)]),t.onEnter),iX(i$([iG,iL(iR)]),t.onShiftEnter),iX(i$([iG,iL(i_)]),t.onShiftTab),iX(i$([iW,iL(i_)]),t.onTab),iX(iL(iB),t.onUp),iX(iL(iH),t.onDown),iX(iL(iV),t.onLeft),iX(iL(iA),t.onRight),iX(iL(iI),t.onSpace),iX(iL(iF),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[iX(iL(iI),ui)]:[]},function(n){return n.focusIn}),cu=(n=rv((g=rp("Creating behaviour: "+(m={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ue.schema(),cyclic:ut.schema(),flow:uU.schema(),flatgrid:uB.schema(),matrix:u4.schema(),execution:ua.schema(),menu:co.schema(),special:ci.schema()}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(n,e,t){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(r){r(n,e,t)})},setGridSize:function(n,e,t,r,o){tT(t,"setGridSize")?t.setGridSize(r,o):console.error("Layout does not support setGridSize")}},state:um}).name,ou,m)).branchKey,g.branches),e=g.name,t=g.active,r=g.apis,o=g.extra,i=g.state,u=rk(e,[rO("config",n)]),on(n,u,e,t,r,o,i)),cc=function(n,e){return rE(n,{},ru(nu(e,function(e){var t,r;return t=e.name(),r="Cannot configure "+e.name()+" for "+n,tY(t,t,t3(),rn(function(n){return tK.serror("The field: "+t+" is forbidden. "+r)}))}).concat([rb("dump",j)])))},ca=function(n){return n.dump},cf=function(n,e){return w(w({},or(e)),n.dump)},cs={field:cc,augment:cf,get:ca},cl="placeholder",cd=rD.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),cm=function(n){return tk(n,"uiType")},cg=function(n,e,t,r){var o,i,u,c;return(o=n,i=0,u=t,c=r,cm(u)&&u.uiType===cl?o.exists(function(n){return n!==u.owner})?cd.single(!0,z(u)):tO(c,u.name).fold(function(){throw Error("Unknown placeholder component: "+u.name+"\nKnown: ["+tp(c)+"]\nNamespace: "+o.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))},function(n){return n.replace()}):cd.single(!1,z(u))).fold(function(o,i){var u=cm(t)?i(e,t.config,t.validated):i(e),c=nh(tO(u,"components").getOr([]),function(t){return cg(n,e,t,r)});return[w(w({},u),{components:c})]},function(n,r){if(!cm(t))return r(e);var o=r(e,t.config,t.validated);return t.validated.preprocess.getOr(j)(o)})},cp=function(n,e){var t=!1;return{name:z(n),required:function(){return e.fold(function(n,e){return n},function(n,e){return n})},used:function(){return t},replace:function(){if(t)throw Error("Trying to use the same placeholder more than once: "+n);return t=!0,e}}},ch=function(n,e,t,r){var o=tb(r,function(n,e){return cp(e,n)}),i=nh(t,function(t){return cg(n,e,t,o)});return tv(o,function(t){if(!1===t.used()&&t.required())throw Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),i},cv=cd.single,cb=cd.multiple,cy=z(cl),cx=0,cS=function(n){var e=new Date().getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++cx+String(e)},cw=rD.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),cO=rC("factory",{sketch:j}),ck=rC("schema",[]),cT=ry("name"),cC=tY("pname","pname",t2(function(n){return"<alloy."+cS(n.name)+">"}),ra()),cE=rb("schema",function(){return[rw("preprocess")]}),cM=rC("defaults",z({})),cD=rC("overrides",z({})),c_=ru([cO,ck,cT,cC,cM,cD]),cR=ru([cO,ck,cT,cM,cD]),cF=ru([cO,ck,cT,cC,cM,cD]),cI=ru([cO,cE,cT,ry("unit"),cC,cM,cD]),cV=function(n){var e=function(n){return n.name};return n.fold(e,e,e,e)},cB=function(n,e){return function(t){return n(rp("Converting part type",e,t))}},cA=cB(cw.required,c_);cB(cw.external,cR);var cH=cB(cw.optional,cF),cN=cB(cw.group,cI),cP=z("entirety"),cz=function(n,e,t,r){return tZ(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))},cj=function(n,e,t){var r={},o={};return nc(t,function(n){n.fold(function(n){r[n.pname]=cv(!0,function(e,t,r){return n.factory.sketch(cz(e,n,t,r))})},function(n){var t=e.parts[n.name];o[n.name]=z(n.factory.sketch(cz(e,n,t[cP()]),t))},function(n){r[n.pname]=cv(!1,function(e,t,r){return n.factory.sketch(cz(e,n,t,r))})},function(n){r[n.pname]=cb(!0,function(e,t,r){return nu(e[n.name],function(t){return n.factory.sketch(tZ(n.defaults(e,t,r),t,n.overrides(e,t)))})})})}),{internals:z(r),externals:z(o)}},cL=function(n,e){var t={};return nc(e,function(e){e.fold(Q.some,Q.none,Q.some,Q.some).each(function(e){var r=c$(n,e.pname);t[e.name]=function(t){var o=rp("Part: "+e.name+" in "+n,ru(e.schema),t);return w(w({},r),{config:t,validated:o})}})}),t},c$=function(n,e){return{uiType:cy(),owner:n,name:e}},cG=function(n,e,t){return cj(n,e,t)},cU=function(n,e,t){return ch(Q.some(n),e,e.components,t)},cW=function(n,e,t){var r=e.partUids[t];return n.getSystem().getByUid(r).toOptional()},cX=function(n,e,t){return cW(n,e,t).getOrDie("Could not find part: "+t)},cq=function(n,e){var t=n.getSystem();return tb(e.partUids,function(n,e){return z(t.getByUid(n))})},cK=function(n,e){var t=nu(e,cV);return rB(nu(t,function(e){return{key:e,value:n+"-"+e}}))},cY=function(n){return tY("partUids","partUids",t5(function(e){return cK(e.uid,n)}),ra())},cJ=cS("alloy-premade"),cQ=function(n){return rV(cJ,n)},cZ=function(n){return r4(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return n.apply(void 0,k([e.getApis(),e],t,!1))},n)},c0=z("alloy-id-"),c1=z("data-alloy-id"),c2=c0(),c9=c1(),c3=function(n,e){var t=cS(c2+n);return c5(e,t),t},c5=function(n,e){Object.defineProperty(n.dom,c9,{value:e,writable:!0})},c4=function(n){var e=eP(n)?n.dom[c9]:null;return Q.from(e)},c6=function(n){return cS(n)},c8=function(n,e,t,r,o){return rp(n+" [SpecSchema]",ri((r.length>0?[rS("parts",r)]:[]).concat([ry("uid"),rC("dom",{}),rC("components",[]),oX("originalSpec"),rC("debug.sketcher",{})]).concat(o).concat(e)),t)},c7=function(n,e,t,r){var o=ae(r);return t(c8(n,e,o,[],[]),o)},an=function(n,e,t,r,o){var i=ae(o),u=c8(n,e,i,nh(t,function(n){return n.fold(Q.none,Q.some,Q.none,Q.none).map(function(n){return rS(n.name,n.schema.concat([oX(cP())]))}).toArray()}),[cY(t)]),c=cG(n,u,t),a=cU(n,u,c.internals());return r(u,a,i,c.externals())},ae=function(n){return tk(n,"uid")?n:w(w({},n),{uid:c6("uid")})},at=ri([ry("name"),ry("factory"),ry("configFields"),rC("apis",{}),rC("extraApis",{})]),ar=ri([ry("name"),ry("factory"),ry("configFields"),ry("partFields"),rC("apis",{}),rC("extraApis",{})]),ao=function(n){var e=rp("Sketcher for "+n.name,at,n),t=tb(e.apis,cZ),r=tb(e.extraApis,function(n,e){return r5(n,e)});return w(w({name:e.name,configFields:e.configFields,sketch:function(n){return c7(e.name,e.configFields,e.factory,n)}},t),r)},ai=function(n){var e=rp("Sketcher for "+n.name,ar,n),t=cL(e.name,e.partFields),r=tb(e.apis,cZ),o=tb(e.extraApis,function(n,e){return r5(n,e)});return w(w({name:e.name,partFields:e.partFields,configFields:e.configFields,sketch:function(n){return an(e.name,e.configFields,e.partFields,e.factory,n)},parts:t},r),o)},au=ao({name:"Button",factory:function(n){var e=rW(np([n.action.map(function(n){return r2(function(e,t){n(e),t.stop()})}).toArray(),ir()])),t=n.dom.tag,r=function(e){return tO(n.dom,"attributes").bind(function(n){return tO(n,e)})};return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:cs.augment(n.buttonBehaviours,[ic.config({}),cu.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==t)return{role:r("role").getOr("button")};var n=r("type").getOr("button"),e=r("role").map(function(n){return{role:n}}).getOr({});return w({type:n},e)}()},eventOrder:n.eventOrder}},configFields:[rC("uid",void 0),ry("dom"),rC("components",[]),cs.field("buttonBehaviours",[ic,cu]),rw("action"),rw("role"),rC("eventOrder",{})]}),ac=oi({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return rW([rX(eu(),q)])},exhibit:function(){return r6({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),aa=function(n){var e=eR.fromHtml(n),t=eX(e),r=nl(void 0!==e.dom.attributes?e.dom.attributes:[],function(n,e){var t;return"class"===e.name?n:w(w({},n),((t={})[e.name]=e.value,t))},{}),o=Array.prototype.slice.call(e.dom.classList,0),i=0===t.length?{}:{innerHtml:ok(e)};return w({tag:eH(e),classes:o,attributes:r},i)},af=function(n){return aa(nD(n,{prefix:ie}))},as=function(n){return{dom:af(n)}},al=function(n){return or([o4.config({toggleClass:it("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),o6(n,function(n,e){(e?o4.on:o4.off)(n)})])},ad=function(n,e){var t=al(e);return ap(e,function(){n.execCommand(e)},t,n)},am=function(n,e,t,r){return ap(e,r,al(t),n)},ag=function(n,e){var t=e.ui.registry.getAll().icons;return Q.from(t[n]).fold(function(){return af('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return af('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})},ap=function(n,e,t,r){return au.sketch({dom:ag(n,r),action:e,buttonBehaviours:tZ(or([ac.config({})]),t)})},ah=cH({schema:[ry("dom")],name:"label"}),av=function(n){return cH({name:""+n+"-edge",overrides:function(e){return e.model.manager.edgeActions[n].fold(function(){return{}},function(n){return{events:rW([rK(n9(),function(e,t,r){return n(e,r)},[e]),rK(n4(),function(e,t,r){return n(e,r)},[e]),rK(n6(),function(e,t,r){r.mouseIsDown.get()&&n(e,r)},[e])])}})}})},ab=av("top-left"),ay=av("top"),ax=av("top-right"),aS=av("right"),aw=av("bottom-right"),aO=av("bottom"),ak=av("bottom-left"),aT=av("left"),aC=cA({name:"thumb",defaults:z({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:rW([rJ(n9(),n,"spectrum"),rJ(n3(),n,"spectrum"),rJ(n5(),n,"spectrum"),rJ(n4(),n,"spectrum"),rJ(n6(),n,"spectrum"),rJ(n8(),n,"spectrum")])}}}),aE=cA({schema:[rb("mouseIsDown",function(){return of(!1)})],name:"spectrum",overrides:function(n){var e=n.model.manager,t=function(t,r){return e.getValueFromEvent(r).map(function(r){return e.setValueFrom(t,n,r)})};return{behaviours:or([cu.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),ic.config({})]),events:rW([rq(n9(),t),rq(n3(),t),rq(n4(),t),rq(n6(),function(e,r){n.mouseIsDown.get()&&t(e,r)})])}}}),aM=function(n,e,t){e.store.manager.onLoad(n,e,t)},aD=function(n,e,t){e.store.manager.onUnload(n,e,t)},a_=Object.freeze({__proto__:null,onLoad:aM,onUnload:aD,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),aR=Object.freeze({__proto__:null,events:function(n,e){return rW(n.resetOnDom?[rZ(function(t,r){aM(t,n,e)}),r0(function(t,r){aD(t,n,e)})]:[r8(n,e,aM)])}}),aF=function(){var n=of(null);return ot({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},aI=function(){var n=of({}),e=of({});return ot({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:e.get()}},lookup:function(t){return tO(n.get(),t).orThunk(function(){return tO(e.get(),t)})},update:function(t){var r=n.get(),o=e.get(),i={},u={};nc(t,function(n){i[n.value]=n,tO(n,"meta").each(function(e){tO(e,"text").each(function(e){u[e]=n})})}),n.set(w(w({},r),i)),e.set(w(w({},o),u))},clear:function(){n.set({}),e.set({})}})},aV=Object.freeze({__proto__:null,memory:aF,dataset:aI,manual:function(){return ot({readState:N})},init:function(n){return n.store.manager.state(n)}}),aB=function(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)},aA=[rw("initialValue"),ry("getFallbackEntry"),ry("getDataKey"),ry("setValue"),oW("manager",{setValue:aB,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).getOrThunk(function(){return r.getFallbackEntry(o)})},onLoad:function(n,e,t){e.store.initialValue.each(function(r){aB(n,e,t,r)})},onUnload:function(n,e,t){t.clear()},state:aI})],aH=[ry("getValue"),rC("setValue",N),rw("initialValue"),oW("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(n,e,t){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:N,state:oe.init})],aN=oi({fields:[rE("store",{mode:"memory"},rv("mode",{memory:[rw("initialValue"),oW("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:aF})],manual:aH,dataset:aA})),oL("onSetValue"),rC("resetOnDom",!1)],name:"representing",active:aR,apis:a_,extra:{setValueFrom:function(n,e){var t=aN.getValue(e);aN.setValue(n,t)}},state:aV}),aP=iy("width",function(n){return n.dom.offsetWidth}),az=function(n,e){return aP.set(n,e)},aj=function(n){return aP.get(n)},aL=function(n,e){return{left:n,top:e,translate:function(t,r){return aL(n+t,e+r)}}},a$=z("slider.change.value"),aG=function(n){var e=n.event.raw;return -1!==e.type.indexOf("touch")?void 0!==e.touches&&1===e.touches.length?Q.some(e.touches[0]).map(function(n){return aL(n.clientX,n.clientY)}):Q.none():void 0!==e.clientX?Q.some(e).map(function(n){return aL(n.clientX,n.clientY)}):Q.none()},aU=function(n){return n.model.minX},aW=function(n){return n.model.minY},aX=function(n){return n.model.minX-1},aq=function(n){return n.model.minY-1},aK=function(n){return n.model.maxX},aY=function(n){return n.model.maxY},aJ=function(n){return n.model.maxX+1},aQ=function(n){return n.model.maxY+1},aZ=function(n,e,t){return e(n)-t(n)},a0=function(n){return aZ(n,aK,aU)},a1=function(n){return aZ(n,aY,aW)},a2=function(n){return a0(n)/2},a9=function(n){return a1(n)/2},a3=function(n){return n.stepSize},a5=function(n){return n.snapToGrid},a4=function(n){return n.snapStart},a6=function(n){return n.rounded},a8=function(n,e){return void 0!==n[e+"-edge"]},a7=function(n){return a8(n,"left")},fn=function(n){return a8(n,"right")},fe=function(n){return a8(n,"top")},ft=function(n){return a8(n,"bottom")},fr=function(n){return n.model.value.get()},fo=function(n){return{x:n}},fi=function(n){return{y:n}},fu=function(n,e){return{x:n,y:e}},fc=function(n,e){ek(n,a$(),{value:e})},fa=function(n,e,t,r){return n<e?n:n>t?t:n===e?e-1:Math.max(e,n-r)},ff=function(n,e,t,r){return n>t?n:n<e?e:n===t?t+1:Math.min(t,n+r)},fs=function(n,e,t){return Math.max(e,Math.min(t,n))},fl=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?e-1:e,p=s?t+1:t;if(o<l)return g;if(o>d)return p;var h=fs((Math.min(d,Math.max(o,l))-l)/m*r+e,g,p);return u&&h>=e&&h<=t?c.fold(function(){return fs(e+Math.round((h-e)/i)*i,e-1,t+1)},function(n){return Math.max(n,n+Math.min(Math.floor((t-n)/i),Math.floor((h-n)/i)+Math.round((h-n)%i/i))*i)}):a?Math.round(h):h},fd=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<e?i?0:f:o>t?u?c:s:(o-e)/r*a},fm="right",fg="bottom",fp="left",fh=function(n){return n.element.dom.getBoundingClientRect()},fv=function(n,e){return n[e]},fb=function(n){return fv(fh(n),fp)},fy=function(n){return fv(fh(n),fm)},fx=function(n){return fv(fh(n),"top")},fS=function(n){return fv(fh(n),fg)},fw=function(n){return fv(fh(n),"width")},fO=function(n){return fv(fh(n),"height")},fk=function(n,e,t){return(n+e)/2-t},fT=function(n,e){var t=fh(n),r=fh(e);return fk(fv(t,fp),fv(t,fm),fv(r,fp))},fC=function(n,e){var t=fh(n),r=fh(e);return fk(fv(t,"top"),fv(t,fg),fv(r,"top"))},fE=function(n,e){ek(n,a$(),{value:e})},fM=function(n){return{x:n}},fD=function(n,e,t){return fl({min:aU(e),max:aK(e),range:a0(e),value:t,step:a3(e),snap:a5(e),snapStart:a4(e),rounded:a6(e),hasMinEdge:a7(e),hasMaxEdge:fn(e),minBound:fb(n),maxBound:fy(n),screenRange:fw(n)})},f_=function(n,e,t){var r=(n>0?ff:fa)(fr(t).x,aU(t),aK(t),a3(t));return fE(e,fM(r)),Q.some(r)},fR=function(n){return function(e,t){return f_(n,e,t).map(q)}},fF=function(n,e,t,r,o){var i=fw(n),u=r.bind(function(e){return Q.some(fT(e,n))}).getOr(0),c=o.bind(function(e){return Q.some(fT(e,n))}).getOr(i);return fd({min:aU(e),max:aK(e),range:a0(e),value:t,hasMinEdge:a7(e),hasMaxEdge:fn(e),minBound:fb(n),minOffset:0,maxBound:fy(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c})},fI=function(n,e,t,r,o,i){var u=fF(e,i,t,r,o);return fb(e)-fb(n)+u},fV=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=fD(n,e,t);return fE(n,fM(r)),r},setToMin:function(n,e){fE(n,fM(aU(e)))},setToMax:function(n,e){fE(n,fM(aK(e)))},findValueOfOffset:fD,getValueFromEvent:function(n){return aG(n).map(function(n){return n.left})},findPositionOfValue:fI,setPositionFromValue:function(n,e,t,r){var o=fr(t),i=fI(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),t),u=aj(e.element)/2;id(e.element,"left",i-u+"px")},onLeft:fR(-1),onRight:fR(1),onUp:Q.none,onDown:Q.none,edgeActions:{"top-left":Q.none(),top:Q.none(),"top-right":Q.none(),right:Q.some(function(n,e){fc(n,fo(aJ(e)))}),"bottom-right":Q.none(),bottom:Q.none(),"bottom-left":Q.none(),left:Q.some(function(n,e){fc(n,fo(aX(e)))})}}),fB=function(n,e){ek(n,a$(),{value:e})},fA=function(n){return{y:n}},fH=function(n,e,t){return fl({min:aW(e),max:aY(e),range:a1(e),value:t,step:a3(e),snap:a5(e),snapStart:a4(e),rounded:a6(e),hasMinEdge:fe(e),hasMaxEdge:ft(e),minBound:fx(n),maxBound:fS(n),screenRange:fO(n)})},fN=function(n,e,t){var r=(n>0?ff:fa)(fr(t).y,aW(t),aY(t),a3(t));return fB(e,fA(r)),Q.some(r)},fP=function(n){return function(e,t){return fN(n,e,t).map(q)}},fz=function(n,e,t,r,o){var i=fO(n),u=r.bind(function(e){return Q.some(fC(e,n))}).getOr(0),c=o.bind(function(e){return Q.some(fC(e,n))}).getOr(i);return fd({min:aW(e),max:aY(e),range:a1(e),value:t,hasMinEdge:fe(e),hasMaxEdge:ft(e),minBound:fx(n),minOffset:0,maxBound:fS(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c})},fj=function(n,e,t,r,o,i){var u=fz(e,i,t,r,o);return fx(e)-fx(n)+u},fL=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=fH(n,e,t);return fB(n,fA(r)),r},setToMin:function(n,e){fB(n,fA(aW(e)))},setToMax:function(n,e){fB(n,fA(aY(e)))},findValueOfOffset:fH,getValueFromEvent:function(n){return aG(n).map(function(n){return n.top})},findPositionOfValue:fj,setPositionFromValue:function(n,e,t,r){var o=fr(t),i=fj(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),t),u=iS(e.element)/2;id(e.element,"top",i-u+"px")},onLeft:Q.none,onRight:Q.none,onUp:fP(-1),onDown:fP(1),edgeActions:{"top-left":Q.none(),top:Q.some(function(n,e){fc(n,fi(aq(e)))}),"top-right":Q.none(),right:Q.none(),"bottom-right":Q.none(),bottom:Q.some(function(n,e){fc(n,fi(aQ(e)))}),"bottom-left":Q.none(),left:Q.none()}}),f$=function(n,e){ek(n,a$(),{value:e})},fG=function(n,e){return{x:n,y:e}},fU=function(n,e,t,r){var o=n>0?ff:fa,i=e?fr(r).x:o(fr(r).x,aU(r),aK(r),a3(r));return f$(t,fG(i,e?o(fr(r).y,aW(r),aY(r),a3(r)):fr(r).y)),Q.some(i)},fW=function(n,e){return function(t,r){return fU(n,e,t,r).map(q)}},fX=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=fG(fD(n,e,t.left),fH(n,e,t.top));return f$(n,r),r},setToMin:function(n,e){f$(n,fG(aU(e),aW(e)))},setToMax:function(n,e){f$(n,fG(aK(e),aY(e)))},getValueFromEvent:function(n){return aG(n)},setPositionFromValue:function(n,e,t,r){var o=fr(t),i=fI(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),t),u=fj(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),t),c=aj(e.element)/2,a=iS(e.element)/2;id(e.element,"left",i-c+"px"),id(e.element,"top",u-a+"px")},onLeft:fW(-1,!1),onRight:fW(1,!1),onUp:fW(-1,!0),onDown:fW(1,!0),edgeActions:{"top-left":Q.some(function(n,e){fc(n,fu(aX(e),aq(e)))}),top:Q.some(function(n,e){fc(n,fu(a2(e),aq(e)))}),"top-right":Q.some(function(n,e){fc(n,fu(aJ(e),aq(e)))}),right:Q.some(function(n,e){fc(n,fu(aJ(e),a9(e)))}),"bottom-right":Q.some(function(n,e){fc(n,fu(aJ(e),aQ(e)))}),bottom:Q.some(function(n,e){fc(n,fu(a2(e),aQ(e)))}),"bottom-left":Q.some(function(n,e){fc(n,fu(aX(e),aQ(e)))}),left:Q.some(function(n,e){fc(n,fu(aX(e),a9(e)))})}}),fq=[rC("stepSize",1),rC("onChange",N),rC("onChoose",N),rC("onInit",N),rC("onDragStart",N),rC("onDragEnd",N),rC("snapToGrid",!1),rC("rounded",!0),rw("snapStart"),rx("model",rv("mode",{x:[rC("minX",0),rC("maxX",100),rb("value",function(n){return of(n.mode.minX)}),ry("getInitialValue"),oW("manager",fV)],y:[rC("minY",0),rC("maxY",100),rb("value",function(n){return of(n.mode.minY)}),ry("getInitialValue"),oW("manager",fL)],xy:[rC("minX",0),rC("maxX",100),rC("minY",0),rC("maxY",100),rb("value",function(n){return of({x:n.mode.minX,y:n.mode.minY})}),ry("getInitialValue"),oW("manager",fX)]})),cc("sliderBehaviours",[cu,aN]),rb("mouseIsDown",function(){return of(!1)})],fK=z("mouse.released"),fY=ai({name:"Slider",configFields:fq,partFields:[ah,aT,aS,ay,aO,ab,ax,ak,aw,aC,aE],factory:function(n,e,t,r){var o,i=function(e){return cX(e,n,"thumb")},u=function(e){return cX(e,n,"spectrum")},c=function(e){return cW(e,n,"left-edge")},a=function(e){return cW(e,n,"right-edge")},f=function(e){return cW(e,n,"top-edge")},s=function(e){return cW(e,n,"bottom-edge")},l=n.model,d=l.manager,m=function(e,t){d.setPositionFromValue(e,t,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:f,getBottomEdge:s,getSpectrum:u})},g=function(n,e){l.value.set(e);var t=i(n);m(n,t)},p=function(e,t){g(e,t);var r=i(e);return n.onChange(e,r,t),Q.some(!0)},h=function(e){var t=n.mouseIsDown.get();n.mouseIsDown.set(!1),t&&cW(e,n,"thumb").each(function(t){var r=l.value.get();n.onChoose(e,t,r)})},v=function(e,t){t.stop(),n.mouseIsDown.set(!0),n.onDragStart(e,i(e))},b=function(e,t){t.stop(),n.onDragEnd(e,i(e)),h(e)};return{uid:n.uid,dom:n.dom,components:e,behaviours:cf(n.sliderBehaviours,[cu.config({mode:"special",focusIn:function(e){return cW(e,n,"spectrum").map(cu.focusIn).map(q)}}),aN.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),oK.config({channels:((o={})[fK()]={onReceive:h},o)})]),events:rW([rq(a$(),function(n,e){p(n,e.event.value)}),rZ(function(e,t){var r=l.getInitialValue();l.value.set(r);var o=i(e);m(e,o);var c=u(e);n.onInit(e,o,c,l.value.get())}),rq(n9(),v),rq(n5(),b),rq(n4(),v),rq(n8(),b)]),apis:{resetToMin:function(e){d.setToMin(e,n)},resetToMax:function(e){d.setToMax(e,n)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(n,e,t){n.setValue(e,t)},resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),fJ=function(n,e,t,r){return ap(e,function(){var r=t();n.setContextToolbar([{label:e+" group",items:r}])},{},r)},fQ=function(n){var e=function(n){return n<0?"black":n>360?"white":"hsl("+n+", 100%, 50%)"};return fY.sketch({dom:af('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[fY.parts["left-edge"](as('<div class="${prefix}-hue-slider-black"></div>')),fY.parts.spectrum({dom:af('<div class="${prefix}-slider-gradient-container"></div>'),components:[as('<div class="${prefix}-slider-gradient"></div>')],behaviours:or([o4.config({toggleClass:it("thumb-active")})])}),fY.parts["right-edge"](as('<div class="${prefix}-hue-slider-white"></div>')),fY.parts.thumb({dom:af('<div class="${prefix}-slider-thumb"></div>'),behaviours:or([o4.config({toggleClass:it("thumb-active")})])})],onChange:function(t,r,o){var i=e(o.x());id(r.element,"background-color",i),n.onChange(t,r,i)},onDragStart:function(n,e){o4.on(e)},onDragEnd:function(n,e){o4.off(e)},onInit:function(n,t,r,o){var i=e(o.x());id(t.element,"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:n.getInitialValue()}}},sliderBehaviours:or([o8(fY.refresh)])})},fZ=function(n,e){var t={onChange:function(n,t,r){e.undoManager.transact(function(){e.formatter.apply("forecolor",{value:r}),e.nodeChanged()})},getInitialValue:z(-1)};return fJ(n,"color-levels",function(){return[fQ(t)]},e)},f0=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],f1=function(n){var e,t=n.selection.getStart(),r=eR.fromDom(t),o=eR.fromDom(n.getBody()),i=(e=function(n){return eA(o,n)},(eP(r)?Q.some(r):eU(r).filter(eP)).map(function(n){return iO(function(n,e){return e(n)},ik,n,function(n){return ih(n,"font-size").isSome()},e).bind(function(n){return ih(n,"font-size")}).getOrThunk(function(){return ig(n,"font-size")})}).getOr(""));return nm(f0,function(n){return i===n}).getOr("medium")},f2=function(n,e){f1(n)!==e&&n.execCommand("fontSize",!1,e)},f9=function(n){var e;return(e=f1(n),ng(f0,function(n){return n===e})).getOr(2)},f3=function(n,e){Q.from(f0[e]).each(function(e){f2(n,e)})},f5=z(f0),f4=ri([ry("getInitialValue"),ry("onChange"),ry("category"),ry("sizes")]),f6=function(n){var e=rp("SizeSlider",f4,n);return fY.sketch({dom:{tag:"div",classes:[it("slider-"+e.category+"-size-container"),it("slider"),it("slider-size-container")]},onChange:function(n,t,r){var o=r.x();o>=0&&o<e.sizes.length&&e.onChange(o)},onDragStart:function(n,e){o4.on(e)},onDragEnd:function(n,e){o4.off(e)},model:{mode:"x",minX:0,maxX:e.sizes.length-1,getInitialValue:function(){return{x:e.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:or([o8(fY.refresh)]),components:[fY.parts.spectrum({dom:af('<div class="${prefix}-slider-size-container"></div>'),components:[as('<div class="${prefix}-slider-size-line"></div>')]}),fY.parts.thumb({dom:af('<div class="${prefix}-slider-thumb"></div>'),behaviours:or([o4.config({toggleClass:it("thumb-active")})])})]})},f8=f5(),f7=function(n,e){var t={onChange:function(n){f3(e,n)},getInitialValue:function(){return f9(e)}};return fJ(n,"font-size",function(){var n;return n=t,[as('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),f6({onChange:n.onChange,sizes:f8,category:"font",getInitialValue:n.getInitialValue}),as('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]},e)},sn=function(n){var e=void 0!==n.uid&&tT(n,"uid")?n.uid:c6("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return w(w({},n),{uid:e})}}},se={},st={exports:se};!function(n,e,t,r){var o,i;o=this,i=function(){var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={exports:{}};(function(e){(function(n){var t=setTimeout;function r(){}function o(n){if("object"!=typeof this)throw TypeError("Promises must be constructed via new");if("function"!=typeof n)throw TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function i(n,e){for(;3===n._state;)n=n._value;if(0===n._state){n._deferreds.push(e);return}n._handled=!0,o._immediateFn(function(){var t,r=1===n._state?e.onFulfilled:e.onRejected;if(null===r){(1===n._state?u:c)(e.promise,n._value);return}try{t=r(n._value)}catch(n){c(e.promise,n);return}u(e.promise,t)})}function u(n,e){try{if(e===n)throw TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof o){n._state=3,n._value=e,a(n);return}if("function"==typeof t){s(function(){t.apply(e,arguments)},n);return}}n._state=1,n._value=e,a(n)}catch(e){c(n,e)}}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&o._immediateFn(function(){n._handled||o._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)i(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function s(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}o.prototype.catch=function(n){return this.then(null,n)},o.prototype.then=function(n,e){var t=new this.constructor(r);return i(this,new f(n,e,t)),t},o.all=function(n){var e=Array.prototype.slice.call(n);return new o(function(n,t){if(0===e.length)return n([]);for(var r=e.length,o=0;o<e.length;o++)!function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c){c.call(u,function(n){o(i,n)},t);return}}e[i]=u,0==--r&&n(e)}catch(n){t(n)}}(o,e[o])})},o.resolve=function(n){return n&&"object"==typeof n&&n.constructor===o?n:new o(function(e){e(n)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(n){return new o(function(e,t){for(var r=0,o=n.length;r<o;r++)n[r].then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(n){setImmediate(n)}:function(n){t(n,0)},o._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},o._setImmediateFn=function(n){o._immediateFn=n},o._setUnhandledRejectionFn=function(n){o._unhandledRejectionFn=n},e.exports?e.exports=o:n.Promise||(n.Promise=o)})(n)})(e);var t=e.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||t}},"object"==typeof e&&void 0!==t?t.exports=i():"function"==typeof n&&n.amd?n(i):(o="undefined"!=typeof globalThis?globalThis:o||self).EphoxContactWrapper=i()}(void 0,se,st);var sr=st.exports.boltExport,so=function(n,e){var t;(t=e,new sr(function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}).then(function(n){return n.split(",")[1]})).then(function(t){n.undoManager.transact(function(){var r=n.editorUpload.blobCache,o=r.create(cS("mceu"),e,t);r.add(o);var i=n.dom.createHTML("img",{src:o.blobUri()});n.insertContent(i)})})},si=function(n){var e=n.event.raw,t=e.target.files||e.dataTransfer.files;return Q.from(t[0])},su=function(n){var e=sn({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:rW([rQ(eo()),rq(er(),function(e,t){si(t).each(function(e){so(n,e)})})])});return au.sketch({dom:ag("image",n),components:[e.asSpec()],action:function(n){e.get(n).element.dom.click()}})},sc=function(n){return n.dom.textContent},sa=function(n,e){n.dom.textContent=e},sf=function(n){return n.length>0},ss=function(n){return null==n?"":n},sl=function(n){var e=sc(n),t=tD(n,"href"),r=tD(n,"title"),o=tD(n,"target");return{url:ss(t),text:e!==t?ss(e):"",title:ss(r),target:ss(o),link:Q.some(n)}},sd=function(n,e){e.link.bind(j).each(function(e){n.execCommand("unlink")})},sm=function(n,e){var t={};return t.href=n,e.title.toOptional().filter(sf).each(function(n){t.title=n}),e.target.toOptional().filter(sf).each(function(n){t.target=n}),t},sg=function(n,e){e.url.toOptional().filter(sf).fold(function(){sd(n,e)},function(t){var r=sm(t,e);e.link.bind(j).fold(function(){var o=e.text.toOptional().filter(sf).getOr(t);n.insertContent(n.dom.createHTML("a",r,n.dom.encode(o)))},function(n){var o=e.text.toOptional().filter(sf).fold(function(){return tD(n,"href")===sc(n)?Q.some(t):Q.none()},Q.some);tM(n,r),o.each(function(e){sa(n,e)})})})},sp=function(n){return iD(eR.fromDom(n.selection.getStart()),"a")},sh=n2(),sv=function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)},sb=function(n,e){(sh.os.isAndroid()?sv:W)(e,n)},sy=function(n,e){var t=rW(e);return oi({fields:[ry("enabled")],name:n,active:{events:z(t)}})},sx=function(n,e){var t=sy(n,e);return{key:n,value:{config:{},me:t,configAsRaw:z({}),initialConfig:{},state:oe}}},sS=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),sw=oi({fields:[ry("find")],name:"composing",apis:sS}),sO=ao({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,r=O(e,["attributes"]);return{uid:n.uid,dom:w({tag:"div",attributes:w({role:"presentation"},t)},r),components:n.components,behaviours:ca(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[rC("components",[]),cc("containerBehaviours",[]),rC("events",{}),rC("domModification",{}),rC("eventOrder",{})]}),sk=ao({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:cs.augment(n.dataBehaviours,[aN.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),sw.config({find:Q.some})]),events:rW([rZ(function(e,t){aN.setValue(e,n.getInitialValue())})])}},configFields:[ry("uid"),ry("dom"),ry("getInitialValue"),cs.field("dataBehaviours",[aN,sw])]}),sT=function(n){return n.dom.value},sC=function(n,e){if(void 0===e)throw Error("Value.set was undefined");n.dom.value=e},sE=ao({name:"Input",configFields:z([rw("data"),rC("inputAttributes",{}),rC("inputStyles",{}),rC("tag","input"),rC("inputClasses",[]),oL("onSetValue"),rC("styles",{}),rC("eventOrder",{}),cc("inputBehaviours",[aN,ic]),rC("selectOnFocus",!0)])(),factory:function(n,e){var t;return{uid:n.uid,dom:{tag:n.tag,attributes:w({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses},components:[],behaviours:(t=n,w(w({},or([ic.config({onFocus:t.selectOnFocus?function(n){var e=n.element,t=sT(e);e.dom.setSelectionRange(0,t.length)}:N})])),cf(t.inputBehaviours,[aN.config({store:w(w({mode:"manual"},t.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return sT(n.element)},setValue:function(n,e){sT(n.element)!==e&&sC(n.element,e)}}),onSetValue:t.onSetValue})]))),eventOrder:n.eventOrder}}}),sM=Object.freeze({__proto__:null,exhibit:function(n,e){return r6({attributes:rB([{key:e.tabAttr,value:"true"}])})}}),sD=oi({fields:[rC("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:sM}),s_=tinymce.util.Tools.resolve("tinymce.util.I18n"),sR=function(n,e){var t=sn(sE.sketch({inputAttributes:{placeholder:s_.translate(e)},onSetValue:function(n,e){eO(n,et())},inputBehaviours:or([sw.config({find:Q.some}),sD.config({}),cu.config({mode:"execution"})]),selectOnFocus:!1})),r=sn(au.sketch({dom:af('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var e=t.get(n);aN.setValue(e,"")}}));return{name:n,spec:sO.sketch({dom:af('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),r.asSpec()],containerBehaviours:or([o4.config({toggleClass:it("input-container-empty")}),sw.config({find:function(n){return Q.some(t.get(n))}}),sx("input-clearing",[rq(et(),function(n){var e=t.get(n);(aN.getValue(e).length>0?o4.off:o4.on)(n)})])])})}},sF=["input","button","textarea","select"],sI=function(n,e,t){(e.disabled()?sP:sz)(n,e)},sV=function(n,e){return!0===e.useNative&&no(sF,eH(n.element))},sB=function(n){tE(n.element,"disabled","disabled")},sA=function(n){tF(n.element,"disabled")},sH=function(n){tE(n.element,"aria-disabled","true")},sN=function(n){tE(n.element,"aria-disabled","false")},sP=function(n,e,t){e.disableClass.each(function(e){tH(n.element,e)}),(sV(n,e)?sB:sH)(n),e.onDisabled(n)},sz=function(n,e,t){e.disableClass.each(function(e){tP(n.element,e)}),(sV(n,e)?sA:sN)(n),e.onEnabled(n)},sj=function(n,e){return sV(n,e)?tR(n.element,"disabled"):"true"===tD(n.element,"aria-disabled")},sL=Object.freeze({__proto__:null,enable:sz,disable:sP,isDisabled:sj,onLoad:sI,set:function(n,e,t,r){(r?sP:sz)(n,e)}}),s$=Object.freeze({__proto__:null,exhibit:function(n,e){return r6({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(n,e){return rW([rX(em(),function(e,t){return sj(e,n)}),r8(n,e,sI)])}}),sG=oi({fields:[rE("disabled",X,rf),rC("useNative",!0),rw("disableClass"),oL("onDisabled"),oL("onEnabled")],name:"disabling",active:s$,apis:sL}),sU="form",sW=[cc("formBehaviours",[aN])],sX=function(n){return"<alloy.field."+n+">"},sq=function(n,e){return{uid:n.uid,dom:n.dom,components:e,behaviours:cf(n.formBehaviours,[aN.config({store:{mode:"manual",getValue:function(e){return tb(cq(e,n),function(n,e){return n().bind(function(n){var t,r;return t=sw.getCurrent(n),r=Error("Cannot find a current component to extract the value from for form part '"+e+"': "+oE(n.element)),t.fold(function(){return tU.error(r)},tU.value)}).map(aN.getValue)})},setValue:function(e,t){tv(t,function(t,r){cW(e,n,r).each(function(n){sw.getCurrent(n).each(function(n){aN.setValue(n,t)})})})}}})]),apis:{getField:function(e,t){return cW(e,n,t).bind(sw.getCurrent)}}}},sK={getField:cZ(function(n,e,t){return n.getField(e,t)}),sketch:function(n){var e,t={field:function(n,t){var r;return e.push(n),r=sX(n),{uiType:cy(),owner:sU,name:r,config:t,validated:{}}},record:z(e=[])},r=n(t);return an(sU,sW,nu(t.record(),function(n){return cA({name:n,pname:sX(n)})}),sq,r)}},sY=function(n,e){if(e===n.xValue)return n;var t=e-n.xValue>0?1:-1;return{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([{direction:t,xValue:e}])}},sJ=function(n){if(0===n.points.length)return 0;var e=n.points[0].direction,t=n.points[n.points.length-1].direction;return -1===e&&-1===t?-1:1===e&&1===t?1:0},sQ=function(n){var e="navigateEvent",t=rp("SerialisedDialog",ru([ry("fields"),rC("maxFieldIndex",n.fields.length-1),ry("onExecute"),ry("getInitialValue"),rb("state",function(){return{dialogSwipeState:ul(),currentScreen:of(0)}})]),n),r=function(n,t,r){return au.sketch({dom:af('<span class="${prefix}-icon-'+t+' ${prefix}-icon"></span>'),action:function(t){ek(t,e,{direction:n})},buttonBehaviours:or([sG.config({disableClass:it("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},o=function(n,e){iM(n.element,"."+it("serialised-dialog-chain")).each(function(n){id(n,"left",-t.state.currentScreen.get()*e.width+"px")})},i=function(n,e){var r=iw(n.element,"."+it("serialised-dialog-screen"));iM(n.element,"."+it("serialised-dialog-chain")).each(function(n){t.state.currentScreen.get()+e>=0&&t.state.currentScreen.get()+e<r.length&&(ih(n,"left").each(function(t){id(n,"left",parseInt(t,10)-e*aj(r[0])+"px")}),t.state.currentScreen.set(t.state.currentScreen.get()+e))})},u=function(n){var e=iw(n.element,"input");Q.from(e[t.state.currentScreen.get()]).each(function(e){n.getSystem().getByDom(e).each(function(e){eD(n,e.element)})});var r=f.get(n);i5.highlightAt(r,t.state.currentScreen.get())},c=function(){t.state.currentScreen.set(0),t.state.dialogSwipeState.clear()},a=sn(sK.sketch(function(n){return{dom:af('<div class="${prefix}-serialised-dialog"></div>'),components:[sO.sketch({dom:af('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:nu(t.fields,function(e,o){return o<=t.maxFieldIndex?sO.sketch({dom:af('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[r(-1,"previous",o>0),n.field(e.name,e.spec),r(1,"next",o<t.maxFieldIndex)]}):n.field(e.name,e.spec)})})],formBehaviours:or([o8(function(n,e){o(n,e)}),cu.config({mode:"special",focusIn:function(n,e){u(n)},onTab:function(n,e){return i(n,1),Q.some(!0)},onShiftTab:function(n,e){return i(n,-1),Q.some(!0)}}),sx("form-events",[rZ(function(n,e){c();var r=f.get(n);i5.highlightFirst(r),t.getInitialValue(n).each(function(e){aN.setValue(n,e)})}),r2(t.onExecute),rq(ei(),function(n,e){"left"===e.event.raw.propertyName&&u(n)}),rq(e,function(n,e){i(n,e.event.direction)})])])}})),f=sn({dom:af('<div class="${prefix}-dot-container"></div>'),behaviours:or([i5.config({highlightClass:it("dot-active"),itemClass:it("dot-item")})]),components:nh(t.fields,function(n,e){return e<=t.maxFieldIndex?[as('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:af('<div class="${prefix}-serializer-wrapper"></div>'),components:[a.asSpec(),f.asSpec()],behaviours:or([cu.config({mode:"special",focusIn:function(n){var e=a.get(n);cu.focusIn(e)}}),sx("serializer-wrapper-events",[rq(n9(),function(n,e){var r=e.event;t.state.dialogSwipeState.set({xValue:r.raw.touches[0].clientX,points:[]})}),rq(n3(),function(n,e){var r=e.event;t.state.dialogSwipeState.on(function(n){e.event.prevent(),t.state.dialogSwipeState.set(sY(n,r.raw.touches[0].clientX))})}),rq(n5(),function(n,e){t.state.dialogSwipeState.on(function(e){i(a.get(n),-1*sJ(e))})})])])}},sZ=Z(function(n,e){return[{label:"the link group",items:[sQ({fields:[sR("url","Type or paste URL"),sR("text","Link text"),sR("title","Link title"),sR("target","Link target"),{name:"link",spec:sk.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return Q.none()}})}],maxFieldIndex:3,getInitialValue:function(){return Q.some(sp(e).fold(function(){return{url:"",text:e.selection.getContent({format:"text"}),title:"",target:"",link:Q.none()}},function(n){return sl(n)}))},onExecute:function(t,r){sg(e,aN.getValue(t)),n.restoreToolbar(),e.focus()}})]}]}),s0=Object.freeze({__proto__:null,events:rW([{key:ef(),value:rU({can:function(n,e){var t=e.event,r=t.originator,o=t.target;return!eA(r,n.element)||!!eA(r,o)||(console.warn(ef()+" did not get interpreted by the desired target. \nOriginator: "+oE(r)+"\nTarget: "+oE(o)+"\nCheck the "+ef()+" event handlers"),!1)}})}])}),s1=function(n){var e=function(e){return"The component must be in a context to execute: "+e+(n?"\n"+oE(n().element)+" is not in context.":"")},t=function(n){return function(){throw Error(e(n))}},r=function(n){return function(){console.warn(e(n))}};return{debugInfo:z("fake"),triggerEvent:r("triggerEvent"),triggerFocus:r("triggerFocus"),triggerEscape:r("triggerEscape"),broadcast:r("broadcast"),broadcastOn:r("broadcastOn"),broadcastEvent:r("broadcastEvent"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:X}},s2=s1(),s9=function(n,e){var t=rm("component.behaviours",ru(nu(e,function(n){return rk(n.name(),[ry("config"),rC("state",oe)])})),n.behaviours).fold(function(e){throw Error(rh(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},j);return{list:e,data:tb(t,function(n){return z(n.map(function(n){return{config:n.config,state:n.state.init(n.config)}}))})}},s3=function(n,e){var t={};return tv(n,function(n,r){tv(n,function(n,o){var i=tO(t,o).getOr([]);t[o]=i.concat([e(r,n)])})}),t},s5=function(n,e,t,r){var o=w({},e);nc(t,function(e){o[e.name()]=e.exhibit(n,r)});var i=s3(o,function(n,e){return{name:n,modification:e}}),u=function(n){return ns(n,function(n,e){return w(w({},e.modification),n)},{})};return r6({classes:ns(i.classes,function(n,e){return e.modification.concat(n)},[]),attributes:u(i.attributes),styles:u(i.styles)})},s4=function(n,e,t,r){try{var o=nS(t,function(t,o){var i=t[e],u=o[e],c=r.indexOf(i),a=r.indexOf(u);if(-1===c)throw Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===a)throw Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return c<a?-1:a<c?1:0});return tU.value(o)}catch(n){return tU.error([n])}},s6=function(n){return n.cHandler},s8=function(n,e){return{name:n,handler:e}},s7=function(n,e){var t={};return nc(n,function(n){t[n.name()]=n.handlers(e)}),t},ln=function(n){var e=A(n)?{can:q,abort:X,run:n}:n;return function(n,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,t].concat(r);e.abort.apply(void 0,i)?t.stop():e.can.apply(void 0,i)&&e.run.apply(void 0,i)}},le=function(n,e,t){var r=e[t];return r?s4("Event: "+t,"name",n,r).map(function(n){var e;return e=nu(n,function(n){return n.handler}),{can:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return nl(e,function(e,t){return e&&t.can.apply(void 0,n)},!0)},abort:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return nl(e,function(e,t){return e||t.abort.apply(void 0,n)},!1)},run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];nc(e,function(e){e.run.apply(void 0,n)})}}}):tU.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(nu(n,function(n){return n.name}),null,2)])},lt=function(n,e){return rA(tS(n,function(n,t){return(1===n.length?tU.value(n[0].handler):le(n,e,t)).map(function(r){var o=ln(r),i=n.length>1?nf(e[t],function(e){return ni(n,function(n){return n.name===e})}).join(" > "):n[0].name;return rV(t,{handler:o,purpose:i})})}),{})},lr="alloy.base.behaviour",lo=ru([tY("dom","dom",t1(),ru([ry("tag"),rC("styles",{}),rC("classes",[]),rC("attributes",{}),rw("value"),rw("innerHtml")])),ry("components"),ry("uid"),rC("events",{}),rC("apis",{}),tY("eventOrder","eventOrder",t5(z(((S={})[em()]=["disabling",lr,"toggling","typeaheadevents"],S[ef()]=[lr,"focusing","keying"],S[ev()]=[lr,"disabling","toggling","representing"],S[et()]=[lr,"representing","streaming","invalidating"],S[ey()]=[lr,"representing","item-events","tooltipping"],S[n4()]=["focusing",lr,"item-type-events"],S[n9()]=["focusing",lr,"item-type-events"],S[n7()]=["item-type-events","tooltipping"],S[ed()]=["receiving","reflecting","tooltipping"],S))),ra()),rw("domModification")]),li=function(n,e){nc(e,function(e){tH(n,e)})},lu=function(n,e){nc(e,function(e){tP(n,e)})},lc=function(n){var e=eR.fromTag(n.tag);return tM(e,n.attributes),li(e,n.classes),im(e,n.styles),n.innerHtml.each(function(n){return oT(e,n)}),e0(e,n.domChildren),n.value.each(function(n){sC(e,n)}),n.uid,c5(e,n.uid),e},la=function(n){var e=tO(n,"behaviours").getOr({});return nh(tp(e),function(n){var t=e[n];return B(t)?[t.me]:[]})},lf=function(n){var e=la(n);return s9(n,e)},ls=function(n,e,t){var r=w(w({},n.dom),{uid:n.uid,domChildren:nu(n.components,function(n){return n.element})}),o=n.domModification.fold(function(){return r6({})},r6),i=e.length>0?s5(t,{"alloy.base.modification":o},e,r):o;return w(w({},r),{attributes:w(w({},r.attributes),i.attributes),styles:w(w({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},ll=function(n,e,t){var r,o,i,u={"alloy.base.behaviour":n.events};return(r=t,o=n.eventOrder,i=e,lt(s3(w(w({},u),s7(i,r)),s8),o)).getOrDie()},ld=function(n){var e=function(){return s},t=of(s2),r=rg(rm("custom.definition",lo,n)),o=lf(n),i=o.list,u=o.data,c=lc(ls(r,i,u)),a=ll(r,i,u),f=of(r.components),s={uid:n.uid,getSystem:t.get,config:function(e){return(A(u[e.name()])?u[e.name()]:function(){throw Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return A(u[n.name()])},spec:n,readState:function(n){return u[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(n){t.set(n)},disconnect:function(){t.set(s1(e))},element:c,syncComponents:function(){var n=nh(eX(c),function(n){return t.get().getByDom(n).fold(function(){return[]},nx)});f.set(n)},components:f.get,events:a};return s},lm=function(n){var e=j(n),t=e.events,r=O(e,["events"]),o=nu(tO(r,"components").getOr([]),lh),i=w(w({},r),{events:w(w({},s0),t),components:o});return tU.value(ld(i))},lg=function(n){return lp({element:eR.fromText(n)})},lp=function(n){var e=rp("external.component",ri([ry("element"),rw("uid")]),n),t=of(s1()),r=e.uid.getOrThunk(function(){return c6("external")});c5(e.element,r);var o={uid:r,getSystem:t.get,config:Q.none,hasConfigured:X,connect:function(n){t.set(n)},disconnect:function(){t.set(s1(function(){return o}))},getApis:function(){return{}},element:e.element,spec:n,readState:z("No state"),syncComponents:N,components:z([]),events:{}};return cQ(o)},lh=function(n){return tO(n,cJ).getOrThunk(function(){return lm(tk(n,"uid")?n:w({uid:c6("")},n)).getOrDie()})},lv="alloy.item-hover",lb="alloy.item-focus",ly=function(n){(og(n.element).isNone()||ic.isFocused(n))&&(ic.isFocused(n)||ic.focus(n),ek(n,lv,{item:n}))},lx=function(n){ek(n,lb,{item:n})},lS=z(lv),lw=z(lb),lO=[ry("data"),ry("components"),ry("dom"),rC("hasSubmenu",!1),rw("toggling"),cs.field("itemBehaviours",[o4,ic,cu,aN]),rC("ignoreFocus",!1),rC("domModification",{}),oW("builder",function(n){return{dom:n.dom,domModification:w(w({},n.domModification),{attributes:w(w(w({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:cs.augment(n.itemBehaviours,[n.toggling.fold(o4.revoke,function(n){return o4.config(w({aria:{mode:"checked"}},n))}),ic.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){lx(n)}}),cu.config({mode:"execution"}),aN.config({store:{mode:"memory",initialValue:n.data}}),sx("item-type-events",k(k([],ir(),!0),[rq(n7(),ly),rq(eg(),ic.focus)],!1))]),components:n.components,eventOrder:n.eventOrder}}),rC("eventOrder",{})],lk=[ry("dom"),ry("components"),oW("builder",function(n){return{dom:n.dom,components:n.components,events:rW([rq(eg(),function(n,e){e.stop()})])}})],lT=z("item-widget"),lC=z([cA({name:"widget",overrides:function(n){return{behaviours:or([aN.config({store:{mode:"manual",getValue:function(e){return n.data},setValue:N}})])}}})]),lE=rv("type",{widget:[ry("uid"),ry("data"),ry("components"),ry("dom"),rC("autofocus",!1),rC("ignoreFocus",!1),cs.field("widgetBehaviours",[aN,ic,cu]),rC("domModification",{}),cY(lC()),oW("builder",function(n){var e=cG(lT(),n,lC()),t=cU(lT(),n,e.internals()),r=function(e){return cW(e,n,"widget").map(function(n){return cu.focusIn(n),n})},o=function(e,t){return ur(t.event.target)||n.autofocus&&t.setSource(e.element),Q.none()};return{dom:n.dom,components:t,domModification:n.domModification,events:rW([r2(function(n,e){r(n).each(function(n){e.stop()})}),rq(n7(),ly),rq(eg(),function(e,t){n.autofocus?r(e):ic.focus(e)})]),behaviours:cs.augment(n.widgetBehaviours,[aN.config({store:{mode:"memory",initialValue:n.data}}),ic.config({ignore:n.ignoreFocus,onFocus:function(n){lx(n)}}),cu.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:oc(),onLeft:o,onRight:o,onEscape:function(e,t){return ic.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element),Q.none()):(ic.focus(e),Q.some(!0))}})])}})],item:lO,separator:lk}),lM=z([cN({factory:{sketch:function(n){var e=rp("menu.spec item",lE,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,e){return tk(e,"uid")?e:w(w({},e),{uid:c6("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),lD=z([ry("value"),ry("items"),ry("dom"),ry("components"),rC("eventOrder",{}),cc("menuBehaviours",[i5,aN,sw,cu]),rE("movement",{mode:"menu",moveOnTab:!0},rv("mode",{grid:[oq(),oW("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[oW("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),ry("rowSelector")],menu:[rC("moveOnTab",!0),oW("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),rx("markers",oP()),rC("fakeFocus",!1),rC("focusManager",i6()),oL("onHighlight")]),l_=z("alloy.menu-focus"),lR=ai({name:"Menu",configFields:lD(),partFields:lM(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:cf(n.menuBehaviours,[i5.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),aN.config({store:{mode:"memory",initialValue:n.value}}),sw.config({find:Q.some}),cu.config(n.movement.config(n,n.movement))]),events:rW([rq(lw(),function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each(function(t){i5.highlight(n,t),e.stop(),ek(n,l_(),{menu:n,item:t})})}),rq(lS(),function(n,e){var t=e.event.item;i5.highlight(n,t)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),lF=function(n,e){var t=e4(e),r=om(t).bind(function(n){var t=function(e){return eA(n,e)};return t(e)?Q.some(e):iT(e,t)}),o=n(e);return r.each(function(n){om(t).filter(function(e){return eA(e,n)}).fold(function(){os(n)},N)}),o},lI=function(n,e,t,r){var o=n.getSystem().build(r);tf(n,o,t)},lV=function(n,e,t,r){nm(lB(n),function(n){return eA(r.element,n.element)}).each(tl)},lB=function(n,e){return n.components()},lA=function(n,e,t,r,o){var i=lB(n);return Q.from(i[r]).map(function(i){return lV(n,e,t,i),o.each(function(t){lI(n,e,function(n,e){eZ(n,e,r)},t)}),i})},lH=oi({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,r){lI(n,e,eQ,r)},prepend:function(n,e,t,r){lI(n,e,eJ,r)},remove:lV,replaceAt:lA,replaceBy:function(n,e,t,r,o){return ng(lB(n),r).bind(function(r){return lA(n,e,t,r,o)})},set:function(n,e,t,r){lF(function(){var e=nu(r,n.getSystem().build);tc(n,e)},n.element)},contents:lB})}),lN=function(n,e,t,r){return tO(t,r).bind(function(r){return tO(n,r).bind(function(r){var o=lN(n,e,t,r);return Q.some([r].concat(o))})}).getOr([])},lP=function(n,e){var t={};tv(n,function(n,e){nc(n,function(n){t[n]=e})});var r=ty(e,function(n,e){return{k:n,v:e}}),o=tb(r,function(n,o){return[o].concat(lN(t,e,r,o))});return tb(t,function(n){return tO(o,n).getOr([n])})},lz=function(n){return"prepared"===n.type?Q.some(n.menu):Q.none()},lj={init:function(){var n=of({}),e=of({}),t=of({}),r=ul(),o=of({}),i=function(n){return u(n).bind(lz)},u=function(n){return tO(e.get(),n)},c=function(e){return tO(n.get(),e)};return{setMenuBuilt:function(n,t){var r;e.set(w(w({},e.get()),((r={})[n]={type:"prepared",menu:t},r)))},setContents:function(i,u,c,a){r.set(i),n.set(c),e.set(u),o.set(a);var f=lP(a,c);t.set(f)},expand:function(e){return tO(n.get(),e).map(function(n){return[n].concat(tO(t.get(),e).getOr([]))})},refresh:function(n){return tO(t.get(),n)},collapse:function(n){return tO(t.get(),n).bind(function(n){return n.length>1?Q.some(n.slice(1)):Q.none()})},lookupMenu:u,lookupItem:c,otherMenus:function(n){return ny(tp(o.get()),n)},getPrimary:function(){return r.get().bind(i)},getMenus:function(){return e.get()},clear:function(){n.set({}),e.set({}),t.set({}),r.clear()},isClear:function(){return r.get().isNone()},getTriggeringPath:function(e,o){var u=nf(c(e).toArray(),function(n){return i(n).isSome()});return tO(t.get(),e).bind(function(e){var t=nb(u.concat(e));return rP(nh(t,function(e,u){var c;return(c=t.slice(0,u+1),i(e).bind(function(t){return tw(n.get(),function(n,t){return n===e}).bind(function(n){return o(n).map(function(n){return{triggeredMenu:t,triggeringItem:n,triggeringPath:c}})})})).fold(function(){return rH(r.get(),e)?[]:[Q.none()]},function(n){return[Q.some(n)]})}))})}}},extractPreparedMenu:lz},lL=z("collapse-item"),l$=ao({name:"TieredMenu",configFields:[oU("onExecute"),oU("onEscape"),oG("onOpenMenu"),oG("onOpenSubmenu"),oL("onRepositionMenu"),oL("onCollapseMenu"),rC("highlightImmediately",!0),rS("data",[ry("primary"),ry("menus"),ry("expansions")]),rC("fakeFocus",!1),oL("onHighlight"),oL("onHover"),rS("markers",[ry("backgroundMenu")].concat(oH()).concat(oN())),ry("dom"),rC("navigateOnHover",!0),rC("stayInDom",!1),cc("tmenuBehaviours",[cu,i5,sw,lH]),rC("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(n,e){var t,r,o=ul(),i=lj.init(),u=function(e){var t,r=(t=n.data.primary,tb(n.data.menus,function(r,o){var i=function(){return lR.sketch(w(w({},r),{value:o,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?i8():i6()}))};return o===t?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})),o=a();return i.setContents(n.data.primary,r,n.data.expansions,o),i.getPrimary()},c=function(n){return aN.getValue(n).value},a=function(e){return tb(n.data.menus,function(n,e){return nh(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})},f=function(n,e){i5.highlight(n,e),i5.getHighlighted(e).orThunk(function(){return i5.getFirst(e)}).each(function(e){eC(n,e.element,eg())})},s=function(n,e){return rN(nu(e,function(e){return n.lookupMenu(e).bind(function(n){return"prepared"===n.type?Q.some(n.menu):Q.none()})}))},l=function(e,t,r){nc(s(t,t.otherMenus(r)),function(t){lu(t.element,[n.markers.backgroundMenu]),n.stayInDom||lH.remove(e,t)})},d=function(e,t){tv(o.get().getOrThunk(function(){var t={};return nc(nf(iw(e.element,"."+n.markers.item),function(n){return"true"===tD(n,"aria-haspopup")}),function(n){e.getSystem().getByDom(n).each(function(n){t[c(n)]=n})}),o.set(t),t}),function(n,e){var r=no(t,e);tE(n.element,"aria-expanded",r)})},m=function(e,t,r){return Q.from(r[0]).bind(function(o){return t.lookupMenu(o).bind(function(o){if("notbuilt"===o.type)return Q.none();var i=o.menu;return nc(s(t,r.slice(1)),function(e){tH(e.element,n.markers.backgroundMenu)}),tn(i.element)||lH.append(e,cQ(i)),lu(i.element,[n.markers.backgroundMenu]),f(e,i),l(e,t,r),Q.some(i)})})};(t=r||(r={}))[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent";var g=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return i.setMenuBuilt(e,r),r},p=function(e,t,o){if(void 0===o&&(o=r.HighlightSubmenu),t.hasConfigured(sG)&&sG.isDisabled(t))return Q.some(t);var u=c(t);return i.expand(u).bind(function(u){return d(e,u),Q.from(u[0]).bind(function(c){return i.lookupMenu(c).bind(function(a){var f=g(e,c,a);return(tn(f.element)||lH.append(e,cQ(f)),n.onOpenSubmenu(e,t,f,nb(u)),o===r.HighlightSubmenu)?(i5.highlightFirst(f),m(e,i,u)):(i5.dehighlightAll(f),Q.some(t))})})})},h=function(e,t){var r=c(t);return i.collapse(r).bind(function(r){return d(e,r),m(e,i,r).map(function(r){return n.onCollapseMenu(e,t,r),r})})},v=function(n,e){var t=c(e);return i.refresh(t).bind(function(e){return d(n,e),m(n,i,e)})},b=function(e){return function(t,r){return iD(r.getSource(),"."+n.markers.item).bind(function(n){return t.getSystem().getByDom(n).toOptional().bind(function(n){return e(t,n).map(q)})})}},y=rW([rq(l_(),function(n,e){var t=e.event.item;i.lookupItem(c(t)).each(function(){var t=e.event.menu;i5.highlight(n,t);var r=c(e.event.item);i.refresh(r).each(function(e){return l(n,i,e)})})}),r2(function(e,t){var o=t.event.target;e.getSystem().getByDom(o).each(function(t){0===c(t).indexOf("collapse-item")&&h(e,t),p(e,t,r.HighlightSubmenu).fold(function(){n.onExecute(e,t)},N)})}),rZ(function(e,t){u(e).each(function(t){lH.append(e,cQ(t)),n.onOpenMenu(e,t),n.highlightImmediately&&f(e,t)})})].concat(n.navigateOnHover?[rq(lS(),function(e,t){var o=t.event.item;v(e,o),p(e,o,r.HighlightParent),n.onHover(e,o)})]:[])),x=function(n){return i5.getHighlighted(n).bind(i5.getHighlighted)};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:cf(n.tmenuBehaviours,[cu.config({mode:"special",onRight:b(function(n,e){return ur(e.element)?Q.none():p(n,e,r.HighlightSubmenu)}),onLeft:b(function(n,e){return ur(e.element)?Q.none():h(n,e)}),onEscape:b(function(e,t){return h(e,t).orThunk(function(){return n.onEscape(e,t).map(function(){return e})})}),focusIn:function(n,e){i.getPrimary().each(function(e){eC(n,e.element,eg())})}}),i5.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),sw.config({find:function(n){return i5.getHighlighted(n)}}),lH.config({})]),eventOrder:n.eventOrder,apis:{collapseMenu:function(n){x(n).each(function(e){h(n,e)})},highlightPrimary:function(n){i.getPrimary().each(function(e){f(n,e)})},repositionMenus:function(e){i.getPrimary().bind(function(n){return x(e).bind(function(n){var e=c(n),t=rN(nu(tS(i.getMenus(),j),lj.extractPreparedMenu));return i.getTriggeringPath(e,function(n){return nw(t,function(e){return e.getSystem().isConnected()?nm(i5.getCandidates(e),function(e){return c(e)===n}):Q.none()})})}).map(function(e){return{primary:n,triggeringPath:e}})}).fold(function(){Q.from(e.components()[0]).filter(function(n){return"menu"===tD(n.element,"role")}).each(function(t){n.onRepositionMenu(e,t,[])})},function(t){var r=t.primary,o=t.triggeringPath;n.onRepositionMenu(e,r,o)})}},events:y}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:rV(n,e),expansions:{}}},collapseItem:function(n){return{value:cS(lL()),meta:{text:n}}}}}),lG=function(n,e,t,r){return tO(e.routes,r.start).bind(function(n){return tO(n,r.destination)})},lU=function(n,e,t,r){return lG(n,e,t,r).bind(function(n){return n.transition.map(function(e){return{transition:e,route:n}})})},lW=function(n,e,t){lX(n,e).bind(function(r){return lU(n,e,t,r)}).each(function(t){var r=t.transition;tP(n.element,r.transitionClass),tF(n.element,e.destinationAttr)})},lX=function(n,e,t){return t_(n.element,e.destinationAttr).map(function(t){return{start:tD(n.element,e.stateAttr),destination:t}})},lq=function(n,e,t,r){lW(n,e,t),tR(n.element,e.stateAttr)&&tD(n.element,e.stateAttr)!==r&&e.onFinish(n,r),tE(n.element,e.stateAttr,r)},lK=function(n,e,t,r){tR(n.element,e.destinationAttr)&&(t_(n.element,e.destinationAttr).each(function(t){tE(n.element,e.stateAttr,t)}),tF(n.element,e.destinationAttr))},lY=Object.freeze({__proto__:null,findRoute:lG,disableTransition:lW,getCurrentRoute:lX,jumpTo:lq,progressTo:function(n,e,t,r){lK(n,e);var o={start:tD(n.element,e.stateAttr),destination:r};lU(n,e,t,o).fold(function(){lq(n,e,t,r)},function(o){lW(n,e,t);var i=o.transition;tH(n.element,i.transitionClass),tE(n.element,e.destinationAttr,r)})},getState:function(n,e,t){return t_(n.element,e.stateAttr)}}),lJ=Object.freeze({__proto__:null,events:function(n,e){return rW([rq(ei(),function(t,r){var o=r.event.raw;lX(t,n).each(function(r){lG(t,n,e,r).each(function(i){i.transition.each(function(i){o.propertyName===i.property&&(lq(t,n,e,r.destination),n.onTransition(t,r))})})})}),rZ(function(t,r){lq(t,n,e,n.initialState)})])}}),lQ=oi({fields:[rC("destinationAttr","data-transitioning-destination"),rC("stateAttr","data-transitioning-state"),ry("initialState"),oL("onTransition"),oL("onFinish"),rx("routes",rl(tU.value,rl(tU.value,ri([rT("transition",[ry("property"),ry("transitionClass")])]))))],name:"transitioning",active:lJ,apis:lY,extra:{createRoutes:function(n){var e={};return tv(n,function(n,t){var r=t.split("<->");e[r[0]]=rV(r[1],n),e[r[1]]=rV(r[0],n)}),e},createBistate:function(n,e,t){return rB([{key:n,value:rV(e,t)},{key:e,value:rV(n,t)}])},createTristate:function(n,e,t,r){return rB([{key:n,value:rB([{key:e,value:r},{key:t,value:r}])},{key:e,value:rB([{key:n,value:r},{key:t,value:r}])},{key:t,value:rB([{key:n,value:r},{key:e,value:r}])}])}}}),lZ=it("scrollable"),l0=function(n){tH(n,lZ)},l1=function(n){tP(n,lZ)},l2=function(n){return tO(n,"format").getOr(n.title)},l9=function(n,e){var t=l5("Styles",[].concat(nu(n.items,function(e){return l3(l2(e),e.title,e.isSelected(),e.getPreview(),tT(n.expansions,l2(e)))})),e,!1),r=tZ(tb(n.menus,function(t,r){return l5(r,nu(t,function(e){return l3(l2(e),e.title,void 0!==e.isSelected&&e.isSelected(),void 0!==e.getPreview?e.getPreview():"",tT(n.expansions,l2(e)))}),e,!0)}),rV("styles",t));return{tmenu:l$.tieredData("styles",r,n.expansions)}},l3=function(n,e,t,r,o){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:o?[it("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:it("format-matches"),selected:t},itemBehaviours:or(o?[]:[o6(n,function(n,e){(e?o4.on:o4.off)(n)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:e}}]}},l5=function(n,e,t,r){return{value:n,dom:{tag:"div"},components:[au.sketch({dom:{tag:"div",classes:[it("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[it("styles-collapse-icon")]}},lg(n)]:[lg(n)],action:function(n){if(r){var e=t().get(n);l$.collapseMenu(e)}}}),{dom:{tag:"div",classes:[it("styles-menu-items-container")]},components:[lR.parts.items({})],behaviours:or([sx("adhoc-scrollable-menu",[rZ(function(n,e){id(n.element,"overflow-y","auto"),id(n.element,"-webkit-overflow-scrolling","touch"),l0(n.element)}),r0(function(n){iv(n.element,"overflow-y"),iv(n.element,"-webkit-overflow-scrolling"),l1(n.element)})])])}],items:e,menuBehaviours:or([lQ.config({initialState:"after",routes:lQ.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},l4=function(n){var e=l9(n.formats,function(){return t}),t=sn(l$.sketch({dom:{tag:"div",classes:[it("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(e,t){var r=aN.getValue(t);return n.handle(t,r.value),Q.none()},onEscape:function(){return Q.none()},onOpenMenu:function(n,e){var t=aj(n.element);az(e.element,t),lQ.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var r=aj(n.element),o=iE(e.element,'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();az(t.element,r),lQ.progressTo(i,"before"),lQ.jumpTo(t,"after"),lQ.progressTo(t,"current")},onCollapseMenu:function(n,e,t){var r=iE(e.element,'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();lQ.progressTo(o,"after"),lQ.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:e.tmenu,markers:{backgroundMenu:it("styles-background-menu"),menu:it("styles-menu"),selectedMenu:it("styles-selected-menu"),item:it("styles-item"),selectedItem:it("styles-selected-item")}}));return t.asSpec()},l6=function(n){var e=tZ(rR(n,["items"]),{menu:!0}),t=l8(n.items);return{item:e,menus:tZ(t.menus,rV(n.title,t.items)),expansions:tZ(t.expansions,rV(n.title,n.title))}},l8=function(n){return ns(n,function(n,e){var t=tT(e,"items")?l6(e):{item:e,menus:{},expansions:{}};return{menus:tZ(n.menus,t.menus),items:[t.item].concat(n.items),expansions:tZ(n.expansions,t.expansions)}},{menus:{},expansions:{},items:[]})},l7=function(n){var e=function(e){return function(){return n.formatter.match(e)}},t=function(e){return function(){return n.formatter.getCssText(e)}},r=function(r){var o=cS(r.title),i=tZ(r,{format:o,isSelected:e(o),getPreview:t(o)});return n.formatter.register(o,i),i},o=function(n){return nu(n,function(n){if(tT(n,"items")){var i=o(n.items);return tZ(tZ(n,{isSelected:X,getPreview:z("")}),{items:i})}return tT(n,"format")?tZ(n,{isSelected:e(n.format),getPreview:t(n.format)}):r(n)})};return o(n.getParam("style_formats",ob,"array"))},dn=function(n,e){var t=function(e){return nh(e,function(e){return void 0!==e.items?t(e.items).length>0?[e]:[]:!tT(e,"format")||n.formatter.canApply(e.format)?[e]:[]})};return l8(t(e))},de=function(n){var e=n.replace(/\|/g," ").trim();return e.length>0?e.split(/\s+/):[]},dt=function(n){return nh(n,function(n){return R(n)?dt(n):de(n)})},dr=function(n){var e=n.getParam("toolbar",oy,"array");return R(e)?dt(e):de(e)},di=function(n,e){var t=function(n){return function(){return ap(n,function(){e.execCommand(n)},{},e)}},r=function(n){return function(){return ad(e,n)}},o=function(n,t,r){return function(){return am(e,n,t,r)}},i=t("undo"),u=t("redo"),c=r("bold"),a=r("italic"),f=r("underline"),s=t("removeformat"),l=o("unlink","link",function(){e.execCommand("unlink",null,!1)}),d=o("unordered-list","ul",function(){e.execCommand("InsertUnorderedList",null,!1)}),m=o("ordered-list","ol",function(){e.execCommand("InsertOrderedList",null,!1)}),g=l7(e),p=function(){var n;return n=function(){e.fire("scrollIntoView")},l4({formats:dn(e,g),handle:function(t,r){e.undoManager.transact(function(){o4.isOn(t)?e.formatter.remove(r):e.formatter.apply(r)}),n()}})},h=function(n,t){return{isSupported:function(){var t=e.ui.registry.getAll().buttons;return n.forall(function(n){return tT(t,n)})},sketch:t}};return{undo:h(Q.none(),i),redo:h(Q.none(),u),bold:h(Q.none(),c),italic:h(Q.none(),a),underline:h(Q.none(),f),removeformat:h(Q.none(),s),link:h(Q.none(),function(){return am(e,"link","link",function(){var t=sZ(n,e);n.setContextToolbar(t),sb(e,function(){n.focusToolbar()}),sp(e).each(function(n){e.selection.select(n.dom)})})}),unlink:h(Q.none(),l),image:h(Q.none(),function(){return su(e)}),bullist:h(Q.some("bullist"),d),numlist:h(Q.some("numlist"),m),fontsizeselect:h(Q.none(),function(){return f7(n,e)}),forecolor:h(Q.none(),function(){return fZ(n,e)}),styleselect:h(Q.none(),function(){return ap("style-formats",function(t){e.fire("toReading"),n.dropup.appear(p,o4.on,t)},or([o4.config({toggleClass:it("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),oK.config({channels:rB([o7(oS,o4.off),o7(ow,o4.off)])})]),e)})}},du=function(n,e){var t=dr(n),r={};return nh(t,function(n){var t=!tT(r,n)&&tT(e,n)&&e[n].isSupported()?[e[n].sketch()]:[];return r[n]=!0,t})},dc=function(n){var e=eR.fromDom(e8(n).getOr(n.target)),t=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},o=P(r,t);return{target:e,x:n.clientX,y:n.clientY,stop:t,prevent:r,kill:o,raw:n}},da=function(n,e,t,r,o){var i=function(n){t(n)&&r(dc(n))};return n.dom.addEventListener(e,i,o),{unbind:$(df,n,e,i,o)}},df=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},ds=function(n,e,t){return da(n,e,q,t,!1)},dl=function(n,e,t){return da(n,e,q,t,!0)},dd=tinymce.util.Tools.resolve("tinymce.util.Delay"),dm=function(n){return{isPortrait:z(n.matchMedia("(orientation: portrait)").matches)}},dg=function(n){var e=n2().os.isiOS(),t=dm(n).isPortrait();return e&&!t?n.screen.height:n.screen.width},dp=function(n,e){var t=eR.fromDom(n),r=null,o=ds(t,"orientationchange",function(){dd.clearInterval(r);var t=dm(n);e.onChange(t),i(function(){e.onReady(t)})}),i=function(e){dd.clearInterval(r);var t=n.innerHeight,o=0;r=dd.setInterval(function(){t!==n.innerHeight?(dd.clearInterval(r),e(Q.some(n.innerHeight))):o>20&&(dd.clearInterval(r),e(Q.none())),o++},50)};return{onAdjustment:i,destroy:function(){o.unbind()}}},dh=function(n,e){e.fold(function(e){n.setStartBefore(e.dom)},function(e,t){n.setStart(e.dom,t)},function(e){n.setStartAfter(e.dom)})},dv=function(n,e){e.fold(function(e){n.setEndBefore(e.dom)},function(e,t){n.setEnd(e.dom,t)},function(e){n.setEndAfter(e.dom)})},db=function(n,e,t){var r=n.document.createRange();return dh(r,e),dv(r,t),r},dy=function(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom,t),i.setEnd(r.dom,o),i},dx=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},dS=function(n){var e=n.getClientRects(),t=e.length>0?e[0]:n.getBoundingClientRect();return t.width>0||t.height>0?Q.some(t).map(dx):Q.none()},dw=rD.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),dO=function(n,e,t){return e(eR.fromDom(t.startContainer),t.startOffset,eR.fromDom(t.endContainer),t.endOffset)},dk=function(n,e){var t=e.ltr();return t.collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return dw.rtl(eR.fromDom(n.endContainer),n.endOffset,eR.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return dO(n,dw.ltr,t)}):dO(n,dw.ltr,t)},dT=function(n,e){var t=e.match({domRange:function(n){return{ltr:z(n),rtl:Q.none}},relative:function(e,t){return{ltr:Z(function(){return db(n,e,t)}),rtl:Z(function(){return Q.some(db(n,t,e))})}},exact:function(e,t,r,o){return{ltr:Z(function(){return dy(n,e,t,r,o)}),rtl:Z(function(){return Q.some(dy(n,r,o,e,t))})}}});return dk(n,t)};dw.ltr,dw.rtl;var dC={create:function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}}},dE=(p="text",{get:function(n){if(!ez(n))throw Error("Can only get "+p+" value of a "+p+" node");return h(n).getOr("")},getOption:h=function(n){return ez(n)?Q.from(n.dom.nodeValue):Q.none()},set:function(n,e){if(!ez(n))throw Error("Can only set raw "+p+" value of a "+p+" node");n.dom.nodeValue=e}}),dM=rD.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),dD={before:dM.before,on:dM.on,after:dM.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(j,j,j)}},d_=rD.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),dR={domRange:d_.domRange,relative:d_.relative,exact:d_.exact,exactFromRange:function(n){return d_.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e;return e=n.match({domRange:function(n){return eR.fromDom(n.startContainer)},relative:function(n,e){return dD.getStart(n)},exact:function(n,e,t,r){return n}}),eR.fromDom(eG(e).dom.defaultView)},range:dC.create},dF=function(n,e){var t=eH(n);return"input"===t?dD.after(n):no(["br","img"],t)?0===e?dD.before(n):dD.after(n):dD.on(n,e)},dI=function(n,e,t,r){var o=dF(n,e),i=dF(t,r);return dR.relative(o,i)},dV=function(n,e,t,r){var o=e$(n).dom.createRange();return o.setStart(n.dom,e),o.setEnd(t.dom,r),o},dB=function(n,e,t,r){var o=dV(n,e,t,r),i=eA(n,t)&&e===r;return o.collapsed&&!i},dA=function(n){return Q.from(n.getSelection())},dH=function(n,e){dA(n).each(function(n){n.removeAllRanges(),n.addRange(e)})},dN=function(n,e,t,r,o){var i=dy(n,e,t,r,o);dH(n,i)},dP=function(n,e,t,r,o,i){e.collapse(t.dom,r),e.extend(o.dom,i)},dz=function(n,e,t,r,o){dT(n,dI(e,t,r,o)).match({ltr:function(e,t,r,o){dN(n,e,t,r,o)},rtl:function(e,t,r,o){dA(n).each(function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom,t,r.dom,o);else if(i.extend)try{dP(n,i,e,t,r,o)}catch(i){dN(n,r,o,e,t)}else dN(n,r,o,e,t)})}})},dj=function(n){if(!(n.rangeCount>0))return Q.none();var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return Q.some(dC.create(eR.fromDom(e.startContainer),e.startOffset,eR.fromDom(t.endContainer),t.endOffset))},dL=function(n){if(null===n.anchorNode||null===n.focusNode)return dj(n);var e=eR.fromDom(n.anchorNode),t=eR.fromDom(n.focusNode);return dB(e,n.anchorOffset,t,n.focusOffset)?Q.some(dC.create(e,n.anchorOffset,t,n.focusOffset)):dj(n)},d$=function(n){return dA(n).filter(function(n){return n.rangeCount>0}).bind(dL)},dG=function(n,e){return dS(dT(n,e).match({ltr:function(e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom,t),i.setEnd(r.dom,o),i},rtl:function(e,t,r,o){var i=n.document.createRange();return i.setStart(r.dom,o),i.setEnd(e.dom,t),i}}))},dU=function(n){dA(n).each(function(n){return n.removeAllRanges()})},dW=function(n){return Q.from(n.dom.contentWindow)},dX=function(n){return dW(n).bind(d$)},dq=function(n){return n.getFrame()},dK=function(n,e,t,r){return n[t].getOrThunk(function(){return function(n){return ds(e,r,n)}})},dY=function(n){var e=dq(n);return Q.some(eR.fromDom(e.dom.contentWindow.document.body)).bind(function(t){return Q.some(eR.fromDom(e.dom.contentWindow.document)).bind(function(r){return dW(e).map(function(o){var i=eR.fromDom(r.dom.documentElement),u=n.getCursorBox.getOrThunk(function(){return function(){return d$(o).map(function(n){return dR.exact(n.start,n.soffset,n.finish,n.foffset)}).bind(function(n){return dG(o,n).orThunk(function(){return d$(o).filter(function(n){return eA(n.start,n.finish)&&n.soffset===n.foffset}).bind(function(n){var e=n.start.dom.getBoundingClientRect();return e.width>0||e.height>0?Q.some(e):Q.none()})})})}}),c=n.setSelection.getOrThunk(function(){return function(n,e,t,r){dz(o,n,e,t,r)}}),a=n.clearSelection.getOrThunk(function(){return function(){dU(o)}});return{body:t,doc:r,win:o,html:i,getSelection:$(dX,e),setSelection:c,clearSelection:a,frame:e,onKeyup:dK(n,r,"onKeyup","keyup"),onNodeChanged:dK(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:u}})})})},dJ=function(){var n=iC("head").getOrDie(),e=iC('meta[name="viewport"]').getOrThunk(function(){var e=eR.fromTag("meta");return tE(e,"name","viewport"),eQ(n,e),e}),t=tD(e,"content");return{maximize:function(){tE(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=t&&t.length>0?tE(e,"content",t):tE(e,"content","user-scalable=yes")}}},dQ="data-ephox-mobile-fullscreen-style",dZ="position:absolute!important;",d0="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",d1=n2().os.isAndroid(),d2=function(n){var e=ig(n,"background-color");return void 0!==e&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;"},d9=function(n,e){var t,r,o=function(n){return function(e){var t=tD(e,"style"),r=void 0===t?"no-styles":t.trim();r!==n&&(tE(e,dQ,r),tE(e,"style",n))}},i=(t="*",nf(eW(n,void 0),function(n){return eF(n,"*")})),u=nh(i,function(n){var e,t;return e=n,t=function(n){return eF(n,"*")},nf(eU(e).map(eX).map(function(n){return nf(n,function(n){return!eA(e,n)})}).getOr([]),t)}),c=d2(e);nc(u,o("display:none!important;")),nc(i,o(dZ+d0+c)),o((!0===d1?"":dZ)+d0+c)(n)},d3=function(){nc(eV("["+dQ+"]"),function(n){var e=tD(n,dQ);"no-styles"!==e?tE(n,"style",e):tF(n,"style"),tF(n,dQ)})},d5=function(n,e){var t=null;return{cancel:function(){null!==t&&(clearTimeout(t),t=null)},schedule:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];t=setTimeout(function(){n.apply(null,r),t=null},e)}}},d4=function(n){var e=n.raw;return void 0===e.touches||1!==e.touches.length?Q.none():Q.some(e.touches[0])},d6=function(n,e){var t=Math.abs(n.clientX-e.x),r=Math.abs(n.clientY-e.y);return t>5||r>5},d8=function(n){var e=ul(),t=of(!1),r=d5(function(e){n.triggerEvent(eh(),e),t.set(!0)},400),o=rB([{key:n9(),value:function(n){return d4(n).each(function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:n.target};r.schedule(n),t.set(!1),e.set(i)}),Q.none()}},{key:n3(),value:function(n){return r.cancel(),d4(n).each(function(n){e.on(function(t){d6(n,t)&&e.clear()})}),Q.none()}},{key:n5(),value:function(o){return r.cancel(),e.get().filter(function(n){return eA(n.target,o.target)}).map(function(e){return t.get()?(o.prevent(),!1):n.triggerEvent(ep(),o)})}}]);return{fireIfReady:function(n,e){return tO(o,e).bind(function(e){return e(n)})}}},d7=function(n){var e=d8({triggerEvent:function(e,t){n.onTapContent(t)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return ds(n.body,"touchend",function(n){e.fireIfReady(n,"touchend")})},onTouchmove:function(){return ds(n.body,"touchmove",function(n){e.fireIfReady(n,"touchmove")})}}},mn=n2().os.version.major>=6,me=function(n,e,t){var r=d7(n),o=e$(e),i=function(n){return!eA(n.start,n.finish)||n.soffset!==n.foffset},u=function(){var r=n.doc.dom.hasFocus()&&n.getSelection().exists(i);t.getByDom(e).each((r||om(o).filter(function(n){return"input"===eH(n)}).exists(function(n){return n.dom.selectionStart!==n.dom.selectionEnd}))===!0?o4.on:o4.off)},c=[ds(n.body,"touchstart",function(e){n.onTouchContent(),r.fireTouchstart(e)}),r.onTouchmove(),r.onTouchend(),ds(e,"touchstart",function(e){n.onTouchToolstrip()}),n.onToReading(function(){ol(n.body)}),n.onToEditing(N),n.onScrollToCursor(function(e){e.preventDefault(),n.getCursorBox().each(function(e){var t=n.win,r=e.top>t.innerHeight||e.bottom>t.innerHeight?e.bottom-t.innerHeight+50:0;0!==r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)})})].concat(!0===mn?[]:[ds(eR.fromDom(n.win),"blur",function(){t.getByDom(e).each(o4.off)}),ds(o,"select",u),ds(n.doc,"selectionchange",u)]);return{destroy:function(){nc(c,function(n){n.unbind()})}}},mt=function(n,e){var t=parseInt(tD(n,e),10);return isNaN(t)?0:t},mr=function(n){return w(w({},n),{width:2})},mo=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},mi=function(n){if(!n.collapsed)return nu(n.getClientRects(),mo);var e=eR.fromDom(n.startContainer);return eU(e).bind(function(t){var r,o=dR.exact(e,n.startOffset,t,"img"===eH(r=t)?1:dE.getOption(r).fold(function(){return eX(r).length},function(n){return n.length}));return dG(n.startContainer.ownerDocument.defaultView,o).map(mr).map(nx)}).getOr([])},mu=function(n){var e=n.getSelection();return void 0!==e&&e.rangeCount>0?mi(e.getRangeAt(0)):[]},mc=function(n){n.focus();var e=eR.fromDom(n.document.body);(om().exists(function(n){return no(["input","textarea"],eH(n))})?function(n){dd.setTimeout(function(){n()},0)}:W)(function(){om().each(ol),os(e)})},ma="data-"+it("last-outer-height"),mf=function(n,e){tE(n,ma,e)},ms=function(n){return{top:n.top,bottom:n.top+n.height}},ml=function(n){var e=mu(n);return e.length>0?Q.some(e[0]).map(ms):Q.none()},md=function(n,e){var t=mt(e,ma),r=n.innerHeight;return t>r?Q.some(t-r):Q.none()},mm=function(n,e){var t=eR.fromDom(e.document.body),r=ds(eR.fromDom(n),"resize",function(){md(n,t).each(function(n){ml(e).each(function(t){var r=t.top>e.innerHeight||t.bottom>e.innerHeight?Math.min(n,t.bottom-e.innerHeight+50):0;0!==r&&e.scrollTo(e.pageXOffset,e.pageYOffset+r)})}),mf(t,n.innerHeight)});return mf(t,n.innerHeight),{toEditing:function(){mc(e)},destroy:function(){r.unbind()}}},mg=function(n,e){var t=dJ(),r=us(),o=us();return{enter:function(){var i;e.hide(),tH(n.container,it("fullscreen-maximized")),tH(n.container,it("android-maximized")),t.maximize(),tH(n.body,it("android-scroll-reload")),r.set(mm(n.win,(i=n.editor).getWin.getOrThunk(function(){var n=dq(i);return function(){return dW(n)}})().getOrDie("no"))),dY(n.editor).each(function(e){d9(n.container,e.body),o.set(me(e,n.toolstrip,n.alloy))})},exit:function(){t.restore(),e.show(),tP(n.container,it("fullscreen-maximized")),tP(n.container,it("android-maximized")),d3(),tP(n.body,it("android-scroll-reload")),o.clear(),r.clear()}}},mp=function(n,e){var t=null;return{cancel:function(){F(t)||(clearTimeout(t),t=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];F(t)&&(t=setTimeout(function(){t=null,n.apply(null,r)},e))}}},mh=function(n,e){var t=null,r=function(){F(t)||(clearTimeout(t),t=null)};return{cancel:r,throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r(),t=setTimeout(function(){t=null,n.apply(null,o)},e)}}},mv=function(n,e){var t=sn(sO.sketch({dom:af('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:or([o4.config({toggleClass:it("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=mp(n,200);return sO.sketch({dom:af('<div class="${prefix}-disabled-mask"></div>'),components:[sO.sketch({dom:af('<div class="${prefix}-content-container"></div>'),components:[au.sketch({dom:af('<div class="${prefix}-content-tap-section"></div>'),components:[t.asSpec()],action:function(n){r.throttle()},buttonBehaviours:or([o4.config({toggleClass:it("mask-tap-icon-selected")})])})]})]})},mb=z({unbind:N}),my=ru([rS("editor",[ry("getFrame"),rw("getBody"),rw("getDoc"),rw("getWin"),rw("getSelection"),rw("setSelection"),rw("clearSelection"),rw("cursorSaver"),rw("onKeyup"),rw("onNodeChanged"),rw("getCursorBox"),ry("onDomChanged"),rC("onTouchContent",N),rC("onTapContent",N),rC("onTouchToolstrip",N),rC("onScrollToCursor",mb),rC("onScrollToElement",mb),rC("onToEditing",mb),rC("onToReading",mb),rC("onToolbarScrollStart",j)]),ry("socket"),ry("toolstrip"),ry("dropup"),ry("toolbar"),ry("container"),ry("alloy"),rb("win",function(n){return e$(n.socket).dom.defaultView}),rb("body",function(n){return eR.fromDom(n.socket.dom.ownerDocument.body)}),rC("translate",j),rC("setReadOnly",N),rC("readOnlyOnInit",q)]),mx=function(n){var e=rp("Getting AndroidWebapp schema",my,n);id(e.toolstrip,"width","100%");var t=lh(mv(function(){e.setReadOnly(e.readOnlyOnInit()),r.enter()},e.translate));e.alloy.add(t),eQ(e.container,t.element);var r=mg(e,{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}});return{setReadOnly:e.setReadOnly,refreshStructure:N,enter:r.enter,exit:r.exit,destroy:N}},mS=z([ry("dom"),rC("shell",!0),cc("toolbarBehaviours",[lH])]),mw=z([cH({name:"groups",overrides:function(){return{behaviours:or([lH.config({})])}}})]),mO=ai({name:"Toolbar",configFields:mS(),partFields:mw(),factory:function(n,e,t,r){var o=n.shell?{behaviours:[lH.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:o.components,behaviours:cf(n.toolbarBehaviours,o.behaviours),apis:{setGroups:function(e,t){(n.shell?Q.some(e):cW(e,n,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){lH.set(n,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),mk=z([ry("items"),rS("markers",nu(["itemSelector"],ry)),cc("tgroupBehaviours",[cu])]),mT=z([cN({name:"items",unit:"item"})]),mC=ai({name:"ToolbarGroup",configFields:mk(),partFields:mT(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,components:e,behaviours:cf(n.tgroupBehaviours,[cu.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),mE="data-"+it("horizontal-scroll"),mM=function(n){n.dom.scrollTop=1;var e=0!==n.dom.scrollTop;return n.dom.scrollTop=0,e},mD=function(n){n.dom.scrollLeft=1;var e=0!==n.dom.scrollLeft;return n.dom.scrollLeft=0,e},m_=function(n){tE(n,mE,"true")},mR=function(n){return"true"===tD(n,mE)?n.dom.scrollLeft>0||mD(n):n.dom.scrollTop>0||mM(n)},mF=function(){var n=function(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:af('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:or([sx("adhoc-scrollable-toolbar",!0===n.scrollable?[r1(function(n,e){id(n.element,"overflow-x","auto"),m_(n.element),l0(n.element)})]:[])]),components:[sO.sketch({components:[mC.parts.items({})]})],markers:{itemSelector:"."+it("toolbar-group-item")},items:n.items}},e=lh(mO.sketch({dom:af('<div class="${prefix}-toolbar"></div>'),components:[mO.parts.groups({})],toolbarBehaviours:or([o4.config({toggleClass:it("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),cu.config({mode:"cyclic"})]),shell:!0})),t=lh(sO.sketch({dom:{classes:[it("toolstrip")]},components:[cQ(e)],containerBehaviours:or([o4.config({toggleClass:it("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){mO.setGroups(e,o.get()),o4.off(e)},o=of([]);return{wrapper:t,toolbar:e,createGroups:function(e){return nu(e,P(mC.sketch,n))},setGroups:function(n){o.set(n),r()},setContextToolbar:function(n){o4.on(e),mO.setGroups(e,n)},restoreToolbar:function(){o4.isOn(e)&&r()},refresh:function(){},focus:function(){cu.focusIn(e)}}},mI=function(n){return lh(au.sketch({dom:af('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))},mV=function(){return lh(sO.sketch({dom:af('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:or([lH.config({})])}))},mB=function(n,e){lH.append(n,cQ(e))},mA=function(n,e){lH.remove(n,e)},mH=function(n,e,t,r){(!0===t?oa.toAlpha:oa.toOmega)(r),(t?mB:mA)(n,e)},mN=function(n,e){return e.getAnimationRoot.fold(function(){return n.element},function(e){return e(n)})},mP=function(n){return n.dimension.property},mz=function(n,e){return n.dimension.getDimension(e)},mj=function(n,e){lu(mN(n,e),[e.shrinkingClass,e.growingClass])},mL=function(n,e){tP(n.element,e.openClass),tH(n.element,e.closedClass),id(n.element,mP(e),"0px"),ib(n.element)},m$=function(n,e){tP(n.element,e.closedClass),tH(n.element,e.openClass),iv(n.element,mP(e))},mG=function(n,e,t,r){t.setCollapsed(),id(n.element,mP(e),mz(e,n.element)),ib(n.element),mj(n,e),mL(n,e),e.onStartShrink(n),e.onShrunk(n)},mU=function(n,e,t,r){var o=r.getOrThunk(function(){return mz(e,n.element)});t.setCollapsed(),id(n.element,mP(e),o),ib(n.element);var i=mN(n,e);tP(i,e.growingClass),tH(i,e.shrinkingClass),mL(n,e),e.onStartShrink(n)},mW=function(n,e,t){var r=mz(e,n.element);("0px"===r?mG:mU)(n,e,t,Q.some(r))},mX=function(n,e,t){var r=mN(n,e),o=tz(r,e.shrinkingClass),i=mz(e,n.element);m$(n,e);var u=mz(e,n.element);(o?function(){id(n.element,mP(e),i),ib(n.element)}:function(){mL(n,e)})(),tP(r,e.shrinkingClass),tH(r,e.growingClass),m$(n,e),id(n.element,mP(e),u),t.setExpanded(),e.onStartGrow(n)},mq=function(n,e,t){return!0===tz(mN(n,e),e.growingClass)},mK=function(n,e,t){return!0===tz(mN(n,e),e.shrinkingClass)},mY=Object.freeze({__proto__:null,refresh:function(n,e,t){if(t.isExpanded()){iv(n.element,mP(e));var r=mz(e,n.element);id(n.element,mP(e),r)}},grow:function(n,e,t){t.isExpanded()||mX(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&mW(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&mG(n,e,t)},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:mq,isShrinking:mK,isTransitioning:function(n,e,t){return mq(n,e)||mK(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?mW:mX)(n,e,t)},disableTransitions:mj}),mJ=Object.freeze({__proto__:null,exhibit:function(n,e,t){return e.expanded?r6({classes:[e.openClass],styles:{}}):r6({classes:[e.closedClass],styles:rV(e.dimension.property,"0px")})},events:function(n,e){return rW([rY(ei())(function(t,r){r.event.raw.propertyName===n.dimension.property&&(mj(t,n),e.isExpanded()&&iv(t.element,n.dimension.property),(e.isExpanded()?n.onGrown:n.onShrunk)(t))})])}}),mQ=oi({fields:[ry("closedClass"),ry("openClass"),ry("shrinkingClass"),ry("growingClass"),rw("getAnimationRoot"),oL("onShrunk"),oL("onStartShrink"),oL("onGrown"),oL("onStartGrow"),rC("expanded",!1),rx("dimension",rv("property",{width:[oW("property","width"),oW("getDimension",function(n){return aj(n)+"px"})],height:[oW("property","height"),oW("getDimension",function(n){return iS(n)+"px"})]}))],name:"sliding",active:mJ,apis:mY,state:Object.freeze({__proto__:null,init:function(n){var e=of(n.expanded);return ot({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:$(e.set,!1),setExpanded:$(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),mZ=function(n,e){var t=lh(sO.sketch({dom:{tag:"div",classes:[it("dropup")]},components:[],containerBehaviours:or([lH.config({}),mQ.config({closedClass:it("dropup-closed"),openClass:it("dropup-open"),shrinkingClass:it("dropup-shrinking"),growingClass:it("dropup-growing"),dimension:{property:"height"},onShrunk:function(t){n(),e(),lH.set(t,[])},onGrown:function(t){n(),e()}}),o8(function(n,e){r(N)})])})),r=function(n){window.requestAnimationFrame(function(){n(),mQ.shrink(t)})};return{appear:function(n,e,r){!0===mQ.hasShrunk(t)&&!1===mQ.isTransitioning(t)&&window.requestAnimationFrame(function(){e(r),lH.set(t,[n()]),mQ.grow(t)})},disappear:r,component:t,element:t.element}},m0=function(){return n2().browser.isFirefox()},m1=function(n,e){var t,r,o=w({stopBackspace:!0},e),i=d8(o),u=nu(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(e){return ds(n,e,function(n){i.fireIfReady(n,e).each(function(e){e&&n.kill()}),o.triggerEvent(e,n)&&n.kill()})}),c=ul(),a=ds(n,"paste",function(n){i.fireIfReady(n,"paste").each(function(e){e&&n.kill()}),o.triggerEvent("paste",n)&&n.kill(),c.set(setTimeout(function(){o.triggerEvent(el(),n)},0))}),f=ds(n,"keydown",function(n){var e;o.triggerEvent("keydown",n)?n.kill():!o.stopBackspace||8!==(e=n).raw.which||no(["input","textarea"],eH(e.target))||iD(e.target,'[contenteditable="true"]',void 0).isSome()||n.prevent()}),s=(t=function(n){o.triggerEvent("focusin",n)&&n.kill()},m0()?dl(n,"focus",t):ds(n,"focusin",t)),l=ul(),d=(r=function(n){o.triggerEvent("focusout",n)&&n.kill(),l.set(setTimeout(function(){o.triggerEvent(es(),n)},0))},m0()?dl(n,"blur",r):ds(n,"focusout",r));return{unbind:function(){nc(u,function(n){n.unbind()}),f.unbind(),s.unbind(),d.unbind(),a.unbind(),c.on(clearTimeout),l.on(clearTimeout)}}},m2=function(n,e){return of(tO(n,"target").getOr(e))},m9=function(n,e){var t=of(!1),r=of(!1);return{stop:function(){t.set(!0)},cut:function(){r.set(!0)},isStopped:t.get,isCut:r.get,event:n,setSource:e.set,getSource:e.get}},m3=function(n){var e=of(!1);return{stop:function(){e.set(!0)},cut:N,isStopped:e.get,isCut:X,event:n,setSource:U("Cannot set source of a broadcasted event"),getSource:U("Cannot get source of a broadcasted event")}},m5=rD.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),m4=function(n,e,t,r,o,i){var u=n(e,r),c=m9(t,o);return u.fold(function(){return i.logEventNoHandlers(e,r),m5.complete()},function(n){var t=n.descHandler;return(s6(t)(c),c.isStopped())?(i.logEventStopped(e,n.element,t.purpose),m5.stopped()):c.isCut()?(i.logEventCut(e,n.element,t.purpose),m5.complete()):eU(n.element).fold(function(){return i.logNoParent(e,n.element,t.purpose),m5.complete()},function(r){return i.logEventResponse(e,n.element,t.purpose),m5.resume(r)})})},m6=function(n,e,t,r,o,i){return m4(n,e,t,r,o,i).fold(q,function(r){return m6(n,e,t,r,o,i)},X)},m8=function(n,e,t,r,o){var i=m2(t,r);return m4(n,e,t,r,i,o)},m7=function(n,e,t){var r=m3(e);return nc(n,function(n){s6(n.descHandler)(r)}),r.isStopped()},gn=function(n,e,t,r,o){var i=m2(t,r);return m6(n,e,t,r,i,o)},ge=function(){var n={};return{registerId:function(e,t,r){tv(r,function(r,o){var i,u,c=void 0!==n[o]?n[o]:{};c[t]=(i=r,u=e,{cHandler:$.apply(void 0,[i.handler].concat(u)),purpose:i.purpose}),n[o]=c})},unregisterId:function(e){tv(n,function(n,t){tk(n,e)&&delete n[e]})},filterByType:function(e){return tO(n,e).map(function(n){return tS(n,function(n,e){return{id:e,descHandler:n}})}).getOr([])},find:function(e,t,r){return tO(n,t).bind(function(n){return rL(r,function(e){return c4(e).bind(function(e){return tO(n,e)}).map(function(n){return{element:e,descHandler:n}})},e)})}}},gt=function(){var n=ge(),e={},t=function(n,t){var o=e[t];if(o===n)r(n);else throw Error('The tagId "'+t+'" is already used by: '+oE(o.element)+"\nCannot use it for: "+oE(n.element)+"\nThe conflicting element is"+(tn(o.element)?" ":" not ")+"already in the DOM")},r=function(t){c4(t.element).each(function(t){delete e[t],n.unregisterId(t)})};return{find:function(e,t,r){return n.find(e,t,r)},filter:function(e){return n.filterByType(e)},register:function(r){var o=c4(r.element).getOrThunk(function(){return c3("uid-",r.element)});tT(e,o)&&t(r,o);var i=[r];n.registerId(i,o,r.events),e[o]=r},unregister:r,getById:function(n){return tO(e,n)}}},gr=function(n){var e=function(e){return eU(n.element).fold(q,function(n){return eA(e,n)})},t=gt(),r=function(n,r){return t.find(e,n,r)},o=m1(n.element,{triggerEvent:function(n,e){return oB(n,e.target,function(t){return gn(r,n,e,e.target,t)})}}),i={debugInfo:z("real"),triggerEvent:function(n,e,t){oB(n,e,function(o){return gn(r,n,t,e,o)})},triggerFocus:function(n,e){c4(n).fold(function(){os(n)},function(t){oB(ef(),n,function(t){return m8(r,ef(),{originator:e,kill:N,prevent:N,target:n},n,t),!1})})},triggerEscape:function(n,e){i.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:lh,addToGui:function(n){a(n)},removeFromGui:function(n){f(n)},addToWorld:function(n){u(n)},removeFromWorld:function(n){c(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:q},u=function(n){n.connect(i),ez(n.element)||(t.register(n),nc(n.components(),u),i.triggerEvent(ev(),n.element,{target:n.element}))},c=function(n){ez(n.element)||(nc(n.components(),c),t.unregister(n)),n.disconnect()},a=function(e){ta(n,e)},f=function(n){tl(n)},s=function(n){nc(t.filter(ed()),function(e){s6(e.descHandler)(n)})},l=function(n){s({universal:!0,data:n})},d=function(n,e){s({universal:!1,channels:n,data:e})},m=function(n,e){return m7(t.filter(n),e)},g=function(n){return t.getById(n).fold(function(){return tU.error(Error('Could not find component with uid: "'+n+'" in system.'))},tU.value)},p=function(n){return g(c4(n).getOr("not found"))};return u(n),{root:n,element:n.element,destroy:function(){o.unbind(),e2(n.element)},add:a,remove:f,getByUid:g,getByDom:p,addToWorld:u,removeFromWorld:c,broadcast:l,broadcastOn:d,broadcastEvent:m}},go=it("readonly-mode"),gi=it("edit-mode");function gu(n){return gr(lh(sO.sketch({dom:{classes:[it("outer-container")].concat(n.classes)},containerBehaviours:or([oa.config({alpha:go,omega:gi})])})))}var gc=function(n,e){var t=eR.fromTag("input");im(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),eQ(n,t),os(t),e(t),e2(t)},ga=function(n){var e=n.getSelection();if(e.rangeCount>0){var t=e.getRangeAt(0),r=n.document.createRange();r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(r)}},gf=function(n,e){om().each(function(n){eA(n,e)||ol(n)}),n.focus(),os(eR.fromDom(n.document.body)),ga(n)},gs=function(n,e,t,r){var o=function(){gf(e,r)},i=ds(t,"keydown",function(n){no(["input","textarea"],eH(n.target))||o()});return{toReading:function(){gc(n,ol)},toEditing:o,onToolbarTouch:N,destroy:function(){i.unbind()}}},gl=function(n,e,t,r,o){var i=function(){e.run(function(n){n.highlightSelection()})},u=function(){e.run(function(n){n.refreshSelection()})},c=function(n,t){var o=n-r.dom.scrollTop;e.run(function(n){n.scrollIntoView(o,o+t)})},a=function(n){c(e,r)},f=function(){n.getCursorBox().each(function(n){c(n.top,n.height)})},s=function(){e.run(function(n){n.clearSelection()})},l=function(){f(),e.run(function(n){n.syncHeight()})},d=function(){var n=iS(t);e.run(function(e){e.setViewportOffset(n)}),u(),l()},m=function(n){e.run(function(e){e.onToolbarTouch(n)})},g=d7(n),p=mh(l,300),h=[n.onKeyup(function(){s(),p.throttle()}),n.onNodeChanged(u),n.onDomChanged(p.throttle),n.onDomChanged(u),n.onScrollToCursor(function(n){n.preventDefault(),p.throttle()}),n.onScrollToElement(function(n){a(n.element)}),n.onToEditing(function(){e.run(function(n){n.toEditing()})}),n.onToReading(function(){e.run(function(n){n.toReading()})}),ds(n.doc,"touchend",function(e){eA(n.html,e.target)||eA(n.body,e.target)}),ds(t,"transitionend",function(n){"height"===n.raw.propertyName&&d()}),dl(t,"touchstart",function(e){i(),m(e),n.onTouchToolstrip()}),ds(n.body,"touchstart",function(e){s(),n.onTouchContent(),g.fireTouchstart(e)}),g.onTouchmove(),g.onTouchend(),ds(n.body,"click",function(n){n.kill()}),ds(t,"touchmove",function(){n.onToolbarScrollStart()})];return{destroy:function(){nc(h,function(n){n.unbind()})}}},gd=function(n){var e=Q.none(),t=[],r=function(n){o()?u(n):t.push(n)},o=function(){return e.isSome()},i=function(n){nc(n,u)},u=function(n){e.each(function(e){setTimeout(function(){n(e)},0)})};return n(function(n){o()||(e=Q.some(n),i(t),t=[])}),{get:r,map:function(n){return gd(function(e){r(function(t){e(n(t))})})},isReady:o}},gm={nu:gd,pure:function(n){return gd(function(e){e(n)})}},gg=function(n){setTimeout(function(){throw n},0)},gp=function(n){var e=function(e){n().then(e,gg)};return{map:function(e){return gp(function(){return n().then(e)})},bind:function(e){return gp(function(){return n().then(function(n){return e(n).toPromise()})})},anonBind:function(e){return gp(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return gm.nu(e)},toCached:function(){var e=null;return gp(function(){return null===e&&(e=n()),e})},toPromise:n,get:e}},gh={nu:function(n){return gp(function(){return new sr(n)})},pure:function(n){return gp(function(){return sr.resolve(n)})}},gv=function(n){var e,t;return e=n.screen.width,t=n.screen.height,nw([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){var r,o;return r=e<=n.width&&t<=n.height,o=n.keyboard,r?Q.some(o):Q.none()}).getOr({portrait:t/5,landscape:e/4})},gb=function(n){var e=dm(n).isPortrait(),t=gv(n),r=e?t.portrait:t.landscape;return(e?n.screen.height:n.screen.width)-n.innerHeight>r?0:r},gy=function(n,e){var t=e$(n).dom.defaultView;return iS(n)+iS(e)-gb(t)},gx=function(n,e,t){var r=gy(e,t);id(n,"padding-bottom",iS(e)+iS(t)-r+"px")},gS=rD.generate([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),gw="data-"+it("position-y-fixed"),gO="data-"+it("y-property"),gk="data-"+it("scrolling"),gT="data-"+it("last-window-height"),gC=function(n){return mt(n,gw)},gE=function(n,e){var t=tD(n,gO);return gS.fixed(n,t,e)},gM=function(n){var e=gC(n);return("true"===tD(n,gk)?function(n,e){return gS.scroller(n,e)}:gE)(n,e)},gD=function(n){var e=tD(n,"style");return im(n,{position:"absolute",top:"0px"}),tE(n,gw,"0px"),tE(n,gO,"top"),{restore:function(){tE(n,"style",e||""),tF(n,gw),tF(n,gO)}}},g_=function(n,e,t){var r=tD(t,"style");return l0(t),im(t,{position:"absolute",height:e+"px",width:"100%",top:n+"px"}),tE(t,gw,n+"px"),tE(t,gk,"true"),tE(t,gO,"top"),{restore:function(){l1(t),tE(t,"style",r||""),tF(t,gw),tF(t,gk),tF(t,gO)}}},gR=function(n){var e=tD(n,"style");return im(n,{position:"absolute",bottom:"0px"}),tE(n,gw,"0px"),tE(n,gO,"bottom"),{restore:function(){tE(n,"style",e||""),tF(n,gw),tF(n,gO)}}},gF=function(n,e,t){var r=e$(n).dom.defaultView.innerHeight;return tE(n,gT,r+"px"),r-e-t},gI=function(n,e,t,r){var o=e$(n).dom.defaultView,i=gD(t),u=iS(t),c=gF(n,u,iS(r)),a=g_(u,c,n),f=gR(r),s=!0,l=function(){return o.innerHeight>mt(n,gT)},d=function(){if(s){var o=iS(t),i=gF(n,o,iS(r));tE(n,gw,o+"px"),id(n,"height",i+"px"),gx(e,n,r)}};return gx(e,n,r),{setViewportOffset:function(e){tE(n,gw,e+"px"),d()},isExpanding:l,isShrinking:G(l),refresh:d,restore:function(){s=!1,i.restore(),a.restore(),f.restore()}}},gV=(v=null,{animate:function(n,e,t,r,o,i){var u=!1,c=function(n){u=!0,o(n)};dd.clearInterval(v);var a=function(n){dd.clearInterval(v),c(n)};v=dd.setInterval(function(){var o=n();(Math.abs(o-e)<=t?Q.none():o<e?Q.some(o+t):Q.some(o-t)).fold(function(){dd.clearInterval(v),c(e)},function(t){if(r(t,a),!u){var i=n();(i!==t||Math.abs(i-e)>Math.abs(o-e))&&(dd.clearInterval(v),c(e))}})},i)}}),gB="data-"+it("last-scroll-top"),gA=function(n){return parseInt(ih(n,"top").getOr("0"),10)},gH=function(n){return parseInt(n.dom.scrollTop,10)},gN=function(n,e){return gh.nu(function(t){var r=$(gH,n);tE(n,gB,r());var o=Math.abs(e-r());gV.animate(r,e,Math.ceil(o/10),function(e,t){mt(n,gB)!==n.dom.scrollTop?t(n.dom.scrollTop):(n.dom.scrollTop=e,tE(n,gB,e))},function(){n.dom.scrollTop=e,tE(n,gB,e),t(e)},10)})},gP=function(n,e){var t=e+gC(n)+"px";id(n,"top",t)},gz=function(n,e,t){var r=e$(n).dom.defaultView;return gh.nu(function(o){gP(n,t),gP(e,t),r.scrollTo(0,t),o(t)})},gj=function(n,e,t,r,o){var i=gy(e,t),u=$(ga,n);r>i||o>i?gN(e,e.dom.scrollTop-i+o).get(u):r<0&&gN(e,e.dom.scrollTop+r).get(u)},gL=function(n,e,t){var r=e+t,o=r-parseInt(ih(n,"top").getOr(t),10),i=n.dom.scrollTop+o;return gh.nu(function(e){var t=$(gH,n);gV.animate(t,i,15,function(e){n.dom.scrollTop=e,id(n,"top",gA(n)+15+"px")},function(){n.dom.scrollTop=i,id(n,"top",r+"px"),e(i)},10)})},g$=function(n,e){var t,r=nu(iw(n,"["+gw+"]"),gM);return t=nu(r,function(n){return n.fold(function(n,t,r){return id(n,t,e+r+"px"),gh.pure(r)},function(n,t){return gL(n,e,t)})}),(0,gh.nu)(function(n){var e=[],r=0;0===t.length?n([]):nc(t,function(o,i){o.get(function(o){e[i]=o,++r>=t.length&&n(e)})})})},gG=function(n,e,t,r,o,i){var u,c=(u=of(gm.pure({})),{start:function(t){var r=gm.nu(function(r){return gz(n,e,t).get(r)});u.set(r)},idle:function(n){u.get().get(function(){n()})}}),a=function(){var n=mu(i);return Q.from(n[0]).bind(function(n){var t=n.top-e.dom.scrollTop;return t>r.innerHeight+5||t<-5?Q.some({top:t,bottom:t+n.height}):Q.none()})},f=mh(function(){c.idle(function(){g$(t,r.pageYOffset).get(function(){a().each(function(n){e.dom.scrollTop=e.dom.scrollTop+n.top}),c.start(0),o.refresh()})})},1e3),s=ds(eR.fromDom(r),"scroll",function(){r.pageYOffset<0||f.throttle()});return g$(t,r.pageYOffset).get(j),{unbind:s.unbind}},gU=function(n){var e,t,r,o,i,u=n.cWin,c=n.ceBody,a=n.socket,f=n.toolstrip,s=n.contentElement,l=n.keyboardType,d=n.outerWindow,m=n.dropup,g=n.outerBody,p=gI(a,c,f,m),h=l(g,u,te(),s),v=dp(d,{onChange:N,onReady:p.refresh});v.onAdjustment(function(){p.refresh()});var b=ds(eR.fromDom(d),"resize",function(){p.isExpanding()&&p.refresh()}),y=gG(f,a,g,d,p,u),x=(e=u.document,tH(t=eR.fromTag("div"),it("unfocused-selections")),eQ(eR.fromDom(e.documentElement),t),r=ds(t,"touchstart",function(n){n.prevent(),gf(u,s),i()}),o=function(n){var e=eR.fromTag("span");return li(e,[it("layer-editor"),it("unfocused-selection")]),im(e,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),e},{update:function(){i(),e0(t,nu(mu(u),o))},isActive:function(){return eX(t).length>0},destroy:function(){r.unbind(),e2(t)},clear:i=function(){e1(t)}}),S=function(){x.clear()};return{toEditing:function(){h.toEditing(),S()},toReading:function(){h.toReading()},onToolbarTouch:function(n){h.onToolbarTouch()},refreshSelection:function(){x.isActive()&&x.update()},clearSelection:S,highlightSelection:function(){x.update()},scrollIntoView:function(n,e){gj(u,a,m,n,e)},updateToolbarPadding:N,setViewportOffset:function(n){p.setViewportOffset(n),gh.nu(function(e){var t=$(gA,a),r=function(n){id(a,"top",n+"px")},o=Math.abs(n-t());gV.animate(t,n,Math.ceil(o/10),r,function(){r(n),e(n)},10)}).get(j)},syncHeight:function(){id(s,"height",s.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:p.refresh,destroy:function(){p.restore(),v.destroy(),y.unbind(),b.unbind(),h.destroy(),x.destroy(),gc(te(),ol)}}},gW=function(n,e){var t=dJ(),r=ul(),o=ul(),i=us(),u=us();return{enter:function(){e.hide();var c=eR.fromDom(document);dY(n.editor).each(function(e){var a;r.set({socketHeight:ih(n.socket,"height"),iframeHeight:ih(e.frame,"height"),outerScroll:document.body.scrollTop}),o.set({exclusives:(a="."+lZ,ds(c,"touchmove",function(n){iD(n.target,a).filter(mR).fold(function(){n.prevent()},N)}))}),tH(n.container,it("fullscreen-maximized")),d9(n.container,e.body),t.maximize(),id(n.socket,"overflow","scroll"),id(n.socket,"-webkit-overflow-scrolling","touch"),os(e.body),i.set(gU({cWin:e.win,ceBody:e.body,socket:n.socket,toolstrip:n.toolstrip,dropup:n.dropup.element,contentElement:e.frame,outerBody:n.body,outerWindow:n.win,keyboardType:gs})),i.run(function(n){n.syncHeight()}),u.set(gl(e,i,n.toolstrip,n.socket,n.dropup))})},refreshStructure:function(){i.run(function(n){n.refreshStructure()})},exit:function(){t.restore(),u.clear(),i.clear(),e.show(),r.on(function(e){e.socketHeight.each(function(e){id(n.socket,"height",e)}),e.iframeHeight.each(function(e){id(n.editor.getFrame(),"height",e)}),document.body.scrollTop=e.scrollTop}),r.clear(),o.on(function(n){n.exclusives.unbind()}),o.clear(),tP(n.container,it("fullscreen-maximized")),d3(),l1(n.toolbar),iv(n.socket,"overflow"),iv(n.socket,"-webkit-overflow-scrolling"),ol(n.editor.getFrame()),dY(n.editor).each(function(n){n.clearSelection()})}}},gX=function(n){var e=rp("Getting IosWebapp schema",my,n);id(e.toolstrip,"width","100%"),id(e.container,"position","relative");var t=lh(mv(function(){e.setReadOnly(e.readOnlyOnInit()),r.enter()},e.translate));e.alloy.add(t);var r=gW(e,{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}});return{setReadOnly:e.setReadOnly,refreshStructure:r.refreshStructure,enter:r.enter,exit:r.exit,destroy:N}},gq=tinymce.util.Tools.resolve("tinymce.EditorManager"),gK=function(n){var e=Q.from(n.getParam("skin_url")).getOrThunk(function(){return gq.baseURL+"/skins/ui/oxide"});return{content:e+"/content.mobile.min.css",ui:e+"/skin.mobile.min.css"}},gY=function(n,e,t){n.system.broadcastOn([ox],{command:e,state:t})},gJ=function(n,e){nc(tp(e.formatter.get()),function(t){e.formatter.formatChanged(t,function(e){gY(n,t,e)})}),nc(["ul","ol"],function(t){e.selection.selectorChanged(t,function(e,r){gY(n,t,e)})})},gQ=function(n){return function(){var e=function(){n._skinLoaded=!0,n.fire("SkinLoaded")};n.initialized?e():n.on("init",e)}},gZ="toReading",g0="toEditing";oh.add("mobile",function(n){return{getNotificationManagerImpl:function(){return{open:z({progressBar:{value:N},close:N,text:N,getEl:z(null),moveTo:N,moveRel:N,settings:{}}),close:N,reposition:N,getArgs:z({})}},renderUI:function(){var e,t,r,o,i,u,c,a,f,s,l,d,m=n.getElement(),g=gK(n);if(!1==(!1===n.getParam("skin"))){var p=op.DOM.styleSheetLoader;n.contentCSS.push(g.content),p.load(g.ui,gQ(n)),n.on("remove",function(){return p.unload(g.ui)})}else gQ(n)();var h=function(){n.fire("ScrollIntoView")},v=n2().os.isAndroid()?(e=gu({classes:[it("android-container")]}),t=mF(),o=mI(r=us()),i=mV(),u=mZ(N,h),e.add(t.wrapper),e.add(i),e.add(u.component),{system:e,element:e.element,init:function(n){r.set(mx(n))},exit:function(){r.run(function(n){n.exit(),lH.remove(i,o)})},setToolbarGroups:function(n){var e=t.createGroups(n);t.setGroups(e)},setContextToolbar:function(n){var e=t.createGroups(n);t.setContextToolbar(e)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){mH(i,o,n,e.root)},socket:i,dropup:u}):(c=gu({classes:[it("ios-container")]}),a=mF(),s=mI(f=us()),l=mV(),d=mZ(function(){f.run(function(n){n.refreshStructure()})},h),c.add(a.wrapper),c.add(l),c.add(d.component),{system:c,element:c.element,init:function(n){f.set(gX(n))},exit:function(){f.run(function(n){lH.remove(l,s),n.exit()})},setToolbarGroups:function(n){var e=a.createGroups(n);a.setGroups(e)},setContextToolbar:function(n){var e=a.createGroups(n);a.setContextToolbar(e)},focusToolbar:function(){a.focus()},restoreToolbar:function(){a.restoreToolbar()},updateMode:function(n){mH(l,s,n,c.root)},socket:l,dropup:d});td(eR.fromDom(m),v.system);var b=m.ownerDocument.defaultView,y=dp(b,{onChange:function(){v.system.broadcastOn([oS],{width:dg(b)})},onReady:N}),x=function(e,t,r,o){!1===o&&n.selection.collapse();var i=S(e,t,r);v.setToolbarGroups(!0===o?i.readOnly:i.main),n.setMode(!0===o?"readonly":"design"),n.fire(!0===o?gZ:g0),v.updateMode(o)},S=function(n,e,t){var r=n.get();return{readOnly:r.backToMask.concat(e.get()),main:r.backToMask.concat(t.get())}},w=function(e,t){return n.on(e,t),{unbind:function(){n.off(e)}}};return n.on("init",function(){v.init({editor:{getFrame:function(){return eR.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:N}},onToReading:function(n){return w(gZ,n)},onToEditing:function(n){return w(g0,n)},onScrollToCursor:function(e){return n.on("ScrollIntoView",function(n){e(n)}),{unbind:function(){n.off("ScrollIntoView"),y.destroy()}}},onTouchToolstrip:function(){e()},onTouchContent:function(){og(eR.fromDom(n.editorContainer.querySelector("."+it("toolbar")))).bind(function(n){return v.system.getByDom(n).toOptional()}).each(eT),v.restoreToolbar(),e()},onTapContent:function(e){var t=e.target;"img"===eH(t)?(n.selection.select(t.dom),e.kill()):"a"===eH(t)&&v.system.getByDom(eR.fromDom(n.editorContainer)).each(function(n){oa.isAlpha(n)&&ov(t.dom)})}},container:eR.fromDom(n.editorContainer),socket:eR.fromDom(n.contentAreaContainer),toolstrip:eR.fromDom(n.editorContainer.querySelector("."+it("toolstrip"))),toolbar:eR.fromDom(n.editorContainer.querySelector("."+it("toolbar"))),dropup:v.dropup,alloy:v.system,translate:N,setReadOnly:function(n){x(f,a,c,n)},readOnlyOnInit:function(){return!1}});var e=function(){v.dropup.disappear(function(){v.system.broadcastOn([ow],{})})},t={label:"The first group",scrollable:!1,items:[ap("back",function(){n.selection.collapse(),v.exit()},{},n)]},r={label:"Back to read only",scrollable:!1,items:[ap("readonly-back",function(){x(f,a,c,!0)},{},n)]},o=di(v,n),i=du(n,o),u={label:"The extra group",scrollable:!1,items:[]},c=of([{label:"the action group",scrollable:!0,items:i},u]),a=of([{label:"The read only mode group",scrollable:!0,items:[]},u]),f=of({backToMask:[t],backToReadOnly:[r]});gJ(v,n)}),n.on("remove",function(){v.exit()}),n.on("detach",function(){tg(v.system),v.system.destroy()}),{iframeContainer:v.socket.element.dom,editorContainer:v.element.dom}}}})}();