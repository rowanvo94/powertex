!function(){"use strict";var t,n,e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,_,T,E,D,A,B,M,F,I,R,N,P,H,V,L,z,U,j=function(t){var n=typeof t;return null===t?"null":"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},W=function(t){return function(n){return j(n)===t}},G=function(t){return function(n){return typeof n===t}},X=function(t){return function(n){return t===n}},Y=W("string"),q=W("object"),K=W("array"),J=X(null),$=G("boolean"),Q=X(void 0),Z=function(t){return null==t},tt=function(t){return!Z(t)},tn=G("function"),te=G("number"),to=function(t,n){if(K(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},tr=function(){},ti=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},tu=function(t){return function(){return t}},ta=function(t){return t},tc=function(t,n){return t===n};function ts(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var tl=function(t){return function(n){return!t(n)}},tf=function(t){return function(){throw Error(t)}},td=tu(!1),tm=tu(!0),tg=tinymce.util.Tools.resolve("tinymce.ThemeManager"),tp=function(){return(tp=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function th(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&0>n.indexOf(o)&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)0>n.indexOf(o[r])&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]]);return e}function tv(t,n,e){if(e||2==arguments.length)for(var o,r=0,i=n.length;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}var tb=function(){return ty},ty={fold:function(t,n){return t()},isSome:td,isNone:tm,getOr:ta,getOrThunk:e=function(t){return t()},getOrDie:function(t){throw Error(t||"error: getOrDie called on none.")},getOrNull:tu(null),getOrUndefined:tu(void 0),or:ta,orThunk:e,map:tb,each:tr,bind:tb,exists:td,forall:tm,filter:function(){return tb()},toArray:function(){return[]},toString:tu("none()")},tx=function(t){var n=tu(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:tm,isNone:td,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return tx(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:ty},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},tw={some:tx,none:tb,from:function(t){return null==t?ty:tx(t)}},tS=Array.prototype.slice,tk=Array.prototype.indexOf,tC=Array.prototype.push,tO=function(t,n){return tk.call(t,n)},t_=function(t,n){var e=tO(t,n);return -1===e?tw.none():tw.some(e)},tT=function(t,n){return tO(t,n)>-1},tE=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},tD=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},tA=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=tS.call(t,o,o+n);e.push(r)}return e},tB=function(t,n){for(var e=t.length,o=Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},tM=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},tF=function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e)},tI=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},tR=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},tN=function(t,n,e){return tF(t,function(t,o){e=n(e,t,o)}),e},tP=function(t,n,e){return tM(t,function(t,o){e=n(e,t,o)}),e},tH=function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return tw.some(i);if(e(i,o))break}return tw.none()},tV=function(t,n){return tH(t,n,td)},tL=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return tw.some(e);return tw.none()},tz=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!K(t[e]))throw Error("Arr.flatten item "+e+" was not an array, input: "+t);tC.apply(n,t[e])}return n},tU=function(t,n){return tz(tB(t,n))},tj=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},tW=function(t){var n=tS.call(t,0);return n.reverse(),n},tG=function(t,n){return tR(t,function(t){return!tT(n,t)})},tX=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e},tY=function(t){return[t]},tq=function(t,n){var e=tS.call(t,0);return e.sort(n),e},tK=function(t,n){return n>=0&&n<t.length?tw.some(t[n]):tw.none()},tJ=function(t){return tK(t,0)},t$=function(t){return tK(t,t.length-1)},tQ=tn(Array.from)?Array.from:function(t){return tS.call(t)},tZ=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return tw.none()},t0=Object.keys,t1=Object.hasOwnProperty,t2=function(t,n){for(var e=t0(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},t5=function(t,n){return t3(t,function(t,e){return{k:e,v:n(t,e)}})},t3=function(t,n){var e={};return t2(t,function(t,o){var r=n(t,o);e[r.k]=r.v}),e},t9=function(t,n){var e,o={};return e=function(t,n){o[n]=t},t2(t,function(t,o){(n(t,o)?e:tr)(t,o)}),o},t4=function(t,n){var e=[];return t2(t,function(t,o){e.push(n(t,o))}),e},t6=function(t,n){for(var e=t0(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return tw.some(u)}return tw.none()},t8=function(t){return t4(t,ta)},t7=function(t,n){return nt(t,n)?tw.from(t[n]):tw.none()},nt=function(t,n){return t1.call(t,n)},nn=function(t,n){return nt(t,n)&&void 0!==t[n]&&null!==t[n]},ne=function(t,n,e){return void 0===e&&(e=tc),t.exists(function(t){return e(t,n)})},no=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},nr=function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return tw.none();n.push(o.getOrDie())}return tw.some(n)},ni=function(t,n,e){return t.isSome()&&n.isSome()?tw.some(e(t.getOrDie(),n.getOrDie())):tw.none()},nu=function(t,n){return t?tw.some(n):tw.none()},na=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},nc=function(t,n){var e;return nl(t,n)?(e=n.length,t.substring(e)):t},ns=function(t,n){return -1!==t.indexOf(n)},nl=function(t,n){return na(t,n,0)},nf=function(t,n){return na(t,n,t.length-n.length)},nd=(o=/^\s+|\s+$/g,function(t){return t.replace(o,"")}),nm=function(t){return t.length>0},ng=function(t){return void 0!==t.style&&tn(t.style.getPropertyValue)},np=function(t){if(null==t)throw Error("Node cannot be null or undefined");return{dom:t}},nh={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),Error("HTML must have a single root node");return np(e.childNodes[0])},fromTag:function(t,n){return np((n||document).createElement(t))},fromText:function(t,n){return np((n||document).createTextNode(t))},fromDom:np,fromPoint:function(t,n,e){return tw.from(t.dom.elementFromPoint(n,e)).map(np)}};"undefined"!=typeof window?window:Function("return this;")();var nv=function(t){return t.dom.nodeName.toLowerCase()},nb=function(t){return function(n){return n.dom.nodeType===t}},ny=nb(1),nx=nb(3),nw=nb(9),nS=nb(11),nk=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},nC=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,l=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:tu(r),isiPhone:tu(i),isTablet:tu(c),isPhone:tu(s),isTouch:tu(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:tu(l),isDesktop:tu(!s&&!c&&!l)}},nO=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}},n_=function(t,n){var e=nO(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return nE(o(1),o(2))},nT=function(){return nE(0,0)},nE=function(t,n){return{major:t,minor:n}},nD={nu:nE,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?nT():n_(t,e)},unknown:nT},nA=function(t,n){var e=String(n).toLowerCase();return tV(t,function(t){return t.search(e)})},nB=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,nM=function(t){return function(n){return ns(n,t)}},nF=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return ns(t,"edge/")&&ns(t,"chrome")&&ns(t,"safari")&&ns(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nB],search:function(t){return ns(t,"chrome")&&!ns(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return ns(t,"msie")||ns(t,"trident")}},{name:"Opera",versionRegexes:[nB,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:nM("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:nM("firefox")},{name:"Safari",versionRegexes:[nB,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(ns(t,"safari")||ns(t,"mobile/"))&&ns(t,"applewebkit")}}],nI=[{name:"Windows",search:nM("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return ns(t,"iphone")||ns(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:nM("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:nM("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:nM("linux"),versionRegexes:[]},{name:"Solaris",search:nM("sunos"),versionRegexes:[]},{name:"FreeBSD",search:nM("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:nM("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],nR={browsers:tu(nF),oses:tu(nI)},nN="Edge",nP="Chrome",nH="Opera",nV="Firefox",nL="Safari",nz=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o(nN),isChrome:o(nP),isIE:o("IE"),isOpera:o(nH),isFirefox:o(nV),isSafari:o(nL)}},nU={unknown:function(){return nz({current:void 0,version:nD.unknown()})},nu:nz,edge:tu(nN),chrome:tu(nP),ie:tu("IE"),opera:tu(nH),firefox:tu(nV),safari:tu(nL)},nj="Windows",nW="Android",nG="Linux",nX="Solaris",nY="FreeBSD",nq="ChromeOS",nK=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(nj),isiOS:o("iOS"),isAndroid:o(nW),isOSX:o("OSX"),isLinux:o(nG),isSolaris:o(nX),isFreeBSD:o(nY),isChromeOS:o(nq)}},nJ={unknown:function(){return nK({current:void 0,version:nD.unknown()})},nu:nK,windows:tu(nj),ios:tu("iOS"),android:tu(nW),linux:tu(nG),osx:tu("OSX"),solaris:tu(nX),freebsd:tu(nY),chromeos:tu(nq)},n$={detect:function(t,n,e){var o=nR.browsers(),r=nR.oses(),i=n.bind(function(t){return tZ(t.brands,function(t){var n=t.brand.toLowerCase();return tV(o,function(t){var e;return n===((e=t.brand)===null||void 0===e?void 0:e.toLowerCase())}).map(function(n){return{current:n.name,version:nD.nu(parseInt(t.version,10),0)}})})}).orThunk(function(){return nA(o,t).map(function(n){var e=nD.detect(n.versionRegexes,t);return{current:n.name,version:e}})}).fold(nU.unknown,nU.nu),u=nA(r,t).map(function(n){var e=nD.detect(n.versionRegexes,t);return{current:n.name,version:e}}).fold(nJ.unknown,nJ.nu),a=nC(u,i,t,e);return{browser:i,os:u,deviceType:a}}},nQ=function(t){return window.matchMedia(t).matches},nZ=nk(function(){return n$.detect(navigator.userAgent,tw.from(navigator.userAgentData),nQ)}),n0=function(){return nZ()},n1=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw Error("Browser lacks native selectors")},n2=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},n5=function(t,n){var e=void 0===n?document:n.dom;return n2(e)?[]:tB(e.querySelectorAll(t),nh.fromDom)},n3=function(t,n){var e=void 0===n?document:n.dom;return n2(e)?tw.none():tw.from(e.querySelector(t)).map(nh.fromDom)},n9=function(t,n){return t.dom===n.dom},n4=function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)},n6=function(t,n){return n0().browser.isIE()?(t.dom.compareDocumentPosition(n.dom)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==0:n4(t,n)},n8=function(t){return nh.fromDom(t.dom.ownerDocument)},n7=function(t){return nw(t)?t:n8(t)},et=function(t){return nh.fromDom(n7(t).dom.documentElement)},en=function(t){return nh.fromDom(n7(t).dom.defaultView)},ee=function(t){return tw.from(t.dom.parentNode).map(nh.fromDom)},eo=function(t){return tw.from(t.dom.offsetParent).map(nh.fromDom)},er=function(t){return tB(t.dom.childNodes,nh.fromDom)},ei=function(t,n){var e=t.dom.childNodes;return tw.from(e[n]).map(nh.fromDom)},eu=function(t,n){return{element:t,offset:n}},ea=function(t,n){var e=er(t);return e.length>0&&n<e.length?eu(e[n],0):eu(t,n)},ec=function(t){return nS(t)&&tt(t.dom.host)},es=tn(Element.prototype.attachShadow)&&tn(Node.prototype.getRootNode),el=tu(es),ef=es?function(t){return nh.fromDom(t.dom.getRootNode())}:n7,ed=function(t){return ec(t)?t:nh.fromDom(n7(t).dom.body)},em=function(t){var n=ef(t);return ec(n)?tw.some(n):tw.none()},eg=function(t){if(el()&&tt(t.target)){var n=nh.fromDom(t.target);if(ny(n)&&ep(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return tJ(e)}}return tw.from(t.target)},ep=function(t){return tt(t.dom.shadowRoot)},eh=function(t){var n=nx(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e=n.ownerDocument;return em(nh.fromDom(n)).fold(function(){return e.body.contains(n)},function(t){var n;return eh((n=t,nh.fromDom(n.dom.host)))})},ev=function(){return eb(nh.fromDom(document))},eb=function(t){var n=t.dom.body;if(null==n)throw Error("Body is not available yet");return nh.fromDom(n)},ey=function(t,n,e){if(Y(e)||$(e)||te(e))t.setAttribute(n,e+"");else throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),Error("Attribute value was not simple")},ex=function(t,n,e){ey(t.dom,n,e)},ew=function(t,n){var e=t.dom;t2(n,function(t,n){ey(e,n,t)})},eS=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},ek=function(t,n){return tw.from(eS(t,n))},eC=function(t,n){var e=t.dom;return!!e&&!!e.hasAttribute&&e.hasAttribute(n)},eO=function(t,n){t.dom.removeAttribute(n)},e_=function(t,n,e){if(!Y(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),Error("CSS value must be a string: "+e);ng(t)&&t.style.setProperty(n,e)},eT=function(t,n){ng(t)&&t.style.removeProperty(n)},eE=function(t,n,e){e_(t.dom,n,e)},eD=function(t,n){var e=t.dom;t2(n,function(t,n){e_(e,n,t)})},eA=function(t,n){var e=t.dom;t2(n,function(t,n){t.fold(function(){eT(e,n)},function(t){e_(e,n,t)})})},eB=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||eh(t)?o:eM(e,n)},eM=function(t,n){return ng(t)?t.style.getPropertyValue(n):""},eF=function(t,n){var e=eM(t.dom,n);return tw.from(e).filter(function(t){return t.length>0})},eI=function(t){var n={},e=t.dom;if(ng(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},eR=function(t,n,e){var o=nh.fromTag(t);return eE(o,n,e),eF(o,n).isSome()},eN=function(t,n){eT(t.dom,n),ne(ek(t,"style").map(nd),"")&&eO(t,"style")},eP=function(t){return t.dom.offsetWidth},eH=function(t,n){var e=function(e){var o=n(e);return o<=0||null===o?parseFloat(eB(e,t))||0:o},o=function(t,n){return tP(n,function(n,e){var o=eB(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r},0)};return{set:function(n,e){if(!te(e)&&!e.match(/^[0-9]+$/))throw Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;ng(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return n>r?n-r:0}}},eV=eH("height",function(t){var n=t.dom;return eh(t)?n.getBoundingClientRect().height:n.offsetHeight}),eL=function(t){return eV.get(t)},ez=function(t){return eV.getOuter(t)},eU=function(t,n){var e=eV.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);eE(t,"max-height",e+"px")},ej=function(t,n){return{left:t,top:n,translate:function(e,o){return ej(t+e,n+o)}}},eW=function(t){var n=t.getBoundingClientRect();return ej(n.left,n.top)},eG=function(t,n){return void 0!==t?t:void 0!==n?n:0},eX=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return ej(e.offsetLeft,e.offsetTop);var i=eG(null==o?void 0:o.pageYOffset,r.scrollTop),u=eG(null==o?void 0:o.pageXOffset,r.scrollLeft),a=eG(r.clientTop,e.clientTop),c=eG(r.clientLeft,e.clientLeft);return eY(t).translate(u-c,i-a)},eY=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?ej(e.offsetLeft,e.offsetTop):eh(t)?eW(n):ej(0,0)},eq=eH("width",function(t){return t.dom.offsetWidth}),eK=function(t){return eq.get(t)},eJ=function(t){return eq.getOuter(t)},e$=function(t,n){var e=eq.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);eE(t,"max-width",e+"px")},eQ=function(t){var n=nh.fromDom(eg(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=ti(o,e);return{target:n,x:t.clientX,y:t.clientY,stop:e,prevent:o,kill:r,raw:t}},eZ=function(t,n,e,o,r){var i=function(t){e(t)&&o(eQ(t))};return t.dom.addEventListener(n,i,r),{unbind:ts(e0,t,n,i,r)}},e0=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},e1=function(t,n){ee(t).each(function(e){e.dom.insertBefore(n.dom,t.dom)})},e2=function(t,n){tw.from(t.dom.nextSibling).map(nh.fromDom).fold(function(){ee(t).each(function(t){e3(t,n)})},function(t){e1(t,n)})},e5=function(t,n){ei(t,0).fold(function(){e3(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})},e3=function(t,n){t.dom.appendChild(n.dom)},e9=function(t,n,e){ei(t,e).fold(function(){e3(t,n)},function(t){e1(t,n)})},e4=function(t,n){tM(n,function(n){e1(t,n)})},e6=function(t,n){tM(n,function(n){e3(t,n)})},e8=function(t){t.dom.textContent="",tM(er(t),function(t){e7(t)})},e7=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},ot=function(t){var n=er(t);n.length>0&&e4(t,n),e7(t)},on=function(t){var n=void 0!==t?t.dom:document;return ej(n.body.scrollLeft||n.documentElement.scrollLeft,n.body.scrollTop||n.documentElement.scrollTop)},oe=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},oo=function(t){var n=void 0===t?window:t;return n0().browser.isFirefox()?tw.none():tw.from(n.visualViewport)},or=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},oi=function(t){var n=void 0===t?window:t,e=n.document,o=on(nh.fromDom(e));return oo(n).fold(function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return or(o.left,o.top,e,r)},function(t){return or(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)})},ou=function(t,n){return t.view(n).fold(tu([]),function(n){var e=t.owner(n);return[n].concat(ou(t,e))})},oa=function(t,n){var e=n.owner(t),o=ou(n,e);return tw.some(o)},oc=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?tw.none():tw.from((n=t.dom.defaultView)===null||void 0===n?void 0:n.frameElement)).map(nh.fromDom)},owner:function(t){return n8(t)}}),os=function(t){var n=on(nh.fromDom(document));return oa(t,oc).fold(ts(eX,t),function(e){var o=eY(t),r=tN(e,function(t,n){var e=eY(n);return{left:t.left+e.left,top:t.top+e.top}},{left:0,top:0});return ej(r.left+o.left+n.left,r.top+o.top+n.top)})},ol=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},of=function(t){var n=eX(t),e=eJ(t),o=ez(t);return ol(n.left,n.top,e,o)},od=function(t){var n=os(t),e=eJ(t),o=ez(t);return ol(n.left,n.top,e,o)},om=function(){return oi(window)},og=function(t){return{isValue:tm,isError:td,getOr:tu(t),getOrThunk:tu(t),getOrDie:tu(t),or:function(n){return og(t)},orThunk:function(n){return og(t)},fold:function(n,e){return e(t)},map:function(n){return og(n(t))},mapError:function(n){return og(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return tw.some(t)}}},op=function(t){return{isValue:td,isError:tm,getOr:ta,getOrThunk:function(t){return t()},getOrDie:function(){return tf(String(t))()},or:ta,orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return op(t)},mapError:function(n){return op(n(t))},each:tr,bind:function(n){return op(t)},exists:td,forall:tm,toOptional:tw.none}},oh={value:og,error:op,fromOption:function(t,n){return t.fold(function(){return op(n)},og)}};(r=D||(D={}))[r.Error=0]="Error",r[r.Value=1]="Value";var ov=function(t,n,e){return t.stype===D.Error?n(t.serror):e(t.svalue)},ob=function(t){return{stype:D.Value,svalue:t}},oy=function(t){return{stype:D.Error,serror:t}},ox={fromResult:function(t){return t.fold(oy,ob)},toResult:function(t){return ov(t,oh.error,oh.value)},svalue:ob,partition:function(t){var n=[],e=[];return tM(t,function(t){ov(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},serror:oy,bind:function(t,n){return t.stype===D.Value?n(t.svalue):t},bindError:function(t,n){return t.stype===D.Error?n(t.serror):t},map:function(t,n){return t.stype===D.Value?{stype:D.Value,svalue:n(t.svalue)}:t},mapError:function(t,n){return t.stype===D.Error?{stype:D.Error,serror:n(t.serror)}:t},fold:ov},ow=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},oS=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},ok=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)nt(i,u)&&(o[u]=t(o[u],i[u]))}return o}},oC=ok(function(t,n){return q(t)&&q(n)?oC(t,n):n}),oO=ok(function(t,n){return n}),o_=function(){return{tag:"required",process:{}}},oT=function(t){return{tag:"defaultedThunk",process:t}},oE=function(t){return oT(tu(t))},oD=function(){return{tag:"option",process:{}}},oA=function(t){return{tag:"mergeWithThunk",process:t}},oB=function(t){return ti(ox.serror,tz)(t)},oM={consolidateObj:function(t,n){var e,o=ox.partition(t);return o.errors.length>0?oB(o.errors):(e=o.values).length>0?ox.svalue(oC(n,oO.apply(void 0,e))):ox.svalue(n)},consolidateArr:function(t){var n=ox.partition(t);return n.errors.length>0?oB(n.errors):ox.svalue(n.values)}},oF=function(t){return q(t)&&t0(t).length>100?" removed due to size":JSON.stringify(t,null,2)},oI=function(t,n){return ox.serror([{path:t,getErrorInfo:n}])},oR=function(t){return{extract:function(n,e){return ox.bindError(t(e),function(t){return oI(n,tu(t))})},toString:tu("val")}},oN=oR(ox.svalue),oP=function(t,n,e,o){return o(t7(t,n).getOrThunk(function(){return e(t)}))},oH=function(t,n,e,o,r){var i,u=function(t){return r.extract(n.concat([o]),t)},a=function(t){return t.fold(function(){return ox.svalue(tw.none())},function(t){var e=r.extract(n.concat([o]),t);return ox.map(e,tw.some)})};switch(t.tag){case"required":return t7(e,o).fold(function(){return oI(n,function(){return'Could not find valid *required* value for "'+o+'" in '+oF(e)})},u);case"defaultedThunk":return oP(e,o,t.process,u);case"option":return a(t7(e,o));case"defaultedOptionThunk":return i=t.process,a(t7(e,o).map(function(t){return!0===t?i(e):t}));case"mergeWithThunk":return oP(e,o,tu({}),function(n){return u(oC(t.process(e),n))})}},oV=function(t,n,e){for(var o={},r=[],i=0;i<e.length;i++)oS(e[i],function(e,i,u,a){var c=oH(u,t,n,e,a);ox.fold(c,function(t){r.push.apply(r,t)},function(t){o[i]=t})},function(t,e){o[t]=e(n)});return r.length>0?ox.serror(r):ox.svalue(o)},oL=function(t){return{extract:function(n,e){return t().extract(n,e)},toString:function(){return t().toString()}}},oz=function(t){var n=oU(t),e=tN(t,function(t,n){return oS(n,function(n){var e;return oC(t,((e={})[n]=!0,e))},tu(t))},{});return{extract:function(t,o){var r=tR($(o)?[]:t0(t9(o,tt)),function(t){return!nn(e,t)});return 0===r.length?n.extract(t,o):oI(t,function(){return"There are unsupported fields: ["+r.join(", ")+"] specified"})},toString:n.toString}},oU=function(t){return{extract:function(n,e){return oV(n,e,t)},toString:function(){return"obj{\n"+tB(t,function(t){return oS(t,function(t,n,e,o){return t+" -> "+o.toString()},function(t,n){return"state("+t+")"})}).join("\n")+"}"}}},oj=function(t){return{extract:function(n,e){var o=tB(e,function(e,o){return t.extract(n.concat(["["+o+"]"]),e)});return oM.consolidateArr(o)},toString:function(){return"array("+t.toString()+")"}}},oW=function(t){return{extract:function(n,e){for(var o=[],r=0;r<t.length;r++){var i=t[r].extract(n,e);if(i.stype===D.Value)return i;o.push(i)}return oM.consolidateArr(o)},toString:function(){return"oneOf("+tB(t,function(t){return t.toString()}).join(", ")+")"}}},oG=ti(oj,oU),oX=tu(oN),oY=function(t,n){return oR(function(e){var o=typeof e;return t(e)?ox.svalue(e):ox.serror("Expected type: "+n+" but got: "+o)})},oq=oY(te,"number"),oK=oY(Y,"string"),oJ=oY($,"boolean"),o$=oY(tn,"function"),oQ=function(t){if(Object(t)!==t)return!0;switch(({}).toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every(function(n){return oQ(t[n])});default:return!1}},oZ=oR(function(t){return oQ(t)?ox.svalue(t):ox.serror("Expected value to be acceptable for sending via postMessage")}),o0=function(t,n){return{extract:function(e,o){return t7(o,t).fold(function(){return oI(e,function(){return'Choice schema did not contain choice key: "'+t+'"'})},function(t){return t7(n,t).fold(function(){return oI(e,function(){return'The chosen schema: "'+t+'" did not exist in branches: '+oF(n)})},function(n){return n.extract(e.concat(["branch: "+t]),o)})})},toString:function(){return"chooseOn("+t+"). Possible values: "+t0(n)}}},o1=function(t){return oR(function(n){return t(n).fold(ox.serror,ox.svalue)})},o2=function(t,n){var e;return e=function(n){return ox.fromResult(t(n))},{extract:function(t,o){var r=t0(o),i=oj(oR(e)).extract(t,r);return ox.bind(i,function(e){return oU(tB(e,function(t){return ow(t,t,o_(),n)})).extract(t,o)})},toString:function(){return"setOf("+n.toString()+")"}}},o5=function(t,n,e){var o=n.extract([t],e);return ox.mapError(o,function(t){return{input:e,errors:t}})},o3=function(t,n,e){return ox.toResult(o5(t,n,e))},o9=function(t){return t.fold(function(t){throw Error(o6(t))},ta)},o4=function(t,n,e){return o9(o3(t,n,e))},o6=function(t){var n;return"Errors: \n"+tB((n=t.errors).length>10?n.slice(0,10).concat([{path:[],getErrorInfo:tu("... (only showing first ten failures)")}]):n,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}).join("\n")+"\n\nInput object: "+oF(t.input)},o8=function(t,n){return o0(t,t5(n,oU))},o7=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},rt=function(t){return o1(function(n){return tT(t,n)?oh.value(n):oh.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')})},rn=function(t){return ow(t,t,o_(),oX())},re=function(t,n){return ow(t,t,o_(),n)},ro=function(t){return re(t,oK)},rr=function(t,n){return ow(t,t,o_(),rt(n))},ri=function(t){return re(t,o$)},ru=function(t,n){return ow(t,t,o_(),oU(n))},ra=function(t,n){return ow(t,t,o_(),oG(n))},rc=function(t,n){return ow(t,t,o_(),oj(n))},rs=function(t){return ow(t,t,oD(),oX())},rl=function(t,n){return ow(t,t,oD(),n)},rf=function(t){return rl(t,oq)},rd=function(t){return rl(t,oK)},rm=function(t){return rl(t,o$)},rg=function(t,n){return rl(t,oj(n))},rp=function(t,n){return rl(t,oU(n))},rh=function(t,n){return ow(t,t,oE(n),oX())},rv=function(t,n,e){return ow(t,t,oE(n),e)},rb=function(t,n){return rv(t,n,oq)},ry=function(t,n){return rv(t,n,oK)},rx=function(t,n,e){return rv(t,n,rt(e))},rw=function(t,n){return rv(t,n,oJ)},rS=function(t,n){return rv(t,n,o$)},rk=function(t,n,e){return rv(t,n,oj(e))},rC=function(t,n,e){return rv(t,n,oU(e))},rO=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},r_={generate:function(t){if(!K(t))throw Error("cases must be an array");if(0===t.length)throw Error("there must be at least one case");var n=[],e={};return tM(t,function(o,r){var i=t0(o);if(1!==i.length)throw Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw Error("duplicate key detected:"+u);if("cata"===u)throw Error("cannot have a case named cata (sorry)");if(!K(a))throw Error("case arguments must be an array");n.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==a.length)throw Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);return n[r].apply(null,e)},match:function(t){var o=t0(t);if(n.length!==o.length)throw Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!tj(n,function(t){return tT(o,t)}))throw Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,e)},log:function(t){console.log(t,{constructors:n,constructor:u,params:e})}}}}),e}};r_.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var rT=function(t){var n=[],e=[];return tM(t,function(t){t.fold(function(t){n.push(t)},function(t){e.push(t)})}),{errors:n,values:e}},rE=function(t,n){var e={};return t2(t,function(t,o){tT(n,o)||(e[o]=t)}),e},rD=function(t,n){var e;return(e={})[t]=n,e},rA=function(t){var n={};return tM(t,function(t){n[t.key]=t.value}),n},rB=function(t,n){return rD(t,n)},rM=function(t){return rA(t)},rF=function(t,n){var e,o,r=rT(t);return r.errors.length>0?(e=r.errors,oh.error(tz(e))):0===(o=r.values).length?oh.value(n):oh.value(oC(n,oO.apply(void 0,o)))},rI=function(t){return tn(t)?t:td},rR=function(t,n,e){for(var o=t.dom,r=rI(e);o.parentNode;){o=o.parentNode;var i=nh.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return tw.none()},rN=function(t,n,e){var o=n(t),r=rI(e);return o.orThunk(function(){return r(t)?tw.none():rR(t,n,r)})},rP=function(t,n){return n9(t.element,n.event.target)},rH={can:tm,abort:td,run:tr},rV=function(t){if(!nn(t,"can")&&!nn(t,"abort")&&!nn(t,"run"))throw Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return tp(tp({},rH),t)},rL=tu("touchstart"),rz=tu("touchmove"),rU=tu("touchend"),rj=tu("touchcancel"),rW=tu("mousedown"),rG=tu("mousemove"),rX=tu("mouseout"),rY=tu("mouseup"),rq=tu("mouseover"),rK=tu("focusin"),rJ=tu("focusout"),r$=tu("keydown"),rQ=tu("keyup"),rZ=tu("input"),r0=tu("change"),r1=tu("click"),r2=tu("transitioncancel"),r5=tu("transitionend"),r3=tu("transitionstart"),r9=tu("selectstart"),r4=function(t){return tu("alloy."+t)},r6={tap:r4("tap")},r8=r4("focus"),r7=r4("blur.post"),it=r4("paste.post"),ie=r4("receive"),io=r4("execute"),ir=r4("focus.item"),ii=r6.tap,iu=r4("longpress"),ia=r4("sandbox.close"),ic=r4("typeahead.cancel"),is=r4("system.init"),il=r4("system.touchmove"),id=r4("system.touchend"),im=r4("system.scroll"),ig=r4("system.resize"),ip=r4("system.attached"),ih=r4("system.detached"),iv=r4("system.dismissRequested"),ib=r4("system.repositionRequested"),iy=r4("focusmanager.shifted"),ix=r4("slotcontainer.visibility"),iw=r4("change.tab"),iS=r4("dismiss.tab"),ik=r4("highlight"),iC=r4("dehighlight"),iO=function(t,n){iD(t,t.element,n,{})},i_=function(t,n,e){iD(t,t.element,n,e)},iT=function(t){iO(t,io())},iE=function(t,n,e){iD(t,n,e,{})},iD=function(t,n,e,o){var r=tp({target:n},o);t.getSystem().triggerEvent(e,n,r)},iA=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},iB=function(t){return rM(t)},iM=function(t,n){return{key:t,value:rV({abort:n})}},iF=function(t){return{key:t,value:rV({run:function(t,n){n.event.prevent()}})}},iI=function(t,n){return{key:t,value:rV({run:n})}},iR=function(t,n,e){return{key:t,value:rV({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},iN=function(t){return function(n){return{key:t,value:rV({run:function(t,e){rP(t,e)&&n(t,e)}})}}},iP=function(t,n,e){var o=n.partUids[e];return iI(t,function(n,e){n.getSystem().getByUid(o).each(function(n){iA(n,n.element,t,e)})})},iH=function(t,n){return iI(t,function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk(function(){return rN(o.target,function(n){return t.getSystem().getByDom(n).toOptional()},td).getOr(t)});n(t,r,e)})},iV=function(t){return iI(t,function(t,n){n.cut()})},iL=function(t,n){return iN(t)(n)},iz=iN(ip()),iU=iN(ih()),ij=iN(is()),iW=(i=io(),function(t){return iI(i,t)}),iG=function(t,n){var e=(n||document).createElement("div");return e.innerHTML=t,er(nh.fromDom(e))},iX=function(t){return t.dom.innerHTML},iY=function(t,n){var e=n8(t).dom,o=nh.fromDom(e.createDocumentFragment());e6(o,iG(n,e)),e8(t),e3(t,o)},iq=function(t){var n=nh.fromTag("div");return e3(n,nh.fromDom(t.dom.cloneNode(!0))),iX(n)},iK=function(t){var n;return ec(t)?"#shadow-root":iq((n=t,nh.fromDom(n.dom.cloneNode(!1))))},iJ=Object.freeze({__proto__:null,events:iB([{key:r8(),value:rV({can:function(t,n){var e=n.event,o=e.originator,r=e.target;return!n9(o,t.element)||!!n9(o,r)||(console.warn(r8()+" did not get interpreted by the desired target. \nOriginator: "+iK(o)+"\nTarget: "+iK(r)+"\nCheck the "+r8()+" event handlers"),!1)}})}])}),i$=0,iQ=function(t){var n=new Date().getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++i$+String(n)},iZ=tu("alloy-id-"),i0=tu("data-alloy-id"),i1=iZ(),i2=i0(),i5=function(t,n){var e=iQ(i1+t);return i3(n,e),e},i3=function(t,n){Object.defineProperty(t.dom,i2,{value:n,writable:!0})},i9=function(t){var n=ny(t)?t.dom[i2]:null;return tw.from(n)},i4=function(t){return iQ(t)},i6=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+iK(t().element)+" is not in context.":"")},e=function(t){return function(){throw Error(n(t))}},o=function(t){return function(){console.warn(n(t))}};return{debugInfo:tu("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:td}},i8=i6(),i7=function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ut(u.slice(0,1).concat(u.slice(3)))}},t},ut=function(t){return tB(t,function(t){return nf(t,"/*")?t.substring(0,t.length-2):t})},un=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:ut(i)}},t},ue=function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ut(i.slice(1))}},t},uo=iQ("alloy-premade"),ur=function(t){return rB(uo,t)},ui=function(t){return ue(function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,tv([n.getApis(),n],e,!1))},t)},uu={init:function(){return ua({readState:tu("No State required")})}},ua=function(t){return t},uc=function(t,n){var e=o3("component.behaviours",oU(tB(n,function(t){return rp(t.name(),[rn("config"),rh("state",uu)])})),t.behaviours).fold(function(n){throw Error(o6(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},ta);return{list:n,data:t5(e,function(t){return tu(t.map(function(t){return{config:t.config,state:t.state.init(t.config)}}))})}},us=function(t,n){var e={};return t2(t,function(t,o){t2(t,function(t,r){var i=t7(e,r).getOr([]);e[r]=i.concat([n(o,t)])})}),e},ul=function(t){return{classes:Q(t.classes)?[]:t.classes,attributes:Q(t.attributes)?{}:t.attributes,styles:Q(t.styles)?{}:t.styles}},uf=function(t,n,e,o){var r=tp({},n);tM(e,function(n){r[n.name()]=n.exhibit(t,o)});var i=us(r,function(t,n){return{name:t,modification:n}}),u=function(t){return tN(t,function(t,n){return tp(tp({},n.modification),t)},{})};return ul({classes:tN(i.classes,function(t,n){return n.modification.concat(t)},[]),attributes:u(i.attributes),styles:u(i.styles)})},ud=function(t,n,e,o){try{var r=tq(e,function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0});return oh.value(r)}catch(t){return oh.error([t])}},um=function(t){return t.cHandler},ug=function(t,n){return{name:t,handler:n}},up=function(t,n){var e={};return tM(t,function(t){e[t.name()]=t.handlers(n)}),e},uh=function(t){var n=tn(t)?{can:tm,abort:td,run:t}:t;return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},uv=function(t,n,e){var o=n[e];return o?ud("Event: "+e,"name",t,o).map(function(t){var n;return n=tB(t,function(t){return t.handler}),{can:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tP(n,function(n,e){return n&&e.can.apply(void 0,t)},!0)},abort:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tP(n,function(n,e){return n||e.abort.apply(void 0,t)},!1)},run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];tM(n,function(n){n.run.apply(void 0,t)})}}}):oh.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(tB(t,function(t){return t.name}),null,2)])},ub=function(t,n){return rF(t4(t,function(t,e){return(1===t.length?oh.value(t[0].handler):uv(t,n,e)).map(function(o){var r=uh(o),i=t.length>1?tR(n[e],function(n){return tE(t,function(t){return t.name===n})}).join(" > "):t[0].name;return rB(e,{handler:r,purpose:i})})}),{})},uy="alloy.base.behaviour",ux=oU([ow("dom","dom",o_(),oU([rn("tag"),rh("styles",{}),rh("classes",[]),rh("attributes",{}),rs("value"),rs("innerHtml")])),rn("components"),rn("uid"),rh("events",{}),rh("apis",{}),ow("eventOrder","eventOrder",oA(tu(((A={})[io()]=["disabling",uy,"toggling","typeaheadevents"],A[r8()]=[uy,"focusing","keying"],A[is()]=[uy,"disabling","toggling","representing"],A[rZ()]=[uy,"representing","streaming","invalidating"],A[ih()]=[uy,"representing","item-events","tooltipping"],A[rW()]=["focusing",uy,"item-type-events"],A[rL()]=["focusing",uy,"item-type-events"],A[rq()]=["item-type-events","tooltipping"],A[ie()]=["receiving","reflecting","tooltipping"],A))),oX()),rs("domModification")]),uw=function(t,n){var e=eS(t,n);return void 0===e||""===e?[]:e.split(" ")},uS=function(t,n,e){var o=uw(t,n).concat([e]);return ex(t,n,o.join(" ")),!0},uk=function(t,n,e){var o=tR(uw(t,n),function(t){return t!==e});return o.length>0?ex(t,n,o.join(" ")):eO(t,n),!1},uC=function(t){return void 0!==t.dom.classList},uO=function(t,n){uC(t)?t.dom.classList.add(n):uS(t,"class",n)},u_=function(t){0===(uC(t)?t.dom.classList:uw(t,"class")).length&&eO(t,"class")},uT=function(t,n){uC(t)?t.dom.classList.remove(n):uk(t,"class",n),u_(t)},uE=function(t,n){return uC(t)&&t.dom.classList.contains(n)},uD=function(t,n){tM(n,function(n){uO(t,n)})},uA=function(t,n){tM(n,function(n){uT(t,n)})},uB=function(t){return t.dom.value},uM=function(t,n){if(void 0===n)throw Error("Value.set was undefined");t.dom.value=n},uF=function(t){var n=nh.fromTag(t.tag);return ew(n,t.attributes),uD(n,t.classes),eD(n,t.styles),t.innerHtml.each(function(t){return iY(n,t)}),e6(n,t.domChildren),t.value.each(function(t){uM(n,t)}),t.uid,i3(n,t.uid),n},uI=function(t){var n=t7(t,"behaviours").getOr({});return tU(t0(n),function(t){var e=n[t];return tt(e)?[e.me]:[]})},uR=function(t){var n=uI(t);return uc(t,n)},uN=function(t,n,e){var o=tp(tp({},t.dom),{uid:t.uid,domChildren:tB(t.components,function(t){return t.element})}),r=t.domModification.fold(function(){return ul({})},ul),i=n.length>0?uf(e,{"alloy.base.modification":r},n,o):r;return tp(tp({},o),{attributes:tp(tp({},o.attributes),i.attributes),styles:tp(tp({},o.styles),i.styles),classes:o.classes.concat(i.classes)})},uP=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events};return(o=e,r=t.eventOrder,i=n,ub(us(tp(tp({},u),up(i,o)),ug),r)).getOrDie()},uH=function(t){var n=function(){return l},e=rO(i8),o=o9(o3("custom.definition",ux,t)),r=uR(t),i=r.list,u=r.data,a=uF(uN(o,i,u)),c=uP(o,i,u),s=rO(o.components),l={uid:t.uid,getSystem:e.get,config:function(n){return(tn(u[n.name()])?u[n.name()]:function(){throw Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return tn(u[t.name()])},spec:t,readState:function(t){return u[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(i6(n))},element:a,syncComponents:function(){var t=tU(er(a),function(t){return e.get().getByDom(t).fold(function(){return[]},tY)});s.set(t)},components:s.get,events:c};return l},uV=function(t){var n=ta(t),e=n.events,o=th(n,["events"]),r=tB(t7(o,"components").getOr([]),uU),i=tp(tp({},o),{events:tp(tp({},iJ),e),components:r});return oh.value(uH(i))},uL=function(t){return uz({element:nh.fromText(t)})},uz=function(t){var n=o4("external.component",oz([rn("element"),rs("uid")]),t),e=rO(i6()),o=n.uid.getOrThunk(function(){return i4("external")});i3(n.element,o);var r={uid:o,getSystem:e.get,config:tw.none,hasConfigured:td,connect:function(t){e.set(t)},disconnect:function(){e.set(i6(function(){return r}))},getApis:function(){return{}},element:n.element,spec:t,readState:tu("No state"),syncComponents:tr,components:tu([]),events:{}};return ur(r)},uU=function(t){return t7(t,uo).getOrThunk(function(){return uV(nt(t,"uid")?t:tp({uid:i4("")},t)).getOrDie()})};function uj(t,n,e,o,r){return t(e,o)?tw.some(e):tn(r)&&r(e)?tw.none():n(e,o,r)}var uW=function(t,n,e){for(var o=t.dom,r=tn(e)?e:td;o.parentNode;){o=o.parentNode;var i=nh.fromDom(o);if(n(i))return tw.some(i);if(r(i))break}return tw.none()},uG=function(t,n,e){return uj(function(t,n){return n(t)},uW,t,n,e)},uX=function(t,n){var e=function(t){for(var o=0;o<t.childNodes.length;o++){var r=nh.fromDom(t.childNodes[o]);if(n(r))return tw.some(r);var i=e(t.childNodes[o]);if(i.isSome())return i}return tw.none()};return e(t.dom)},uY=function(t,n,e){return uG(t,n,e).isSome()},uq=function(t,n,e){return uW(t,function(t){return n1(t,n)},e)},uK=function(t,n){return n3(n,t)},uJ=function(t,n,e){return uj(function(t,n){return n1(t,n)},uq,t,n,e)},u$=function(){var t=iQ("aria-owns");return{id:t,link:function(n){ex(n,"aria-owns",t)},unlink:function(t){eO(t,"aria-owns")}}},uQ=function(t,n){return uY(n,function(n){return n9(n,t.element)},td)||uG(n,function(t){if(!ny(t))return!1;var n=eS(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1}).bind(function(t){var n=eS(t,"id");return uK(ef(t),'[aria-owns="'+n+'"]')}).exists(function(n){return uQ(t,n)})},uZ="unknown";(u=B||(B={}))[u.STOP=0]="STOP",u[u.NORMAL=1]="NORMAL",u[u.LOGGING=2]="LOGGING";var u0=rO({}),u1=function(t,n){var e=[],o=new Date().getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=new Date().getTime();tT(["mousemove","mouseover","mouseout",is()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:tB(e,function(t){return tT(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+iK(t.target)+")":t.outcome})})}}},u2=function(t,n,e){switch(t7(u0.get(),t).orThunk(function(){return tZ(t0(u0.get()),function(n){return t.indexOf(n)>-1?tw.some(u0.get()[n]):tw.none()})}).getOr(B.NORMAL)){case B.NORMAL:return e(u4());case B.LOGGING:var o=u1(t,n),r=e(o);return o.write(),r;case B.STOP:return!0}},u5=["alloy/data/Fields","alloy/debugging/Debugging"],u3=function(){var t=Error();return void 0!==t.stack?tV(t.stack.split("\n"),function(t){return t.indexOf("alloy")>0&&!tE(u5,function(n){return t.indexOf(n)>-1})}).getOr(uZ):uZ},u9=function(t,n,e){return u2(t,n,e)},u4=tu({logEventCut:tr,logEventStopped:tr,logNoParent:tr,logEventNoHandlers:tr,logEventResponse:tr,write:tr}),u6=tu([rn("menu"),rn("selectedMenu")]),u8=tu([rn("item"),rn("selectedItem")]);tu(oU(u8().concat(u6())));var u7=tu(oU(u8())),at=ru("initSize",[rn("numColumns"),rn("numRows")]),an=function(){return ru("markers",[rn("backgroundMenu")].concat(u6()).concat(u8()))},ae=function(t){return ru("markers",tB(t,rn))},ao=function(t,n,e){return u3(),ow(n,n,e,o1(function(t){return oh.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))},ar=function(t){return ao("onHandler",t,oE(tr))},ai=function(t){return ao("onKeyboardHandler",t,oE(tw.none))},au=function(t){return ao("onHandler",t,o_())},aa=function(t){return ao("onKeyboardHandler",t,o_())},ac=function(t,n){return o7(t,tu(n))},as=function(t){return o7(t,ta)},al=tu(at),af=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},ad=r_.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),am=ad.southeast,ag=ad.southwest,ap=ad.northeast,ah=ad.northwest,av=ad.south,ab=ad.north,ay=ad.east,ax=ad.west,aw=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},aS=function(t,n,e){return Math.min(Math.max(t,n),e)},ak=function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}},aC=function(t,n){return tX(["left","right","top","bottom"],function(e){return t7(n,e).map(function(n){return ak(t,n)})})},aO=function(t,n,e){var o=function(o,r){return n[o].map(function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a=("left"===o||"top"===o?Math.max:Math.min)(n,r)+u;return i?aS(a,t.y,t.bottom):aS(a,t.x,t.right)}).getOr(r)},r=o("left",t.x),i=o("top",t.y);return ol(r,i,o("right",t.right)-r,o("bottom",t.bottom)-i)},a_="layout",aT=function(t){return t.x},aE=function(t,n){return t.x+t.width/2-n.width/2},aD=function(t,n){return t.x+t.width-n.width},aA=function(t,n){return t.y-n.height},aB=function(t){return t.y+t.height},aM=function(t,n){return t.y+t.height/2-n.height/2},aF=function(t,n,e){return af(aT(t),aB(t),e.southeast(),am(),"southeast",aC(t,{left:1,top:3}),a_)},aI=function(t,n,e){return af(aD(t,n),aB(t),e.southwest(),ag(),"southwest",aC(t,{right:0,top:3}),a_)},aR=function(t,n,e){return af(aT(t),aA(t,n),e.northeast(),ap(),"northeast",aC(t,{left:1,bottom:2}),a_)},aN=function(t,n,e){return af(aD(t,n),aA(t,n),e.northwest(),ah(),"northwest",aC(t,{right:0,bottom:2}),a_)},aP=function(t,n,e){return af(aE(t,n),aA(t,n),e.north(),ab(),"north",aC(t,{bottom:2}),a_)},aH=function(t,n,e){return af(aE(t,n),aB(t),e.south(),av(),"south",aC(t,{top:3}),a_)},aV=function(t,n,e){return af(t.x+t.width,aM(t,n),e.east(),ay(),"east",aC(t,{left:0}),a_)},aL=function(t,n,e){return af(t.x-n.width,aM(t,n),e.west(),ax(),"west",aC(t,{right:1}),a_)},az=function(){return[aF,aI,aR,aN,aH,aP,aV,aL]},aU=function(){return[aI,aF,aN,aR,aH,aP,aV,aL]},aj=function(){return[aR,aN,aF,aI,aP,aH]},aW=function(){return[aN,aR,aI,aF,aP,aH]},aG=function(){return[aF,aI,aR,aN,aH,aP]},aX=function(){return[aI,aF,aN,aR,aH,aP]},aY=Object.freeze({__proto__:null,events:function(t){return iB([iI(ie(),function(n,e){var o=t.channels,r=t0(o);tM(e.universal?r:tR(r,function(t){return tT(e.channels,t)}),function(t){var r=o[t],i=r.schema,u=o4("channel["+t+"] data\nReceiver: "+iK(n.element),i,e.data);r.onReceive(n,u)})})])}}),aq=[re("channels",o2(oh.value,oz([au("onReceive"),rh("schema",oX())])))],aK=function(t,n,e){return ij(function(o,r){e(o,t,n)})},aJ=function(t,n,e,o,r,i){var u=rp(n,[rl("config",t)]);return aQ(t,u,n,e,o,r,i)},a$=function(t){return{key:t,value:void 0}},aQ=function(t,n,e,o,r,i,u){var a=function(t){return nn(t,e)?t[e]():tw.none()},c=t5(r,function(t,n){var o;return i7(function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[n].concat(r);return n.config({name:tu(e)}).fold(function(){throw Error("We could not find any behaviour configuration for: "+e+". Using API: "+o)},function(e){var o=Array.prototype.slice.call(u,1);return t.apply(void 0,[n,e.config,e.state].concat(o))})},o=n,t)}),s=t5(i,function(t,n){return un(t,n)}),l=tp(tp(tp({},s),c),{revoke:ts(a$,e),config:function(n){var o=o4(e+"-config",t,n);return{key:e,value:{config:o,me:l,configAsRaw:nk(function(){return o4(e+"-config",t,n)}),initialConfig:n,state:u}}},schema:tu(n),exhibit:function(t,n){return ni(a(t),t7(o,"exhibit"),function(t,e){return e(n,t.config,t.state)}).getOrThunk(function(){return ul({})})},name:tu(e),handlers:function(t){return a(t).map(function(t){return t7(o,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return l},aZ=function(t){return rM(t)},a0=oz([rn("fields"),rn("name"),rh("active",{}),rh("apis",{}),rh("state",uu),rh("extra",{})]),a1=function(t){var n,e,o,r,i,u,a=o4("Creating behaviour: "+t.name,a0,t);return n=a.fields,e=a.name,o=a.active,r=a.apis,i=a.extra,u=a.state,aQ(oz(n),rp(e,[rl("config",oz(n))]),e,o,r,i,u)},a2=oz([rn("branchKey"),rn("branches"),rn("name"),rh("active",{}),rh("apis",{}),rh("state",uu),rh("extra",{})]),a5=function(t){var n=o4("Creating behaviour: "+t.name,a2,t);return aJ(o8(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},a3=tu(void 0),a9=a1({fields:aq,name:"receiving",active:aY}),a4=Object.freeze({__proto__:null,exhibit:function(t,n){return ul({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),a6=function(){return nh.fromDom(document)},a8=function(t){return t.dom.focus()},a7=function(t){var n=ef(t).dom;return t.dom===n.activeElement},ct=function(t){return void 0===t&&(t=a6()),tw.from(t.dom.activeElement).map(nh.fromDom)},cn=function(t){return ct(ef(t)).filter(function(n){return t.dom.contains(n.dom)})},ce=function(t,n){var e=ef(n),o=ct(e).bind(function(t){var e=function(n){return n9(t,n)};return e(n)?tw.some(n):uX(n,e)}),r=t(n);return o.each(function(t){ct(e).filter(function(n){return n9(n,t)}).fold(function(){a8(t)},tr)}),r},co=function(t,n,e,o,r){var i=function(t){return t+"px"};return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},cr=function(t,n){eA(t,tp(tp({},n),{position:tw.some(n.position)}))},ci=r_.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),cu=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=u.width,l=u.height,f=tw.some(a),d=tw.some(c),m=tw.some(r-(a+s)),g=tw.some(i-(c+l)),p=tw.none();return n.direction.fold(function(){return co(t,f,d,p,p)},function(){return co(t,p,d,m,p)},function(){return co(t,f,p,p,g)},function(){return co(t,p,p,m,g)},function(){return co(t,f,d,p,p)},function(){return co(t,f,p,p,g)},function(){return co(t,f,d,p,p)},function(){return co(t,p,d,m,p)})},ca=function(t,n){return t.fold(function(){var t=n.rect;return co("absolute",tw.some(t.x),tw.some(t.y),tw.none(),tw.none())},function(t,e,o,r){return cu("absolute",n,t,e,o,r)},function(t,e,o,r){return cu("fixed",n,t,e,o,r)})},cc=function(t,n){var e=ts(os,n),o=t.fold(e,e,function(){var t=on();return os(n).translate(-t.left,-t.top)}),r=eJ(n),i=ez(n);return ol(o.left,o.top,r,i)},cs=function(t,n,e){var o=ej(n,e);return t.fold(tu(o),tu(o),function(){var t=on();return o.translate(-t.left,-t.top)})};ci.none;var cl=ci.relative,cf=ci.fixed,cd="data-alloy-placement",cm=function(t,n){ex(t,cd,n)},cg=function(t){return ek(t,cd)},cp=r_.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),ch=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom;return{originInBounds:u>=e&&u<=r&&a>=o&&a<=i,sizeInBounds:c<=r&&c>=e&&s<=i&&s>=o,visibleW:Math.min(t.width,u>=e?r-u:c-e),visibleH:Math.min(t.height,a>=o?i-a:s-o)}},cv=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,l=aS(u,e,Math.max(e,r-c)),f=aS(a,o,Math.max(o,i-s));return ol(l,f,Math.min(l+c,r)-l,Math.min(f+s,i)-f)},cb=function(t,n,e){var o=tu(n.bottom-e.y),r=tu(e.bottom-n.y),i=t.fold(r,r,o,o,r,o,r,r),u=tu(n.right-e.x),a=tu(e.right-n.x);return{maxWidth:t.fold(a,u,a,u,a,a,a,u),maxHeight:i}},cy=function(t,n,e,o){var r=t.bubble,i=r.offset,u=aO(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=ol(a,c,n,e),l=ch(s,u),f=l.originInBounds,d=l.sizeInBounds,m=l.visibleW,g=l.visibleH,p=f&&d,h=p?s:cv(s,u),v=h.width>0&&h.height>0,b=cb(t.direction,h,o),y=b.maxWidth,x={rect:h,maxHeight:b.maxHeight,maxWidth:y,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c};return p||t.alwaysFit?cp.fit(x):cp.nofit(x,m,g,v)},cx=function(t,n,e,o,r,i){var u=o.width,a=o.height,c=function(n,c,s,l,f){var d=cy(n(e,o,r,t,i),u,a,i);return d.fold(tu(d),function(t,n,e,o){return(f===o?e>l||n>s:!f&&o)?d:cp.nofit(c,s,l,f)})};return tP(n,function(t,n){var e=ts(c,n);return t.fold(tu(t),e)},cp.nofit({rect:e,maxHeight:o.height,maxWidth:o.width,direction:am(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:e.y},-1,-1,!1)).fold(ta,ta)},cw=function(t){var n=rO(tw.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(tw.none())},isSet:function(){return n.get().isSome()},get:function(){return n.get()},set:function(t){e(),n.set(tw.some(t))}}},cS=function(){return cw(function(t){return t.destroy()})},ck=function(){return cw(function(t){return t.unbind()})},cC=function(){var t=cS();return tp(tp({},t),{run:function(n){return t.get().each(n)}})},cO=function(){var t=cw(tr);return tp(tp({},t),{on:function(n){return t.get().each(n)}})},c_=function(t,n,e){return eZ(t,n,tm,e,!1)},cT=function(t,n,e){return eZ(t,n,tm,e,!0)},cE=["top","bottom","right","left"],cD="data-alloy-transition-timer",cA=function(t,n){var e=function(t){return parseFloat(t).toFixed(3)};return t6(n,function(n,o){var r,i=t[o].map(e),u=n.map(e);return void 0===r&&(r=tc),!ni(i,u,r).getOr(i.isNone()&&u.isNone())}).isSome()},cB=function(t){var n=function(n){var e=eB(t,n);return tR(Y(e)?e.split(/\s*,\s*/):[],nm)},e=function(t){if(!(Y(t)&&/^[\d.]+/.test(t)))return 0;var n=parseFloat(t);return nf(t,"ms")?n:1e3*n},o=n("transition-delay");return tP(n("transition-duration"),function(t,n,r){return Math.max(t,e(o[r])+e(n))},0)},cM=function(t,n){var e,o=ck(),r=ck(),i=function(n){var e,o=(e=n.raw.pseudoElement)!==null&&void 0!==e?e:"";return n9(n.target,t)&&!nm(o)&&tT(cE,n.raw.propertyName)},u=function(u){if(Z(u)||i(u)){o.clear(),r.clear();var a=null==u?void 0:u.raw.type;(Z(a)||a===r5())&&(clearTimeout(e),eO(t,cD),uA(t,n.classes))}},a=function(){o.set(c_(t,r5(),u)),r.set(c_(t,r2(),u))};if("ontransitionstart"in t.dom)var c=c_(t,r3(),function(t){i(t)&&(c.unbind(),a())});else a();var s=cB(t);requestAnimationFrame(function(){ex(t,cD,e=setTimeout(u,s+17))})},cF=function(t,n){uD(t,n.classes),ek(t,cD).each(function(n){clearTimeout(parseInt(n,10)),eO(t,cD)}),cM(t,n)},cI=function(t,n,e,o,r,i){var u,a=i.exists(function(t){var n=o.mode;return"all"===n||t[n]!==r[n]});if(a||(u=t,tj(o.classes,function(t){return uE(u,t)}))){eE(t,"position",e.position);var c=cc(n,t),s=ca(n,tp(tp({},r),{rect:c})),l=tX(cE,function(t){return s[t]});cA(e,l)&&(eA(t,l),a&&cF(t,o),eP(t))}else uA(t,o.classes)},cR=function(t,n,e,o){eN(n,"max-height"),eN(n,"max-width");var r={width:eJ(n),height:ez(n)};return cx(n,o.preference,t,r,e,o.bounds)},cN=function(t,n){var e=n.classes;uA(t,e.off),uD(t,e.on)},cP=function(t,n,e){(0,e.maxHeightFunction)(t,n.maxHeight)},cH=function(t,n,e){(0,e.maxWidthFunction)(t,n.maxWidth)},cV=function(t,n,e){var o=ca(e.origin,n);e.transition.each(function(r){cI(t,e.origin,o,r,n,e.lastPlacement)}),cr(t,o)},cL=function(t,n){cm(t,n.placement)},cz=function(t,n){eU(t,Math.floor(n))},cU=tu(function(t,n){cz(t,n),eD(t,{"overflow-x":"hidden","overflow-y":"auto"})}),cj=tu(function(t,n){cz(t,n)}),cW=function(t,n,e){return void 0===t[n]?e:t[n]},cG=function(t,n,e,o,r,i,u,a){var c=cW(u,"maxHeightFunction",cU()),s=cW(u,"maxWidthFunction",tr),l=t.anchorBox,f=t.origin;return cX(l,n,e,{bounds:i.fold(function(){return f.fold(om,om,ol)},function(t){return f.fold(t,t,function(){var n=t(),e=cs(f,n.x,n.y);return ol(e.left,e.top,n.width,n.height)})}),origin:f,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a})},cX=function(t,n,e,o){var r=cR(t,n,e,o);return cV(n,r,o),cL(n,r),cN(n,r),cP(n,r,o),cH(n,r,o),{layout:r.layout,placement:r.placement}},cY=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],cq=function(t,n,e,o){void 0===o&&(o=1);var r=t*o,i=n*o,u=function(t){return t7(e,t).getOr([])},a=function(t,n,e){var o=tG(cY,e);return{offset:ej(t,n),classesOn:tU(e,u),classesOff:tU(o,u)}};return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},cK=function(){return cq(0,0,{})},cJ=function(t,n){return function(e){return"rtl"===c$(e)?n:t}},c$=function(t){return"rtl"===eB(t,"direction")?"rtl":"ltr"};(a=M||(M={})).TopToBottom="toptobottom",a.BottomToTop="bottomtotop";var cQ="data-alloy-vertical-dir",cZ=function(t){return uY(t,function(t){return ny(t)&&eS(t,"data-alloy-vertical-dir")===M.BottomToTop})},c0=function(){return rp("layouts",[rn("onLtr"),rn("onRtl"),rs("onBottomLtr"),rs("onBottomRtl")])},c1=function(t,n,e,o,r,i,u){var a=u.map(cZ).getOr(!1),c=n.layouts.map(function(n){return n.onLtr(t)}),s=n.layouts.map(function(n){return n.onRtl(t)});return cJ(a?n.layouts.bind(function(n){return n.onBottomLtr.map(function(n){return n(t)})}).or(c).getOr(r):c.getOr(e),a?n.layouts.bind(function(n){return n.onBottomRtl.map(function(n){return n(t)})}).or(s).getOr(i):s.getOr(o))(t)},c2=[rn("hotspot"),rs("bubble"),rh("overrides",{}),c0(),ac("placement",function(t,n,e){var o=cc(e,n.hotspot.element),r=c1(t.element,n,aG(),aX(),aj(),aW(),tw.some(n.hotspot.element));return tw.some(ta({anchorBox:o,bubble:n.bubble.getOr(cK()),overrides:n.overrides,layouts:r,placer:tw.none()}))})],c5=[rn("x"),rn("y"),rh("height",0),rh("width",0),rh("bubble",cK()),rh("overrides",{}),c0(),ac("placement",function(t,n,e){var o=cs(e,n.x,n.y),r=ol(o.left,o.top,n.width,n.height),i=c1(t.element,n,az(),aU(),az(),aU(),tw.none());return tw.some(ta({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:tw.none()}))})],c3=r_.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),c9=function(t){return t.fold(ta,function(t,n,e){return t.translate(-n,-e)})},c4=function(t){return t.fold(ta,ta)},c6=function(t){return tP(t,function(t,n){return t.translate(n.left,n.top)},ej(0,0))},c8=function(t){return c6(tB(t,c4))},c7=c3.screen,st=c3.absolute,sn=function(t,n,e){var o=en(e.root).dom;return tw.from(o.frameElement).map(nh.fromDom).filter(function(n){return n9(n8(n),n8(t.element))}).map(eX)},se=function(t,n,e){var o=on(n8(t.element));return st(sn(t,n,e).getOr(o),o.left,o.top)},so=function(t,n,e,o){var r=c7(ej(t,n));return tw.some({point:r,width:e,height:o})},sr=function(t,n,e,o,r){return t.map(function(t){var i,u=[n,t.point],a=o.fold(function(){return c8(u)},function(){return c8(u)},function(){return c6(tB(u,c9))}),c=(i=a.left,{x:i,y:a.top,width:t.width,height:t.height}),s=e.showAbove?aj():aG(),l=e.showAbove?aW():aX(),f=c1(r,e,s,l,s,l,tw.none());return ta({anchorBox:c,bubble:e.bubble.getOr(cK()),overrides:e.overrides,layouts:f,placer:tw.none()})})},si=[rn("node"),rn("root"),rs("bubble"),c0(),rh("overrides",{}),rh("showAbove",!1),ac("placement",function(t,n,e){var o=se(t,e,n);return n.node.filter(eh).bind(function(r){var i=r.dom.getBoundingClientRect(),u=so(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return sr(u,o,n,e,a)})})],su={create:function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}}},sa=r_.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),sc={before:sa.before,on:sa.on,after:sa.after,cata:function(t,n,e,o){return t.fold(n,e,o)},getStart:function(t){return t.fold(ta,ta,ta)}},ss=r_.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),sl={domRange:ss.domRange,relative:ss.relative,exact:ss.exact,exactFromRange:function(t){return ss.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){return en(t.match({domRange:function(t){return nh.fromDom(t.startContainer)},relative:function(t,n){return sc.getStart(t)},exact:function(t,n,e,o){return t}}))},range:su.create},sf=function(t,n){n.fold(function(n){t.setStartBefore(n.dom)},function(n,e){t.setStart(n.dom,e)},function(n){t.setStartAfter(n.dom)})},sd=function(t,n){n.fold(function(n){t.setEndBefore(n.dom)},function(n,e){t.setEnd(n.dom,e)},function(n){t.setEndAfter(n.dom)})},sm=function(t,n,e){var o=t.document.createRange();return sf(o,n),sd(o,e),o},sg=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},sp=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},sh=function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?tw.some(e).map(sp):tw.none()},sv=function(t){var n=t.getBoundingClientRect();return n.width>0||n.height>0?tw.some(n).map(sp):tw.none()},sb=r_.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),sy=function(t,n,e){return n(nh.fromDom(e.startContainer),e.startOffset,nh.fromDom(e.endContainer),e.endOffset)},sx=function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return sb.rtl(nh.fromDom(t.endContainer),t.endOffset,nh.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return sy(t,sb.ltr,e)}):sy(t,sb.ltr,e)},sw=function(t,n){var e=n.match({domRange:function(t){return{ltr:tu(t),rtl:tw.none}},relative:function(n,e){return{ltr:nk(function(){return sm(t,n,e)}),rtl:nk(function(){return tw.some(sm(t,e,n))})}},exact:function(n,e,o,r){return{ltr:nk(function(){return sg(t,n,e,o,r)}),rtl:nk(function(){return tw.some(sg(t,o,r,n,e))})}}});return sx(t,e)},sS=function(t,n){return sw(t,n).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})};sb.ltr,sb.rtl;var sk=(c="text",{get:function(t){if(!nx(t))throw Error("Can only get "+c+" value of a "+c+" node");return s(t).getOr("")},getOption:s=function(t){return nx(t)?tw.from(t.dom.nodeValue):tw.none()},set:function(t,n){if(!nx(t))throw Error("Can only set raw "+c+" value of a "+c+" node");t.dom.nodeValue=n}}),sC=function(t){return sk.getOption(t)},sO=["img","br"],s_=function(t){return sC(t).filter(function(t){return 0!==t.trim().length||t.indexOf("\xa0")>-1}).isSome()||tT(sO,nv(t))},sT=function(t,n){var e=function(t){for(var o=er(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return tw.some(i);var u=e(i);if(u.isSome())return u}return tw.none()};return e(t)},sE=function(t,n){return n5(n,t)},sD=function(t,n,e,o){var r=n8(t).dom.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r},sA=function(t,n,e,o){var r=sD(t,n,e,o),i=n9(t,e)&&n===o;return r.collapsed&&!i},sB=function(t){if(!(t.rangeCount>0))return tw.none();var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return tw.some(su.create(nh.fromDom(n.startContainer),n.startOffset,nh.fromDom(e.endContainer),e.endOffset))},sM=function(t){if(null===t.anchorNode||null===t.focusNode)return sB(t);var n=nh.fromDom(t.anchorNode),e=nh.fromDom(t.focusNode);return sA(n,t.anchorOffset,e,t.focusOffset)?tw.some(su.create(n,t.anchorOffset,e,t.focusOffset)):sB(t)},sF=function(t,n){return sh(sS(t,n))},sI=function(t,n){return{element:t,offset:n}},sR=function(t,n){var e=er(t);if(0===e.length)return sI(t,n);if(n<e.length)return sI(e[n],0);var o=e[e.length-1],r=nx(o)?sk.get(o).length:er(o).length;return sI(o,r)},sN=function(t,n){return nx(t)?sI(t,n):sR(t,n)},sP=function(t,n){return n.getSelection.getOrThunk(function(){return function(){var n;return n=t,tw.from(n.getSelection()).filter(function(t){return t.rangeCount>0}).bind(sM)}})().map(function(t){var n=sN(t.start,t.soffset),e=sN(t.finish,t.foffset);return sl.range(n.element,n.offset,e.element,e.offset)})},sH=[rs("getSelection"),rn("root"),rs("bubble"),c0(),rh("overrides",{}),rh("showAbove",!1),ac("placement",function(t,n,e){var o=en(n.root).dom,r=se(t,e,n),i=sP(o,n).bind(function(t){return sv(sS(o,sl.exactFromRange(t))).orThunk(function(){var n=nh.fromText("\uFEFF");e1(t.start,n);var e=sF(o,sl.exact(n,0,n,1));return e7(n),e}).bind(function(t){return so(t.left,t.top,t.width,t.height)})}),u=sP(o,n).bind(function(t){return ny(t.start)?tw.some(t.start):ee(t.start)}).getOr(t.element);return sr(i,r,n,e,u)})],sV="link-layout",sL=function(t){return t.x+t.width},sz=function(t,n){return t.x-n.width},sU=function(t,n){return t.y-n.height+t.height},sj=function(t){return t.y},sW=function(t,n,e){return af(sL(t),sj(t),e.southeast(),am(),"southeast",aC(t,{left:0,top:2}),sV)},sG=function(t,n,e){return af(sz(t,n),sj(t),e.southwest(),ag(),"southwest",aC(t,{right:1,top:2}),sV)},sX=function(t,n,e){return af(sL(t),sU(t,n),e.northeast(),ap(),"northeast",aC(t,{left:0,bottom:3}),sV)},sY=function(t,n,e){return af(sz(t,n),sU(t,n),e.northwest(),ah(),"northwest",aC(t,{right:1,bottom:3}),sV)},sq=function(){return[sW,sG,sX,sY]},sK=function(){return[sG,sW,sY,sX]},sJ=o8("type",{selection:sH,node:si,hotspot:c2,submenu:[rn("item"),c0(),rh("overrides",{}),ac("placement",function(t,n,e){var o=cc(e,n.item.element),r=c1(t.element,n,sq(),sK(),sq(),sK(),tw.none());return tw.some(ta({anchorBox:o,bubble:cK(),overrides:n.overrides,layouts:r,placer:tw.none()}))})],makeshift:c5}),s$=[rc("classes",oK),rx("mode","all",["all","layout","placement"])],sQ=[rh("useFixed",td),rs("getBounds")],sZ=[re("anchor",sJ),rp("transition",s$)],s0=function(){var t=document.documentElement;return cf(0,0,t.clientWidth,t.clientHeight)},s1=function(t){var n=eX(t.element),e=t.element.dom.getBoundingClientRect();return cl(n.left,n.top,e.width,e.height)},s2=function(t,n,e,o,r,i,u){return cG({anchorBox:e.anchorBox,origin:n},r.element,e.bubble,e.layouts,i,o,e.overrides,u)},s5=function(t,n,e,o,r,i){return s3(t,n,e,o,r,i.map(of))},s3=function(t,n,e,o,r,i){var u=o4("placement.info",oU(sZ),r),a=u.anchor,c=o.element,s=e.get(o.uid);ce(function(){eE(c,"position","fixed");var r=eF(c,"visibility");eE(c,"visibility","hidden");var l=n.useFixed()?s0():s1(t),f=a.placement,d=i.map(tu).or(n.getBounds);f(t,a,l).each(function(n){var r=n.placer.getOr(s2)(t,l,n,d,o,s,u.transition);e.set(o.uid,r)}),r.fold(function(){eN(c,"visibility")},function(t){eE(c,"visibility",t)}),eF(c,"left").isNone()&&eF(c,"top").isNone()&&eF(c,"right").isNone()&&eF(c,"bottom").isNone()&&ne(eF(c,"position"),"fixed")&&eN(c,"position")},c)},s9=a1({fields:sQ,name:"positioning",active:a4,apis:Object.freeze({__proto__:null,position:function(t,n,e,o,r){s5(t,n,e,o,r,tw.none())},positionWithin:s5,positionWithinBounds:s3,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"},reset:function(t,n,e,o){var r=o.element;tM(["position","left","right","top","bottom"],function(t){return eN(r,t)}),eO(r,cd),e.clear(o.uid)}}),state:Object.freeze({__proto__:null,init:function(){var t={};return ua({readState:function(){return t},clear:function(n){tt(n)?delete t[n]:t={}},set:function(n,e){t[n]=e},get:function(n){return t7(t,n)}})}})}),s4=function(t){iO(t,ih()),tM(t.components(),s4)},s6=function(t){tM(t.components(),s6),iO(t,ip())},s8=function(t,n){e3(t.element,n.element)},s7=function(t){tM(t.components(),function(t){return e7(t.element)}),e8(t.element),t.syncComponents()},lt=function(t,n){var e=t.components();s7(t),tM(tG(e,n),function(n){s4(n),t.getSystem().removeFromWorld(n)}),tM(n,function(n){n.getSystem().isConnected()?s8(t,n):(t.getSystem().addToWorld(n),s8(t,n),eh(t.element)&&s6(n)),t.syncComponents()})},ln=function(t,n){le(t,n,e3)},le=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),eh(t.element)&&s6(n),t.syncComponents()},lo=function(t){s4(t),e7(t.element),t.getSystem().removeFromWorld(t)},lr=function(t){var n=ee(t.element).bind(function(n){return t.getSystem().getByDom(n).toOptional()});lo(t),n.each(function(t){t.syncComponents()})},li=function(t){tM(t.components(),lo),e8(t.element),t.syncComponents()},lu=function(t,n){lc(t,n,e3)},la=function(t,n){lc(t,n,e2)},lc=function(t,n,e){e(t,n.element),tM(er(n.element),function(t){n.getByDom(t).each(s6)})},ls=function(t){tM(er(t.element),function(n){t.getByDom(n).each(s4)}),e7(t.element)},ll=function(t,n,e,o){e.get().each(function(n){li(t)}),ln(n.getAttachPoint(t),t);var r=t.getSystem().build(o);return ln(t,r),e.set(r),r},lf=function(t,n,e,o){var r=ll(t,n,e,o);return n.onOpen(t,r),r},ld=function(t,n,e){e.get().each(function(o){li(t),lr(t),n.onClose(t,o),e.clear()})},lm=function(t,n,e){return e.isOpen()},lg=function(t,n,e,o){eF(t.element,n).fold(function(){eO(t.element,e)},function(n){ex(t.element,e,n)}),eE(t.element,n,o)},lp=function(t,n,e){ek(t.element,e).fold(function(){return eN(t.element,n)},function(e){return eE(t.element,n,e)})},lh=function(t,n,e){var o=n.getAttachPoint(t);eE(t.element,"position",s9.getMode(o)),lg(t,"visibility",n.cloakVisibilityAttr,"hidden")},lv=function(t,n,e){var o;o=t.element,tE(["top","left","right","bottom"],function(t){return eF(o,t).isSome()})||eN(t.element,"position"),lp(t,"visibility",n.cloakVisibilityAttr)},lb=Object.freeze({__proto__:null,cloak:lh,decloak:lv,open:lf,openWhileCloaked:function(t,n,e,o,r){lh(t,n),lf(t,n,e,o),r(),lv(t,n)},close:ld,isOpen:lm,isPartOf:function(t,n,e,o){return lm(t,n,e)&&e.get().exists(function(e){return n.isPartOf(t,e,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return ll(t,n,e,o)})}}),ly=Object.freeze({__proto__:null,events:function(t,n){return iB([iI(ia(),function(e,o){ld(e,t,n)})])}}),lx=a1({fields:[ar("onOpen"),ar("onClose"),rn("isPartOf"),rn("getAttachPoint"),rh("cloakVisibilityAttr","data-precloak-visibility")],name:"sandboxing",active:ly,apis:lb,state:Object.freeze({__proto__:null,init:function(){var t=cO();return ua({readState:tu("not-implemented"),isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}})}),lw=tu("dismiss.popups"),lS=tu("reposition.popups"),lk=tu("mouse.released"),lC=oz([rh("isExtraPart",td),rp("fireEventInstead",[rh("event",iv())])]),lO=function(t){var n,e=o4("Dismissal",lC,t);return(n={})[lw()]={schema:oz([rn("target")]),onReceive:function(t,n){lx.isOpen(t)&&!(lx.isPartOf(t,n.target)||e.isExtraPart(t,n.target))&&e.fireEventInstead.fold(function(){return lx.close(t)},function(n){return iO(t,n.event)})}},n},l_=oz([rp("fireEventInstead",[rh("event",ib())]),ri("doReposition")]),lT=function(t){var n,e=o4("Reposition",l_,t);return(n={})[lS()]={onReceive:function(t){lx.isOpen(t)&&e.fireEventInstead.fold(function(){return e.doReposition(t)},function(n){return iO(t,n.event)})}},n},lE=function(t,n,e){n.store.manager.onLoad(t,n,e)},lD=function(t,n,e){n.store.manager.onUnload(t,n,e)},lA=Object.freeze({__proto__:null,onLoad:lE,onUnload:lD,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),lB=Object.freeze({__proto__:null,events:function(t,n){return iB(t.resetOnDom?[iz(function(e,o){lE(e,t,n)}),iU(function(e,o){lD(e,t,n)})]:[aK(t,n,lE)])}}),lM=function(){var t=rO(null);return ua({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},lF=function(){var t=rO({}),n=rO({});return ua({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return t7(t.get(),e).orThunk(function(){return t7(n.get(),e)})},update:function(e){var o=t.get(),r=n.get(),i={},u={};tM(e,function(t){i[t.value]=t,t7(t,"meta").each(function(n){t7(n,"text").each(function(n){u[n]=t})})}),t.set(tp(tp({},o),i)),n.set(tp(tp({},r),u))},clear:function(){t.set({}),n.set({})}})},lI=Object.freeze({__proto__:null,memory:lM,dataset:lF,manual:function(){return ua({readState:tr})},init:function(t){return t.store.manager.state(t)}}),lR=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},lN=[rs("initialValue"),rn("getFallbackEntry"),rn("getDataKey"),rn("setValue"),ac("manager",{setValue:lR,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk(function(){return o.getFallbackEntry(r)})},onLoad:function(t,n,e){n.store.initialValue.each(function(o){lR(t,n,e,o)})},onUnload:function(t,n,e){e.clear()},state:lF})],lP=[rn("getValue"),rh("setValue",tr),rs("initialValue"),ac("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each(function(e){n.store.setValue(t,e)})},onUnload:tr,state:uu.init})],lH=a1({fields:[rv("store",{mode:"memory"},o8("mode",{memory:[rs("initialValue"),ac("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:lM})],manual:lP,dataset:lN})),ar("onSetValue"),rh("resetOnDom",!1)],name:"representing",active:lB,apis:lA,extra:{setValueFrom:function(t,n){var e=lH.getValue(n);lH.setValue(t,e)}},state:lI}),lV=function(t,n){return rC(t,{},tB(n,function(n){var e,o;return e=n.name(),o="Cannot configure "+n.name()+" for "+t,ow(e,e,oD(),oR(function(t){return ox.serror("The field: "+e+" is forbidden. "+o)}))}).concat([o7("dump",ta)]))},lL=function(t){return t.dump},lz=function(t,n){return tp(tp({},aZ(n)),t.dump)},lU={field:lV,augment:lz,get:lL},lj="placeholder",lW=r_.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),lG=function(t){return nt(t,"uiType")},lX=function(t,n,e,o){var r,i,u,a;return(r=t,i=0,u=e,a=o,lG(u)&&u.uiType===lj?r.exists(function(t){return t!==u.owner})?lW.single(!0,tu(u)):t7(a,u.name).fold(function(){throw Error("Unknown placeholder component: "+u.name+"\nKnown: ["+t0(a)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))},function(t){return t.replace()}):lW.single(!1,tu(u))).fold(function(r,i){var u=lG(e)?i(n,e.config,e.validated):i(n),a=tU(t7(u,"components").getOr([]),function(e){return lX(t,n,e,o)});return[tp(tp({},u),{components:a})]},function(t,o){if(!lG(e))return o(n);var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(ta)(r)})},lY=function(t,n){var e=!1;return{name:tu(t),required:function(){return n.fold(function(t,n){return t},function(t,n){return t})},used:function(){return e},replace:function(){if(e)throw Error("Trying to use the same placeholder more than once: "+t);return e=!0,n}}},lq=function(t,n,e,o){var r=t5(o,function(t,n){return lY(n,t)}),i=tU(e,function(e){return lX(t,n,e,r)});return t2(r,function(e){if(!1===e.used()&&e.required())throw Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))}),i},lK=lW.single,lJ=lW.multiple,l$=tu(lj),lQ=r_.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),lZ=rh("factory",{sketch:ta}),l0=rh("schema",[]),l1=rn("name"),l2=ow("pname","pname",oT(function(t){return"<alloy."+iQ(t.name)+">"}),oX()),l5=o7("schema",function(){return[rs("preprocess")]}),l3=rh("defaults",tu({})),l9=rh("overrides",tu({})),l4=oU([lZ,l0,l1,l2,l3,l9]),l6=oU([lZ,l0,l1,l3,l9]),l8=oU([lZ,l0,l1,l2,l3,l9]),l7=oU([lZ,l5,l1,rn("unit"),l2,l3,l9]),ft=function(t){return t.fold(tw.some,tw.none,tw.some,tw.some)},fn=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},fe=function(t,n){return function(e){return t(o4("Converting part type",n,e))}},fo=fe(lQ.required,l4),fr=fe(lQ.external,l6),fi=fe(lQ.optional,l8),fu=fe(lQ.group,l7),fa=tu("entirety"),fc=Object.freeze({__proto__:null,required:fo,external:fr,optional:fi,group:fu,asNamedPart:ft,name:fn,asCommon:function(t){return t.fold(ta,ta,ta,ta)},original:fa}),fs=function(t,n,e,o){return oC(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},fl=function(t,n,e){var o={},r={};return tM(e,function(t){t.fold(function(t){o[t.pname]=lK(!0,function(n,e,o){return t.factory.sketch(fs(n,t,e,o))})},function(t){var e=n.parts[t.name];r[t.name]=tu(t.factory.sketch(fs(n,t,e[fa()]),e))},function(t){o[t.pname]=lK(!1,function(n,e,o){return t.factory.sketch(fs(n,t,e,o))})},function(t){o[t.pname]=lJ(!0,function(n,e,o){return tB(n[t.name],function(e){return t.factory.sketch(oC(t.defaults(n,e,o),e,t.overrides(n,e)))})})})}),{internals:tu(o),externals:tu(r)}},ff=function(t,n){var e={};return tM(n,function(n){ft(n).each(function(n){var o=fd(t,n.pname);e[n.name]=function(e){var r=o4("Part: "+n.name+" in "+t,oU(n.schema),e);return tp(tp({},o),{config:e,validated:r})}})}),e},fd=function(t,n){return{uiType:l$(),owner:t,name:n}},fm=function(t,n,e){return{uiType:l$(),owner:t,name:n,config:e,validated:{}}},fg=function(t){return tU(t,function(t){return t.fold(tw.none,tw.some,tw.none,tw.none).map(function(t){return ru(t.name,t.schema.concat([as(fa())]))}).toArray()})},fp=function(t){return tB(t,fn)},fh=function(t,n,e){return fl(t,n,e)},fv=function(t,n,e){return lq(tw.some(t),n,n.components,e)},fb=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},fy=function(t,n,e){return fb(t,n,e).getOrDie("Could not find part: "+e)},fx=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return tM(e,function(t){o[t]=tu(i.getByUid(r[t]))}),o},fw=function(t,n){var e=t.getSystem();return t5(n.partUids,function(t,n){return tu(e.getByUid(t))})},fS=function(t){return t0(t.partUids)},fk=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return tM(e,function(t){o[t]=tu(i.getByUid(r[t]).getOrDie())}),o},fC=function(t,n){return rM(tB(fp(n),function(n){return{key:n,value:t+"-"+n}}))},fO=function(t){return ow("partUids","partUids",oA(function(n){return fC(n.uid,t)}),oX())},f_=Object.freeze({__proto__:null,generate:ff,generateOne:fm,schemas:fg,names:fp,substitutes:fh,components:fv,defaultUids:fC,defaultUidsSchema:fO,getAllParts:fw,getAllPartNames:fS,getPart:fb,getPartOrDie:fy,getParts:fx,getPartsOrDie:fk}),fT=function(t,n,e,o,r){return o4(t+" [SpecSchema]",oz((o.length>0?[ru("parts",o)]:[]).concat([rn("uid"),rh("dom",{}),rh("components",[]),as("originalSpec"),rh("debug.sketcher",{})]).concat(r).concat(n)),e)},fE=function(t,n,e,o){var r=fA(o);return e(fT(t,n,r,[],[]),r)},fD=function(t,n,e,o,r){var i=fA(r),u=fT(t,n,i,fg(e),[fO(e)]),a=fh(t,u,e),c=fv(t,u,a.internals());return o(u,c,i,a.externals())},fA=function(t){return nt(t,"uid")?t:tp(tp({},t),{uid:i4("uid")})},fB=oz([rn("name"),rn("factory"),rn("configFields"),rh("apis",{}),rh("extraApis",{})]),fM=oz([rn("name"),rn("factory"),rn("configFields"),rn("partFields"),rh("apis",{}),rh("extraApis",{})]),fF=function(t){var n=o4("Sketcher for "+t.name,fB,t),e=t5(n.apis,ui),o=t5(n.extraApis,function(t,n){return un(t,n)});return tp(tp({name:n.name,configFields:n.configFields,sketch:function(t){return fE(n.name,n.configFields,n.factory,t)}},e),o)},fI=function(t){var n=o4("Sketcher for "+t.name,fM,t),e=ff(n.name,n.partFields),o=t5(n.apis,ui),r=t5(n.extraApis,function(t,n){return un(t,n)});return tp(tp({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return fD(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},fR=function(t){return"input"===nv(t)&&"radio"!==eS(t,"type")||"textarea"===nv(t)},fN=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),fP=a1({fields:[rn("find")],name:"composing",apis:fN}),fH=["input","button","textarea","select"],fV=function(t,n,e){(n.disabled()?fG:fX)(t,n)},fL=function(t,n){return!0===n.useNative&&tT(fH,nv(t.element))},fz=function(t){ex(t.element,"disabled","disabled")},fU=function(t){eO(t.element,"disabled")},fj=function(t){ex(t.element,"aria-disabled","true")},fW=function(t){ex(t.element,"aria-disabled","false")},fG=function(t,n,e){n.disableClass.each(function(n){uO(t.element,n)}),(fL(t,n)?fz:fj)(t),n.onDisabled(t)},fX=function(t,n,e){n.disableClass.each(function(n){uT(t.element,n)}),(fL(t,n)?fU:fW)(t),n.onEnabled(t)},fY=function(t,n){return fL(t,n)?eC(t.element,"disabled"):"true"===eS(t.element,"aria-disabled")},fq=Object.freeze({__proto__:null,enable:fX,disable:fG,isDisabled:fY,onLoad:fV,set:function(t,n,e,o){(o?fG:fX)(t,n)}}),fK=Object.freeze({__proto__:null,exhibit:function(t,n){return ul({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return iB([iM(io(),function(n,e){return fY(n,t)}),aK(t,n,fV)])}}),fJ=a1({fields:[rS("disabled",td),rh("useNative",!0),rs("disableClass"),ar("onDisabled"),ar("onEnabled")],name:"disabling",active:fK,apis:fq}),f$=function(t,n,e,o){tM(sE(t.element,"."+n.highlightClass),function(e){tE(o,function(t){return t.element===e})||(uT(e,n.highlightClass),t.getSystem().getByDom(e).each(function(e){n.onDehighlight(t,e),iO(e,iC())}))})},fQ=function(t,n,e,o){f$(t,n,e,[o]),fZ(t,n,e,o)||(uO(o.element,n.highlightClass),n.onHighlight(t,o),iO(o,ik()))},fZ=function(t,n,e,o){return uE(o.element,n.highlightClass)},f0=function(t,n,e,o){var r=sE(t.element,"."+n.itemClass);return tw.from(r[o]).fold(function(){return oh.error(Error("No element found with index "+o))},t.getSystem().getByDom)},f1=function(t,n,e){return uK(t.element,"."+n.itemClass).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},f2=function(t,n,e){var o=sE(t.element,"."+n.itemClass);return(o.length>0?tw.some(o[o.length-1]):tw.none()).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},f5=function(t,n,e,o){var r=sE(t.element,"."+n.itemClass);return tL(r,function(t){return uE(t,n.highlightClass)}).bind(function(n){var e=aw(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})},f3=function(t,n,e){return no(tB(sE(t.element,"."+n.itemClass),function(n){return t.getSystem().getByDom(n).toOptional()}))},f9=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return f$(t,n,e,[])},dehighlight:function(t,n,e,o){fZ(t,n,e,o)&&(uT(o.element,n.highlightClass),n.onDehighlight(t,o),iO(o,iC()))},highlight:fQ,highlightFirst:function(t,n,e){f1(t,n).each(function(o){fQ(t,n,e,o)})},highlightLast:function(t,n,e){f2(t,n).each(function(o){fQ(t,n,e,o)})},highlightAt:function(t,n,e,o){f0(t,n,e,o).fold(function(t){throw t},function(o){fQ(t,n,e,o)})},highlightBy:function(t,n,e,o){tV(f3(t,n),o).each(function(o){fQ(t,n,e,o)})},isHighlighted:fZ,getHighlighted:function(t,n,e){return uK(t.element,"."+n.highlightClass).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},getFirst:f1,getLast:f2,getPrevious:function(t,n,e){return f5(t,n,e,-1)},getNext:function(t,n,e){return f5(t,n,e,1)},getCandidates:f3}),f4=a1({fields:[rn("highlightClass"),rn("itemClass"),ar("onHighlight"),ar("onDehighlight")],name:"highlighting",apis:f9}),f6=[9],f8=[13],f7=[27],dt=[32],dn=[37],de=[38],dr=[39],di=[40],du=function(t,n,e){var o=tW(t.slice(0,n)),r=tW(t.slice(n+1));return tV(o.concat(r),e)},da=function(t,n,e){return tV(tW(t.slice(0,n)),e)},dc=function(t,n,e){var o=t.slice(0,n);return tV(t.slice(n+1).concat(o),e)},ds=function(t,n,e){return tV(t.slice(n+1),e)},dl=function(t){return function(n){return tT(t,n.raw.which)}},df=function(t){return function(n){return tj(t,function(t){return t(n)})}},dd=function(t){return!0===t.raw.shiftKey},dm=function(t){return!0===t.raw.ctrlKey},dg=tl(dd),dp=function(t,n){return{matches:t,classification:n}},dh=function(t,n,e){n.exists(function(t){return e.exists(function(n){return n9(n,t)})})||i_(t,iy(),{prevFocus:n,newFocus:e})},dv=function(){var t=function(t){return cn(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);dh(n,o,r)}}},db=function(){var t=function(t){return f4.getHighlighted(t).map(function(t){return t.element})};return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(tr,function(t){f4.highlight(n,t)});var r=t(n);dh(n,o,r)}}};(l=F||(F={})).OnFocusMode="onFocus",l.OnEnterOrSpaceMode="onEnterOrSpace",l.OnApiMode="onApi";var dy=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u;return(i=e(t,n,o,r),u=n.event,tV(i,function(t){return t.matches(u)}).map(function(t){return t.classification})).bind(function(e){return e(t,n,o,r)})},u={schema:function(){return t.concat([rh("focusManager",dv()),rv("focusInside","onFocus",o1(function(t){return tT(["onFocus","onEnterOrSpace","onApi"],t)?oh.value(t):oh.error("Invalid value for focusInside")})),ac("handler",u),ac("state",n),ac("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==F.OnFocusMode?tw.none():r(t).map(function(e){return iI(r8(),function(o,r){e(o,t,n),r.stop()})}),a=function(e,o){var i=dl(dt.concat(f8))(o.event);t.focusInside===F.OnEnterOrSpaceMode&&i&&rP(e,o)&&r(t).each(function(r){r(e,t,n),o.stop()})},c=[iI(r$(),function(o,r){i(o,r,e,t,n).fold(function(){a(o,r)},function(t){r.stop()})}),iI(rQ(),function(e,r){i(e,r,o,t,n).each(function(t){r.stop()})})];return iB(u.toArray().concat(c))}};return u},dx=function(t){var n=[rs("onEscape"),rs("onEnter"),rh("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),rh("firstTabstop",0),rh("useTabstopAt",tm),rs("visibilitySelector")].concat([t]),e=function(t,n){return eL(t.visibilitySelector.bind(function(t){return uJ(n,t)}).getOr(n))>0},o=function(t,n){var o=tR(sE(t.element,n.selector),function(t){return e(n,t)});return tw.from(o[n.firstTabstop])},r=function(t,n,e){o(t,n).each(function(e){n.focusManager.set(t,e)})},i=function(t,n,o,r){var i=sE(t.element,o.selector);return o.focusManager.get(t).bind(function(t){return uJ(t,o.selector)}).bind(function(n){return tL(i,ts(n9,n)).bind(function(n){return r(i,n,function(t){return e(o,t)&&o.useTabstopAt(t)}).fold(function(){return o.cyclic?tw.some(!0):tw.none()},function(n){return o.focusManager.set(t,n),tw.some(!0)})})})},u=tu([dp(df([dd,dl(f6)]),function(t,n,e){var o=e.cyclic?du:da;return i(t,n,e,o)}),dp(dl(f6),function(t,n,e){var o=e.cyclic?dc:ds;return i(t,n,e,o)}),dp(dl(f7),function(t,n,e){return e.onEscape.bind(function(e){return e(t,n)})}),dp(df([dg,dl(f8)]),function(t,n,e){return e.onEnter.bind(function(e){return e(t,n)})})]),a=tu([]);return dy(n,uu.init,u,a,function(){return tw.some(r)})},dw=dx(o7("cyclic",td)),dS=dx(o7("cyclic",tm)),dk=function(t,n,e){return fR(e)&&dl(dt)(n.event)?tw.none():(iE(t,e,io()),tw.some(!0))},dC=function(t,n){return tw.some(!0)},dO=[rh("execute",dk),rh("useSpace",!1),rh("useEnter",!0),rh("useControlEnter",!1),rh("useDown",!1)],d_=function(t,n,e){return e.execute(t,n,t.element)},dT=dy(dO,uu.init,function(t,n,e,o){var r=e.useSpace&&!fR(t.element)?dt:[],i=e.useEnter?f8:[],u=e.useDown?di:[];return[dp(dl(r.concat(i).concat(u)),d_)].concat(e.useControlEnter?[dp(df([dm,dl(f8)]),d_)]:[])},function(t,n,e,o){return e.useSpace&&!fR(t.element)?[dp(dl(dt),dC)]:[]},function(){return tw.none()}),dE=function(){var t=cO();return ua({readState:function(){return t.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map(function(t){return t.numRows})},getNumColumns:function(){return t.get().map(function(t){return t.numColumns})}})},dD=Object.freeze({__proto__:null,flatgrid:dE,init:function(t){return t.state(t)}}),dA=function(t){return function(n,e,o,r){return dI(t(n.element),n,e,o,r)}},dB=function(t,n){return dA(cJ(t,n))},dM=function(t,n){return dA(cJ(n,t))},dF=function(t){return function(n,e,o,r){return dI(t,n,e,o,r)}},dI=function(t,n,e,o,r){return o.focusManager.get(n).bind(function(e){return t(n.element,e,o,r)}).map(function(t){return o.focusManager.set(n,t),!0})},dR=function(t){var n;return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0)},dN=function(t,n,e){var o;return tL(o=tR(sE(t,e),dR),function(t){return n9(t,n)}).map(function(t){return{index:t,candidates:o}})},dP=function(t,n){return tL(t,function(t){return n9(n,t)})},dH=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind(function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?tw.some(t[o]):tw.none()})},dV=function(t,n,e,o,r){return dH(t,n,o,function(n,i){var u=aw(i,r,0,(n===e-1?t.length-n*o:o)-1);return tw.some({row:n,column:u})})},dL=function(t,n,e,o,r){return dH(t,n,o,function(n,i){var u=aw(n,r,0,e-1),a=aS(i,0,(u===e-1?t.length-u*o:o)-1);return tw.some({row:u,column:a})})},dz=[rn("selector"),rh("execute",dk),ai("onEscape"),rh("captureTab",!1),al()],dU=function(t,n,e){uK(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})},dj=function(t){return function(n,e,o,r){return dN(n,e,o.selector).bind(function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))})}},dW=function(t,n,e){return e.captureTab?tw.some(!0):tw.none()},dG=dj(function(t,n,e,o){return dV(t,n,e,o,-1)}),dX=dj(function(t,n,e,o){return dV(t,n,e,o,1)}),dY=dj(function(t,n,e,o){return dL(t,n,e,o,-1)}),dq=dj(function(t,n,e,o){return dL(t,n,e,o,1)}),dK=dy(dz,dE,tu([dp(dl(dn),dB(dG,dX)),dp(dl(dr),dM(dG,dX)),dp(dl(de),dF(dY)),dp(dl(di),dF(dq)),dp(df([dd,dl(f6)]),dW),dp(df([dg,dl(f6)]),dW),dp(dl(f7),function(t,n,e){return e.onEscape(t,n)}),dp(dl(dt.concat(f8)),function(t,n,e,o){return e.focusManager.get(t).bind(function(t){return uJ(t,e.selector)}).bind(function(o){return e.execute(t,n,o)})})]),tu([dp(dl(dt),dC)]),function(){return tw.some(dU)}),dJ=function(t,n,e,o){var r=function(t,n,e){var i,u=aw(n,o,0,e.length-1);return u===t?tw.none():"button"===nv(i=e[u])&&"disabled"===eS(i,"disabled")?r(t,u,e):tw.from(e[u])};return dN(t,e,n).bind(function(t){var n=t.index;return r(n,n,t.candidates)})},d$=[rn("selector"),rh("getInitial",tw.none),rh("execute",dk),ai("onEscape"),rh("executeOnMove",!1),rh("allowVertical",!0)],dQ=function(t,n,e){return e.focusManager.get(t).bind(function(t){return uJ(t,e.selector)}).bind(function(o){return e.execute(t,n,o)})},dZ=function(t,n,e){n.getInitial(t).orThunk(function(){return uK(t.element,n.selector)}).each(function(e){n.focusManager.set(t,e)})},d0=function(t,n,e){return dJ(t,e.selector,n,-1)},d1=function(t,n,e){return dJ(t,e.selector,n,1)},d2=function(t){return function(n,e,o,r){return t(n,e,o,r).bind(function(){return o.executeOnMove?dQ(n,e,o):tw.some(!0)})}},d5=function(t,n,e){return e.onEscape(t,n)},d3=tu([dp(dl(dt),dC)]),d9=dy(d$,uu.init,function(t,n,e,o){var r=dn.concat(e.allowVertical?de:[]),i=dr.concat(e.allowVertical?di:[]);return[dp(dl(r),d2(dB(d0,d1))),dp(dl(i),d2(dM(d0,d1))),dp(dl(f8),dQ),dp(dl(dt),dQ),dp(dl(f7),d5)]},d3,function(){return tw.some(dZ)}),d4=function(t,n,e){return tw.from(t[n]).bind(function(t){return tw.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})},d6=function(t,n,e,o){var r=aw(e,o,0,t[n].length-1);return d4(t,n,r)},d8=function(t,n,e,o){var r=aw(e,o,0,t.length-1),i=aS(n,0,t[r].length-1);return d4(t,r,i)},d7=function(t,n,e,o){var r=aS(e+o,0,t[n].length-1);return d4(t,n,r)},mt=function(t,n,e,o){var r=aS(e+o,0,t.length-1),i=aS(n,0,t[r].length-1);return d4(t,r,i)},mn=[ru("selectors",[rn("row"),rn("cell")]),rh("cycles",!0),rh("previousSelector",tw.none),rh("execute",dk)],me=function(t,n,e){n.previousSelector(t).orThunk(function(){var e=n.selectors;return uK(t.element,e.cell)}).each(function(e){n.focusManager.set(t,e)})},mo=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return uJ(o,r.selectors.row).bind(function(t){return dP(sE(t,r.selectors.cell),o).bind(function(n){var o=sE(e,r.selectors.row);return dP(o,t).bind(function(t){return i(tB(o,function(t){return sE(t,r.selectors.cell)}),t,n).map(function(t){return t.cell})})})})}},mr=mo(function(t,n,e){return d6(t,n,e,-1)},function(t,n,e){return d7(t,n,e,-1)}),mi=mo(function(t,n,e){return d6(t,n,e,1)},function(t,n,e){return d7(t,n,e,1)}),mu=mo(function(t,n,e){return d8(t,e,n,-1)},function(t,n,e){return mt(t,e,n,-1)}),ma=mo(function(t,n,e){return d8(t,e,n,1)},function(t,n,e){return mt(t,e,n,1)}),mc=tu([dp(dl(dn),dB(mr,mi)),dp(dl(dr),dM(mr,mi)),dp(dl(de),dF(mu)),dp(dl(di),dF(ma)),dp(dl(dt.concat(f8)),function(t,n,e){return cn(t.element).bind(function(o){return e.execute(t,n,o)})})]),ms=tu([dp(dl(dt),dC)]),ml=dy(mn,uu.init,mc,ms,function(){return tw.some(me)}),mf=[rn("selector"),rh("execute",dk),rh("moveOnTab",!1)],md=function(t,n,e){return e.focusManager.get(t).bind(function(o){return e.execute(t,n,o)})},mm=function(t,n,e){uK(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})},mg=function(t,n,e){return dJ(t,e.selector,n,-1)},mp=function(t,n,e){return dJ(t,e.selector,n,1)},mh=tu([dp(dl(de),dF(mg)),dp(dl(di),dF(mp)),dp(df([dd,dl(f6)]),function(t,n,e,o){return e.moveOnTab?dF(mg)(t,n,e,o):tw.none()}),dp(df([dg,dl(f6)]),function(t,n,e,o){return e.moveOnTab?dF(mp)(t,n,e,o):tw.none()}),dp(dl(f8),md),dp(dl(dt),md)]),mv=tu([dp(dl(dt),dC)]),mb=dy(mf,uu.init,mh,mv,function(){return tw.some(mm)}),my=dy([ai("onSpace"),ai("onEnter"),ai("onShiftEnter"),ai("onLeft"),ai("onRight"),ai("onTab"),ai("onShiftTab"),ai("onUp"),ai("onDown"),ai("onEscape"),rh("stopSpaceKeyup",!1),rs("focusIn")],uu.init,function(t,n,e){return[dp(dl(dt),e.onSpace),dp(df([dg,dl(f8)]),e.onEnter),dp(df([dd,dl(f8)]),e.onShiftEnter),dp(df([dd,dl(f6)]),e.onShiftTab),dp(df([dg,dl(f6)]),e.onTab),dp(dl(de),e.onUp),dp(dl(di),e.onDown),dp(dl(dn),e.onLeft),dp(dl(dr),e.onRight),dp(dl(dt),e.onSpace),dp(dl(f7),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[dp(dl(dt),dC)]:[]},function(t){return t.focusIn}),mx=a5({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:dw.schema(),cyclic:dS.schema(),flow:d9.schema(),flatgrid:dK.schema(),matrix:ml.schema(),execution:dT.schema(),menu:mb.schema(),special:my.schema()}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold(function(){t.getSystem().triggerFocus(t.element,t.element)},function(o){o(t,n,e)})},setGridSize:function(t,n,e,o,r){nn(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:dD}),mw=function(t,n,e,o){var r=t.getSystem().build(o);le(t,r,e)},mS=function(t,n,e,o){tV(mk(t),function(t){return n9(o.element,t.element)}).each(lr)},mk=function(t,n){return t.components()},mC=function(t,n,e,o,r){var i=mk(t);return tw.from(i[o]).map(function(i){return mS(t,n,e,i),r.each(function(e){mw(t,n,function(t,n){e9(t,n,o)},e)}),i})},mO=a1({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){mw(t,n,e3,o)},prepend:function(t,n,e,o){mw(t,n,e5,o)},remove:mS,replaceAt:mC,replaceBy:function(t,n,e,o,r){return tL(mk(t),o).bind(function(o){return mC(t,n,e,o,r)})},set:function(t,n,e,o){ce(function(){var n=tB(o,t.getSystem().build);lt(t,n)},t.element)},contents:mk})}),m_=function(t,n){var e=iB(n);return a1({fields:[rn("enabled")],name:t,active:{events:tu(e)}})},mT=function(t,n){var e=m_(t,n);return{key:t,value:{config:{},me:e,configAsRaw:tu({}),initialConfig:{},state:uu}}},mE=function(t,n){n.ignore||(a8(t.element),n.onFocus(t))},mD=Object.freeze({__proto__:null,focus:mE,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return a7(t.element)}}),mA=Object.freeze({__proto__:null,exhibit:function(t,n){return ul(n.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(t){return iB([iI(r8(),function(n,e){mE(n,t),e.stop()})].concat(t.stopMousedown?[iI(rW(),function(t,n){n.event.prevent()})]:[]))}}),mB=a1({fields:[ar("onFocus"),rh("stopMousedown",!1),rh("ignore",!1)],name:"focusing",active:mA,apis:mD}),mM=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},mF=function(t,n,e){n.toggleClass.each(function(n){e.get()?uO(t.element,n):uT(t.element,n)})},mI=function(t,n,e){mP(t,n,e,!e.get())},mR=function(t,n,e){e.set(!0),mF(t,n,e),mM(t,n,e)},mN=function(t,n,e){e.set(!1),mF(t,n,e),mM(t,n,e)},mP=function(t,n,e,o){(o?mR:mN)(t,n,e)},mH=function(t,n,e){mP(t,n,e,n.selected)},mV=Object.freeze({__proto__:null,onLoad:mH,toggle:mI,isOn:function(t,n,e){return e.get()},on:mR,off:mN,set:mP}),mL=Object.freeze({__proto__:null,exhibit:function(){return ul({})},events:function(t,n){var e=iW(function(e){mI(e,t,n)}),o=aK(t,n,mH);return iB(tz([t.toggleOnExecute?[e]:[],[o]]))}}),mz=function(t,n,e){ex(t.element,"aria-expanded",e)},mU=a1({fields:[rh("selected",!1),rs("toggleClass"),rh("toggleOnExecute",!0),rv("aria",{mode:"none"},o8("mode",{pressed:[rh("syncWithExpanded",!1),ac("update",function(t,n,e){ex(t.element,"aria-pressed",e),n.syncWithExpanded&&mz(t,n,e)})],checked:[ac("update",function(t,n,e){ex(t.element,"aria-checked",e)})],expanded:[ac("update",mz)],selected:[ac("update",function(t,n,e){ex(t.element,"aria-selected",e)})],none:[ac("update",tr)]}))],name:"toggling",active:mL,apis:mV,state:{init:function(){var t=rO(!1);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(!1)},readState:function(){return t.get()}}}}}),mj=function(){var t=function(t,n){n.stop(),iT(t)};return[iI(r1(),t),iI(ii(),t),iV(rL()),iV(rW())]},mW=function(t){return iB(tz([t.map(function(t){return iW(function(n,e){t(n),e.stop()})}).toArray(),mj()]))},mG="alloy.item-hover",mX="alloy.item-focus",mY=function(t){(cn(t.element).isNone()||mB.isFocused(t))&&(mB.isFocused(t)||mB.focus(t),i_(t,mG,{item:t}))},mq=function(t){i_(t,mX,{item:t})},mK=tu(mG),mJ=tu(mX),m$=[rn("data"),rn("components"),rn("dom"),rh("hasSubmenu",!1),rs("toggling"),lU.field("itemBehaviours",[mU,mB,mx,lH]),rh("ignoreFocus",!1),rh("domModification",{}),ac("builder",function(t){return{dom:t.dom,domModification:tp(tp({},t.domModification),{attributes:tp(tp(tp({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:lU.augment(t.itemBehaviours,[t.toggling.fold(mU.revoke,function(t){return mU.config(tp({aria:{mode:"checked"}},t))}),mB.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){mq(t)}}),mx.config({mode:"execution"}),lH.config({store:{mode:"memory",initialValue:t.data}}),mT("item-type-events",tv(tv([],mj(),!0),[iI(rq(),mY),iI(ir(),mB.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}}),rh("eventOrder",{})],mQ=[rn("dom"),rn("components"),ac("builder",function(t){return{dom:t.dom,components:t.components,events:iB([iI(ir(),function(t,n){n.stop()})])}})],mZ=tu("item-widget"),m0=tu([fo({name:"widget",overrides:function(t){return{behaviours:aZ([lH.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:tr}})])}}})]),m1=o8("type",{widget:[rn("uid"),rn("data"),rn("components"),rn("dom"),rh("autofocus",!1),rh("ignoreFocus",!1),lU.field("widgetBehaviours",[lH,mB,mx]),rh("domModification",{}),fO(m0()),ac("builder",function(t){var n=fh(mZ(),t,m0()),e=fv(mZ(),t,n.internals()),o=function(n){return fb(n,t,"widget").map(function(t){return mx.focusIn(t),t})},r=function(n,e){return fR(e.event.target)||t.autofocus&&e.setSource(n.element),tw.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:iB([iW(function(t,n){o(t).each(function(t){n.stop()})}),iI(rq(),mY),iI(ir(),function(n,e){t.autofocus?o(n):mB.focus(n)})]),behaviours:lU.augment(t.widgetBehaviours,[lH.config({store:{mode:"memory",initialValue:t.data}}),mB.config({ignore:t.ignoreFocus,onFocus:function(t){mq(t)}}),mx.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:a3(),onLeft:r,onRight:r,onEscape:function(n,e){return mB.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),tw.none()):(mB.focus(n),tw.some(!0))}})])}})],item:m$,separator:mQ}),m2=tu([fu({factory:{sketch:function(t){var n=o4("menu.spec item",m1,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return nt(n,"uid")?n:tp(tp({},n),{uid:i4("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),m5=tu([rn("value"),rn("items"),rn("dom"),rn("components"),rh("eventOrder",{}),lV("menuBehaviours",[f4,lH,fP,mx]),rv("movement",{mode:"menu",moveOnTab:!0},o8("mode",{grid:[al(),ac("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[ac("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),rn("rowSelector")],menu:[rh("moveOnTab",!0),ac("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),re("markers",u7()),rh("fakeFocus",!1),rh("focusManager",dv()),ar("onHighlight")]),m3=tu("alloy.menu-focus"),m9=fI({name:"Menu",configFields:m5(),partFields:m2(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:lz(t.menuBehaviours,[f4.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),lH.config({store:{mode:"memory",initialValue:t.value}}),fP.config({find:tw.some}),mx.config(t.movement.config(t,t.movement))]),events:iB([iI(mJ(),function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each(function(e){f4.highlight(t,e),n.stop(),i_(t,m3(),{menu:t,item:e})})}),iI(mK(),function(t,n){var e=n.event.item;f4.highlight(t,e)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),m4=function(t,n,e,o){return t7(e,o).bind(function(o){return t7(t,o).bind(function(o){var r=m4(t,n,e,o);return tw.some([o].concat(r))})}).getOr([])},m6=function(t,n){var e={};t2(t,function(t,n){tM(t,function(t){e[t]=n})});var o=t3(n,function(t,n){return{k:t,v:n}}),r=t5(o,function(t,r){return[r].concat(m4(e,n,o,r))});return t5(e,function(t){return t7(r,t).getOr([t])})},m8=function(t){return"prepared"===t.type?tw.some(t.menu):tw.none()},m7={init:function(){var t=rO({}),n=rO({}),e=rO({}),o=cO(),r=rO({}),i=function(t){return u(t).bind(m8)},u=function(t){return t7(n.get(),t)},a=function(n){return t7(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(tp(tp({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c);var s=m6(c,a);e.set(s)},expand:function(n){return t7(t.get(),n).map(function(t){return[t].concat(t7(e.get(),n).getOr([]))})},refresh:function(t){return t7(e.get(),t)},collapse:function(t){return t7(e.get(),t).bind(function(t){return t.length>1?tw.some(t.slice(1)):tw.none()})},lookupMenu:u,lookupItem:a,otherMenus:function(t){return tG(t0(r.get()),t)},getPrimary:function(){return o.get().bind(i)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.clear()},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,r){var u=tR(a(n).toArray(),function(t){return i(t).isSome()});return t7(e.get(),n).bind(function(n){var e=tW(u.concat(n));return nr(tU(e,function(n,u){var a;return(a=e.slice(0,u+1),i(n).bind(function(e){return t6(t.get(),function(t,e){return t===n}).bind(function(t){return r(t).map(function(t){return{triggeredMenu:e,triggeringItem:t,triggeringPath:a}})})})).fold(function(){return ne(o.get(),n)?[]:[tw.none()]},function(t){return[tw.some(t)]})}))})}}},extractPreparedMenu:m8},gt=tu("collapse-item"),gn=fF({name:"TieredMenu",configFields:[aa("onExecute"),aa("onEscape"),au("onOpenMenu"),au("onOpenSubmenu"),ar("onRepositionMenu"),ar("onCollapseMenu"),rh("highlightImmediately",!0),ru("data",[rn("primary"),rn("menus"),rn("expansions")]),rh("fakeFocus",!1),ar("onHighlight"),ar("onHover"),an(),rn("dom"),rh("navigateOnHover",!0),rh("stayInDom",!1),lV("tmenuBehaviours",[mx,f4,fP,mO]),rh("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o,r=cO(),i=m7.init(),u=function(n){var e,o=(e=t.data.primary,t5(t.data.menus,function(o,r){var i=function(){return m9.sketch(tp(tp({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?db():dv()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})),r=c();return i.setContents(t.data.primary,o,t.data.expansions,r),i.getPrimary()},a=function(t){return lH.getValue(t).value},c=function(n){return t5(t.data.menus,function(t,n){return tU(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},s=function(t,n){f4.highlight(t,n),f4.getHighlighted(n).orThunk(function(){return f4.getFirst(n)}).each(function(n){iE(t,n.element,ir())})},l=function(t,n){return no(tB(n,function(n){return t.lookupMenu(n).bind(function(t){return"prepared"===t.type?tw.some(t.menu):tw.none()})}))},f=function(n,e,o){tM(l(e,e.otherMenus(o)),function(e){uA(e.element,[t.markers.backgroundMenu]),t.stayInDom||mO.remove(n,e)})},d=function(n,e){t2(r.get().getOrThunk(function(){var e={};return tM(tR(sE(n.element,"."+t.markers.item),function(t){return"true"===eS(t,"aria-haspopup")}),function(t){n.getSystem().getByDom(t).each(function(t){e[a(t)]=t})}),r.set(e),e}),function(t,n){var o=tT(e,n);ex(t.element,"aria-expanded",o)})},m=function(n,e,o){return tw.from(o[0]).bind(function(r){return e.lookupMenu(r).bind(function(r){if("notbuilt"===r.type)return tw.none();var i=r.menu;return tM(l(e,o.slice(1)),function(n){uO(n.element,t.markers.backgroundMenu)}),eh(i.element)||mO.append(n,ur(i)),uA(i.element,[t.markers.backgroundMenu]),s(n,i),f(n,e,o),tw.some(i)})})};(e=o||(o={}))[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent";var g=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return i.setMenuBuilt(n,o),o},p=function(n,e,r){if(void 0===r&&(r=o.HighlightSubmenu),e.hasConfigured(fJ)&&fJ.isDisabled(e))return tw.some(e);var u=a(e);return i.expand(u).bind(function(u){return d(n,u),tw.from(u[0]).bind(function(a){return i.lookupMenu(a).bind(function(c){var s=g(n,a,c);return(eh(s.element)||mO.append(n,ur(s)),t.onOpenSubmenu(n,e,s,tW(u)),r===o.HighlightSubmenu)?(f4.highlightFirst(s),m(n,i,u)):(f4.dehighlightAll(s),tw.some(e))})})})},h=function(n,e){var o=a(e);return i.collapse(o).bind(function(o){return d(n,o),m(n,i,o).map(function(o){return t.onCollapseMenu(n,e,o),o})})},v=function(t,n){var e=a(n);return i.refresh(e).bind(function(n){return d(t,n),m(t,i,n)})},b=function(n){return function(e,o){return uJ(o.getSource(),"."+t.markers.item).bind(function(t){return e.getSystem().getByDom(t).toOptional().bind(function(t){return n(e,t).map(tm)})})}},y=iB([iI(m3(),function(t,n){var e=n.event.item;i.lookupItem(a(e)).each(function(){var e=n.event.menu;f4.highlight(t,e);var o=a(n.event.item);i.refresh(o).each(function(n){return f(t,i,n)})})}),iW(function(n,e){var r=e.event.target;n.getSystem().getByDom(r).each(function(e){0===a(e).indexOf("collapse-item")&&h(n,e),p(n,e,o.HighlightSubmenu).fold(function(){t.onExecute(n,e)},tr)})}),iz(function(n,e){u(n).each(function(e){mO.append(n,ur(e)),t.onOpenMenu(n,e),t.highlightImmediately&&s(n,e)})})].concat(t.navigateOnHover?[iI(mK(),function(n,e){var r=e.event.item;v(n,r),p(n,r,o.HighlightParent),t.onHover(n,r)})]:[])),x=function(t){return f4.getHighlighted(t).bind(f4.getHighlighted)};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:lz(t.tmenuBehaviours,[mx.config({mode:"special",onRight:b(function(t,n){return fR(n.element)?tw.none():p(t,n,o.HighlightSubmenu)}),onLeft:b(function(t,n){return fR(n.element)?tw.none():h(t,n)}),onEscape:b(function(n,e){return h(n,e).orThunk(function(){return t.onEscape(n,e).map(function(){return n})})}),focusIn:function(t,n){i.getPrimary().each(function(n){iE(t,n.element,ir())})}}),f4.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),fP.config({find:function(t){return f4.getHighlighted(t)}}),mO.config({})]),eventOrder:t.eventOrder,apis:{collapseMenu:function(t){x(t).each(function(n){h(t,n)})},highlightPrimary:function(t){i.getPrimary().each(function(n){s(t,n)})},repositionMenus:function(n){i.getPrimary().bind(function(t){return x(n).bind(function(t){var n=a(t),e=no(tB(t8(i.getMenus()),m7.extractPreparedMenu));return i.getTriggeringPath(n,function(t){return tZ(e,function(n){return n.getSystem().isConnected()?tV(f4.getCandidates(n),function(n){return a(n)===t}):tw.none()})})}).map(function(n){return{primary:t,triggeringPath:n}})}).fold(function(){tw.from(n.components()[0]).filter(function(t){return"menu"===eS(t.element,"role")}).each(function(e){t.onRepositionMenu(n,e,[])})},function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)})}},events:y}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:rB(t,n),expansions:{}}},collapseItem:function(t){return{value:iQ(gt()),meta:{text:t}}}}}),ge=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return aG()},onRtl:function(){return aX()}}}:{},a=function(t){return 2===t.length?u:{}};return gn.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return lx.close(n),t.onEscape.map(function(t){return t(n)}),tw.some(!0)},onExecute:function(){return tw.some(!0)},onOpenMenu:function(t,n){s9.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();s9.position(r,e,{anchor:tp({type:"submenu",item:n},a(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie();s9.positionWithinBounds(u,n,e,r()),tM(o,function(t){var n=a(t.triggeringPath);s9.position(u,t.triggeredMenu,{anchor:tp({type:"submenu",item:t.triggeringItem},n)})})}})},go=fF({name:"InlineView",configFields:[rn("lazySink"),ar("onShow"),ar("onHide"),rm("onEscape"),lV("inlineBehaviours",[lx,lH,a9]),rp("fireDismissalEventInstead",[rh("event",iv())]),rp("fireRepositionEventInstead",[rh("event",ib())]),rh("getRelated",tw.none),rh("isExtraPart",td),rh("eventOrder",tw.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,function(){return r.map(function(t){return of(t)})})},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();lx.openWhileCloaked(n,e,function(){return s9.positionWithinBounds(i,n,o,r())}),lH.setValue(n,tw.some({mode:"position",config:o,getBounds:r}))},r=function(n,e,o,r){var i=ge(t,n,e,o,r);lx.open(n,i),lH.setValue(n,tw.some({mode:"menu",menu:i}))},i=function(n){lx.isOpen(n)&&lH.getValue(n).each(function(e){switch(e.mode){case"menu":lx.getState(n).each(gn.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();s9.positionWithinBounds(o,n,e.config,e.getBounds())}})},u={setContent:function(t,n){lx.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,tw.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,tw.none)},showMenuWithinBounds:r,hide:function(t){lx.isOpen(t)&&(lH.setValue(t,tw.none()),lx.close(t))},getContent:function(t){return lx.getState(t)},reposition:i,isOpen:lx.isOpen};return{uid:t.uid,dom:t.dom,behaviours:lz(t.inlineBehaviours,[lx.config({isPartOf:function(n,e,o){return uQ(e,o)||t.getRelated(n).exists(function(t){return uQ(t,o)})},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),lH.config({store:{mode:"memory",initialValue:tw.none()}}),a9.config({channels:tp(tp({},lO(tp({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),lT(tp(tp({},t.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),gr="layout-inset",gi=function(t){return t.x},gu=function(t,n){return t.x+t.width/2-n.width/2},ga=function(t,n){return t.x+t.width-n.width},gc=function(t){return t.y},gs=function(t,n){return t.y+t.height-n.height},gl=function(t,n){return t.y+t.height/2-n.height/2},gf=function(t,n,e){return af(ga(t,n),gs(t,n),e.insetSouthwest(),ah(),"southwest",aC(t,{right:0,bottom:3}),gr)},gd=function(t,n,e){return af(gi(t),gs(t,n),e.insetSoutheast(),ap(),"southeast",aC(t,{left:1,bottom:3}),gr)},gm=function(t,n,e){return af(ga(t,n),gc(t),e.insetNorthwest(),ag(),"northwest",aC(t,{right:0,top:2}),gr)},gg=function(t,n,e){return af(gi(t),gc(t),e.insetNortheast(),am(),"northeast",aC(t,{left:1,top:2}),gr)},gp=function(t,n,e){return af(gu(t,n),gc(t),e.insetNorth(),av(),"north",aC(t,{top:2}),gr)},gh=function(t,n,e){return af(gu(t,n),gs(t,n),e.insetSouth(),ab(),"south",aC(t,{bottom:3}),gr)},gv=function(t,n,e){return af(ga(t,n),gl(t,n),e.insetEast(),ax(),"east",aC(t,{right:0}),gr)},gb=function(t,n,e){return af(gi(t),gl(t,n),e.insetWest(),ay(),"west",aC(t,{left:1}),gr)},gy=function(t){switch(t){case"north":return gp;case"northeast":return gg;case"northwest":return gm;case"south":return gh;case"southeast":return gd;case"southwest":return gf;case"east":return gv;case"west":return gb}},gx=function(t,n,e,o,r){return cg(o).map(gy).getOr(gp)(t,n,e,o,r)},gw=function(t){switch(t){case"north":return gh;case"northeast":return gd;case"northwest":return gf;case"south":return gp;case"southeast":return gg;case"southwest":return gm;case"east":return gb;case"west":return gv}},gS=function(t,n,e,o,r){return cg(o).map(gw).getOr(gp)(t,n,e,o,r)},gk=tinymce.util.Tools.resolve("tinymce.util.Delay"),gC=fF({name:"Button",factory:function(t){var n=mW(t.action),e=t.dom.tag,o=function(n){return t7(t.dom,"attributes").bind(function(t){return t7(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:lU.augment(t.buttonBehaviours,[mB.config({}),mx.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return tp({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[rh("uid",void 0),rn("dom"),rh("components",[]),lU.field("buttonBehaviours",[mB,mx]),rs("action"),rs("role"),rh("eventOrder",{})]}),gO=function(t){var n=nh.fromHtml(t),e=er(n),o=tP(void 0!==n.dom.attributes?n.dom.attributes:[],function(t,n){var e;return"class"===n.name?t:tp(tp({},t),((e={})[n.name]=n.value,e))},{}),r=Array.prototype.slice.call(n.dom.classList,0),i=0===e.length?{}:{innerHtml:iX(n)};return tp({tag:nv(n),classes:r,attributes:o},i)},g_=function(t){var n=void 0!==t.uid&&nn(t,"uid")?t.uid:i4("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return tp(tp({},t),{uid:n})}}};function gT(t){return(gT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gE(t,n){return(gE=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function gD(t,n,e){return(gD=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,n,e){var o=[null];o.push.apply(o,n);var r=new(Function.bind.apply(t,o));return e&&gE(r,e.prototype),r}:Reflect.construct).apply(null,arguments)}function gA(t){return function(t){if(Array.isArray(t))return gB(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return gB(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if("Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return gB(t,n)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gB(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=Array(n);e<n;e++)o[e]=t[e];return o}var gM=Object.hasOwnProperty,gF=Object.setPrototypeOf,gI=Object.isFrozen,gR=Object.getPrototypeOf,gN=Object.getOwnPropertyDescriptor,gP=Object.freeze,gH=Object.seal,gV=Object.create,gL="undefined"!=typeof Reflect&&Reflect,gz=gL.apply,gU=gL.construct;gz||(gz=function(t,n,e){return t.apply(n,e)}),gP||(gP=function(t){return t}),gH||(gH=function(t){return t}),gU||(gU=function(t,n){return gD(t,gA(n))});var gj=gZ(Array.prototype.forEach),gW=gZ(Array.prototype.pop),gG=gZ(Array.prototype.push),gX=gZ(String.prototype.toLowerCase),gY=gZ(String.prototype.match),gq=gZ(String.prototype.replace),gK=gZ(String.prototype.indexOf),gJ=gZ(String.prototype.trim),g$=gZ(RegExp.prototype.test),gQ=(t=TypeError,function(){for(var n=arguments.length,e=Array(n),o=0;o<n;o++)e[o]=arguments[o];return gU(t,e)});function gZ(t){return function(n){for(var e=arguments.length,o=Array(e>1?e-1:0),r=1;r<e;r++)o[r-1]=arguments[r];return gz(t,n,o)}}function g0(t,n){gF&&gF(t,null);for(var e=n.length;e--;){var o=n[e];if("string"==typeof o){var r=gX(o);r!==o&&(gI(n)||(n[e]=r),o=r)}t[o]=!0}return t}function g1(t){var n,e=gV(null);for(n in t)gz(gM,t,[n])&&(e[n]=t[n]);return e}function g2(t,n){for(;null!==t;){var e=gN(t,n);if(e){if(e.get)return gZ(e.get);if("function"==typeof e.value)return gZ(e.value)}t=gR(t)}return function(t){return console.warn("fallback value for",t),null}}var g5=gP(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),g3=gP(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),g9=gP(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),g4=gP(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),g6=gP(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),g8=gP(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),g7=gP(["#text"]),pt=gP(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),pn=gP(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),pe=gP(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),po=gP(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pr=gH(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pi=gH(/<%[\w\W]*|[\w\W]*%>/gm),pu=gH(/^data-[\-\w.\u00B7-\uFFFF]/),pa=gH(/^aria-[\-\w]+$/),pc=gH(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ps=gH(/^(?:\w+script|data):/i),pl=gH(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pf=gH(/^html$/i),pd=function(t,n){if("object"!==gT(t)||"function"!=typeof t.createPolicy)return null;var e=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(e=n.currentScript.getAttribute(o));var r="dompurify"+(e?"#"+e:"");try{return t.createPolicy(r,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},pm=function t(){var n,e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,r=function(n){return t(n)};if(r.version="2.3.8",r.removed=[],!o||!o.document||9!==o.document.nodeType)return r.isSupported=!1,r;var i=o.document,u=o.document,a=o.DocumentFragment,c=o.HTMLTemplateElement,s=o.Node,l=o.Element,f=o.NodeFilter,d=o.NamedNodeMap,m=void 0===d?o.NamedNodeMap||o.MozNamedAttrMap:d,g=o.HTMLFormElement,p=o.DOMParser,h=o.trustedTypes,v=l.prototype,b=g2(v,"cloneNode"),y=g2(v,"nextSibling"),x=g2(v,"childNodes"),w=g2(v,"parentNode");if("function"==typeof c){var S=u.createElement("template");S.content&&S.content.ownerDocument&&(u=S.content.ownerDocument)}var k=pd(h,i),C=k?k.createHTML(""):"",O=u,_=O.implementation,T=O.createNodeIterator,E=O.createDocumentFragment,D=O.getElementsByTagName,A=i.importNode,B={};try{B=g1(u).documentMode?u.documentMode:{}}catch(t){}var M={};r.isSupported="function"==typeof w&&_&&void 0!==_.createHTMLDocument&&9!==B;var F=pc,I=null,R=g0({},[].concat(gA(g5),gA(g3),gA(g9),gA(g6),gA(g7))),N=null,P=g0({},[].concat(gA(pt),gA(pn),gA(pe),gA(po))),H=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),V=null,L=null,z=!0,U=!0,j=!1,W=!1,G=!1,X=!1,Y=!1,q=!1,K=!1,J=!1,$=!0,Q=!0,Z=!1,tt={},tn=null,te=g0({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),to=null,tr=g0({},["audio","video","img","source","image","track"]),ti=null,tu=g0({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ta="http://www.w3.org/1998/Math/MathML",tc="http://www.w3.org/2000/svg",ts="http://www.w3.org/1999/xhtml",tl=ts,tf=!1,td=["application/xhtml+xml","text/html"],tm=null,tg=u.createElement("form"),tp=function(t){return t instanceof RegExp||t instanceof Function},th=function(t){tm&&tm===t||(t&&"object"===gT(t)||(t={}),I="ALLOWED_TAGS"in(t=g1(t))?g0({},t.ALLOWED_TAGS):R,N="ALLOWED_ATTR"in t?g0({},t.ALLOWED_ATTR):P,ti="ADD_URI_SAFE_ATTR"in t?g0(g1(tu),t.ADD_URI_SAFE_ATTR):tu,to="ADD_DATA_URI_TAGS"in t?g0(g1(tr),t.ADD_DATA_URI_TAGS):tr,tn="FORBID_CONTENTS"in t?g0({},t.FORBID_CONTENTS):te,V="FORBID_TAGS"in t?g0({},t.FORBID_TAGS):{},L="FORBID_ATTR"in t?g0({},t.FORBID_ATTR):{},tt="USE_PROFILES"in t&&t.USE_PROFILES,z=!1!==t.ALLOW_ARIA_ATTR,U=!1!==t.ALLOW_DATA_ATTR,j=t.ALLOW_UNKNOWN_PROTOCOLS||!1,W=t.SAFE_FOR_TEMPLATES||!1,G=t.WHOLE_DOCUMENT||!1,q=t.RETURN_DOM||!1,K=t.RETURN_DOM_FRAGMENT||!1,J=t.RETURN_TRUSTED_TYPE||!1,Y=t.FORCE_BODY||!1,$=!1!==t.SANITIZE_DOM,Q=!1!==t.KEEP_CONTENT,Z=t.IN_PLACE||!1,F=t.ALLOWED_URI_REGEXP||F,tl=t.NAMESPACE||ts,t.CUSTOM_ELEMENT_HANDLING&&tp(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&tp(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),e="application/xhtml+xml"===(n=n=-1===td.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?function(t){return t}:gX,W&&(U=!1),K&&(q=!0),tt&&(I=g0({},gA(g7)),N=[],!0===tt.html&&(g0(I,g5),g0(N,pt)),!0===tt.svg&&(g0(I,g3),g0(N,pn),g0(N,po)),!0===tt.svgFilters&&(g0(I,g9),g0(N,pn),g0(N,po)),!0===tt.mathMl&&(g0(I,g6),g0(N,pe),g0(N,po))),t.ADD_TAGS&&(I===R&&(I=g1(I)),g0(I,t.ADD_TAGS)),t.ADD_ATTR&&(N===P&&(N=g1(N)),g0(N,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&g0(ti,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(tn===te&&(tn=g1(tn)),g0(tn,t.FORBID_CONTENTS)),Q&&(I["#text"]=!0),G&&g0(I,["html","head","body"]),I.table&&(g0(I,["tbody"]),delete V.tbody),gP&&gP(t),tm=t)},tv=g0({},["mi","mo","mn","ms","mtext"]),tb=g0({},["foreignobject","desc","title","annotation-xml"]),ty=g0({},["title","style","font","a","script"]),tx=g0({},g3);g0(tx,g9),g0(tx,g4);var tw=g0({},g6);g0(tw,g8);var tS=function(t){var n=w(t);n&&n.tagName||(n={namespaceURI:ts,tagName:"template"});var e=gX(t.tagName),o=gX(n.tagName);return t.namespaceURI===tc?n.namespaceURI===ts?"svg"===e:n.namespaceURI===ta?"svg"===e&&("annotation-xml"===o||tv[o]):!!tx[e]:t.namespaceURI===ta?n.namespaceURI===ts?"math"===e:n.namespaceURI===tc?"math"===e&&tb[o]:!!tw[e]:t.namespaceURI===ts&&(n.namespaceURI!==tc||!!tb[o])&&(n.namespaceURI!==ta||!!tv[o])&&!tw[e]&&(ty[e]||!tx[e])},tk=function(t){gG(r.removed,{element:t});try{t.parentNode.removeChild(t)}catch(n){try{t.outerHTML=C}catch(n){t.remove()}}},tC=function(t,n){try{gG(r.removed,{attribute:n.getAttributeNode(t),from:n})}catch(t){gG(r.removed,{attribute:null,from:n})}if(n.removeAttribute(t),"is"===t&&!N[t]){if(q||K)try{tk(n)}catch(t){}else try{n.setAttribute(t,"")}catch(t){}}},tO=function(t){if(Y)t="<remove></remove>"+t;else{var e,o,r=gY(t,/^[\r\n\t ]+/);o=r&&r[0]}"application/xhtml+xml"===n&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var i=k?k.createHTML(t):t;if(tl===ts)try{e=new p().parseFromString(i,n)}catch(t){}if(!e||!e.documentElement){e=_.createDocument(tl,"template",null);try{e.documentElement.innerHTML=tf?"":i}catch(t){}}var a=e.body||e.documentElement;return(t&&o&&a.insertBefore(u.createTextNode(o),a.childNodes[0]||null),tl===ts)?D.call(e,G?"html":"body")[0]:G?e.documentElement:a},t_=function(t){return T.call(t.ownerDocument||t,t,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},tT=function(t){return"object"===gT(s)?t instanceof s:t&&"object"===gT(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},tE=function(t,n,e){M[t]&&gj(M[t],function(t){t.call(r,n,e,tm)})},tD=function(t){if(tE("beforeSanitizeElements",t,null),t instanceof g&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)||g$(/[\u0080-\uFFFF]/,t.nodeName))return tk(t),!0;var n,o=e(t.nodeName);if(tE("uponSanitizeElement",t,{tagName:o,allowedTags:I}),t.hasChildNodes()&&!tT(t.firstElementChild)&&(!tT(t.content)||!tT(t.content.firstElementChild))&&g$(/<[/\w]/g,t.innerHTML)&&g$(/<[/\w]/g,t.textContent)||"select"===o&&g$(/<template/i,t.innerHTML))return tk(t),!0;if(!I[o]||V[o]){if(!V[o]&&tB(o)&&(H.tagNameCheck instanceof RegExp&&g$(H.tagNameCheck,o)||H.tagNameCheck instanceof Function&&H.tagNameCheck(o)))return!1;if(Q&&!tn[o]){var i=w(t)||t.parentNode,u=x(t)||t.childNodes;if(u&&i)for(var a=u.length,c=a-1;c>=0;--c)i.insertBefore(b(u[c],!0),y(t))}return tk(t),!0}return t instanceof l&&!tS(t)||("noscript"===o||"noembed"===o)&&g$(/<\/no(script|embed)/i,t.innerHTML)?(tk(t),!0):(W&&3===t.nodeType&&(n=gq(n=t.textContent,pr," "),n=gq(n,pi," "),t.textContent!==n&&(gG(r.removed,{element:t.cloneNode()}),t.textContent=n)),tE("afterSanitizeElements",t,null),!1)},tA=function(t,n,e){if($&&("id"===n||"name"===n)&&(e in u||e in tg))return!1;if(U&&!L[n]&&g$(pu,n));else if(z&&g$(pa,n));else if(!N[n]||L[n]){if(!(tB(t)&&(H.tagNameCheck instanceof RegExp&&g$(H.tagNameCheck,t)||H.tagNameCheck instanceof Function&&H.tagNameCheck(t))&&(H.attributeNameCheck instanceof RegExp&&g$(H.attributeNameCheck,n)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(n))||"is"===n&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&g$(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))))return!1}else if(ti[n]);else if(g$(F,gq(e,pl,"")));else if(("src"===n||"xlink:href"===n||"href"===n)&&"script"!==t&&0===gK(e,"data:")&&to[t]);else if(j&&!g$(ps,gq(e,pl,"")));else if(e)return!1;return!0},tB=function(t){return t.indexOf("-")>0},tM=function(t){tE("beforeSanitizeAttributes",t,null);var n,o,i,u,a=t.attributes;if(a){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:N};for(u=a.length;u--;){var s=(n=a[u]).name,l=n.namespaceURI;if(o="value"===s?n.value:gJ(n.value),i=e(s),c.attrName=i,c.attrValue=o,c.keepAttr=!0,c.forceKeepAttr=void 0,tE("uponSanitizeAttribute",t,c),o=c.attrValue,!c.forceKeepAttr&&(tC(s,t),c.keepAttr)){if(g$(/\/>/i,o)){tC(s,t);continue}if(W&&(o=gq(o,pr," "),o=gq(o,pi," ")),tA(e(t.nodeName),i,o))try{l?t.setAttributeNS(l,s,o):t.setAttribute(s,o),gW(r.removed)}catch(t){}}}tE("afterSanitizeAttributes",t,null)}},tF=function t(n){var e,o=t_(n);for(tE("beforeSanitizeShadowDOM",n,null);e=o.nextNode();)tE("uponSanitizeShadowNode",e,null),tD(e)||(e.content instanceof a&&t(e.content),tM(e));tE("afterSanitizeShadowDOM",n,null)};return r.sanitize=function(t,n){if((tf=!t)&&(t="<!-->"),"string"!=typeof t&&!tT(t)){if("function"!=typeof t.toString)throw gQ("toString is not a function");if("string"!=typeof(t=t.toString()))throw gQ("dirty is not a string, aborting")}if(!r.isSupported){if("object"===gT(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof t)return o.toStaticHTML(t);if(tT(t))return o.toStaticHTML(t.outerHTML)}return t}if(X||th(n),r.removed=[],"string"==typeof t&&(Z=!1),Z){if(t.nodeName){var u,c,l,f,d,m=e(t.nodeName);if(!I[m]||V[m])throw gQ("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof s)1===(c=(u=tO("<!---->")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===c.nodeName?u=c:"HTML"===c.nodeName?u=c:u.appendChild(c);else{if(!q&&!W&&!G&&-1===t.indexOf("<"))return k&&J?k.createHTML(t):t;if(!(u=tO(t)))return q?null:J?C:""}u&&Y&&tk(u.firstChild);for(var g=t_(Z?t:u);l=g.nextNode();)3===l.nodeType&&l===f||tD(l)||(l.content instanceof a&&tF(l.content),tM(l),f=l);if(f=null,Z)return t;if(q){if(K)for(d=E.call(u.ownerDocument);u.firstChild;)d.appendChild(u.firstChild);else d=u;return N.shadowroot&&(d=A.call(i,d,!0)),d}var p=G?u.outerHTML:u.innerHTML;return G&&I["!doctype"]&&u.ownerDocument&&u.ownerDocument.doctype&&u.ownerDocument.doctype.name&&g$(pf,u.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+u.ownerDocument.doctype.name+">\n"+p),W&&(p=gq(p,pr," "),p=gq(p,pi," ")),k&&J?k.createHTML(p):p},r.setConfig=function(t){th(t),X=!0},r.clearConfig=function(){tm=null,X=!1},r.isValidAttribute=function(t,n,o){return tm||th({}),tA(e(t),e(n),o)},r.addHook=function(t,n){"function"==typeof n&&(M[t]=M[t]||[],gG(M[t],n))},r.removeHook=function(t){if(M[t])return gW(M[t])},r.removeHooks=function(t){M[t]&&(M[t]=[])},r.removeAllHooks=function(){M={}},r}(),pg=function(t){return pm().sanitize(t)},pp=tinymce.util.Tools.resolve("tinymce.util.I18n"),ph={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},pv="temporary-placeholder",pb=function(t){return function(){return t7(t,pv).getOr("!not found!")}},py=function(t,n){var e,o=t.toLowerCase();if(!pp.isRtl())return o;var r=nf(o,e="-rtl")?o:o+e;return nt(n,r)?r:o},px=function(t,n){return t7(n,py(t,n))},pw=function(t,n){var e=n();return px(t,e).getOrThunk(pb(e))},pS=function(t,n,e){var o=n();return px(t,o).or(e).getOrThunk(pb(o))},pk=function(){return mT("add-focusable",[iz(function(t){var n,e;(n=t.element,e="svg",tV(n.dom.childNodes,function(t){return n1(nh.fromDom(t),"svg")}).map(nh.fromDom)).each(function(t){return ex(t,"focusable","false")})})])},pC=function(t,n,e,o){var r,i,u=pp.isRtl()&&nt(ph,n)?["tox-icon--flip"]:[],a=t7(e,py(n,e)).or(o).getOrThunk(pb(e));return{dom:{tag:t.tag,attributes:(r=t.attributes)!==null&&void 0!==r?r:{},classes:t.classes.concat(u),innerHtml:a},behaviours:aZ(tv(tv([],(i=t.behaviours)!==null&&void 0!==i?i:[],!0),[pk()],!1))}},pO=function(t,n,e,o){return void 0===o&&(o=tw.none()),pC(n,t,e(),o)},p_=function(t,n,e){var o=e();return pC(n,tV(t,function(t){return nt(o,py(t,o))}).getOr(pv),o,tw.none())},pT={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},pE=fF({name:"Notification",factory:function(t){var n=g_({dom:gO("<p>"+pg(t.translationProvider(t.text))+"</p>"),behaviours:aZ([mO.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},o=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},r=g_({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:aZ([mO.config({})])}),i=tz([t.icon.toArray(),t.level.toArray(),t.level.bind(function(t){return tw.from(pT[t])}).toArray()]),u=g_(gC.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[pO("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),a=p_(i,{tag:"div",classes:["tox-notification__icon"]},t.iconProvider),c={dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:aZ([mO.config({})])};return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:aZ([mB.config({}),mT("notification-events",[iI(rK(),function(t){u.getOpt(t).each(mB.focus)})])]),components:[a,c].concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[u.asSpec()]:[]),apis:{updateProgress:function(t,n){t.getSystem().isConnected()&&r.getOpt(t).each(function(t){mO.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])})},updateText:function(t,e){if(t.getSystem().isConnected()){var o=n.get(t);mO.set(o,[uL(e)])}}}}},configFields:[rs("level"),rn("progress"),rn("icon"),rn("onAction"),rn("text"),rn("iconProvider"),rn("translationProvider"),rw("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),pD=function(t,n){var e=null;return{cancel:function(){J(e)||(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];J(e)&&(e=setTimeout(function(){e=null,t.apply(null,o)},n))}}},pA=function(t,n){var e=null,o=function(){J(e)||(clearTimeout(e),e=null)};return{cancel:o,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o(),e=setTimeout(function(){e=null,t.apply(null,r)},n)}}},pB=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),pM=function(t,n,e,o,r){var i=pB(t,function(n){return t.isBlock(n)||tT(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)});return tw.from(i.backwards(n,e,o,r))},pF=function(t){return uJ(t,"[data-mce-autocompleter]")},pI=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},pR=function(t){return""!==t&&-1!==" \xa0\f\n\r	\v".indexOf(t)},pN=function(t,n){return t.substring(n.length)},pP=function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(pR(r))return tw.none();if(r===e)break}return tw.some(o)},pH=function(t,n,e,o){if(void 0===o&&(o=0),!(n.collapsed&&3===n.startContainer.nodeType))return tw.none();var r=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return pM(t,n.startContainer,n.startOffset,function(t,n,o){return pP(o,n,e).getOr(n)},r).bind(function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return tw.none();var i=pI(r);return 0!==i.lastIndexOf(e)||pN(i,e).length<o?tw.none():tw.some({text:pN(i,e),range:r,triggerChar:e})})},pV=function(t,n,e,o){return void 0===o&&(o=0),pF(nh.fromDom(n.startContainer)).fold(function(){return pH(t,n,e,o)},function(n){var o=t.createRng();o.selectNode(n.dom);var r=pI(o);return tw.some({range:o,text:pN(r,e),triggerChar:e})})},pL={setup:function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){i_(t,r$(),{raw:n})};n.on("keydown",function(n){var o=function(){return t.getView().bind(f4.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(iT),n.preventDefault()):40===n.which?(o().fold(function(){t.getView().each(f4.highlightFirst)},function(t){e(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):(37===n.which||38===n.which||39===n.which)&&o().each(function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()}):(13===n.which||38===n.which||40===n.which)&&t.cancelIfNecessary())}),n.on("NodeChange",function(n){t.isActive()&&!t.isProcessingAction()&&pF(nh.fromDom(n.element)).isNone()&&t.cancelIfNecessary()})}},pz=tinymce.util.Tools.resolve("tinymce.util.Promise"),pU=function(t,n){return{container:t,offset:n}},pj=function(t){if(3===t.nodeType)return pU(t,t.data.length);var n=t.childNodes;return n.length>0?pj(n[n.length-1]):pU(t,n.length)},pW=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?pW(e[n],0):e.length>0&&1===t.nodeType&&e.length===n?pj(e[e.length-1]):pU(t,n)},pG=function(t,n){var e,o=n(),r=t.selection.getRng();return(e=t.dom,tZ(o.triggerChars,function(t){return pV(e,r,t)})).bind(function(e){return pX(t,n,e)})},pX=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=tR(r.lookupByChar(e.triggerChar),function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk(function(){var n;return n=t.dom,function(t){var e=pW(t.startContainer,t.startOffset);return!pM(n,e.container,e.offset,function(t,n){return 0===n?-1:n},n.getRoot()).filter(function(t){return!pR(t.container.data.charAt(t.offset-1))}).isSome()}})(e.range,i,e.text)});if(0===u.length)return tw.none();var a=pz.all(tB(u,function(t){return t.fetch(e.text,t.maxResults,o).then(function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}})}));return tw.some({lookupData:a,context:e})},pY=oU([ro("type"),rd("text")]),pq=oU([rh("type","autocompleteitem"),rh("active",!1),rh("disabled",!1),rh("meta",{}),ro("value"),rd("text"),rd("icon")]),pK=oU([ro("type"),ro("ch"),rb("minChars",1),rh("columns",1),rb("maxResults",10),rm("matches"),ri("fetch"),ri("onAction"),rk("highlightOn",[],oK)]),pJ=[rw("disabled",!1),rd("tooltip"),rd("icon"),rd("text"),rS("onSetup",function(){return tr})],p$=oU([ro("type"),ri("onAction")].concat(pJ)),pQ=function(t){return o3("toolbarbutton",p$,t)},pZ=[rw("active",!1)].concat(pJ),p0=oU(pZ.concat([ro("type"),ri("onAction")])),p1=function(t){return o3("ToggleButton",p0,t)},p2=[rS("predicate",td),rx("scope","node",["node","editor"]),rx("position","selection",["node","selection","line"])],p5=pJ.concat([rh("type","contextformbutton"),rh("primary",!1),ri("onAction"),o7("original",ta)]),p3=pZ.concat([rh("type","contextformbutton"),rh("primary",!1),ri("onAction"),o7("original",ta)]),p9=pJ.concat([rh("type","contextformbutton")]),p4=pZ.concat([rh("type","contextformtogglebutton")]),p6=o8("type",{contextformbutton:p5,contextformtogglebutton:p3}),p8=oU([rh("type","contextform"),rS("initValue",tu("")),rd("label"),rc("commands",p6),rl("launch",o8("type",{contextformbutton:p9,contextformtogglebutton:p4}))].concat(p2)),p7=oU([rh("type","contexttoolbar"),ro("items")].concat(p2)),ht=function(t){var n={};return tM(t,function(t){n[t]={}}),t0(n)},hn=function(t){var n=t5(t.ui.registry.getAll().popups,function(t){return o3("Autocompleter",pK,t).fold(function(t){throw Error(o6(t))},ta)}),e=ht(t4(n,function(t){return t.ch})),o=t8(n);return{dataset:n,triggerChars:e,lookupByChar:function(t){return tR(o,function(n){return n.ch===t})}}};(f=I||(I={}))[f.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",f[f.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var he=I,ho="tox-menu-nav__js",hr="tox-collection__item",hi="tox-swatch",hu={normal:ho,color:hi},ha="tox-collection__item--enabled",hc="tox-collection__item-icon",hs="tox-collection__item-label",hl="tox-collection__item-caret",hf="tox-collection__item--active",hd="tox-collection__item-container",hm="tox-collection__item-container--row",hg=function(t){return t7(hu,t).getOr(ho)},hp=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},hh=function(t){var n=hp(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:hg(t)}},hv=function(t,n,e){var o=hp(e);return{tag:"div",classes:tz([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},hb=[m9.parts.items({})],hy=function(t,n,e){return{dom:{tag:"div",classes:tz([[hp(e).tieredMenu]])},markers:hh(e)}},hx=function(t,n){return function(e){return tB(tA(e,n),function(n){return{dom:t,components:n}})}},hw=function(t,n){var e=[],o=[];return tM(t,function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],nt(t.dom,"innerHtml")&&o.push(t)):o.push(t)}),o.length>0&&e.push(o),tB(e,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})},hS=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[m9.parts.items({preprocess:function(e){return"auto"!==t&&t>1?hx({tag:"div",classes:["tox-collection__group"]},t)(e):hw(e,function(t,e){return"separator"===n[e].type})}})]}},hk=function(t){return tE(t,function(t){return"icon"in t&&void 0!==t.icon})},hC=function(t){return console.error(o6(t)),console.log(t),tw.none()},hO=function(t,n,e,o,r){var i={dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[m9.parts.items({preprocess:function(t){return hw(t,function(t,n){return"separator"===e[n].type})}})]};return{value:t,dom:i.dom,components:i.components,items:e}},h_=function(t,n,e,o,r){if("color"===r){var i={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[m9.parts.items({preprocess:"auto"!==o?hx({tag:"div",classes:["tox-swatches__row"]},o):ta})]}]};return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o){var i=hS(o,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&1===o){var i=hS(1,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r){var i=hS(o,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("listpreview"===r&&"auto"!==o){var i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[m9.parts.items({preprocess:hx({tag:"div",classes:["tox-collection__group"]},o)})]};return{value:t,dom:i.dom,components:i.components,items:e}}return{value:t,dom:hv(n,o,r),components:hb,items:e}},hT=oU([ro("type"),ro("src"),rd("alt"),rk("classes",[],oK)]),hE=oU([ro("type"),ro("text"),rd("name"),rk("classes",["tox-collection__item-label"],oK)]),hD=oL(function(){return o0("type",{cardimage:hT,cardtext:hE,cardcontainer:hA})}),hA=oU([ro("type"),ry("direction","horizontal"),ry("align","left"),ry("valign","middle"),rc("items",hD)]),hB=[rw("disabled",!1),rd("text"),rd("shortcut"),ow("value","value",oT(function(){return iQ("menuitem-value")}),oX()),rh("meta",{})],hM=oU([ro("type"),rd("label"),rc("items",hD),rS("onSetup",function(){return tr}),rS("onAction",tr)].concat(hB)),hF=oU([ro("type"),rw("active",!1),rd("icon")].concat(hB)),hI=[ro("type"),ro("fancytype"),rS("onAction",tr)],hR=o8("fancytype",{inserttable:[rh("initData",{})].concat(hI),colorswatch:[rC("initData",{},[rw("allowCustomColors",!0),rg("colors",oX())])].concat(hI)}),hN=oU([ro("type"),rS("onSetup",function(){return tr}),rS("onAction",tr),rd("icon")].concat(hB)),hP=oU([ro("type"),ri("getSubmenuItems"),rS("onSetup",function(){return tr}),rd("icon")].concat(hB)),hH=oU([ro("type"),rd("icon"),rw("active",!1),rS("onSetup",function(){return tr}),ri("onAction")].concat(hB)),hV=function(t,n,e){var o=sE(t.element,"."+e);if(!(o.length>0))return tw.none();var r=tL(o,function(t){return Math.abs(t.dom.getBoundingClientRect().top-o[0].dom.getBoundingClientRect().top)>n}).getOr(o.length);return tw.some({numColumns:r,numRows:Math.ceil(o.length/r)})},hL=function(t,n){return aZ([mT(t,n)])},hz={namedEvents:hL,unnamedEvents:function(t){return hL(iQ("unnamed-events"),t)}},hU=iQ("tooltip.exclusive"),hj=iQ("tooltip.show"),hW=iQ("tooltip.hide"),hG=function(t,n,e){t.getSystem().broadcastOn([hU],{})},hX=Object.freeze({__proto__:null,hideAllExclusive:hG,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&mO.set(t,o)})}}),hY=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each(function(o){lr(o),t.onHide(e,o),n.clearTooltip()}),n.clearTimer()},o=function(e){if(!n.isShowing()){hG(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:iB("normal"===t.mode?[iI(rq(),function(t){iO(e,hj)}),iI(rX(),function(t){iO(e,hW)})]:[]),behaviours:aZ([mO.config({})])});n.setTooltip(r),ln(o,r),t.onShow(e,r),s9.position(o,r,{anchor:t.anchor(e)})}};return iB(tz([[iI(hj,function(e){n.resetTimer(function(){o(e)},t.delay)}),iI(hW,function(o){n.resetTimer(function(){e(o)},t.delay)}),iI(ie(),function(t,n){!n.universal&&tT(n.channels,hU)&&e(t)}),iU(function(t){e(t)})],"normal"===t.mode?[iI(rK(),function(t){iO(t,hj)}),iI(r7(),function(t){iO(t,hW)}),iI(rq(),function(t){iO(t,hj)}),iI(rX(),function(t){iO(t,hW)})]:[iI(ik(),function(t,n){iO(t,hj)}),iI(iC(),function(t){iO(t,hW)})]]))}}),hq=a1({fields:[rn("lazySink"),rn("tooltipDom"),rh("exclusive",!0),rh("tooltipComponents",[]),rh("delay",300),rx("mode","normal",["normal","follow-highlight"]),rh("anchor",function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:tu([aH,aP,aF,aR,aI,aN]),onRtl:tu([aH,aP,aF,aR,aI,aN])}}}),ar("onHide"),ar("onShow")],name:"tooltipping",active:hY,state:Object.freeze({__proto__:null,init:function(){var t=cO(),n=cO(),e=function(){t.on(clearTimeout)},o=tu("not-implemented");return ua({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:function(n,o){e(),t.set(setTimeout(n,o))},readState:o})}}),apis:hX}),hK=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),hJ=tinymce.util.Tools.resolve("tinymce.EditorManager"),h$=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");return!1!==n&&(e=e?t.documentBaseURI.toAbsolute(e):hJ.baseURL+"/skins/ui/"+(n||"oxide")),e},hQ=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},hZ=function(t){return t.getParam("width",hK.DOM.getStyle(t.getElement(),"width"))},h0=function(t){return tw.from(t.getParam("min_width")).filter(te)},h1=function(t){return tw.from(t.getParam("min_height")).filter(te)},h2=function(t){return tw.from(t.getParam("max_width")).filter(te)},h5=function(t){return tw.from(t.getParam("max_height")).filter(te)},h3=function(t){return!1!==t.getParam("menubar",!0,"boolean")},h9=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=Y(n),r=K(n)&&n.length>0;return!h6(t)&&(r||o||e)},h4=function(t){var n=tR(tD(9,function(n){return t.getParam("toolbar"+(n+1),!1,"string")}),function(t){return"string"==typeof t});return n.length>0?tw.some(n):tw.none()},h6=function(t){return h4(t).fold(function(){return t.getParam("toolbar",[],"string[]").length>0},tm)};(d=R||(R={})).default="wrap",d.floating="floating",d.sliding="sliding",d.scrolling="scrolling";var h8=function(t){return t.getParam("toolbar_mode","","string")};(m=N||(N={})).auto="auto",m.top="top",m.bottom="bottom";var h7=function(t){return t.getParam("toolbar_location",N.auto,"string")},vt=function(t){return h7(t)===N.bottom},vn=function(t){if(!t.inline)return tw.none();var n=t.getParam("fixed_toolbar_container","","string");if(n.length>0)return uK(ev(),n);var e=t.getParam("fixed_toolbar_container_target");return tt(e)?tw.some(nh.fromDom(e)):tw.none()},ve=function(t){return t.inline&&vn(t).isSome()},vo=function(t){return vn(t).getOrThunk(function(){return ed(ef(nh.fromDom(t.getElement())))})},vr=function(t){return t.inline&&!h3(t)&&!h9(t)&&!h6(t)},vi=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!ve(t)&&!vr(t)},vu=function(t){var n=t.getParam("menu");return n?t5(n,function(t){return tp(tp({},t),{items:t.items})}):{}},va=function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n},vc="silver.readonly",vs=oU([re("readonly",oJ)]),vl=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([lw()],{target:e}),t.uiMothership.broadcastOn([lw()],{target:e})),t.mothership.broadcastOn([vc],{readonly:n}),t.uiMothership.broadcastOn([vc],{readonly:n})},vf=function(t,n){t.on("init",function(){t.mode.isReadOnly()&&vl(n,!0)}),t.on("SwitchMode",function(){return vl(n,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},vd=function(){var t;return a9.config({channels:((t={})[vc]={schema:vs,onReceive:function(t,n){fJ.set(t,n.readonly)}},t)})},vm={item:function(t){return fJ.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},button:function(t){return fJ.config({disabled:t})},splitButton:function(t){return fJ.config({disabled:t,disableClass:"tox-tbtn--disabled"})},toolbarButton:function(t){return fJ.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})}},vg=function(t,n){var e=t.getApi(n);return function(t){t(e)}},vp=function(t,n){return iz(function(e){vg(t,e)(function(e){var o=t.onSetup(e);tn(o)&&n.set(o)})})},vh=function(t,n){return iU(function(e){return vg(t,e)(n.get())})},vv=((P={})[io()]=["disabling","alloy.base.behaviour","toggling","item-events"],P),vb=function(t,n,e,o){var r=rO(tr);return{type:"item",dom:n.dom,components:no(n.optComponents),data:t.data,eventOrder:vv,hasSubmenu:t.triggersSubmenu,itemBehaviours:aZ([mT("item-events",[iW(function(n,o){vg(t,n)(t.onAction),t.triggersSubmenu||e!==he.CLOSE_ON_EXECUTE||(iO(n,ia()),o.stop())}),vp(t,r),vh(t,r)]),vm.item(function(){return t.disabled||o.isDisabled()}),vd(),mO.config({})].concat(t.itemBehaviours))}},vy=function(t){return{value:t.value,meta:tp({text:t.text.getOr("")},t.meta)}},vx=tinymce.util.Tools.resolve("tinymce.Env"),vw=function(t){var n=vx.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=tB(t.split("+"),function(t){var e=t.toLowerCase().trim();return nt(n,e)?n[e]:t});return vx.mac?e.join(""):e.join("+")},vS=function(t,n,e){return void 0===e&&(e=[hc]),pO(t,{tag:"div",classes:e},n)},vk=function(t){return{dom:{tag:"div",classes:[hs]},components:[uL(pp.translate(t))]}},vC=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},vO=function(t,n){return{dom:{tag:"div",classes:[hs]},components:[{dom:{tag:t.tag,styles:t.styles},components:[uL(pp.translate(n))]}]}},v_=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:vw(t)}}},vT=function(t){return vS("checkmark",t,["tox-collection__item-checkmark"])},vE=function(t,n,e){var o,r,i=t.ariaLabel,u=t.value;return{dom:(o=t.iconContent.map(function(t){return pS(t,n.icons,e)}).getOr(""),r={tag:"div",attributes:i.map(function(t){return{title:n.translate(t)}}).getOr({}),classes:[hi]},"custom"===u?tp(tp({},r),{tag:"button",classes:tv(tv([],r.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:o}):"remove"===u?tp(tp({},r),{classes:tv(tv([],r.classes,!0),["tox-swatch--remove"],!1),innerHtml:o}):tp(tp({},r),{attributes:tp(tp({},r.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}},vD=function(t){var n=t.map(function(t){return{attributes:{title:pp.translate(t)}}}).getOr({});return tp({tag:"div",classes:[ho,hr]},n)},vA=function(t,n,e,o){var r={tag:"div",classes:[hc]},i=e?t.iconContent.map(function(t){return pO(t,r,n.icons,o)}).orThunk(function(){return tw.some({dom:r})}):tw.none(),u=t.checkMark,a=tw.from(t.meta).fold(function(){return vk},function(t){return nt(t,"style")?ts(vO,t.style):vk}),c=t.htmlContent.fold(function(){return t.textContent.map(a)},function(t){return tw.some(vC(t,[hs]))});return{dom:vD(t.ariaLabel),optComponents:[i,c,t.shortcutContent.map(v_),u,t.caret]}},vB=function(t,n,e,o){return(void 0===o&&(o=tw.none()),"color"===t.presets)?vE(t,n,o):vA(t,n,e,o)},vM=function(t,n){return t7(t,"tooltipWorker").map(function(t){return[hq.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:cj}}},mode:"follow-highlight",onShow:function(n,e){t(function(t){hq.setComponents(n,[uz({element:nh.fromDom(t)})])})}})]}).getOr([])},vF=function(t,n){var e,o=(e=pp.translate(t),hK.DOM.encode(e));if(!(n.length>0))return o;var r=RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(r,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})},vI=function(t,n){return tB(t,function(t){switch(t.type){case"cardcontainer":return e=vI(t.items,n),{dom:{tag:"div",classes:[hd,"vertical"===t.direction?"tox-collection__item-container--column":hm,"left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",function(){switch(t.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:e};case"cardimage":return o=t.src,{dom:{tag:"img",classes:t.classes,attributes:{src:o,alt:t.alt.getOr("")}}};case"cardtext":var e,o,r=t.name.exists(function(t){return tT(n.cardText.highlightOn,t)})?tw.from(n.cardText.matchText).getOr(""):"";return vC(vF(t.text,r),t.classes)}})},vR=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=vB({presets:e,textContent:n?t.text:tw.none(),htmlContent:tw.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:tw.none(),checkMark:n?tw.some(vT(u.icons)):tw.none(),caret:tw.none(),value:t.value},u,a);return oC(vb({data:vy(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){mU.set(t,n)},isActive:function(){return mU.isOn(t)},isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),tr},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:ha,toggleOnExecute:!1,selected:t.active}})},vN=ff(mZ(),m0()),vP=function(t){return{value:t}},vH=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,vV=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,vL=function(t){return vH.test(t)||vV.test(t)},vz=function(t){var n={value:t.value.replace(vH,function(t,n,e,o){return n+n+e+e+o+o})},e=vV.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},vU=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},vj=function(t){return vP(vU(t.red)+vU(t.green)+vU(t.blue))},vW=Math.min,vG=Math.max,vX=Math.round,vY=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,vq=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,vK=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},vJ=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},v$=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=vG(0,vW(i,1)),u=vG(0,vW(u,1)),0===i)return vK(n=e=o=vX(255*u),e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return vK(n=vX(255*(n+l)),e=vX(255*(e+l)),o=vX(255*(o+l)),1)},vQ=function(t){var n=vz(t);return vK(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),1)},vZ=function(t,n,e,o){return vK(parseInt(t,10),parseInt(n,10),parseInt(e,10),parseFloat(o))},v0=function(t){if("transparent"===t)return tw.some(vK(0,0,0,0));var n=vY.exec(t);if(null!==n)return tw.some(vZ(n[1],n[2],n[3],"1"));var e=vq.exec(t);return null!==e?tw.some(vZ(e[1],e[2],e[3],e[4])):tw.none()},v1=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},v2=vK(255,0,0,1),v5=function(t,n){return t.fire("ResizeContent",n)},v3=function(t,n,e){return{hue:t,saturation:n,value:e}},v9=function(t){var n=0,e=t.red/255,o=t.green/255,r=t.blue/255,i=Math.min(e,Math.min(o,r)),u=Math.max(e,Math.max(o,r));return i===u?v3(0,0,100*i):v3(Math.round(60*((e===i?3:r===i?1:5)-(e===i?o-r:r===i?e-o:r-e)/(u-i))),Math.round((u-i)/u*100),Math.round(100*u))},v4=function(t){return vj(v$(t))},v6=function(t){return(vL(t)?tw.some({value:nc(t,"#").toUpperCase()}):tw.none()).orThunk(function(){return v0(t).map(vj)}).getOrThunk(function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data;return vj(vK(o[0],o[1],o[2],o[3]))})},v8=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),v7="tinymce-custom-colors",bt="choiceitem",bn=[{type:bt,text:"Light Green",value:"#BFEDD2"},{type:bt,text:"Light Yellow",value:"#FBEEB8"},{type:bt,text:"Light Red",value:"#F8CAC6"},{type:bt,text:"Light Purple",value:"#ECCAFA"},{type:bt,text:"Light Blue",value:"#C2E0F4"},{type:bt,text:"Green",value:"#2DC26B"},{type:bt,text:"Yellow",value:"#F1C40F"},{type:bt,text:"Red",value:"#E03E2D"},{type:bt,text:"Purple",value:"#B96AD9"},{type:bt,text:"Blue",value:"#3598DB"},{type:bt,text:"Dark Turquoise",value:"#169179"},{type:bt,text:"Orange",value:"#E67E23"},{type:bt,text:"Dark Red",value:"#BA372A"},{type:bt,text:"Dark Purple",value:"#843FA1"},{type:bt,text:"Dark Blue",value:"#236FA1"},{type:bt,text:"Light Gray",value:"#ECF0F1"},{type:bt,text:"Medium Gray",value:"#CED4D9"},{type:bt,text:"Gray",value:"#95A5A6"},{type:bt,text:"Dark Gray",value:"#7E8C8D"},{type:bt,text:"Navy Blue",value:"#34495E"},{type:bt,text:"Black",value:"#000000"},{type:bt,text:"White",value:"#ffffff"}],be=(h=10-(p=Y(g=v8.getItem(v7))?JSON.parse(g):[]).length<0?p.slice(0,10):p,v=function(t){h.splice(t,1)},{add:function(t){t_(h,t).each(v),h.unshift(t),h.length>10&&h.pop(),v8.setItem(v7,JSON.stringify(h))},state:function(){return h.slice(0)}}),bo=function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+v6(t[e]).value,type:"choiceitem"});return n},br=function(t){return!1!==t.getParam("custom_colors")},bi=function(t){var n=t.getParam("color_map");return void 0!==n?bo(n):bn},bu=function(t){be.add(t)},ba="#000000",bc=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)}),tw.from(e)},bs=function(t,n,e){t.undoManager.transact(function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()})},bl=function(t,n){t.undoManager.transact(function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()})},bf=function(t){t.addCommand("mceApplyTextcolor",function(n,e){bs(t,n,e)}),t.addCommand("mceRemoveTextcolor",function(n){bl(t,n)})},bd=function(t){var n=Math.max(5,Math.ceil(Math.sqrt(bi(t).length)));return t.getParam("color_cols",n,"number")},bm=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]},bg=function(t,n,e,o){"custom"===e?bx(t)(function(e){e.each(function(e){bu(e),t.execCommand("mceApplyTextcolor",n,e),o(e)})},ba):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},bp=function(t,n){return t.concat(tB(be.state(),function(t){return{type:bt,text:t,value:t}}).concat(bm(n)))},bh=function(t,n){return function(e){e(bp(t,n))}},bv=function(t,n,e){t.setIconFill("forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",e)},bb=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){return bc(t,e).bind(function(t){return v0(t).map(function(t){var e=vj(t).value;return ns(n.toLowerCase(),e)})}).getOr(!1)},columns:bd(t),fetch:bh(bi(t),br(t)),onAction:function(n){bg(t,e,r.get(),tr)},onItemAction:function(o,i){bg(t,e,i,function(e){r.set(e),t.fire("TextColorChange",{name:n,color:e})})},onSetup:function(e){bv(e,n,r.get());var o=function(t){t.name===n&&bv(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},by=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){bg(t,e,n.value,tr)}}]}})},bx=function(t){return function(n,e){var o=!1;t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:e},onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker;o?(n(tw.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:tr,onCancel:function(){n(tw.none())}})}},bw=function(t){bf(t);var n=rO(ba),e=rO(ba);bb(t,"forecolor","forecolor","Text color",n),bb(t,"backcolor","hilitecolor","Background color",e),by(t,"forecolor","forecolor","Text color"),by(t,"backcolor","hilitecolor","Background color")},bS=function(t,n,e,o,r,i,u,a){return h_(t,hk(n),bk(n,e,o,"color"!==r?"normal":"color",i,u,a),o,r)},bk=function(t,n,e,o,r,i,u){return no(tB(t,function(a){return"choiceitem"!==a.type?tw.none():o3("choicemenuitem",hF,a).fold(hC,function(c){return tw.some(vR(c,1===e,o,n,i(a.value),r,u,hk(t)))})}))},bC=function(t,n){var e=hh(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},bO=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return t.initData.colors.fold(function(){return bp(n.colorinput.getColors(),e)},function(t){return t.concat(bm(e))})},b_=iQ("cell-over"),bT=iQ("cell-execute"),bE=function(t,n,e){var o,r=function(e){return i_(e,bT,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return uU({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=e,o)},behaviours:aZ([mT("insert-table-picker-cell",[iI(rq(),mB.focus),iI(io(),r),iI(r1(),i),iI(ii(),i)]),mU.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),mB.config({onFocus:function(e){return i_(e,b_,{row:t,col:n})}})])})},bD=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(bE(r,u,t));o.push(i)}return o},bA=function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)mU.set(t[i][u],i<=n&&u<=e)},bB=function(t,n){return uL(n+"x"+t)},bM={inserttable:function(t){var n=iQ("size-label"),e=bD(n,10,10),o=bB(0,0),r=g_({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[o],behaviours:aZ([mO.config({})])});return{type:"widget",data:{value:iQ("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[vN.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:tU(e,function(t){return tB(t,ur)}).concat(r.asSpec()),behaviours:aZ([mT("insert-table-picker",[iz(function(t){mO.set(r.get(t),[o])}),iH(b_,function(t,n,o){var i=o.event,u=i.row,a=i.col;bA(e,u,a,10,10),mO.set(r.get(t),[bB(u+1,a+1)])}),iH(bT,function(n,e,o){var r=o.event,i=r.row,u=r.col;t.onAction({numRows:i+1,numColumns:u+1}),iO(n,ia())})]),mx.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=bO(t,n),o=n.colorinput.getColorCols(),r="color",i=bS(iQ("menu-value"),e,function(n){t.onAction({value:n})},o,r,he.CLOSE_ON_EXECUTE,td,n.shared.providers),u=tp(tp({},i),{markers:hh(r),movement:bC(o,r)});return{type:"widget",data:{value:iQ("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[vN.widget(m9.sketch(u))]}}},bF=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=vB({presets:o,textContent:tw.none(),htmlContent:e?t.text.map(function(t){return vF(t,n)}):tw.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:tw.none(),checkMark:tw.none(),caret:tw.none(),value:t.value},u.providers,a,t.icon);return vb({data:vy(t),disabled:t.disabled,getApi:tu({}),onAction:function(n){return r(t.value,t.meta)},onSetup:tu(tr),triggersSubmenu:!1,itemBehaviours:vM(t.meta,u)},c,i,u.providers)},bI=function(t){var n=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:tp({tag:"div",classes:[hr,"tox-collection__group-heading"]},n),components:[]}},bR=function(t,n,e,o){void 0===o&&(o=!0);var r=vB({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:tw.none(),ariaLabel:t.text,caret:tw.none(),checkMark:tw.none(),shortcutContent:t.shortcut},e,o);return vb({data:vy(t),getApi:function(t){return{isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},bN=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i=r?vS("chevron-down",e.icons,[hl]):vS("chevron-right",e.icons,[hl]),u=vB({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:tw.none(),ariaLabel:t.text,caret:tw.some(i),checkMark:tw.none(),shortcutContent:t.shortcut},e,o);return vb({data:vy(t),getApi:function(t){return{isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)}}},disabled:t.disabled,onAction:tr,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},u,n,e)},bP=function(t,n,e,o){void 0===o&&(o=!0);var r=vB({iconContent:t.icon,textContent:t.text,htmlContent:tw.none(),ariaLabel:t.text,checkMark:tw.some(vT(e.icons)),caret:tw.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return oC(vb({data:vy(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){mU.set(t,n)},isActive:function(){return mU.isOn(t)},isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:ha,toggleOnExecute:!1,selected:t.active}})},bH=function(t,n,e,o){var r={dom:vD(t.label),optComponents:[tw.some({dom:{tag:"div",classes:[hd,hm]},components:vI(t.items,o)})]};return vb({data:vy(tp({text:tw.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){fJ.set(t,n),tM(sE(t.element,"*"),function(e){t.getSystem().getByDom(e).each(function(t){t.hasConfigured(fJ)&&fJ.set(t,n)})})}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:tw.from(o.itemBehaviours).getOr([])},r,n,e.providers)};(b=H||(H={}))[b.ContentFocus=0]="ContentFocus",b[b.UiFocus=1]="UiFocus";var bV=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?tp(tp({},t),{shortcut:tw.none(),icon:t.text.isSome()?tw.none():t.icon}):t};switch(t.type){case"menuitem":return o3("menuitem",hN,t).fold(hC,function(t){return tw.some(bR(u(t),n,i,o))});case"nestedmenuitem":return o3("nestedmenuitem",hP,t).fold(hC,function(t){return tw.some(bN(u(t),n,i,o,r))});case"togglemenuitem":return o3("togglemenuitem",hH,t).fold(hC,function(t){return tw.some(bP(u(t),n,i,o))});case"separator":return o3("separatormenuitem",pY,t).fold(hC,function(t){return tw.some(bI(t))});case"fancymenuitem":return o3("fancymenuitem",hR,t).fold(hC,function(t){var n;return t7(bM,(n=u(t)).fancytype).map(function(t){return t(n,e)})});default:return console.error("Unknown item in general menu",t),tw.none()}},bL=function(t,n,e,o,r,i,u){var a=1===o,c=!a||hk(t);return no(tB(t,function(t){switch(t.type){case"separator":return o3("Autocompleter.Separator",pY,t).fold(hC,function(t){return tw.some(bI(t))});case"cardmenuitem":return o3("cardmenuitem",hM,t).fold(hC,function(t){return tw.some(bH(tp(tp({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:vM(t.meta,i),cardText:{matchText:n,highlightOn:u}}))});default:return o3("Autocompleter.Item",pq,t).fold(hC,function(t){return tw.some(bF(t,n,a,"normal",e,r,i,c))})}}))},bz=function(t,n,e,o,r){var i=hk(n),u=no(tB(n,function(t){var n;return bV(n="nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?tp(tp({},t),{disabled:!0}):t,e,o,r?!nt(n,"text"):i,r)}));return(r?hO:h_)(t,i,u,1,"normal")},bU=function(t){return gn.singleData(t.value,t)},bj=function(t,n,e,o){var r=e===H.ContentFocus?db():dv(),i=bC(n,o),u=hh(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===H.ContentFocus,focusManager:r,menuBehaviours:hz.unnamedEvents("auto"!==n?[]:[iz(function(t,n){hV(t,4,u.item).each(function(n){var e=n.numColumns,o=n.numRows;mx.setGridSize(t,o,e)})})])}},bW={register:function(t,n){var e=cO(),o=rO(!1),r=uU(go.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:aZ([mT("dismissAutocompleter",[iI(iv(),function(){return a()})])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&go.hide(r)},a=function(){i()&&(pF(e.get().map(function(t){return t.element}).getOr(nh.fromDom(t.selection.getNode()))).each(ot),u(),e.clear(),o.set(!1))},c=nk(function(){return hn(t)}),s=function(e,r){var i=tZ(r,function(t){return tw.from(t.columns)}).getOr(1);return tU(r,function(r){return bL(r.items,r.matchText,function(n,i){var c=t.selection.getRng();pV(t.dom,c,e).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var e=t.range;o.set(!0),r.onAction({hide:function(){a()},reload:function(t){u(),d(t)}},e,n,i),o.set(!1)})},i,he.BUBBLE_TO_SANDBOX,n,r.highlightOn)})},l=function(n){if(!i()){var r,u=(r=n.range,pF(nh.fromDom(t.selection.getNode())).getOrThunk(function(){var n=nh.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return e3(n,nh.fromDom(r.extractContents())),r.insertNode(n.dom),ee(n).each(function(t){return t.dom.normalize()}),sT(n,s_).map(function(n){t.selection.setCursorLocation(n.dom,"img"===nv(n)?1:sC(n).fold(function(){return er(n).length},function(t){return t.length}))}),n}));e.set({triggerChar:n.triggerChar,element:u,matchLength:n.text.length}),o.set(!1)}},f=function(n,e,o,i){n.matchLength=e.text.length;var u=tZ(o,function(t){return tw.from(t.columns)}).getOr(1);go.showAt(r,m9.sketch(bj(h_("autocompleter-value",!0,i,u,"normal"),u,H.ContentFocus,"normal")),{anchor:{type:"node",root:nh.fromDom(t.getBody()),node:tw.from(n.element)}}),go.getContent(r).each(f4.highlightFirst)},d=function(n){e.get().map(function(e){return pV(t.dom,t.selection.getRng(),e.triggerChar).bind(function(e){return pX(t,c,e,n)})}).getOrThunk(function(){return pG(t,c)}).fold(a,function(t){l(t.context),t.lookupData.then(function(n){e.get().map(function(e){var o=t.context;if(e.triggerChar===o.triggerChar){var r=s(o.triggerChar,n);r.length>0?f(e,o,n,r):o.text.length-e.matchLength>=10?a():u()}})})})},m={onKeypress:pA(function(t){27!==t.which&&d()},50),cancelIfNecessary:a,isMenuOpen:function(){return go.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return go.getContent(r)}};!1===t.hasPlugin("rtc")&&pL.setup(m,t)}},bG=function(t,n,e){return uJ(t,n,e).isSome()},bX=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout(function(){t.apply(null,o),e=null},n)}}},bY=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?tw.none():tw.some(n.touches[0])},bq=function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>5||o>5},bK=function(t){var n=cO(),e=rO(!1),o=bX(function(n){t.triggerEvent(iu(),n),e.set(!0)},400),r=rM([{key:rL(),value:function(t){return bY(t).each(function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(i)}),tw.none()}},{key:rz(),value:function(t){return o.cancel(),bY(t).each(function(t){n.on(function(e){bq(t,e)&&n.clear()})}),tw.none()}},{key:rU(),value:function(r){return o.cancel(),n.get().filter(function(t){return n9(t.target,r.target)}).map(function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(ii(),r)})}}]);return{fireIfReady:function(t,n){return t7(r,n).bind(function(n){return n(t)})}}},bJ=function(){return n0().browser.isFirefox()},b$=function(t,n){var e,o,r=tp({stopBackspace:!0},n),i=bK(r),u=tB(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return c_(t,n,function(t){i.fireIfReady(t,n).each(function(n){n&&t.kill()}),r.triggerEvent(n,t)&&t.kill()})}),a=cO(),c=c_(t,"paste",function(t){i.fireIfReady(t,"paste").each(function(n){n&&t.kill()}),r.triggerEvent("paste",t)&&t.kill(),a.set(setTimeout(function(){r.triggerEvent(it(),t)},0))}),s=c_(t,"keydown",function(t){if(r.triggerEvent("keydown",t))t.kill();else{var n;!r.stopBackspace||8!==(n=t).raw.which||tT(["input","textarea"],nv(n.target))||bG(n.target,'[contenteditable="true"]')||t.prevent()}}),l=(e=function(t){r.triggerEvent("focusin",t)&&t.kill()},bJ()?cT(t,"focus",e):c_(t,"focusin",e)),f=cO(),d=(o=function(t){r.triggerEvent("focusout",t)&&t.kill(),f.set(setTimeout(function(){r.triggerEvent(r7(),t)},0))},bJ()?cT(t,"blur",o):c_(t,"focusout",o));return{unbind:function(){tM(u,function(t){t.unbind()}),s.unbind(),l.unbind(),d.unbind(),c.unbind(),a.on(clearTimeout),f.on(clearTimeout)}}},bQ=function(t,n){return rO(t7(t,"target").getOr(n))},bZ=function(t,n){var e=rO(!1),o=rO(!1);return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}},b0=function(t){var n=rO(!1);return{stop:function(){n.set(!0)},cut:tr,isStopped:n.get,isCut:td,event:t,setSource:tf("Cannot set source of a broadcasted event"),getSource:tf("Cannot get source of a broadcasted event")}},b1=r_.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),b2=function(t,n,e,o,r,i){var u=t(n,o),a=bZ(e,r);return u.fold(function(){return i.logEventNoHandlers(n,o),b1.complete()},function(t){var e=t.descHandler;return(um(e)(a),a.isStopped())?(i.logEventStopped(n,t.element,e.purpose),b1.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),b1.complete()):ee(t.element).fold(function(){return i.logNoParent(n,t.element,e.purpose),b1.complete()},function(o){return i.logEventResponse(n,t.element,e.purpose),b1.resume(o)})})},b5=function(t,n,e,o,r,i){return b2(t,n,e,o,r,i).fold(tm,function(o){return b5(t,n,e,o,r,i)},td)},b3=function(t,n,e,o,r){var i=bQ(e,o);return b2(t,n,e,o,i,r)},b9=function(t,n,e){var o=b0(n);return tM(t,function(t){um(t.descHandler)(o)}),o.isStopped()},b4=function(t,n,e,o,r){var i=bQ(e,o);return b5(t,n,e,o,i,r)},b6=function(){var t={};return{registerId:function(n,e,o){t2(o,function(o,r){var i,u,a=void 0!==t[r]?t[r]:{};a[e]=(i=o,u=n,{cHandler:ts.apply(void 0,[i.handler].concat(u)),purpose:i.purpose}),t[r]=a})},unregisterId:function(n){t2(t,function(t,e){nt(t,n)&&delete t[n]})},filterByType:function(n){return t7(t,n).map(function(t){return t4(t,function(t,n){return{id:n,descHandler:t}})}).getOr([])},find:function(n,e,o){return t7(t,e).bind(function(t){return rN(o,function(n){return i9(n).bind(function(n){return t7(t,n)}).map(function(t){return{element:n,descHandler:t}})},n)})}}},b8=function(){var t=b6(),n={},e=function(t,e){var r=n[e];if(r===t)o(t);else throw Error('The tagId "'+e+'" is already used by: '+iK(r.element)+"\nCannot use it for: "+iK(t.element)+"\nThe conflicting element is"+(eh(r.element)?" ":" not ")+"already in the DOM")},o=function(e){i9(e.element).each(function(e){delete n[e],t.unregisterId(e)})};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(o){var r=i9(o.element).getOrThunk(function(){return i5("uid-",o.element)});nn(n,r)&&e(o,r);var i=[o];t.registerId(i,r,o.events),n[r]=o},unregister:o,getById:function(t){return t7(n,t)}}},b7=fF({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=th(n,["attributes"]);return{uid:t.uid,dom:tp({tag:"div",attributes:tp({role:"presentation"},e)},o),components:t.components,behaviours:lL(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[rh("components",[]),lV("containerBehaviours",[]),rh("events",{}),rh("domModification",{}),rh("eventOrder",{})]}),yt=function(t){var n=function(n){return ee(t.element).fold(tm,function(t){return n9(n,t)})},e=b8(),o=function(t,o){return e.find(n,t,o)},r=b$(t.element,{triggerEvent:function(t,n){return u9(t,n.target,function(e){return b4(o,t,n,n.target,e)})}}),i={debugInfo:tu("real"),triggerEvent:function(t,n,e){u9(t,n,function(r){return b4(o,t,e,n,r)})},triggerFocus:function(t,n){i9(t).fold(function(){a8(t)},function(e){u9(r8(),t,function(e){return b3(o,r8(),{originator:n,kill:tr,prevent:tr,target:t},t,e),!1})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:uU,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){f(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:tm},u=function(t){t.connect(i),nx(t.element)||(e.register(t),tM(t.components(),u),i.triggerEvent(is(),t.element,{target:t.element}))},a=function(t){nx(t.element)||(tM(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){ln(t,n)},s=function(t){lr(t)},l=function(t){tM(e.filter(ie()),function(n){um(n.descHandler)(t)})},f=function(t){l({universal:!0,data:t})},d=function(t,n){l({universal:!1,channels:t,data:n})},m=function(t,n){return b9(e.filter(t),n)},g=function(t){return e.getById(t).fold(function(){return oh.error(Error('Could not find component with uid: "'+t+'" in system.'))},oh.value)},p=function(t){return g(i9(t).getOr("not found"))};return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),e7(t.element)},add:c,remove:s,getByUid:g,getByDom:p,addToWorld:u,removeFromWorld:a,broadcast:f,broadcastOn:d,broadcastEvent:m}},yn=tu([rh("prefix","form-field"),lV("fieldBehaviours",[fP,lH])]),ye=tu([fi({schema:[rn("dom")],name:"label"}),fi({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[rn("text")],name:"aria-descriptor"}),fo({factory:{sketch:function(t){var n=rE(t,["factory"]);return t.factory.sketch(n)}},schema:[rn("factory")],name:"field"})]),yo=fI({name:"FormField",configFields:yn(),partFields:ye(),factory:function(t,n,e,o){var r=lz(t.fieldBehaviours,[fP.config({find:function(n){return fb(n,t,"field")}}),lH.config({store:{mode:"manual",getValue:function(t){return fP.getCurrent(t).bind(lH.getValue)},setValue:function(t,n){fP.getCurrent(t).each(function(t){lH.setValue(t,n)})}}})]),i=iB([iz(function(n,e){var o=fx(n,t,["label","field","aria-descriptor"]);o.field().each(function(n){var e=iQ(t.prefix);o.label().each(function(t){ex(t.element,"for",e),ex(n.element,"id",e)}),o["aria-descriptor"]().each(function(e){var o=iQ(t.prefix);ex(e.element,"id",o),ex(n.element,"aria-describedby",o)})})})]);return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:{getField:function(n){return fb(n,t,"field")},getLabel:function(n){return fb(n,t,"label")}}}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),yr=Object.freeze({__proto__:null,exhibit:function(t,n){return ul({attributes:rM([{key:n.tabAttr,value:"true"}])})}}),yi=a1({fields:[rh("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:yr}),yu=tinymce.util.Tools.resolve("tinymce.html.Entities"),ya=function(t,n,e,o){var r=yc(t,n,e,o);return yo.sketch(r)},yc=function(t,n,e,o){return{dom:ys(e),components:t.toArray().concat([n]),fieldBehaviours:aZ(o)}},ys=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},yl=function(t,n){return yo.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},yf=iQ("form-component-change"),yd=iQ("form-close"),ym=iQ("form-cancel"),yg=iQ("form-action"),yp=iQ("form-submit"),yh=iQ("form-block"),yv=iQ("form-unblock"),yb=iQ("form-tabchange"),yy=iQ("form-resize"),yx=function(t,n){var e,o,r=t.label.map(function(t){return yl(t,n)}),i=function(t){return function(n,e){uJ(e.event.target,"[data-collection-item-value]").each(function(o){t(n,e,o,eS(o,"data-collection-item-value"))})}},u=function(e,o){var r=tB(o,function(e){var o=pp.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,function(t){return u[t]});return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+yu.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"}),i=tB("auto"!==t.columns&&t.columns>1?tA(r,t.columns):[r],function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});iY(e.element,i.join(""))},a=i(function(e,o,r,i){o.stop(),n.isDisabled()||i_(e,yg,{name:t.name,value:i})}),c=[iI(rq(),i(function(t,n,e){a8(e)})),iI(r1(),a),iI(ii(),a),iI(rK(),i(function(t,n,e){uK(t.element,"."+hf).each(function(t){uT(t,hf)}),uO(e,hf)})),iI(rJ(),i(function(t){uK(t.element,"."+hf).each(function(t){uT(t,hf)})})),iW(i(function(n,e,o,r){i_(n,yg,{name:t.name,value:r})}))],s=function(t,n){return tB(sE(t.element,".tox-collection__item"),n)};return ya(r,yo.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:ta},behaviours:aZ([fJ.config({disabled:n.isDisabled,onDisabled:function(t){s(t,function(t){uO(t,"tox-collection__item--state-disabled"),ex(t,"aria-disabled",!0)})},onEnabled:function(t){s(t,function(t){uT(t,"tox-collection__item--state-disabled"),eO(t,"aria-disabled")})}}),vd(),mO.config({}),lH.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){u(n,e),"auto"===t.columns&&hV(n,5,"tox-collection__item").each(function(t){var e=t.numRows,o=t.numColumns;mx.setGridSize(n,e,o)}),iO(n,yy)}}),yi.config({}),mx.config(1===(e=t.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+hr}}),mT("collection-events",c)]),eventOrder:((o={})[io()]=["disabling","alloy.base.behaviour","collection-events"],o)}),["tox-form__group--collection"],[])},yw=tu([rs("data"),rh("inputAttributes",{}),rh("inputStyles",{}),rh("tag","input"),rh("inputClasses",[]),ar("onSetValue"),rh("styles",{}),rh("eventOrder",{}),lV("inputBehaviours",[lH,mB]),rh("selectOnFocus",!0)]),yS=function(t){return aZ([mB.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=uB(n);n.dom.setSelectionRange(0,e.length)}:tr})])},yk=function(t){return{tag:t.tag,attributes:tp({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},yC=fF({name:"Input",configFields:yw(),factory:function(t,n){return{uid:t.uid,dom:yk(t),components:[],behaviours:tp(tp({},yS(t)),lz(t.inputBehaviours,[lH.config({store:tp(tp({mode:"manual"},t.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return uB(t.element)},setValue:function(t,n){uB(t.element)!==n&&uM(t.element,n)}}),onSetValue:t.onSetValue})])),eventOrder:t.eventOrder}}}),yO={},y_={exports:yO};!function(t,n,e,o){var r,i;r=this,i=function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n={exports:{}};(function(n){(function(t){var e=setTimeout;function o(){}function r(t){if("object"!=typeof this)throw TypeError("Promises must be constructed via new");if("function"!=typeof t)throw TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function i(t,n){for(;3===t._state;)t=t._value;if(0===t._state){t._deferreds.push(n);return}t._handled=!0,r._immediateFn(function(){var e,o=1===t._state?n.onFulfilled:n.onRejected;if(null===o){(1===t._state?u:a)(n.promise,t._value);return}try{e=o(t._value)}catch(t){a(n.promise,t);return}u(n.promise,e)})}function u(t,n){try{if(n===t)throw TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof r){t._state=3,t._value=n,c(t);return}if("function"==typeof e){l(function(){e.apply(n,arguments)},t);return}}t._state=1,t._value=n,c(t)}catch(n){a(t,n)}}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)i(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t(function(t){e||(e=!0,u(n,t))},function(t){e||(e=!0,a(n,t))})}catch(t){if(e)return;e=!0,a(n,t)}}r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var e=new this.constructor(o);return i(this,new s(t,n,e)),e},r.all=function(t){var n=Array.prototype.slice.call(t);return new r(function(t,e){if(0===n.length)return t([]);for(var o=n.length,r=0;r<n.length;r++)!function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a){a.call(u,function(t){r(i,t)},e);return}}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}(r,n[r])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(n){n(t)})},r.reject=function(t){return new r(function(n,e){e(t)})},r.race=function(t){return new r(function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)})},r._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},n.exports?n.exports=r:t.Promise||(t.Promise=r)})(t)})(n);var e=n.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||e}},"object"==typeof n&&void 0!==e?e.exports=i():"function"==typeof t&&t.amd?t(i):(r="undefined"!=typeof globalThis?globalThis:r||self).EphoxContactWrapper=i()}(void 0,yO,y_);var yT=y_.exports.boltExport,yE=function(t){var n=tw.none(),e=[],o=function(t){r()?u(t):e.push(t)},r=function(){return n.isSome()},i=function(t){tM(t,u)},u=function(t){n.each(function(n){setTimeout(function(){t(n)},0)})};return t(function(t){r()||(n=tw.some(t),i(e),e=[])}),{get:o,map:function(t){return yE(function(n){o(function(e){n(t(e))})})},isReady:r}},yD={nu:yE,pure:function(t){return yE(function(n){n(t)})}},yA=function(t){setTimeout(function(){throw t},0)},yB=function(t){var n=function(n){t().then(n,yA)};return{map:function(n){return yB(function(){return t().then(n)})},bind:function(n){return yB(function(){return t().then(function(t){return n(t).toPromise()})})},anonBind:function(n){return yB(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return yD.nu(n)},toCached:function(){var n=null;return yB(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},yM={nu:function(t){return yB(function(){return new yT(t)})},pure:function(t){return yB(function(){return yT.resolve(t)})}},yF=["input","textarea"],yI=function(t){return tT(yF,nv(t))},yR=function(t,n){uT(n.getRoot(t).getOr(t.element),n.invalidClass),n.notify.each(function(n){yI(t.element)&&ex(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){iY(t,n.validHtml)}),n.onValid(t)})},yN=function(t,n,e,o){uO(n.getRoot(t).getOr(t.element),n.invalidClass),n.notify.each(function(n){yI(t.element)&&ex(t.element,"aria-invalid",!0),n.getContainer(t).each(function(t){iY(t,o)}),n.onInvalid(t,o)})},yP=function(t,n,e){return n.validator.fold(function(){return yM.pure(oh.value(!0))},function(n){return n.validate(t)})},yH=function(t,n,e){return n.notify.each(function(n){n.onValidate(t)}),yP(t,n).map(function(o){return t.getSystem().isConnected()?o.fold(function(o){return yN(t,n,e,o),oh.error(o)},function(e){return yR(t,n),oh.value(e)}):oh.error("No longer in system")})},yV=Object.freeze({__proto__:null,markValid:yR,markInvalid:yN,query:yP,run:yH,isInvalid:function(t,n){return uE(n.getRoot(t).getOr(t.element),n.invalidClass)}}),yL=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map(function(e){return iB([iI(e.onEvent,function(e){yH(e,t,n).get(ta)})].concat(e.validateOnLoad?[iz(function(e){yH(e,t,n).get(tr)})]:[]))}).getOr({})}}),yz=a1({fields:[rn("invalidClass"),rh("getRoot",tw.none),rp("notify",[rh("aria","alert"),rh("getContainer",tw.none),rh("validHtml",""),ar("onValid"),ar("onInvalid"),ar("onValidate")]),rp("validator",[rn("validate"),rh("onEvent","input"),rh("validateOnLoad",!0)])],name:"invalidating",active:yL,apis:yV,extra:{validation:function(t){return function(n){var e=lH.getValue(n);return yM.pure(t(e))}}}}),yU=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),yj=a1({fields:[re("others",o2(oh.value,oX()))],name:"coupling",apis:yU,state:Object.freeze({__proto__:null,init:function(){var t={};return ua({readState:tu({}),getOrCreate:function(n,e,o){var r=t0(e.others);if(r)return t7(t,o).getOrThunk(function(){var r=t7(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i,i});throw Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),yW=tu("sink"),yG=tu(fi({name:yW(),overrides:tu({dom:{tag:"div"},behaviours:aZ([s9.config({useFixed:tm})]),events:iB([iV(r$()),iV(rW()),iV(r1())])})}));(y=V||(V={}))[y.HighlightFirst=0]="HighlightFirst",y[y.HighlightNone=1]="HighlightNone";var yX=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold(function(){return{type:o,hotspot:e,overrides:r}},function(t){return{type:o,hotspot:e,overrides:r,layouts:t}})},yY=function(t,n,e,o,r,i,u){var a=(0,t.fetch)(o).map(n),c=y$(o,t);return a.map(function(t){return t.bind(function(t){return tw.from(gn.sketch(tp(tp({},i.menu()),{uid:i4(""),data:t,highlightImmediately:u===V.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();s9.position(o,n,{anchor:e}),lx.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();s9.position(o,e,{anchor:{type:"submenu",item:n}}),lx.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();s9.position(r,n,{anchor:e}),tM(o,function(t){s9.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})})},onEscape:function(){return mB.focus(o),lx.close(r),tw.some(!0)}})))})})},yq=function(t,n,e,o,r,i,u){var a=yX(t,e);return yY(t,n,a,e,o,r,u).map(function(t){return t.fold(function(){lx.isOpen(o)&&lx.close(o)},function(t){lx.cloak(o),lx.open(o,t),i(o)}),o})},yK=function(t,n,e,o,r,i){var u=yj.getCoupled(e,"sandbox");return(lx.isOpen(u)?function(t,n,e,o,r,i,u){return lx.close(o),yM.pure(o)}:yq)(t,n,e,u,o,r,i)},yJ=function(t,n,e){var o,r=fP.getCurrent(n).getOr(n),i=eK(t.element);e?eE(r.element,"min-width",i+"px"):(o=r.element,eq.set(o,i))},y$=function(t,n){return t.getSystem().getByUid(n.uid+"-"+yW()).map(function(t){return function(){return oh.value(t)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return oh.error(Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(t)}})})},yQ=function(t){lx.getState(t).each(function(t){gn.repositionMenus(t)})},yZ=function(t,n,e){var o=u$(),r=y$(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:lU.augment(t.sandboxBehaviours,[lH.config({store:{mode:"memory",initialValue:n}}),lx.config({onOpen:function(r,i){var u=yX(t,n);o.link(n.element),t.matchWidth&&yJ(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return uQ(e,o)||uQ(n,o)},getAttachPoint:function(){return r().getOrDie()}}),fP.config({find:function(t){return lx.getState(t).bind(function(t){return fP.getCurrent(t)})}}),a9.config({channels:tp(tp({},lO({isExtraPart:td})),lT({doReposition:yQ}))})])}},y0=function(t){yQ(yj.getCoupled(t,"sandbox"))},y1=function(){return[rh("sandboxClasses",[]),lU.field("sandboxBehaviours",[fP,a9,lx,lH])]},y2=tu([rn("dom"),rn("fetch"),ar("onOpen"),ai("onExecute"),rh("getHotspot",tw.some),rh("getAnchorOverrides",tu({})),c0(),lV("dropdownBehaviours",[mU,yj,mx,mB]),rn("toggleClass"),rh("eventOrder",{}),rs("lazySink"),rh("matchWidth",!1),rh("useMinWidth",!1),rs("role")].concat(y1())),y5=tu([fr({schema:[an()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),yG()]),y3=fI({name:"Dropdown",configFields:y2(),partFields:y5(),factory:function(t,n,e,o){var r,i=function(t){lx.getState(t).each(function(t){gn.highlightPrimary(t)})},u={expand:function(n){mU.isOn(n)||yK(t,ta,n,o,tr,V.HighlightNone).get(tr)},open:function(n){mU.isOn(n)||yK(t,ta,n,o,tr,V.HighlightFirst).get(tr)},isOpen:mU.isOn,close:function(n){mU.isOn(n)&&yK(t,ta,n,o,tr,V.HighlightFirst).get(tr)},repositionMenus:function(t){mU.isOn(t)&&y0(t)}},a=function(t,n){return iT(t),tw.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:lz(t.dropdownBehaviours,[mU.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),yj.config({others:{sandbox:function(n){return yZ(t,n,{onOpen:function(){return mU.on(n)},onClose:function(){return mU.off(n)}})}}}),mx.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){return y3.isOpen(t)?i(yj.getCoupled(t,"sandbox")):y3.open(t),tw.some(!0)},onEscape:function(t,n){return y3.isOpen(t)?(y3.close(t),tw.some(!0)):tw.none()}}),mB.config({})]),events:mW(tw.some(function(n){yK(t,ta,n,o,i,V.HighlightFirst).get(tr)})),eventOrder:tp(tp({},t.eventOrder),((r={})[io()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:u,domModification:{attributes:tp(tp({"aria-haspopup":"true"},t.role.fold(function(){return{}},function(t){return{role:t}})),"button"===t.dom.tag?{type:t7(t.dom,"attributes").bind(function(t){return t7(t,"type")}).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),y9=a1({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return iB([iM(r9(),tm)])},exhibit:function(){return ul({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),y4=iQ("color-input-change"),y6=iQ("color-swatch-change"),y8=iQ("color-picker-cancel"),y7=function(t,n,e){var o,r=yo.parts.field({factory:yC,inputClasses:["tox-textfield"],onSetValue:function(t){return yz.run(t).get(tr)},inputBehaviours:aZ([fJ.config({disabled:n.providers.isDisabled}),vd(),yi.config({}),yz.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return ee(t.element)},notify:{onValid:function(t){var n=lH.getValue(t);i_(t,y4,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=lH.getValue(t);if(0===n.length)return yM.pure(oh.value(!0));var e=nh.fromTag("span");eE(e,"background-color",n);var o=eF(e,"background-color").fold(function(){return oh.error("blah")},function(t){return oh.value(n)});return yM.pure(o)}}})]),selectOnFocus:!1}),i=t.label.map(function(t){return yl(t,n.providers)}),u=function(t,n){i_(t,y6,{value:n})},a=g_((o={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[aI,aF,aH]},onLtr:function(){return[aF,aI,aH]}},components:[],fetch:bh(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){a.getOpt(t).each(function(t){"custom"===n?e.colorPicker(function(n){n.fold(function(){return iO(t,y8)},function(n){u(t,n),bu(n)})},"#ffffff"):"remove"===n?u(t,""):u(t,n)})}},y3.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:aZ([vm.button(n.providers.isDisabled),vd(),y9.config({}),yi.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(t){return yM.nu(function(t){return o.fetch(t)}).map(function(e){return tw.from(bU(oC(bS(iQ("menu-value"),e,function(n){o.onItemAction(t,n)},o.columns,o.presets,he.CLOSE_ON_EXECUTE,td,n.providers),{movement:bC(o.columns,o.presets)})))})},parts:{menu:hy(!1,1,o.presets)}})));return yo.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:i.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,a.asSpec()]}]),fieldBehaviours:aZ([mT("form-field-events",[iI(y4,function(n,e){a.getOpt(n).each(function(t){eE(t.element,"background-color",e.event.color)}),i_(n,yf,{name:t.name})}),iI(y6,function(t,n){yo.getField(t).each(function(e){lH.setValue(e,n.event.value),fP.getCurrent(t).each(mB.focus)})}),iI(y8,function(t,n){yo.getField(t).each(function(n){fP.getCurrent(t).each(mB.focus)})})])])})},xt=fi({schema:[rn("dom")],name:"label"}),xn=function(t){return fi({name:""+t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold(function(){return{}},function(t){return{events:iB([iR(rL(),function(n,e,o){return t(n,o)},[n]),iR(rW(),function(n,e,o){return t(n,o)},[n]),iR(rG(),function(n,e,o){o.mouseIsDown.get()&&t(n,o)},[n])])}})}})},xe=xn("top-left"),xo=xn("top"),xr=xn("top-right"),xi=xn("right"),xu=xn("bottom-right"),xa=xn("bottom"),xc=xn("bottom-left"),xs=xn("left"),xl=fo({name:"thumb",defaults:tu({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:iB([iP(rL(),t,"spectrum"),iP(rz(),t,"spectrum"),iP(rU(),t,"spectrum"),iP(rW(),t,"spectrum"),iP(rG(),t,"spectrum"),iP(rY(),t,"spectrum")])}}}),xf=fo({schema:[o7("mouseIsDown",function(){return rO(!1)})],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map(function(o){return n.setValueFrom(e,t,o)})};return{behaviours:aZ([mx.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),mB.config({})]),events:iB([iI(rL(),e),iI(rz(),e),iI(rW(),e),iI(rG(),function(n,o){t.mouseIsDown.get()&&e(n,o)})])}}}),xd=tu("slider.change.value"),xm=function(t){var n=t.event.raw;return -1!==n.type.indexOf("touch")?void 0!==n.touches&&1===n.touches.length?tw.some(n.touches[0]).map(function(t){return ej(t.clientX,t.clientY)}):tw.none():void 0!==n.clientX?tw.some(n).map(function(t){return ej(t.clientX,t.clientY)}):tw.none()},xg=function(t){return t.model.minX},xp=function(t){return t.model.minY},xh=function(t){return t.model.minX-1},xv=function(t){return t.model.minY-1},xb=function(t){return t.model.maxX},xy=function(t){return t.model.maxY},xx=function(t){return t.model.maxX+1},xw=function(t){return t.model.maxY+1},xS=function(t,n,e){return n(t)-e(t)},xk=function(t){return xS(t,xb,xg)},xC=function(t){return xS(t,xy,xp)},xO=function(t){return xk(t)/2},x_=function(t){return xC(t)/2},xT=function(t){return t.stepSize},xE=function(t){return t.snapToGrid},xD=function(t){return t.snapStart},xA=function(t){return t.rounded},xB=function(t,n){return void 0!==t[n+"-edge"]},xM=function(t){return xB(t,"left")},xF=function(t){return xB(t,"right")},xI=function(t){return xB(t,"top")},xR=function(t){return xB(t,"bottom")},xN=function(t){return t.model.value.get()},xP=function(t){return{x:t}},xH=function(t){return{y:t}},xV=function(t,n){return{x:t,y:n}},xL=function(t,n){i_(t,xd(),{value:n})},xz=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},xU=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},xj=function(t,n,e){return Math.max(n,Math.min(e,t))},xW=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(r>d)return p;var h=xj((Math.min(d,Math.max(r,f))-f)/m*o+n,g,p);return u&&h>=n&&h<=e?a.fold(function(){return xj(n+Math.round((h-n)/i)*i,n-1,e+1)},function(t){return Math.max(t,t+Math.min(Math.floor((e-t)/i),Math.floor((h-t)/i)+Math.round((h-t)%i/i))*i)}):c?Math.round(h):h},xG=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:l:(r-n)/o*c},xX="right",xY="bottom",xq="left",xK=function(t){return t.element.dom.getBoundingClientRect()},xJ=function(t,n){return t[n]},x$=function(t){return xJ(xK(t),xq)},xQ=function(t){return xJ(xK(t),xX)},xZ=function(t){return xJ(xK(t),"top")},x0=function(t){return xJ(xK(t),xY)},x1=function(t){return xJ(xK(t),"width")},x2=function(t){return xJ(xK(t),"height")},x5=function(t,n,e){return(t+n)/2-e},x3=function(t,n){var e=xK(t),o=xK(n);return x5(xJ(e,xq),xJ(e,xX),xJ(o,xq))},x9=function(t,n){var e=xK(t),o=xK(n);return x5(xJ(e,"top"),xJ(e,xY),xJ(o,"top"))},x4=function(t,n){i_(t,xd(),{value:n})},x6=function(t){return{x:t}},x8=function(t,n,e){return xW({min:xg(n),max:xb(n),range:xk(n),value:e,step:xT(n),snap:xE(n),snapStart:xD(n),rounded:xA(n),hasMinEdge:xM(n),hasMaxEdge:xF(n),minBound:x$(t),maxBound:xQ(t),screenRange:x1(t)})},x7=function(t,n,e){var o=(t>0?xU:xz)(xN(e).x,xg(e),xb(e),xT(e));return x4(n,x6(o)),tw.some(o)},wt=function(t){return function(n,e){return x7(t,n,e).map(tm)}},wn=function(t,n,e,o,r){var i=x1(t),u=o.bind(function(n){return tw.some(x3(n,t))}).getOr(0),a=r.bind(function(n){return tw.some(x3(n,t))}).getOr(i);return xG({min:xg(n),max:xb(n),range:xk(n),value:e,hasMinEdge:xM(n),hasMaxEdge:xF(n),minBound:x$(t),minOffset:0,maxBound:xQ(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a})},we=function(t,n,e,o,r,i){var u=wn(n,i,e,o,r);return x$(n)-x$(t)+u},wo=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=x8(t,n,e);return x4(t,x6(o)),o},setToMin:function(t,n){x4(t,x6(xg(n)))},setToMax:function(t,n){x4(t,x6(xb(n)))},findValueOfOffset:x8,getValueFromEvent:function(t){return xm(t).map(function(t){return t.left})},findPositionOfValue:we,setPositionFromValue:function(t,n,e,o){var r=xN(e),i=we(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=eK(n.element)/2;eE(n.element,"left",i-u+"px")},onLeft:wt(-1),onRight:wt(1),onUp:tw.none,onDown:tw.none,edgeActions:{"top-left":tw.none(),top:tw.none(),"top-right":tw.none(),right:tw.some(function(t,n){xL(t,xP(xx(n)))}),"bottom-right":tw.none(),bottom:tw.none(),"bottom-left":tw.none(),left:tw.some(function(t,n){xL(t,xP(xh(n)))})}}),wr=function(t,n){i_(t,xd(),{value:n})},wi=function(t){return{y:t}},wu=function(t,n,e){return xW({min:xp(n),max:xy(n),range:xC(n),value:e,step:xT(n),snap:xE(n),snapStart:xD(n),rounded:xA(n),hasMinEdge:xI(n),hasMaxEdge:xR(n),minBound:xZ(t),maxBound:x0(t),screenRange:x2(t)})},wa=function(t,n,e){var o=(t>0?xU:xz)(xN(e).y,xp(e),xy(e),xT(e));return wr(n,wi(o)),tw.some(o)},wc=function(t){return function(n,e){return wa(t,n,e).map(tm)}},ws=function(t,n,e,o,r){var i=x2(t),u=o.bind(function(n){return tw.some(x9(n,t))}).getOr(0),a=r.bind(function(n){return tw.some(x9(n,t))}).getOr(i);return xG({min:xp(n),max:xy(n),range:xC(n),value:e,hasMinEdge:xI(n),hasMaxEdge:xR(n),minBound:xZ(t),minOffset:0,maxBound:x0(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a})},wl=function(t,n,e,o,r,i){var u=ws(n,i,e,o,r);return xZ(n)-xZ(t)+u},wf=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=wu(t,n,e);return wr(t,wi(o)),o},setToMin:function(t,n){wr(t,wi(xp(n)))},setToMax:function(t,n){wr(t,wi(xy(n)))},findValueOfOffset:wu,getValueFromEvent:function(t){return xm(t).map(function(t){return t.top})},findPositionOfValue:wl,setPositionFromValue:function(t,n,e,o){var r=xN(e),i=wl(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=eL(n.element)/2;eE(n.element,"top",i-u+"px")},onLeft:tw.none,onRight:tw.none,onUp:wc(-1),onDown:wc(1),edgeActions:{"top-left":tw.none(),top:tw.some(function(t,n){xL(t,xH(xv(n)))}),"top-right":tw.none(),right:tw.none(),"bottom-right":tw.none(),bottom:tw.some(function(t,n){xL(t,xH(xw(n)))}),"bottom-left":tw.none(),left:tw.none()}}),wd=function(t,n){i_(t,xd(),{value:n})},wm=function(t,n){return{x:t,y:n}},wg=function(t,n,e,o){var r=t>0?xU:xz,i=n?xN(o).x:r(xN(o).x,xg(o),xb(o),xT(o));return wd(e,wm(i,n?r(xN(o).y,xp(o),xy(o),xT(o)):xN(o).y)),tw.some(i)},wp=function(t,n){return function(e,o){return wg(t,n,e,o).map(tm)}},wh=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=wm(x8(t,n,e.left),wu(t,n,e.top));return wd(t,o),o},setToMin:function(t,n){wd(t,wm(xg(n),xp(n)))},setToMax:function(t,n){wd(t,wm(xb(n),xy(n)))},getValueFromEvent:function(t){return xm(t)},setPositionFromValue:function(t,n,e,o){var r=xN(e),i=we(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=wl(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=eK(n.element)/2,c=eL(n.element)/2;eE(n.element,"left",i-a+"px"),eE(n.element,"top",u-c+"px")},onLeft:wp(-1,!1),onRight:wp(1,!1),onUp:wp(-1,!0),onDown:wp(1,!0),edgeActions:{"top-left":tw.some(function(t,n){xL(t,xV(xh(n),xv(n)))}),top:tw.some(function(t,n){xL(t,xV(xO(n),xv(n)))}),"top-right":tw.some(function(t,n){xL(t,xV(xx(n),xv(n)))}),right:tw.some(function(t,n){xL(t,xV(xx(n),x_(n)))}),"bottom-right":tw.some(function(t,n){xL(t,xV(xx(n),xw(n)))}),bottom:tw.some(function(t,n){xL(t,xV(xO(n),xw(n)))}),"bottom-left":tw.some(function(t,n){xL(t,xV(xh(n),xw(n)))}),left:tw.some(function(t,n){xL(t,xV(xh(n),x_(n)))})}}),wv=fI({name:"Slider",configFields:[rh("stepSize",1),rh("onChange",tr),rh("onChoose",tr),rh("onInit",tr),rh("onDragStart",tr),rh("onDragEnd",tr),rh("snapToGrid",!1),rh("rounded",!0),rs("snapStart"),re("model",o8("mode",{x:[rh("minX",0),rh("maxX",100),o7("value",function(t){return rO(t.mode.minX)}),rn("getInitialValue"),ac("manager",wo)],y:[rh("minY",0),rh("maxY",100),o7("value",function(t){return rO(t.mode.minY)}),rn("getInitialValue"),ac("manager",wf)],xy:[rh("minX",0),rh("maxX",100),rh("minY",0),rh("maxY",100),o7("value",function(t){return rO({x:t.mode.minX,y:t.mode.minY})}),rn("getInitialValue"),ac("manager",wh)]})),lV("sliderBehaviours",[mx,lH]),o7("mouseIsDown",function(){return rO(!1)})],partFields:[xt,xs,xi,xo,xa,xe,xr,xc,xu,xl,xf],factory:function(t,n,e,o){var r,i=function(n){return fy(n,t,"thumb")},u=function(n){return fy(n,t,"spectrum")},a=function(n){return fb(n,t,"left-edge")},c=function(n){return fb(n,t,"right-edge")},s=function(n){return fb(n,t,"top-edge")},l=function(n){return fb(n,t,"bottom-edge")},f=t.model,d=f.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:l,getSpectrum:u})},g=function(t,n){f.value.set(n);var e=i(t);m(t,e)},p=function(n,e){g(n,e);var o=i(n);return t.onChange(n,o,e),tw.some(!0)},h=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&fb(n,t,"thumb").each(function(e){var o=f.value.get();t.onChoose(n,e,o)})},v=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},b=function(n,e){e.stop(),t.onDragEnd(n,i(n)),h(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:lz(t.sliderBehaviours,[mx.config({mode:"special",focusIn:function(n){return fb(n,t,"spectrum").map(mx.focusIn).map(tm)}}),lH.config({store:{mode:"manual",getValue:function(t){return f.value.get()}}}),a9.config({channels:((r={})[lk()]={onReceive:h},r)})]),events:iB([iI(xd(),function(t,n){p(t,n.event.value)}),iz(function(n,e){var o=f.getInitialValue();f.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,f.value.get())}),iI(rL(),v),iI(rU(),b),iI(rW(),v),iI(rY(),b)]),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),wb=iQ("rgb-hex-update"),wy=iQ("slider-update"),wx=iQ("palette-update"),ww=function(t,n){var e=wv.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=wv.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return wv.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:tu({y:0})},components:[e,o],sliderBehaviours:aZ([mB.config({})]),onChange:function(t,n,e){i_(t,wy,{value:e})}})},wS="form",wk=[lV("formBehaviours",[lH])],wC=function(t){return"<alloy.field."+t+">"},wO=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:lz(t.formBehaviours,[lH.config({store:{mode:"manual",getValue:function(n){return t5(fw(n,t),function(t,n){return t().bind(function(t){var e,o;return e=fP.getCurrent(t),o=Error("Cannot find a current component to extract the value from for form part '"+n+"': "+iK(t.element)),e.fold(function(){return oh.error(o)},oh.value)}).map(lH.getValue)})},setValue:function(n,e){t2(e,function(e,o){fb(n,t,o).each(function(t){fP.getCurrent(t).each(function(t){lH.setValue(t,e)})})})}}})]),apis:{getField:function(n,e){return fb(n,t,e).bind(fP.getCurrent)}}}},w_={getField:ui(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var n,e={field:function(t,e){return n.push(t),fm(wS,wC(t),e)},record:tu(n=[])},o=t(e);return fD(wS,wk,tB(e.record(),function(t){return fo({name:t,pname:wC(t)})}),wO,o)}},wT=iQ("valid-input"),wE=iQ("invalid-input"),wD=iQ("validating-input"),wA="colorcustom.rgb.",wB=function(t,n,e,o){var r=function(e,o,r,i,u){var a=t(wA+"range");return{dom:{tag:"div",attributes:{role:"presentation"}},components:[yo.parts.label({dom:{tag:"label",innerHtml:r,attributes:{"aria-label":i}}}),yo.parts.field({data:u,factory:yC,inputAttributes:tp({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:aZ([yz.config({invalidClass:n("invalid"),notify:{onValidate:function(t){i_(t,wD,{type:o})},onValid:function(t){i_(t,wT,{type:o,value:lH.getValue(t)})},onInvalid:function(t){i_(t,wE,{type:o,value:lH.getValue(t)})}},validator:{validate:function(n){var o=e(lH.getValue(n))?oh.value(!0):oh.error(t("aria.input.invalid"));return yM.pure(o)},validateOnLoad:!1}}),yi.config({})]),onSetValue:function(t){yz.isInvalid(t)&&yz.run(t).get(tr)}})].concat("hex"!==o?[yo.parts["aria-descriptor"]({text:a})]:[])}},i=function(t,n){var e=vj(n);return w_.getField(t,"hex").each(function(n){mB.isFocused(n)||lH.setValue(t,{hex:e.value})}),e},u=function(t,n){var e=n.red,o=n.green,r=n.blue;lH.setValue(t,{red:e,green:o,blue:r})},a=g_({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each(function(t){eE(t.element,"background-color","#"+n.value)})};return fF({factory:function(){var s={red:rO(tw.some(255)),green:rO(tw.some(255)),blue:rO(tw.some(255)),hex:rO(tw.some("ffffff"))},l=function(t,n){var e=vQ(n);u(t,e),m(e)},f=function(t){return s[t].get()},d=function(t,n){s[t].set(n)},m=function(t){var n=t.red,e=t.green,o=t.blue;d("red",tw.some(n)),d("green",tw.some(e)),d("blue",tw.some(o))},g=function(t,n){var e=n.event;"hex"!==e.type?d(e.type,tw.none()):o(t)},p=function(t,n){e(t);var o=vP(n);d("hex",tw.some(n));var r=vQ(o);u(t,r),m(r),i_(t,wb,{hex:o}),c(t,o)},h=function(t,n,e){var o=parseInt(e,10);d(n,tw.some(o)),f("red").bind(function(t){return f("green").bind(function(n){return f("blue").map(function(e){return vK(t,n,e,1)})})}).each(function(n){var e=i(t,n);i_(t,wb,{hex:e}),c(t,e)})},v=function(t,n){var e=n.event;"hex"===e.type?p(t,e.value):h(t,e.type,e.value)},b=function(n){return{label:t(wA+n+".label"),description:t(wA+n+".description")}},y=b("red"),x=b("green"),w=b("blue"),S=b("hex");return oC(w_.sketch(function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",yo.sketch(r(vJ,"red",y.label,y.description,255))),e.field("green",yo.sketch(r(vJ,"green",x.label,x.description,255))),e.field("blue",yo.sketch(r(vJ,"blue",w.label,w.description,255))),e.field("hex",yo.sketch(r(vL,"hex",S.label,S.description,"ffffff"))),a.asSpec()],formBehaviours:aZ([yz.config({invalidClass:n("form-invalid")}),mT("rgb-form-events",[iI(wT,v),iI(wE,g),iI(wD,g)])])}}),{apis:{updateHex:function(t,n){lH.setValue(t,{hex:n.value}),l(t,n),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},wM=function(t,n){var e=wv.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=wv.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},i=function(t,n){r(t.components()[0].element.dom,v1(v$(v3(n,100,100))))},u=function(t,n){var e=v9(vQ(n));wv.setValue(t,{x:e.saturation,y:100-e.value})};return fF({factory:function(t){var i=tu({x:0,y:0}),u=aZ([fP.config({find:tw.some}),mB.config({})]);return wv.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:function(t,n,e){i_(t,wx,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,v1(v2))},sliderBehaviours:u})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){i(n,e)},setThumb:function(t,n,e){u(n,e)}},extraApis:{}})},wF={self:function(){return fP.config({find:tw.some})},memento:function(t){return fP.config({find:t.getOpt})},childAt:function(t){return fP.config({find:function(n){return ei(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})}},wI={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},wR=function(t){return wI[t]},wN=tinymce.util.Tools.resolve("tinymce.Resource"),wP=tinymce.util.Tools.resolve("tinymce.util.Tools"),wH=oU([rh("preprocess",ta),rh("postprocess",ta)]),wV=function(t,n,e){return lH.config(oC({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},wL=function(t,n,e){return wV(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)})},wz={memento:function(t,n){var e=o4("RepresentingConfigs.memento processors",wH,n);return lH.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=lH.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);lH.setValue(i,r)}}})},withElement:wL,withComp:wV,domValue:function(t){return wL(t,uB,uM)},domHtml:function(t){return wL(t,iX,iY)},memory:function(t){return lH.config({store:{mode:"memory",initialValue:t}})}},wU=function(t,n){var e=wP.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return tR(tQ(t),function(t){return tE(e,function(n){return nf(t.name.toLowerCase(),"."+n.toLowerCase())})})},wj=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){tM(t,function(t){t(n,e)})}},r=function(t,n){fJ.isDisabled(t)||u(t,n.event.raw.dataTransfer.files)},i=function(t,n){u(t,n.event.raw.target.files)},u=function(e,o){lH.setValue(e,wU(o,n)),i_(e,yf,{name:t.name})},a=g_({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:aZ([mT("input-file-events",[iV(r1()),iV(ii())])])});return ya(t.label.map(function(t){return yl(t,n)}),yo.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:aZ([wz.memory([]),wF.self(),fJ.config({}),mU.config({toggleClass:"dragenter",toggleOnExecute:!1}),mT("dropzone-events",[iI("dragenter",o([e,mU.toggle])),iI("dragleave",o([e,mU.toggle])),iI("dragover",e),iI("drop",o([e,r])),iI(r0(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},gC.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:aZ([yi.config({}),vm.button(n.isDisabled),vd()])})]}]}}}}),["tox-form__group--stretched"],[])},wW=iQ("alloy-fake-before-tabstop"),wG=iQ("alloy-fake-after-tabstop"),wX=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:aZ([mB.config({ignore:!0}),yi.config({})])}},wY=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[wX([wW]),t,wX([wG])],behaviours:aZ([wF.childAt(1)])}},wq=function(t,n){i_(t,r$(),{raw:{which:9,shiftKey:n}})},wK=function(t,n){var e=n.element;uE(e,wW)?wq(t,!0):uE(e,wG)&&wq(t,!1)},wJ=function(t){return bG(t,["."+wW,"."+wG].join(","),td)},w$=!(n0().browser.isIE()||n0().browser.isEdge()),wQ=function(t){var n=rO("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)ex(e.element,"srcdoc",o);else{ex(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}},wZ=function(t,n){var e=w$&&t.sandboxed,o=tp(tp({},t.label.map(function(t){return{title:t}}).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=wQ(e);return ya(t.label.map(function(t){return yl(t,n)}),yo.parts.field({factory:{sketch:function(t){return wY({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:aZ([yi.config({}),mB.config({}),wz.withComp(tw.none(),r.getValue,r.setValue)])})}}}),["tox-form__group--stretched"],[])},w0=function(t,n){return w5(document.createElement("canvas"),t,n)},w1=function(t){var n=w0(t.width,t.height);return w2(n).drawImage(t,0,0),n},w2=function(t){return t.getContext("2d")},w5=function(t,n,e){return t.width=n,t.height=e,t},w3=function(t){return t.naturalWidth||t.width},w9=function(t){return t.naturalHeight||t.height},w4=function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return tw.none();for(var o=e[1],r=n[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(l+1024,u),d=Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return tw.some(new Blob(c,{type:o}))},w6=function(t,n,e){var o;return(n=n||"image/png",tn(HTMLCanvasElement.prototype.toBlob))?new yT(function(o,r){t.toBlob(function(t){t?o(t):r()},n,e)}):(o=t.toDataURL(n,e),new yT(function(t,n){w4(o).fold(function(){n("uri is not base64: "+o)},t)}))},w8=function(t){URL.revokeObjectURL(t.src)},w7=function(t,n,e){var o=tu(n.type),r=tu(e),i=function(n,e){return t.then(function(t){var o;return o=(o=n)||"image/png",t.toDataURL(o,e)})};return{getType:o,toBlob:function(){return yT.resolve(n)},toDataURL:r,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return w6(t,n,e)})},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(w1)}}},St=function(t,n){return w6(t,n).then(function(n){return w7(yT.resolve(t),n,t.toDataURL())})},Sn=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},Se=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},So=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],Sr=function(t,n){for(var e,o=[],r=Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(var u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},Si=function(t,n){return t.toCanvas().then(function(e){return Su(e,t.getType(),n)})},Su=function(t,n,e){var o=w2(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),St(t,n)},Sa=function(t,n,e){var o=w2(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height);return i=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=(o(l+p-i,0,s-1)*c+o(f+h-i,0,c-1))*4,b=e[p*r+h];d+=u[v]*b,m+=u[v+1]*b,g+=u[v+2]*b}var y=(l*c+f)*4;a[y]=o(d,0,255),a[y+1]=o(m,0,255),a[y+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),St(t,n)},Sc=function(t){return function(n,e){return Si(n,t(Se(),e))}},Ss=(x=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return Si(t,x)}),Sl=Sc(function(t,n){return Sr(t,[1,0,0,0,n=Sn(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}),Sf=Sc(function(t,n){var e;return Sr(t,[(e=(n=100*Sn(n,-1,1))<0?127+n/100*127:127*(e=0==(e=n%1)?So[n]:So[Math.floor(n)]*(1-e)+So[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),Sd=function(t,n,e,o){var r,i,u,a;return Si(t,(r=Se(),i=n,u=e,a=o,Sr(r,[i=Sn(i,0,2),0,0,0,0,0,u=Sn(u,0,2),0,0,0,0,0,a=Sn(a,0,2),0,0,0,0,0,1,0,0,0,0,0,1])))},Sm=(w=[0,-1,0,-1,5,-1,0,-1,0],function(t){return t.toCanvas().then(function(n){return Sa(n,t.getType(),w)})}),Sg=(S=function(t,n,e){for(var o=w2(t),r=Array(256),i=0;i<r.length;i++)r[i]=255*Math.pow(i/255,1-e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),St(t,n)},function(t,n){return t.toCanvas().then(function(e){return S(e,t.getType(),n)})}),Sp=function(t,n,e){var o=w3(t),r=w9(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=Sh(t,i,u);return a?c.then(function(t){return Sp(t,n,e)}):c},Sh=function(t,n,e){return new yT(function(o){var r=w3(t),i=w9(t),u=Math.floor(r*n),a=Math.floor(i*e),c=w0(u,a);w2(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)})},Sv=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n);return Math.ceil(Math.round(t*e)/e)},Sb=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=Sv(Math.abs(r*a)+Math.abs(i*u)),s=Sv(Math.abs(r*u)+Math.abs(i*a)),l=w0(c,s),f=w2(l);return f.translate(c/2,s/2),f.rotate(o),f.drawImage(t,-r/2,-i/2),St(l,n)},Sy=function(t,n,e){var o=w0(t.width,t.height),r=w2(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),St(o,n)},Sx=function(t,n,e,o,r,i){var u=w0(r,i);return w2(u).drawImage(t,-e,-o),St(u,n)},Sw=function(t){return Ss(t)},SS=function(t){return Sm(t)},Sk=function(t,n){return Sg(t,n)},SC=function(t,n){return Sl(t,n)},SO=function(t,n){return Sf(t,n)},S_=function(t,n){return t.toCanvas().then(function(e){return Sy(e,t.getType(),n)})},ST=function(t,n){return t.toCanvas().then(function(e){return Sb(e,t.getType(),n)})},SE=function(t,n,e){return pO(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},SD=function(t,n){return SE(t,n,[])},SA=function(t,n){return SE(t,n,[mO.config({})])},SB=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:aZ([mO.config({})])}},SM=iQ("toolbar.button.execute"),SF=((L={})[io()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],L),SI=iQ("update-menu-text"),SR=iQ("update-menu-icon"),SN=function(t,n,e){var o=rO(tr),r=t.text.map(function(t){return g_(SB(t,n,e.providers))}),i=t.icon.map(function(t){return g_(SA(t,e.providers.icons))}),u=function(t,n){var e=lH.getValue(t);return mB.focus(e),i_(e,"keydown",{raw:n.event.raw}),y3.close(e),tw.some(!0)},a=t.role.fold(function(){return{}},function(t){return{role:t}}),c=t.tooltip.fold(function(){return{}},function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}}),s=pO("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons);return g_(y3.sketch(tp(tp(tp({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(tB(t.classes,function(t){return n+"--"+t})),attributes:tp({},c)},components:no([i.map(function(t){return t.asSpec()}),r.map(function(t){return t.asSpec()}),tw.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:aZ(tv(tv([],t.dropdownBehaviours,!0),[vm.button(function(){return t.disabled||e.providers.isDisabled()}),vd(),y9.config({}),mO.config({}),mT("dropdown-events",[vp(t,o),vh(t,o)]),mT("menubutton-update-display-text",[iI(SI,function(t,n){r.bind(function(n){return n.getOpt(t)}).each(function(t){mO.set(t,[uL(e.providers.translate(n.event.text))])})}),iI(SR,function(t,n){i.bind(function(n){return n.getOpt(t)}).each(function(t){mO.set(t,[SA(n.event.icon,e.providers.icons)])})})])],!1)),eventOrder:oC(SF,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:aZ([mx.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:hy(!1,t.columns,t.presets)},fetch:function(n){return yM.nu(ts(t.fetch,n))}}))).asSpec()},SP=function(t){return"separator"===t.type},SH={type:"separator"},SV=function(t,n){var e=tP(t,function(t,e){return Y(e)?""===e?t:"|"===e?t.length>0&&!SP(t[t.length-1])?t.concat([SH]):t:nt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])},[]);return e.length>0&&SP(e[e.length-1])&&e.pop(),e},SL=function(t,n){var e=Sz(t.getSubmenuItems(),n),o=oC(e.menus,rB(t.value,e.items)),r=oC(e.expansions,rB(t.value,t.value));return{item:t,menus:o,expansions:r}},Sz=function(t,n){return tN(SV(Y(t)?t.split(" "):t,n),function(t,e){var o,r=nt(o=SP(e)?e:oC({value:t7(e,"value").getOrThunk(function(){return iQ("generated-menu-item")})},e),"getSubmenuItems")?SL(o,n):{item:o,menus:{},expansions:{}};return{menus:oC(t.menus,r.menus),items:[r.item].concat(t.items),expansions:oC(t.expansions,r.expansions)}},{menus:{},expansions:{},items:[]})},SU=function(t,n,e,o){var r=iQ("primary-menu"),i=Sz(t,e.shared.providers.menuItems());if(0===i.items.length)return tw.none();var u=bz(r,i.items,n,e,o),a=oC(t5(i.menus,function(t,o){return bz(o,t,n,e,!1)}),rB(r,u));return tw.from(gn.tieredData(r,a,i.expansions))},Sj=function(t){return{isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)},setActive:function(n){var e=t.element;n?(uO(e,"tox-tbtn--enabled"),ex(e,"aria-pressed",!0)):(uT(e,"tox-tbtn--enabled"),eO(e,"aria-pressed"))},isActive:function(){return uE(t.element,"tox-tbtn--enabled")}}},SW=function(t,n,e,o){return SN({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch(function(t){o(SU(t,he.CLOSE_ON_EXECUTE,e,!1))})},onSetup:t.onSetup,getApi:Sj,columns:1,presets:"normal",classes:[],dropdownBehaviours:[yi.config({})]},n,e.shared)},SG=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold(function(){return{}},function(t){return{action:t}}),a=oC(tp({buttonBehaviours:aZ([vm.button(function(){return t.disabled||i.isDisabled()}),vd(),yi.config({}),mT("button press",[iF("click"),iF("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),{dom:o});return oC(a,{components:r})},SX=function(t,n,e,o){void 0===o&&(o=[]);var r=t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({}),i=no([t.icon.map(function(t){return SD(t,e.icons)})]);return SG(t,n,o,{tag:"button",classes:["tox-tbtn"],attributes:r},i,e)},SY=function(t,n,e,o){void 0===o&&(o=[]);var r=SX(t,tw.some(n),e,o);return gC.sketch(r)},Sq=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map(function(t){return SD(t,e.icons)}):tw.none(),a=u.isSome()?no([u]):[],c=u.isSome()?{}:{innerHtml:i},s=tv(tv(tv(tv([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0);return SG(t,n,o,tp(tp({tag:"button",classes:s},c),{attributes:{title:i}}),a,e)},SK=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=Sq(t,tw.some(n),e,o,r);return gC.sketch(i)},SJ=function(t,n){return function(e){"custom"===n?i_(e,yg,{name:t,value:{}}):"submit"===n?iO(e,yp):"cancel"===n?iO(e,ym):console.error("Unknown button type: ",n)}},S$=function(t,n,e){if("menu"===n){var o,r=g_(SW(tp(tp({},t),{onSetup:function(n){return n.setDisabled(t.disabled),tr},fetch:(o=t.items,function(t){t(tB(o,function(t){var n=t.text.fold(function(){return{}},function(t){return{text:t}});return tp(tp({type:t.type,active:!1},n),{onAction:function(n){var o=!n.isActive();n.setActive(o),t.storage.set(o),e.shared.getSink().each(function(n){r.getOpt(n).each(function(n){a8(n.element),i_(n,yg,{name:t.name,value:t.storage.get()})})})},onSetup:function(n){n.setActive(t.storage.get())}})}))})}),"tox-tbtn",e,tw.none()));return r.asSpec()}if("custom"===n||"cancel"===n||"submit"===n){var i=SJ(t.name,n);return SK(tp(tp({},t),{borderless:!1}),i,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},SQ=function(t,n){var e=SJ(t.name,"custom");return ya(tw.none(),yo.parts.field(tp({factory:gC},Sq(t,tw.some(e),n,[wz.memory(""),wF.self()]))),[],[])},SZ=tu([rh("field1Name","field1"),rh("field2Name","field2"),au("onLockedChange"),ae(["lockClass"]),rh("locked",!1),lU.field("coupledFieldBehaviours",[fP,lH])]),S0=function(t,n){return fo({factory:yo,name:t,overrides:function(t){return{fieldBehaviours:aZ([mT("coupled-input-behaviour",[iI(rZ(),function(e){fb(e,t,n).bind(fP.getCurrent).each(function(n){fb(e,t,"lock").each(function(o){mU.isOn(o)&&t.onLockedChange(e,n,o)})})})])])}}})},S1=tu([S0("field1","field2"),S0("field2","field1"),fo({factory:gC,schema:[rn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:aZ([mU.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),S2=fI({name:"FormCoupledInputs",configFields:SZ(),partFields:S1(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:lU.augment(t.coupledFieldBehaviours,[fP.config({find:tw.some}),lH.config({store:{mode:"manual",getValue:function(n){var e,o=fk(n,t,["field1","field2"]);return(e={})[t.field1Name]=lH.getValue(o.field1()),e[t.field2Name]=lH.getValue(o.field2()),e},setValue:function(n,e){var o=fk(n,t,["field1","field2"]);nn(e,t.field1Name)&&lH.setValue(o.field1(),e[t.field1Name]),nn(e,t.field2Name)&&lH.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return fb(n,t,"field1")},getField2:function(n){return fb(n,t,"field2")},getLock:function(n){return fb(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),S5=function(t){var n,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=t.value.toFixed((n=t.unit)in e?e[n]:1);return -1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit},S3=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return oh.error(t);var e=parseFloat(n[1]),o=n[2];return oh.value({value:e,unit:o})},S9=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return nt(e,t)};return t.unit===n?tw.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?tw.some(t.value):tw.some(t.value/e[t.unit]*e[n]):tw.none()},S4=function(t){return tw.none()},S6=function(t,n){var e=S4,o=iQ("ratio-event"),r=function(t){return pO(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=S2.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||n.isDisabled()}}),vd(),yi.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return yo.parts.field({factory:yC,inputClasses:["tox-textfield"],inputBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||n.isDisabled()}}),vd(),yi.config({}),mT("size-input-events",[iI(rK(),function(t,n){i_(t,o,{isField1:e})}),iI(r0(),function(n,e){i_(n,yf,{name:t.name})})])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=S2.parts.field1(u([yo.parts.label(c("Width")),a(!0)])),l=S2.parts.field2(u([yo.parts.label(c("Height")),a(!1)]));return S2.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,l,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){S3(lH.getValue(t)).each(function(t){e(t).each(function(t){lH.setValue(n,S5(t))})})},coupledFieldBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){S2.getField1(t).bind(yo.getField).each(fJ.disable),S2.getField2(t).bind(yo.getField).each(fJ.disable),S2.getLock(t).each(fJ.disable)},onEnabled:function(t){S2.getField1(t).bind(yo.getField).each(fJ.enable),S2.getField2(t).bind(yo.getField).each(fJ.enable),S2.getLock(t).each(fJ.enable)}}),vd(),mT("size-input-events2",[iI(o,function(t,n){var o=n.event.isField1,r=o?S2.getField1(t):S2.getField2(t),i=o?S2.getField2(t):S2.getField1(t),u=r.map(lH.getValue).getOr(""),a=i.map(lH.getValue).getOr("");e=ni(S3(u).toOptional(),S3(a).toOptional(),function(t,n){return S9(t,n.unit).map(function(t){return n.value/t}).map(function(t){var e;return e=n.unit,function(n){return S9(n,e).map(function(n){return{value:n*t,unit:e}})}}).getOr(S4)}).getOr(S4)})])])})},S8={undo:tu(iQ("undo")),redo:tu(iQ("redo")),zoom:tu(iQ("zoom")),back:tu(iQ("back")),apply:tu(iQ("apply")),swap:tu(iQ("swap")),transform:tu(iQ("transform")),tempTransform:tu(iQ("temp-transform")),transformApply:tu(iQ("transform-apply"))},S7={formActionEvent:yg,saveState:tu("save-state"),disable:tu("disable"),enable:tu("enable")},kt=function(t,n){var e=function(t,e,o,r){return g_(SK({name:t,text:t,disabled:o,primary:r,icon:tw.none(),borderless:!1},e,n))},o=function(t,e,o,r){return g_(SY({name:t,icon:tw.some(t),tooltip:tw.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(fJ)&&fJ.disable(e)})},i=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(fJ)&&fJ.enable(e)})},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=function(t,n,e){i_(t,n,e)},c=function(t){return iO(t,S7.disable())},s=function(t){return iO(t,S7.enable())},l=function(t,n){c(t),a(t,S8.transform(),{transform:n}),s(t)},f=function(t,n){c(t),a(t,S8.tempTransform(),{transform:n}),s(t)},d=function(t){return function(){q.getOpt(t).each(function(t){mO.set(t,[Y])})}},m=function(t,n){c(t),a(t,S8.transformApply(),{transform:n,swap:d(t)}),s(t)},g=function(){return e("Back",function(t){return a(t,S8.back(),{swap:d(t)})},!1,!1)},p=function(){return g_({dom:{tag:"div",classes:["tox-spacer"]},behaviours:aZ([fJ.config({})])})},h=function(){return e("Apply",function(t){return a(t,S8.apply(),{swap:d(t)})},!0,!0)},v=[g(),p(),e("Apply",function(n){m(n,function(n){var e,o,r,i,u,a=t.getRect();return e=n,o=a.x,r=a.y,i=a.w,u=a.h,e.toCanvas().then(function(t){return Sx(t,e.getType(),o,r,i,u)})}),t.hideCrop()},!1,!0)],b=b7.sketch({dom:u,components:v.map(function(t){return t.asSpec()}),containerBehaviours:aZ([mT("image-tools-crop-buttons-events",[iI(S7.disable(),function(t,n){r(v,t)}),iI(S7.enable(),function(t,n){i(v,t)})])])}),y=g_(S6({name:"size",label:tw.none(),constrain:!0,disabled:!1},n)),x=[g(),p(),y,p(),e("Apply",function(t){y.getOpt(t).each(function(n){var e=lH.getValue(n),o=parseInt(e.width,10),r=parseInt(e.height,10);m(t,function(t){var n,e,i;return n=t,e=o,i=r,n.toCanvas().then(function(t){return Sp(t,e,i).then(function(t){return St(t,n.getType())})})})})},!1,!0)],w=b7.sketch({dom:u,components:x.map(function(t){return t.asSpec()}),containerBehaviours:aZ([mT("image-tools-resize-buttons-events",[iI(S7.disable(),function(t,n){r(x,t)}),iI(S7.enable(),function(t,n){i(x,t)})])])}),S=function(t,n){return function(e){return t(e,n)}},k=S(S_,"h"),C=S(S_,"v"),O=S(ST,-90),_=S(ST,90),T=function(t,n){f(t,n)},E=[g(),p(),o("flip-horizontally","Flip horizontally",function(t){T(t,k)},!1),o("flip-vertically","Flip vertically",function(t){T(t,C)},!1),o("rotate-left","Rotate counterclockwise",function(t){T(t,O)},!1),o("rotate-right","Rotate clockwise",function(t){T(t,_)},!1),p(),h()],D=b7.sketch({dom:u,components:E.map(function(t){return t.asSpec()}),containerBehaviours:aZ([mT("image-tools-fliprotate-buttons-events",[iI(S7.disable(),function(t,n){r(E,t)}),iI(S7.enable(),function(t,n){i(E,t)})])])}),A=function(t,e,o,r,i){var u=wv.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=wv.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=wv.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return g_(wv.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:tu({x:r})},components:[u,a,c],sliderBehaviours:aZ([mB.config({})]),onChoose:e}))},B=function(t,n,e,o,a){var c,s,f,d,m,p=(c=t,s=n,f=e,d=o,m=a,[g(),A(c,function(t,n,e){l(t,S(s,e.x/100))},f,d,m),h()]);return b7.sketch({dom:u,components:p.map(function(t){return t.asSpec()}),containerBehaviours:aZ([mT("image-tools-filter-panel-buttons-events",[iI(S7.disable(),function(t,n){r(p,t)}),iI(S7.enable(),function(t,n){i(p,t)})])])})},M=[g(),p(),h()],F=b7.sketch({dom:u,components:M.map(function(t){return t.asSpec()})}),I=B("Brightness",SC,-100,0,100),R=B("Contrast",SO,-100,0,100),N=B("Gamma",Sk,-100,0,100),P=function(t){return A(t,function(t,n,e){var o=H.getOpt(t),r=L.getOpt(t),i=V.getOpt(t);o.each(function(n){r.each(function(e){i.each(function(o){var r=lH.getValue(n).x/100,i=lH.getValue(o).x/100,u=lH.getValue(e).x/100;l(t,function(t){return Sd(t,r,i,u)})})})})},0,100,200)},H=P("R"),V=P("G"),L=P("B"),z=[g(),H,V,L,h()],U=b7.sketch({dom:u,components:z.map(function(t){return t.asSpec()})}),j=function(t,n,e){return function(o){a(o,S8.swap(),{transform:n,swap:function(){q.getOpt(o).each(function(n){mO.set(n,[t]),e(n)})}})}},W=tw.some(SS),G=tw.some(Sw),X=[o("crop","Crop",j(b,tw.none(),function(n){t.showCrop()}),!1),o("resize","Resize",j(w,tw.none(),function(n){y.getOpt(n).each(function(n){var e=t.getMeasurements(),o=e.width,r=e.height;lH.setValue(n,{width:o,height:r})})}),!1),o("orientation","Orientation",j(D,tw.none(),tr),!1),o("brightness","Brightness",j(I,tw.none(),tr),!1),o("sharpen","Sharpen",j(F,W,tr),!1),o("contrast","Contrast",j(R,tw.none(),tr),!1),o("color-levels","Color levels",j(U,tw.none(),tr),!1),o("gamma","Gamma",j(N,tw.none(),tr),!1),o("invert","Invert",j(F,G,tr),!1)],Y=b7.sketch({dom:u,components:X.map(function(t){return t.asSpec()})}),q=g_(b7.sketch({dom:{tag:"div"},components:[Y],containerBehaviours:aZ([mO.config({})])}));return{memContainer:q,getApplyButton:function(t){return q.getOpt(t).map(function(t){var n=t.components()[0];return n.components()[n.components().length-1]})}}},kn=tinymce.util.Tools.resolve("tinymce.geom.Rect"),ke=tinymce.util.Tools.resolve("tinymce.util.Observable"),ko=tinymce.util.Tools.resolve("tinymce.util.VK"),kr=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight);return{width:r<u?i:r,height:a<n(e.offsetHeight,o.offsetHeight)?c:a}},ki=function(t){if(tt(t.changedTouches))for(var n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]},ku=0,ka={create:function(t,n,e,o,r){var i,u,a,c=[],s="tox-",l=s+"crid-"+ku++,f=nh.fromDom(o),d=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],m=["top","right","bottom","left"],g=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},p=function(n,o,r,i){var u=o.x+r*n.deltaX,a=o.y+i*n.deltaY,c=Math.max(20,o.w+r*n.deltaW),s=Math.max(20,o.h+i*n.deltaH),l=t=kn.clamp({x:u,y:a,w:c,h:s},e,"move"===n.name);l=g(e,l),y.fire("updateRect",{rect:l}),b(l)},h=function(t){var e=function(t,n){uK(f,"#"+l+"-"+t).each(function(t){eD(t,{left:n.x+"px",top:n.y+"px",width:Math.max(0,n.w)+"px",height:Math.max(0,n.h)+"px"})})};tM(d,function(n){uK(f,"#"+l+"-"+n.name).each(function(e){eD(e,{left:t.w*n.xMul+t.x+"px",top:t.h*n.yMul+t.y+"px"})})}),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},v=function(n){h(t=n)},b=function(t){var n;v((n=e,{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}))};ew(i=nh.fromTag("div"),{id:l,class:s+"croprect-container",role:"grid","aria-dropeffect":"execute"}),e3(f,i),tM(m,function(t){uK(f,"#"+l).each(function(n){var e=nh.fromTag("div");ew(e,{id:l+"-"+t,class:s+"croprect-block","data-mce-bogus":"all"}),eE(e,"display","none"),e3(n,e)})}),tM(d,function(t){uK(f,"#"+l).each(function(n){var e=nh.fromTag("div");ew(e,{id:l+"-"+t.name,"aria-label":t.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:t.label}),uD(e,[s+"croprect-handle",s+"croprect-handle-"+t.name]),eE(e,"display","none"),e3(n,e)})}),a=tB(d,function(n){var e,r,i,u,a,c,s,d,m,g,h,v,b,y,x,w,S,k;return r={document:o.ownerDocument,root:ef(f).dom,handle:l+"-"+n.name,start:function(){e=t},drag:function(t){p(n,e,t.deltaX,t.deltaY)}},g=[],h=[],v=(i=r.document)!==null&&void 0!==i?i:document,b=(u=r.root)!==null&&void 0!==u?u:v,y=nh.fromDom(v),x=nh.fromDom(b.getElementById((a=r.handle)!==null&&void 0!==a?a:l)),w=function(t){var n=t.raw,e=kr(v);ki(n),t.prevent(),s=n.button,d=n.screenX,m=n.screenY;var o=eB(x,"cursor");eD(c=nh.fromTag("div",v),{position:"absolute",top:"0",left:"0",width:e.width+"px",height:e.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:o}),e3(eb(y),c),h.push(c_(y,"mousemove",S),c_(y,"touchmove",S),c_(y,"mouseup",k),c_(y,"touchend",k)),r.start(n)},S=function(t){var n=t.raw;if(ki(n),n.button!==s)return k(t);n.deltaX=n.screenX-d,n.deltaY=n.screenY-m,t.prevent(),r.drag(n)},k=function(t){ki(t.raw),tM(h,function(t){return t.unbind()}),h=[],e7(c),r.stop&&r.stop(t.raw)},g.push(c_(x,"mousedown",w),c_(x,"touchstart",w)),{destroy:function(){tM(h.concat(g),function(t){return t.unbind()}),h=[],g=[],tt(c)&&e7(c)}}}),h(t),u=function(t){ex(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")},c.push(c_(f,"focusin",u),c_(f,"focusout",u),c_(f,"keydown",function(n){tM(d,function(t){if(eS(n.target,"id")===l+"-"+t.name)return e=t,!1});var e,o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),p(e,o,r,i)};switch(n.raw.keyCode){case ko.LEFT:o(n,e,t,-10,0);break;case ko.RIGHT:o(n,e,t,10,0);break;case ko.UP:o(n,e,t,0,-10);break;case ko.DOWN:o(n,e,t,0,10);break;case ko.ENTER:case ko.SPACEBAR:n.prevent(),r()}}));var y=tp(tp({},ke),{toggleVisibility:function(t){var n=sE(f,tv(tv([],tB(d,function(t){return"#"+l+"-"+t.name}),!0),tB(m,function(t){return"#"+l+"-"+t}),!0).join(","));t?tM(n,function(t){return eN(t,"display")}):tM(n,function(t){return eE(t,"display","none")})},setClampRect:function(n){e=n,h(t)},setRect:v,getInnerRect:function(){return g(e,t)},setInnerRect:b,setViewPortRect:function(e){n=e,h(t)},destroy:function(){tM(a,function(t){return t.destroy()}),a=[],tM(c,function(t){return t.unbind()}),c=[]}});return y}},kc=function(t){var n=g_({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=rO(1),o=cC(),r=rO({x:0,y:0,w:1,h:1}),i=rO({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each(function(t){var u=e.get(),a=eK(t.element),c=eL(t.element),s=i.dom.naturalWidth*u,l=i.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};eD(i,m),n.getOpt(t).each(function(t){eD(t.element,m)}),o.run(function(t){var n=r.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})})})},a=function(t,n){s.getOpt(t).each(function(t){var o=eK(t.element),r=eL(t.element),i=Math.min(o/n.dom.naturalWidth,r/n.dom.naturalHeight);i>=1?e.set(1):e.set(i)})},c=function(t,n){var e,o=nh.fromTag("img");return ex(o,"src",n),(e=o.dom,new pz(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)})).then(function(){t.getSystem().isConnected()&&s.getOpt(t).map(function(t){var n=uz({element:o});mO.replaceAt(t,1,tw.some(n));var e=i.get(),c={x:0,y:0,w:o.dom.naturalWidth,h:o.dom.naturalHeight};i.set(c);var s=kn.inflate(c,-20,-20);r.set(s),(e.w!==c.w||e.h!==c.h)&&a(t,o),u(t,o)})})},s=g_(b7.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:aZ([mT("image-panel-crop-events",[iz(function(t){s.getOpt(t).each(function(t){var n=t.element.dom,i=ka.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,tr);i.toggleVisibility(!1),i.on("updateRect",function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)}),o.set(i)})}),iU(function(){o.clear()})])])}],containerBehaviours:aZ([mO.config({}),mT("image-panel-events",[iz(function(n){c(n,t)})])])}));return{memContainer:s,updateSrc:c,zoom:function(t,n){var o=e.get();e.set(n>0?Math.min(2,o+.1):Math.max(.1,o-.1)),s.getOpt(t).each(function(t){var n=t.components()[1].element;u(t,n)})},showCrop:function(){o.run(function(t){t.toggleVisibility(!0)})},hideCrop:function(){o.run(function(t){t.toggleVisibility(!1)})},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}},ks=function(t,n,e,o,r){return SY({name:t,icon:tw.some(n),disabled:e,tooltip:tw.some(t),primary:!1,borderless:!1},o,r)},kl=function(t,n){n?fJ.enable(t):fJ.disable(t)},kf=function(t){var n=g_(ks("Undo","undo",!0,function(t){i_(t,S8.undo(),{direction:1})},t)),e=g_(ks("Redo","redo",!0,function(t){i_(t,S8.redo(),{direction:1})},t));return{container:b7.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),ks("Zoom in","zoom-in",!1,function(t){i_(t,S8.zoom(),{direction:1})},t),ks("Zoom out","zoom-out",!1,function(t){i_(t,S8.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,o,r){n.getOpt(t).each(function(t){kl(t,o)}),e.getOpt(t).each(function(t){kl(t,r)})}}},kd=function(t){var n,e,o,r,i=rO(t),u=cO(),a=(n=[],e=-1,o=function(){return e>0},r=function(){return -1!==e&&e<n.length-1},{data:n,add:function(t){var o=n.splice(++e);return n.push(t),{state:t,removed:o}},undo:function(){if(o())return n[--e]},redo:function(){if(r())return n[++e]},canUndo:o,canRedo:r});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},l=function(t){URL.revokeObjectURL(t.url)},f=function(t){wP.each(t,l)},d=function(){u.on(l),u.clear()},m=function(t){var n=s(t);return c(n),f(a.add(n).removed),n.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:m,getTempState:function(){return u.get().getOrThunk(i.get)},updateTempState:function(t){var n=s(t);return d(),u.set(n),n.url},addTempState:function(t){var n=s(t);return u.set(n),n.url},applyTempState:function(t){return u.get().fold(tr,function(n){m(n.blob),t()})},destroyTempState:d,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}},km=function(t,n){var e=kd(t.currentState),o=function(t){var n=e.getHistoryStates();h.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),i_(t,S7.formActionEvent,{name:S7.saveState(),value:n.undoEnabled})},r=function(t){h.updateButtonUndoStates(t,!1,!1)},i=function(t){return t.toBlob()},u=function(t){i_(t,S7.formActionEvent,{name:S7.disable(),value:{}})},a=function(t){v.getApplyButton(t).each(function(t){fJ.enable(t)}),i_(t,S7.formActionEvent,{name:S7.enable(),value:{}})},c=function(t,n){return u(t),p.updateSrc(t,n)},s=function(t,n,e,r,s){var l;u(t),(l=n,new yT(function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(l)}).then(function(t){var n;return w7((n=l,new yT(function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),t(r)},a=function(){i(),e("Unable to load data of type "+n.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}).then(function(t){w8(t);var n=w0(w3(t),w9(t));return w2(n).drawImage(t,0,0),n})),l,t)})).then(e).then(i).then(r).then(function(n){return c(t,n)}).then(function(){o(t),s(),a(t)}).catch(function(n){console.log(n),t.getSystem().isConnected()&&a(t)})},l=function(t,n,o){s(t,e.getBlobState().blob,n,function(t){return e.updateTempState(t)},o)},f=function(t,n){s(t,e.getTempState().blob,n,function(t){return e.addTempState(t)},tr)},d=function(t,n,o){s(t,e.getBlobState().blob,n,function(n){var o=e.addBlobState(n);return m(t),o},o)},m=function(t){var n=e.getBlobState().url;return e.destroyTempState(),o(t),n},g=function(t){var n=m(t);c(t,n).then(function(n){a(t)})},p=kc(t.currentState.url),h=kf(n),v=kt(p,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[v.memContainer.asSpec(),p.memContainer.asSpec(),h.container],behaviours:aZ([lH.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),mT("image-tools-events",[iI(S8.undo(),function(t,n){c(t,e.undo()).then(function(n){a(t),o(t)})}),iI(S8.redo(),function(t,n){c(t,e.redo()).then(function(n){a(t),o(t)})}),iI(S8.zoom(),function(t,n){var e=n.event.direction;p.zoom(t,e)}),iI(S8.back(),function(t,n){g(t),(0,n.event.swap)(),p.hideCrop()}),iI(S8.apply(),function(t,n){e.applyTempState(function(){m(t),(0,n.event.swap)()})}),iI(S8.transform(),function(t,n){return l(t,n.event.transform,tr)}),iI(S8.tempTransform(),function(t,n){return f(t,n.event.transform)}),iI(S8.transformApply(),function(t,n){return d(t,n.event.transform,n.event.swap)}),iI(S8.swap(),function(t,n){r(t);var e=n.event.transform,o=n.event.swap;e.fold(function(){o()},function(n){l(t,n,o)})})]),wF.self()])}},kg=function(t){return!nt(t,"items")},kp="data-value",kh=function(t,n,e,o){return tB(e,function(e){return kg(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){lH.setValue(t,e.value),i_(t,yf,{name:n}),mB.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return kh(t,n,e.items,o)}}})},kv=function(t,n){return tZ(t,function(t){return kg(t)?nu(t.value===n,t):kv(t.items,n)})},kb=function(t,n){var e=n.shared.providers,o=tJ(t.items).filter(kg),r=t.label.map(function(t){return yl(t,e)}),i=yo.parts.field({dom:{},factory:{sketch:function(e){return SN({uid:e.uid,text:o.map(function(t){return t.text}),icon:tw.none(),tooltip:t.label,role:tw.none(),fetch:function(e,o){o(SU(kh(e,t.name,t.items,lH.getValue(e)),he.CLOSE_ON_EXECUTE,n,!1))},onSetup:tu(tr),getApi:tu({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[yi.config({}),lH.config({store:{mode:"manual",initialValue:o.map(function(t){return t.value}).getOr(""),getValue:function(t){return eS(t.element,kp)},setValue:function(n,e){kv(t.items,e).each(function(t){ex(n.element,kp,t.value),i_(n,SI,{text:t.text})})}}})]},"tox-listbox",n.shared)}}});return yo.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:tz([r.toArray(),[{dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]}]]),fieldBehaviours:aZ([fJ.config({disabled:tu(t.disabled),onDisabled:function(t){yo.getField(t).each(fJ.disable)},onEnabled:function(t){yo.getField(t).each(fJ.enable)}})])})},ky=fF({name:"HtmlSelect",configFields:[rn("options"),lV("selectBehaviours",[mB,lH]),rh("selectClasses",[]),rh("selectAttributes",{}),rs("data")],factory:function(t,n){var e=tB(t.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=t.data.map(function(t){return rB("initialValue",t)}).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:lz(t.selectBehaviours,[mB.config({}),lH.config({store:tp({mode:"manual",getValue:function(t){return uB(t.element)},setValue:function(n,e){tV(t.options,function(t){return t.value===e}).isSome()&&uM(n.element,e)}},o)})])}}}),kx=function(t,n){var e=tB(t.items,function(t){return{text:n.translate(t.text),value:t.value}}),o=t.label.map(function(t){return yl(t,n)}),r={dom:{tag:"div",classes:["tox-selectfield"]},components:tz([[yo.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:ky,selectBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||n.isDisabled()}}),yi.config({}),mT("selectbox-change",[iI(r0(),function(n,e){i_(n,yf,{name:t.name})})])])})],(t.size>1?tw.none():tw.some(pO("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons))).toArray()])};return yo.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:tz([o.toArray(),[r]]),fieldBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){yo.getField(t).each(fJ.disable)},onEnabled:function(t){yo.getField(t).each(fJ.enable)}}),vd()])})},kw=function(t,n){var e=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:tB(t.header,function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}})}]},{dom:{tag:"tbody"},components:tB(t.cells,function(t){return{dom:{tag:"tr"},components:tB(t,e)}})}],behaviours:aZ([yi.config({}),mB.config({})])}},kS=function(t,n){var e=t.label.map(function(t){return yl(t,n)}),o=[fJ.config({disabled:function(){return t.disabled||n.isDisabled()}}),vd(),mx.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return iO(t,yp),tw.some(!0)}}),mT("textfield-change",[iI(rZ(),function(n,e){i_(n,yf,{name:t.name})}),iI(it(),function(n,e){i_(n,yf,{name:t.name})})]),yi.config({})],r=t.validation.map(function(t){return yz.config({getRoot:function(t){return ee(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=lH.getValue(n),o=t.validator(e);return yM.pure(!0===o?oh.value(e):oh.error(o))},validateOnLoad:t.validateOnLoad}})}).toArray(),i=t.placeholder.fold(tu({}),function(t){return{placeholder:n.translate(t)}}),u=t.inputMode.fold(tu({}),function(t){return{inputmode:t}}),a=tp(tp({},i),u);return ya(e,yo.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:aZ(tz([o,r])),selectOnFocus:!1,factory:yC}),(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),[fJ.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){yo.getField(t).each(fJ.disable)},onEnabled:function(t){yo.getField(t).each(fJ.enable)}}),vd()])},kk=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return iB([iI(t.event,e),iU(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[iI(t,function(){return n.cancel()})]}).getOr([])))}}),kC=function(t){var n=rO(null);return ua({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},kO=Object.freeze({__proto__:null,throttle:kC,init:function(t){return t.stream.streams.state(t)}}),k_=a1({fields:[re("stream",o8("mode",{throttle:[rn("delay"),rh("stopEvent",!0),ac("streams",{setup:function(t,n){var e=t.stream,o=pA(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:kC})]})),rh("event","input"),rs("cancelEvent"),au("onStream")],name:"streaming",active:kk,state:kO}),kT=function(t,n,e){var o=lH.getValue(e);lH.setValue(n,o),kD(n)},kE=function(t,n){var e=t.element,o=uB(e),r=e.dom;"number"!==eS(e,"type")&&n(r,o)},kD=function(t){kE(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},kA=function(t,n){kE(t,function(t,e){return t.setSelectionRange(n,e.length)})},kB=function(t,n,e){if(!t.selectsOver)return tw.none();var o=lH.getValue(n),r=t.getDisplayText(o),i=lH.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?tw.some(function(){kT(t,n,e),kA(n,r.length)}):tw.none()},kM=tu("alloy.typeahead.itemexecute"),kF=tu([rs("lazySink"),rn("fetch"),rh("minChars",5),rh("responseTime",1e3),ar("onOpen"),rh("getHotspot",tw.some),rh("getAnchorOverrides",tu({})),rh("layouts",tw.none()),rh("eventOrder",{}),rC("model",{},[rh("getDisplayText",function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value}),rh("selectsOver",!0),rh("populateFromBrowse",!0)]),ar("onSetValue"),ai("onExecute"),ar("onItemExecute"),rh("inputClasses",[]),rh("inputAttributes",{}),rh("inputStyles",{}),rh("matchWidth",!0),rh("useMinWidth",!1),rh("dismissOnBlur",!0),ae(["openClass"]),rs("initialData"),lV("typeaheadBehaviours",[mB,lH,k_,mx,mU,yj]),o7("previewing",function(){return rO(!0)})].concat(yw()).concat(y1())),kI=tu([fr({schema:[an()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each(function(o){kB(t.model,o,e).fold(function(){return f4.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&kT(t.model,n,e)}),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map(function(t){return i_(t,kM(),{item:e}),!0})},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&kT(t.model,n,e)})}}}})]),kR=fI({name:"Typeahead",configFields:kF(),partFields:kI(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=yj.getCoupled(n,"sandbox");lx.isOpen(i)?fP.getCurrent(i).each(function(t){f4.getHighlighted(t).fold(function(){r(t)},function(){iA(i,t.element,"keydown",e)})}):yq(t,u(n),n,i,o,function(t){fP.getCurrent(t).each(r)},V.HighlightFirst).get(tr)},i=yS(t),u=function(t){return function(n){return n.map(function(n){var e=tU(t8(n.menus),function(t){return tR(t.items,function(t){return"item"===t.type})});return lH.getState(t).update(tB(e,function(t){return t.data})),n})}},a=[mB.config({}),lH.config({onSetValue:t.onSetValue,store:tp({mode:"dataset",getDataKey:function(t){return uB(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){uM(n.element,t.model.getDisplayText(e))}},t.initialData.map(function(t){return rB("initialValue",t)}).getOr({}))}),k_.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=yj.getCoupled(n,"sandbox");if(mB.isFocused(n)&&uB(n.element).length>=t.minChars){var i=fP.getCurrent(r).bind(function(t){return f4.getHighlighted(t).map(lH.getValue)});t.previewing.set(!0),yq(t,u(n),n,r,o,function(n){fP.getCurrent(r).each(function(n){i.fold(function(){t.model.selectsOver&&f4.highlightFirst(n)},function(t){f4.highlightBy(n,function(n){return lH.getValue(n).value===t.value}),f4.getHighlighted(n).orThunk(function(){return f4.highlightFirst(n),tw.none()})})})},V.HighlightFirst).get(tr)}},cancelEvent:ic()}),mx.config({mode:"special",onDown:function(t,n){return r(t,n,f4.highlightFirst),tw.some(!0)},onEscape:function(t){var n=yj.getCoupled(t,"sandbox");return lx.isOpen(n)?(lx.close(n),tw.some(!0)):tw.none()},onUp:function(t,n){return r(t,n,f4.highlightLast),tw.some(!0)},onEnter:function(n){var e=yj.getCoupled(n,"sandbox"),o=lx.isOpen(e);if(o&&!t.previewing.get())return fP.getCurrent(e).bind(function(t){return f4.getHighlighted(t)}).map(function(t){return i_(n,kM(),{item:t}),!0});var r=lH.getValue(n);return iO(n,ic()),t.onExecute(e,n,r),o&&lx.close(e),tw.some(!0)}}),mU.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),yj.config({others:{sandbox:function(n){return yZ(t,n,{onOpen:function(){return mU.on(n)},onClose:function(){return mU.off(n)}})}}}),mT("typeaheadevents",[iW(function(n){yK(t,u(n),n,o,tr,V.HighlightFirst).get(tr)}),iI(kM(),function(n,e){var o=yj.getCoupled(n,"sandbox");kT(t.model,n,e.event.item),iO(n,ic()),t.onItemExecute(n,o,e.event.item,lH.getValue(n)),lx.close(o),kD(n)})].concat(t.dismissOnBlur?[iI(r7(),function(t){var n=yj.getCoupled(t,"sandbox");cn(n.element).isNone()&&lx.close(n)})]:[]))];return{uid:t.uid,dom:yk(oC(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:tp(tp({},i),lz(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),kN=function(t){return tp(tp({},t),{toCached:function(){return kN(t.toCached())},bindFuture:function(n){return kN(t.bind(function(t){return t.fold(function(t){return yM.pure(oh.error(t))},function(t){return n(t)})}))},bindResult:function(n){return kN(t.map(function(t){return t.bind(n)}))},mapResult:function(n){return kN(t.map(function(t){return t.map(n)}))},mapError:function(n){return kN(t.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return t.map(function(t){return t.fold(n,e)})},withTimeout:function(n,e){return kN(yM.nu(function(o){var r=!1,i=setTimeout(function(){r=!0,o(oh.error(e()))},n);t.get(function(t){r||(clearTimeout(i),o(t))})}))}})},kP=function(t){return kN(yM.nu(t))},kH=function(t){return kN(yM.pure(oh.value(t)))},kV={nu:kP,wrap:kN,pure:kH,value:kH,error:function(t){return kN(yM.pure(oh.error(t)))},fromResult:function(t){return kN(yM.pure(t))},fromFuture:function(t){return kN(t.map(oh.value))},fromPromise:function(t){return kP(function(n){t.then(function(t){n(oh.value(t))},function(t){n(oh.error(t))})})}},kL={type:"separator"},kz=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:tr}},kU=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:tr}},kj=function(t,n){return tB(tR(n,function(n){return n.type===t}),kz)},kW=function(t,n){var e=t.toLowerCase();return tR(n,function(t){return ns((void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text).toLowerCase(),e)||ns(t.value.toLowerCase(),e)})},kG=function(t,n,e){var o=lH.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold(function(){return[]},function(n){var o=kW(r,tB(e.getHistory(t),function(t){return kU(t,t)}));return"file"===t?tP([o,kW(r,kj("header",n.targets)),kW(r,tz([tw.from(n.anchorTop).map(function(t){return kU("<top>",t)}).toArray(),kj("anchor",n.targets),tw.from(n.anchorBottom).map(function(t){return kU("<bottom>",t)}).toArray()]))],function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(kL,n)},[]):o})},kX=iQ("aria-invalid"),kY=function(t,n,e){var o,r,i,u,a=n.shared.providers,c=function(n){var o=lH.getValue(n);e.addToHistory(o.value,t.filetype)},s=yo.parts.field({factory:kR,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":kX,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=SU(kG(t.filetype,o,e),he.BUBBLE_TO_SANDBOX,n,!1);return yM.pure(r)},getHotspot:function(t){return p.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(yz)&&yz.run(t).get(tr)},typeaheadBehaviours:aZ(tz([e.getValidationHandler().map(function(n){return yz.config({getRoot:function(t){return ee(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){f.getOpt(t).each(function(t){ex(t.element,"title",a.translate(n))})}},validator:{validate:function(e){var o=lH.getValue(e);return kV.nu(function(e){n({type:t.filetype,url:o.value},function(t){"invalid"===t.status?e(oh.error(t.message)):e(oh.value(t.message))})})},validateOnLoad:!1}})}).toArray(),[fJ.config({disabled:function(){return t.disabled||a.isDisabled()}}),yi.config({}),mT("urlinput-events",tz(["file"===t.filetype?[iI(rZ(),function(n){i_(n,yf,{name:t.name})})]:[],[iI(r0(),function(n){i_(n,yf,{name:t.name}),c(n)}),iI(it(),function(n){i_(n,yf,{name:t.name}),c(n)})]]))]])),eventOrder:((u={})[rZ()]=["streaming","urlinput-events","invalidating"],u),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:hy(!1,1,"normal")},onExecute:function(t,n,e){i_(n,yp,{})},onItemExecute:function(n,e,o,r){c(n),i_(n,yf,{name:t.name})}}),l=t.label.map(function(t){return yl(t,a)}),f=g_((o="invalid",r=tw.some(kX),void 0===i&&(i=o),pO("warning",{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+o],attributes:tp({title:a.translate(i),"aria-live":"polite"},r.fold(function(){return{}},function(t){return{id:t}}))},a.icons))),d=g_({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),m=e.getUrlPicker(t.filetype),g=iQ("browser.url.event"),p=g_({dom:{tag:"div",classes:["tox-control-wrap"]},components:[s,d.asSpec()],behaviours:aZ([fJ.config({disabled:function(){return t.disabled||a.isDisabled()}})])}),h=g_(SK({name:t.name,icon:tw.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},function(t){return iO(t,g)},a,[],["tox-browse-url"]));return yo.sketch({dom:ys([]),components:l.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:tz([[p.asSpec()],m.map(function(){return h.asSpec()}).toArray()])}]),fieldBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||a.isDisabled()},onDisabled:function(t){yo.getField(t).each(fJ.disable),h.getOpt(t).each(fJ.disable)},onEnabled:function(t){yo.getField(t).each(fJ.enable),h.getOpt(t).each(fJ.enable)}}),vd(),mT("url-input-events",[iI(g,function(n){fP.getCurrent(n).each(function(e){var o=lH.getValue(e),r=tp({fieldname:t.name},o);m.each(function(o){o(r).get(function(o){lH.setValue(e,o),i_(n,yf,{name:t.name})})})})})])])})},kq=function(t,n){var e=lH.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),o=function(t){return t.element.dom.click(),tw.some(!0)},r=yo.parts.field({factory:{sketch:ta},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:aZ([wF.self(),fJ.config({disabled:function(){return t.disabled||n.isDisabled()}}),yi.config({}),mB.config({}),e,mx.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),mT("checkbox-events",[iI(r0(),function(n,e){i_(n,yf,{name:t.name})})])])}),i=yo.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:aZ([y9.config({})])}),u=function(t){return pO("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=g_({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return yo.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:aZ([fJ.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){yo.getField(t).each(fJ.disable)},onEnabled:function(t){yo.getField(t).each(fJ.enable)}}),vd()])})},kK=function(t){return function(n,e,o){return t7(e,"name").fold(function(){return t(e,o)},function(r){return n.field(r,t(e,o))})}},kJ={bar:kK(function(t,n){var e;return e=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:tB(t.items,e.interpreter)}}),collection:kK(function(t,n){return yx(t,n.shared.providers)}),alertbanner:kK(function(t,n){var e;return e=n.shared.providers,b7.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[gC.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:pw(t.icon,e.icons),attributes:{title:e.translate(t.iconTooltip)}},action:function(n){i_(n,yg,{name:"alert-banner",value:t.url})},buttonBehaviours:aZ([pk()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:e.translate(t.text)}}]})}),input:kK(function(t,n){var e;return e=n.shared.providers,kS({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:tw.none(),maximized:t.maximized},e)}),textarea:kK(function(t,n){var e;return e=n.shared.providers,kS({name:t.name,multiline:!0,label:t.label,inputMode:tw.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:tw.none(),maximized:t.maximized},e)}),label:kK(function(t,n){var e;return{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",innerHtml:(e=n.shared).providers.translate(t.label),classes:["tox-label"]}}].concat(tB(t.items,e.interpreter)),behaviours:aZ([wF.self(),mO.config({}),wz.domHtml(tw.none()),mx.config({mode:"acyclic"})])}}),iframe:(k=function(t,n){return wZ(t,n.shared.providers)},function(t,n,e){var o=oC(n,{source:"dynamic"});return kK(k)(t,o,e)}),button:kK(function(t,n){return SQ(t,n.shared.providers)}),checkbox:kK(function(t,n){return kq(t,n.shared.providers)}),colorinput:kK(function(t,n){return y7(t,n.shared,n.colorinput)}),colorpicker:kK(function(t){var n=function(t){return"tox-"+t},e=fF({name:"ColourPicker",configFields:[rn("dom"),rh("onValidHex",tr),rh("onInvalidHex",tr)],factory:function(t){var e,o,r,i=wB(wR,n,t.onValidHex,t.onInvalidHex),u=wM(wR,n),a={paletteRgba:rO(v2),paletteHue:rO(0)},c=g_(ww(wR,n)),s=g_(u.sketch({})),l=g_(i.sketch({})),f=function(t,n,e){s.getOpt(t).each(function(t){u.setHue(t,e)})},d=function(t,n){l.getOpt(t).each(function(t){i.updateHex(t,n)})},m=function(t,n){var e=vQ(t);a.paletteRgba.set(e),a.paletteHue.set(n)},g=function(t,n,e,o){m(n,e),tM(o,function(o){o(t,n,e)})};return{uid:t.uid,dom:t.dom,components:[s.asSpec(),c.asSpec(),l.asSpec()],behaviours:aZ([mT("colour-picker-events",[iI(wb,(e=[f,function(t,n,e){c.getOpt(t).each(function(t){wv.setValue(t,{y:100-e/360*100})})},function(t,n){s.getOpt(t).each(function(t){u.setThumb(t,n)})}],function(t,n){var o=n.event.hex,r=v9(vQ(o));g(t,o,r.hue,e)})),iI(wx,(o=[d],function(t,n){var e=n.event.value,r=a.paletteHue.get();g(t,v4(v3(r,e.x,100-e.y)),r,o)})),iI(wy,(r=[f,d],function(t,n){var e=(100-n.event.value.y)/100*360,o=v9(a.paletteRgba.get());g(t,v4(v3(e,o.saturation,o.value)),e,r)}))]),fP.config({find:function(t){return l.getOpt(t)}}),mx.config({mode:"acyclic"})])}}}),o=g_(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){i_(t,yg,{name:"hex-valid",value:!0})},onInvalidHex:function(t){i_(t,yg,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:aZ([lH.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return fP.getCurrent(n).bind(function(t){return lH.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);fP.getCurrent(r).fold(function(){console.log("Can not find form")},function(t){lH.setValue(t,{hex:tw.from(e[1]).getOr("")}),w_.getField(t,"hex").each(function(t){iO(t,rZ())})})}}}),wF.self()])}}),dropzone:kK(function(t,n){return wj(t,n.shared.providers)}),grid:kK(function(t,n){var e;return e=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:tB(t.items,e.interpreter)}}),listbox:kK(function(t,n){return kb(t,n)}),selectbox:kK(function(t,n){return kx(t,n.shared.providers)}),sizeinput:kK(function(t,n){return S6(t,n.shared.providers)}),urlinput:kK(function(t,n){return kY(t,n,n.urlinput)}),customeditor:kK(function(t){var n=cO(),e=g_({dom:{tag:t.tag}}),o=cO();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:aZ([mT("custom-editor-events",[iz(function(r){e.getOpt(r).each(function(e){(nt(t,"init")?t.init(e.element.dom):wN.load(t.scriptId,t.scriptUrl).then(function(n){return n(e.element.dom,t.settings)})).then(function(t){o.on(function(n){t.setValue(n)}),o.clear(),n.set(t)})})})]),lH.config({store:{mode:"manual",getValue:function(){return n.get().fold(function(){return o.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,e){n.get().fold(function(){o.set(e)},function(t){return t.setValue(e)})}}}),wF.self()]),components:[e.asSpec()]}}),htmlpanel:kK(function(t){return"presentation"===t.presets?b7.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):b7.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:aZ([yi.config({}),mB.config({})])})}),imagetools:kK(function(t,n){return km(t,n.shared.providers)}),table:kK(function(t,n){return kw(t,n.shared.providers)}),panel:kK(function(t,n){return{dom:{tag:"div",classes:t.classes},components:tB(t.items,n.shared.interpreter)}})},k$={field:function(t,n){return n}},kQ=function(t,n,e){var o=oC(e,{shared:{interpreter:function(n){return kZ(t,n,o)}}});return kZ(t,n,o)},kZ=function(t,n,e){return t7(kJ,n.type).fold(function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n},function(o){return o(t,n,e)})},k0={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},k1=function(t,n,e){var o={maxHeightFunction:cj()};return function(){return e()?{type:"node",root:ed(t()),node:tw.from(t()),bubble:cq(12,12,k0),layouts:{onRtl:function(){return[gg]},onLtr:function(){return[gm]}},overrides:o}:{type:"hotspot",hotspot:n(),bubble:cq(-12,12,k0),layouts:{onRtl:function(){return[aF]},onLtr:function(){return[aI]}},overrides:o}}},k2=function(t,n,e){var o=ve(t),r=function(){return nh.fromDom(t.getBody())},i=function(){return nh.fromDom(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:k1(i,n,u),banner:function(){return u()?{type:"node",root:ed(i()),node:tw.from(i()),layouts:{onRtl:function(){return[gp]},onLtr:function(){return[gp]}}}:{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[aH]},onLtr:function(){return[aH]}}}},cursor:function(){return{type:"selection",root:r(),getSelection:function(){var n=t.selection.getRng();return tw.some(sl.range(nh.fromDom(n.startContainer),n.startOffset,nh.fromDom(n.endContainer),n.endOffset))}}},node:function(t){return{type:"node",root:r(),node:t}}}},k5=function(t){var n=rO(vt(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}},k3=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],k9=function(t){return tP(t,function(t,n){if(nt(n,"items")){var e=k9(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(!(nt(n,"inline")||nt(n,"block")||nt(n,"selector")))return tp(tp({},t),{formats:t.formats.concat(n)});var o="custom-"+(Y(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}},{customFormats:[],formats:[]})},k4=function(t,n){var e=k9(n),o=function(n){tM(n,function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)})};return t.formatter?o(e.customFormats):t.on("init",function(){o(e.customFormats)}),e.formats},k6=function(t){return tw.from(t.getParam("style_formats")).filter(K).map(function(n){var e=k4(t,n);return t.getParam("style_formats_merge",!1,"boolean")?k3.concat(e):e}).getOr(k3)},k8=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return oC(t,o)},k7=function(t,n,e,o){var r=function(n){var r=Y(n.name)?n.name:iQ(n.title),i="custom-"+r,u=oC(n,{type:"formatter",format:i,isSelected:e(i),getStylePreview:o(i)});return t.formatter.register(r,u),u},i=function(t){return tB(t,function(t){var n=t0(t);if(nn(t,"items")){var u=i(t.items);return oC(oC(t,{type:"submenu"}),{getStyleItems:tu(u)})}return nn(t,"format")?k8(t,e,o):1===n.length&&tT(n,"title")?oC(t,{type:"separator"}):r(t)})};return i(n)},Ct=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?tw.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):tw.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?tU(n,o):[t.format]},r=rO([]),i=rO([]),u=rO([]),a=rO([]),c=rO(!1);return t.on("PreInit",function(u){var a=k6(t),c=k7(t,a,n,e);r.set(c),i.set(tU(c,o))}),t.on("addStyleModifications",function(r){var i=k7(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(tU(i,o))}),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}},Cn=wP.trim,Ce=function(t){return function(n){return!!tt(n)&&1===n.nodeType&&(n.contentEditable===t||n.getAttribute("data-mce-contenteditable")===t)}},Co=Ce("true"),Cr=Ce("false"),Ci=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},Cu=function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return Co(t)}return!1},Ca=function(t){return t.innerText||t.textContent},Cc=function(t){return t&&"A"===t.nodeName&&(t.id||t.name)!==void 0&&Cl(t)},Cs=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},Cl=function(t){return Cu(t)&&!Cr(t)},Cf=function(t){return Cs(t)&&Cl(t)},Cd=function(t){var n=t.id?t.id:iQ("h");return Ci("header",Ca(t),"#"+n,Cs(t)?parseInt(t.nodeName.substr(1),10):0,function(){t.id=n})},Cm=function(t){var n=t.id||t.name;return Ci("anchor",Ca(t)||"#"+n,"#"+n,0,tr)},Cg=function(t){return Cn(t.title).length>0},Cp={find:function(t){var n,e=(n=t,tB(sE(nh.fromDom(n),"h1,h2,h3,h4,h5,h6,a:not([href])"),function(t){return t.dom}));return tR(tB(tR(e,Cf),Cd).concat(tB(tR(e,Cc),Cm)),Cg)}},Ch="tinymce-url-history",Cv=function(t){return Y(t)&&/^https?/.test(t)},Cb=function(t){return q(t)&&t6(t,function(t){return!(K(t)&&t.length<=5&&tj(t,Cv))}).isNone()},Cy=function(){var t,n=v8.getItem(Ch);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+Ch+" was not valid JSON",t),{};throw t}return Cb(t)?t:(console.log("Local storage "+Ch+" was not valid format",t),{})},Cx=function(t){if(!Cb(t))throw Error("Bad format for history:\n"+JSON.stringify(t));v8.setItem(Ch,JSON.stringify(t))},Cw=function(t){return t7(Cy(),t).getOr([])},CS=function(t,n){if(Cv(t)){var e=Cy(),o=tR(t7(e,n).getOr([]),function(n){return n!==t});e[n]=[t].concat(o).slice(0,5),Cx(e)}},Ck=function(t){return!!t},CC=function(t){return t5(wP.makeMap(t,/[, ]/),Ck)},CO=function(t){return tw.from(t.getParam("file_picker_callback")).filter(tn)},C_=function(t){var n=tw.some(t.getParam("file_picker_types")).filter(Ck),e=tw.some(t.getParam("file_browser_callback_types")).filter(Ck),o=n.or(e).map(CC);return CO(t).fold(td,function(t){return o.fold(tm,function(t){return t0(t).length>0&&t})})},CT=function(t,n){var e=C_(t);return $(e)?e?CO(t):tw.none():e[n]?CO(t):tw.none()},CE=function(t){return tw.from(t).filter(Y).getOrUndefined()},CD=function(t,n,e){var o,r,i=rO(!1),u=k5(n),a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:pp.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return kZ(k$,t,a)},anchors:k2(n,e,u.isPositionedAtTop),header:u,getSink:function(){return oh.value(t)}},urlinput:{getHistory:Cw,addToHistory:CS,getLinkInformation:function(){return!1===n.getParam("typeahead_urls")?tw.none():tw.some({targets:Cp.find(n.getBody()),anchorTop:CE(n.getParam("anchor_top","#top")),anchorBottom:CE(n.getParam("anchor_bottom","#bottom"))})},getValidationHandler:function(){return tw.from(va(n))},getUrlPicker:function(t){return CT(n,t).map(function(e){return function(o){return yM.nu(function(r){var i=tp({filetype:t,fieldname:o.fieldname},tw.from(o.meta).getOr({}));e.call(n,function(t,n){if(!Y(t))throw Error("Expected value to be string");if(void 0!==n&&!q(n))throw Error("Expected meta to be a object");r({value:t,meta:n})},o.value,i)})}})}},styleselect:Ct(n),colorinput:(o=n,{colorPicker:function(t,n){bx(o)(t,n)},hasCustomColors:function(){return br(o)},getColors:function(){return bi(o)},getColorCols:function(){return bd(o)}}),dialog:(r=n,{isDraggableModal:function(){return r.getParam("draggable_modal",!1,"boolean")}}),isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},CA=function(t,n,e){var o=function(t,o){tM([n,e],function(n){n.broadcastEvent(t,o)})},r=function(t,o){tM([n,e],function(n){n.broadcastOn([t],o)})},i=function(t){return r(lw(),{target:t.target})},u=a6(),a=c_(u,"touchstart",i),c=c_(u,"touchmove",function(t){return o(il(),t)}),s=c_(u,"touchend",function(t){return o(id(),t)}),l=c_(u,"mousedown",i),f=c_(u,"mouseup",function(t){0===t.raw.button&&r(lk(),{target:t.target})}),d=function(t){return r(lw(),{target:nh.fromDom(t.target)})},m=function(t){0===t.button&&r(lk(),{target:nh.fromDom(t.target)})},g=function(){tM(t.editorManager.get(),function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})})},p=function(t){return o(im(),eQ(t))},h=function(t){r(lS(),{}),o(ig(),eQ(t))},v=function(){return r(lS(),{})},b=function(n){n.state&&r(lw(),{target:nh.fromDom(t.getContainer())})},y=function(t){r(lw(),{target:nh.fromDom(t.relatedTarget.getContainer())})};t.on("PostRender",function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("mousedown",g),t.on("ScrollWindow",p),t.on("ResizeWindow",h),t.on("ResizeEditor",v),t.on("AfterProgressState",b),t.on("DismissPopups",y)}),t.on("remove",function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("mousedown",g),t.off("ScrollWindow",p),t.off("ResizeWindow",h),t.off("ResizeEditor",v),t.off("AfterProgressState",b),t.off("DismissPopups",y),l.unbind(),a.unbind(),c.unbind(),s.unbind(),f.unbind()}),t.on("detach",function(){ls(n),ls(e),n.destroy(),e.destroy()})},CB=tu([rh("shell",!1),rn("makeItem"),rh("setupItem",tr),lU.field("listBehaviours",[mO])]),CM=tu([fi({name:"items",overrides:function(){return{behaviours:aZ([mO.config({})])}}})]),CF=fI({name:tu("CustomList")(),configFields:CB(),partFields:CM(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[mO.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:lz(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){(t.shell?tw.some(n):fb(n,t,"items")).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(o){var r=mO.contents(o),i=e.length,u=i-r.length,a=u>0?tD(u,function(){return t.makeItem()}):[];tM(r.slice(i),function(t){return mO.remove(o,t)}),tM(a,function(t){return mO.append(o,t)}),tM(mO.contents(o),function(o,r){t.setupItem(n,o,e[r],r)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),CI=tu([rn("dom"),rh("shell",!0),lV("toolbarBehaviours",[mO])]),CR=tu([fi({name:"groups",overrides:function(){return{behaviours:aZ([mO.config({})])}}})]),CN=fI({name:"Toolbar",configFields:CI(),partFields:CR(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[mO.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:lz(t.toolbarBehaviours,r.behaviours),apis:{setGroups:function(n,e){(t.shell?tw.some(n):fb(n,t,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){mO.set(t,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),CP=tu([]),CH=Object.freeze({__proto__:null,setup:tr,isDocked:td,getBehaviours:CP}),CV=function(t){return(ne(eF(t,"position"),"fixed")?tw.none():eo(t)).orThunk(function(){var n=nh.fromTag("span");return ee(t).bind(function(t){e3(t,n);var e=eo(n);return e7(n),e})})},CL=function(t){return CV(t).map(eX).getOrThunk(function(){return ej(0,0)})},Cz=r_.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),CU=function(t,n){var e=t.element;uO(e,n.transitionClass),uT(e,n.fadeOutClass),uO(e,n.fadeInClass),n.onShow(t)},Cj=function(t,n){var e=t.element;uO(e,n.transitionClass),uT(e,n.fadeInClass),uO(e,n.fadeOutClass),n.onHide(t)},CW=function(t,n,e){return tj(t,function(t){switch(t){case"bottom":return n.bottom<=e.bottom;case"top":return n.y>=e.y}})},CG=function(t,n){return n.getInitialPos().map(function(n){return ol(n.bounds.x,n.bounds.y,eK(t),eL(t))})},CX=function(t,n,e){e.setInitialPos({style:eI(t),position:eB(t,"position")||"static",bounds:n})},CY=function(t,n,e){return e.getInitialPos().bind(function(o){switch(e.clearInitialPos(),o.position){case"static":return tw.some(Cz.static());case"absolute":var r=CV(t).map(of).getOrThunk(function(){return of(ev())});return tw.some(Cz.absolute(co("absolute",t7(o.style,"left").map(function(t){return n.x-r.x}),t7(o.style,"top").map(function(t){return n.y-r.y}),t7(o.style,"right").map(function(t){return r.right-n.right}),t7(o.style,"bottom").map(function(t){return r.bottom-n.bottom}))));default:return tw.none()}})},Cq=function(t,n,e){var o=of(t);if(CW(e.getModes(),o,n))return tw.none();CX(t,o,e);var r=om(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return tw.some(Cz.fixed(co("fixed",tw.some(i),c?tw.some(u):tw.none(),tw.none(),c?tw.none():tw.some(a))))},CK=function(t,n,e){var o=t.element;return ne(eF(o,"position"),"fixed")?CG(o,e).filter(function(t){return CW(e.getModes(),t,n)}).bind(function(t){return CY(o,t,e)}):Cq(o,n,e)},CJ=function(t,n){var e=t.element;return CG(e,n).bind(function(t){return CY(e,t,n)})},C$=function(t,n,e){e.setDocked(!1),tM(["left","right","top","bottom","position"],function(n){return eN(t.element,n)}),n.onUndocked(t)},CQ=function(t,n,e,o){var r="fixed"===o.position;e.setDocked(r),cr(t.element,o),(r?n.onDocked:n.onUndocked)(t)},CZ=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each(function(n){n.lazyContext(t).each(function(i){var u=i.y<o.bottom&&i.bottom>o.y;u!==e.isVisible()&&(e.setVisible(u),r&&!u?(uD(t.element,[n.fadeOutClass]),n.onHide(t)):(u?CU:Cj)(t,n))})})},C0=function(t,n,e){var o=n.lazyViewport(t);e.isDocked()&&CZ(t,n,e,o),CK(t,o,e).each(function(r){r.fold(function(){return C$(t,n,e)},function(o){return CQ(t,n,e,o)},function(r){CZ(t,n,e,o,!0),CQ(t,n,e,r)})})},C1=function(t,n,e){var o=t.element;e.setDocked(!1),CJ(t,e).each(function(o){o.fold(function(){return C$(t,n,e)},function(o){return CQ(t,n,e,o)},tr)}),e.setVisible(!0),n.contextual.each(function(n){uA(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)}),C2(t,n,e)},C2=function(t,n,e){t.getSystem().isConnected()&&C0(t,n,e)},C5=function(t,n,e){e.isDocked()&&C1(t,n,e)},C3=Object.freeze({__proto__:null,refresh:C2,reset:C5,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),C9=Object.freeze({__proto__:null,events:function(t,n){return iB([iL(r5(),function(e,o){t.contextual.each(function(t){uE(e.element,t.transitionClass)&&(uA(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()})}),iI(im(),function(e,o){C2(e,t,n)}),iI(ig(),function(e,o){C5(e,t,n)})])}}),C4=a1({fields:[rp("contextual",[ro("fadeInClass"),ro("fadeOutClass"),ro("transitionClass"),ri("lazyContext"),ar("onShow"),ar("onShown"),ar("onHide"),ar("onHidden")]),rS("lazyViewport",om),rk("modes",["top","bottom"],oK),ar("onDocked"),ar("onUndocked")],name:"docking",active:C9,apis:C3,state:Object.freeze({__proto__:null,init:function(t){var n=rO(!1),e=rO(!0),o=cO(),r=rO(t.modes);return ua({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),C6=tu(iQ("toolbar-height-change")),C8={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},C7="tox-tinymce--toolbar-sticky-on",Ot="tox-tinymce--toolbar-sticky-off",On=function(t,n){var e=n8(n),o=e.dom.defaultView.innerHeight,r=on(e),i=nh.fromDom(t.elm),u=od(i),a=eL(i),c=u.y,s=eX(n),l=eL(n),f=s.top,d=f+l,m=2>Math.abs(f-r.top),g=2>Math.abs(d-(r.top+o));m&&c<d?oe(r.left,c-l,e):g&&c+a>f&&oe(r.left,c-o+a+l,e)},Oe=function(t,n){return tT(C4.getModes(t),n)},Oo=function(t){var n=t.element;ee(n).each(function(e){var o="padding-"+C4.getModes(t)[0];C4.isDocked(t)?(eE(n,"width",eK(e)+"px"),eE(e,o,ez(n)+(parseInt(eB(n,"margin-top"),10)||0)+(parseInt(eB(n,"margin-bottom"),10)||0)+"px")):(eN(n,"width"),eN(e,o))})},Or=function(t,n){n?(uT(t,C8.fadeOutClass),uD(t,[C8.transitionClass,C8.fadeInClass])):(uT(t,C8.fadeInClass),uD(t,[C8.fadeOutClass,C8.transitionClass]))},Oi=function(t,n){var e=nh.fromDom(t.getContainer());n?(uO(e,C7),uT(e,Ot)):(uO(e,Ot),uT(e,C7))},Ou=function(t,n){var e=n8(n);ct(e).filter(function(t){return!n9(n,t)}).filter(function(n){return n9(n,nh.fromDom(e.dom.body))||n6(t,n)}).each(function(){return a8(n)})},Oa=function(){var t;return[a9.config({channels:((t={})[C6()]={onReceive:Oo},t)})]},Oc=function(t,n){var e=cO(),o=n.getSink,r=function(t){o().each(function(n){return t(n.element)})},i=function(n){t.inline||Oo(n),Oi(t,C4.isDocked(n)),n.getSystem().broadcastOn([lS()],{}),o().each(function(t){return t.getSystem().broadcastOn([lS()],{})})},u=t.inline?[]:Oa();return tv([mB.config({}),C4.config({contextual:tp({lazyContext:function(n){var e=ez(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=of(nh.fromDom(o)),i=r.height-e,u=r.y+(Oe(n,"top")?0:e);return tw.some(ol(r.x,u,r.width,i))},onShow:function(){r(function(t){return Or(t,!0)})},onShown:function(t){r(function(t){return uA(t,[C8.transitionClass,C8.fadeInClass])}),e.get().each(function(n){Ou(t.element,n),e.clear()})},onHide:function(t){cn(t.element).orThunk(function(){return o().toOptional().bind(function(t){return cn(t.element)})}).fold(e.clear,e.set),r(function(t){return Or(t,!1)})},onHidden:function(){r(function(t){return uA(t,[C8.transitionClass])})}},C8),lazyViewport:function(n){var e=om(),o=t.getParam("toolbar_sticky_offset",0,"number"),r=e.y+(Oe(n,"top")?o:0),i=e.height-(Oe(n,"bottom")?o:0);return ol(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u,!0)},Os=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(C4.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(Oo)}),t.on("SkinLoaded",function(){e().each(function(t){C4.isDocked(t)?C4.reset(t):C4.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(C4.reset)})),t.on("AfterScrollIntoView",function(t){e().each(function(n){C4.refresh(n);var e=n.element;dR(e)&&On(t,e)})}),t.on("PostRender",function(){Oi(t,!1)})},isDocked:function(t){return t().map(C4.isDocked).getOr(!1)},getBehaviours:Oc}),Ol=oU([ro("type"),re("items",oW([oG([ro("name"),rc("items",oK)]),oK]))].concat(pJ)),Of=[rd("text"),rd("tooltip"),rd("icon"),ri("fetch"),rS("onSetup",function(){return tr})],Od=oU(tv([ro("type")],Of,!0)),Om=function(t){return o3("menubutton",Od,t)},Og=oU([ro("type"),rd("tooltip"),rd("icon"),rd("text"),rm("select"),ri("fetch"),rS("onSetup",function(){return tr}),rx("presets","normal",["normal","color","listpreview"]),rh("columns",1),ri("onAction"),ri("onItemAction")]),Op=fF({factory:function(t,n){var e={focus:mx.focusIn,setMenus:function(t,e){var o=tB(e,function(t){return SW(Om({type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}}).mapError(function(t){return o6(t)}).getOrDie(),"tox-mbtn",n.backstage,tw.some("menuitem"))});mO.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:aZ([mO.config({}),mT("menubar-events",[iz(function(n){t.onSetup(n)}),iI(rq(),function(t,n){uK(t.element,".tox-mbtn--active").each(function(e){uJ(n.event.target,".tox-mbtn").each(function(n){n9(e,n)||t.getSystem().getByDom(e).each(function(e){t.getSystem().getByDom(n).each(function(t){y3.expand(t),y3.close(e),mB.focus(t)})})})})}),iI(iy(),function(t,n){n.event.prevFocus.bind(function(n){return t.getSystem().getByDom(n).toOptional()}).each(function(e){n.event.newFocus.bind(function(n){return t.getSystem().getByDom(n).toOptional()}).each(function(t){y3.isOpen(e)&&(y3.expand(t),y3.close(e))})})})]),mx.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),tw.some(!0)}}),yi.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[rn("dom"),rn("uid"),rn("onEscape"),rn("backstage"),rh("onSetup",tr)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),Oh=function(t,n){return n.getAnimationRoot.fold(function(){return t.element},function(n){return n(t)})},Ov=function(t){return t.dimension.property},Ob=function(t,n){return t.dimension.getDimension(n)},Oy=function(t,n){uA(Oh(t,n),[n.shrinkingClass,n.growingClass])},Ox=function(t,n){uT(t.element,n.openClass),uO(t.element,n.closedClass),eE(t.element,Ov(n),"0px"),eP(t.element)},Ow=function(t,n){uT(t.element,n.closedClass),uO(t.element,n.openClass),eN(t.element,Ov(n))},OS=function(t,n,e,o){e.setCollapsed(),eE(t.element,Ov(n),Ob(n,t.element)),eP(t.element),Oy(t,n),Ox(t,n),n.onStartShrink(t),n.onShrunk(t)},Ok=function(t,n,e,o){var r=o.getOrThunk(function(){return Ob(n,t.element)});e.setCollapsed(),eE(t.element,Ov(n),r),eP(t.element);var i=Oh(t,n);uT(i,n.growingClass),uO(i,n.shrinkingClass),Ox(t,n),n.onStartShrink(t)},OC=function(t,n,e){var o=Ob(n,t.element);("0px"===o?OS:Ok)(t,n,e,tw.some(o))},OO=function(t,n,e){var o=Oh(t,n),r=uE(o,n.shrinkingClass),i=Ob(n,t.element);Ow(t,n);var u=Ob(n,t.element);(r?function(){eE(t.element,Ov(n),i),eP(t.element)}:function(){Ox(t,n)})(),uT(o,n.shrinkingClass),uO(o,n.growingClass),Ow(t,n),eE(t.element,Ov(n),u),e.setExpanded(),n.onStartGrow(t)},O_=function(t,n,e){return!0===uE(Oh(t,n),n.growingClass)},OT=function(t,n,e){return!0===uE(Oh(t,n),n.shrinkingClass)},OE=Object.freeze({__proto__:null,refresh:function(t,n,e){if(e.isExpanded()){eN(t.element,Ov(n));var o=Ob(n,t.element);eE(t.element,Ov(n),o)}},grow:function(t,n,e){e.isExpanded()||OO(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&OC(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&OS(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:O_,isShrinking:OT,isTransitioning:function(t,n,e){return O_(t,n)||OT(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?OC:OO)(t,n,e)},disableTransitions:Oy}),OD=Object.freeze({__proto__:null,exhibit:function(t,n,e){return n.expanded?ul({classes:[n.openClass],styles:{}}):ul({classes:[n.closedClass],styles:rB(n.dimension.property,"0px")})},events:function(t,n){return iB([iL(r5(),function(e,o){o.event.raw.propertyName===t.dimension.property&&(Oy(e,t),n.isExpanded()&&eN(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))})])}}),OA=a1({fields:[rn("closedClass"),rn("openClass"),rn("shrinkingClass"),rn("growingClass"),rs("getAnimationRoot"),ar("onShrunk"),ar("onStartShrink"),ar("onGrown"),ar("onStartGrow"),rh("expanded",!1),re("dimension",o8("property",{width:[ac("property","width"),ac("getDimension",function(t){return eK(t)+"px"})],height:[ac("property","height"),ac("getDimension",function(t){return eL(t)+"px"})]}))],name:"sliding",active:OD,apis:OE,state:Object.freeze({__proto__:null,init:function(t){var n=rO(t.expanded);return ua({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:ts(n.set,!1),setExpanded:ts(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),OB="container",OM=[lV("slotBehaviours",[])],OF=function(t){return"<alloy.field."+t+">"},OI=function(t,n){var e=function(n){return fS(t)},o=function(n,e){return function(o,r){return fb(o,t,r).map(function(t){return n(t,r)}).getOr(e)}},r=function(t,n){return"true"!==eS(t.element,"aria-hidden")},i=o(r,!1),u=o(function(t,n){if(r(t)){var e=t.element;eE(e,"display","none"),ex(e,"aria-hidden","true"),i_(t,ix(),{name:n,visible:!1})}}),a=function(t,n){tM(n,function(n){return u(t,n)})},c=o(function(t,n){if(!r(t)){var e=t.element;eN(e,"display"),eO(e,"aria-hidden"),i_(t,ix(),{name:n,visible:!0})}});return{uid:t.uid,dom:t.dom,components:n,behaviours:lL(t.slotBehaviours),apis:{getSlotNames:e,getSlot:function(n,e){return fb(n,t,e)},isShowing:i,hideSlot:u,hideAllSlots:function(t){return a(t,e())},showSlot:c}}},OR=t5({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},function(t){return ui(t)}),ON=tp(tp({},OR),{sketch:function(t){var n,e={slot:function(t,e){return n.push(t),fm(OB,OF(t),e)},record:tu(n=[])},o=t(e);return fD(OB,OM,tB(e.record(),function(t){return fo({name:t,pname:OF(t)})}),OI,o)}}),OP=oU([rd("icon"),rd("tooltip"),rS("onShow",tr),rS("onHide",tr),rS("onSetup",function(){return tr})]),OH=function(t){var n=t.ui.registry.getAll().sidebars;tM(t0(n),function(e){var o=n[e],r=function(){return ne(tw.from(t.queryCommandValue("ToggleSidebar")),e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})})},OV=function(t){return{element:function(){return t.element.dom}}},OL=function(t,n){var e=tB(t0(n),function(t){var e=o9(o3("sidebar",OP,n[t]));return{name:t,getApi:OV,onSetup:e.onSetup,onShow:e.onShow,onHide:e.onHide}});return tB(e,function(n){var o=rO(tr);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:hz.unnamedEvents([vp(n,o),vh(n,o),iI(ix(),function(t,n){var o=n.event;tV(e,function(t){return t.name===o.name}).each(function(n){(o.visible?n.onShow:n.onHide)(n.getApi(t))})})])})})},Oz=function(t,n){fP.getCurrent(t).each(function(t){return mO.set(t,[ON.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:OL(t,n),slotBehaviours:hz.unnamedEvents([iz(function(t){return ON.hideAllSlots(t)})])}})])})},OU=function(t,n){fP.getCurrent(t).each(function(t){fP.getCurrent(t).each(function(e){OA.hasGrown(t)?ON.isShowing(e,n)?OA.shrink(t):(ON.hideAllSlots(e),ON.showSlot(e,n)):(ON.hideAllSlots(e),ON.showSlot(e,n),OA.grow(t))})})},Oj=function(t){return fP.getCurrent(t).bind(function(t){return OA.isGrowing(t)||OA.hasGrown(t)?fP.getCurrent(t).bind(function(t){return tV(ON.getSlotNames(t),function(n){return ON.isShowing(t,n)})}):tw.none()})},OW=iQ("FixSizeEvent"),OG=iQ("AutoSizeEvent"),OX=Object.freeze({__proto__:null,block:function(t,n,e,o){ex(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=o(r,aZ([mx.config({mode:"special",onTab:function(){return tw.some(!0)},onShiftTab:function(){return tw.some(!0)}}),mB.config({})])),u=r.getSystem().build(i);mO.append(r,ur(u)),u.hasConfigured(mx)&&n.focus&&mx.focusIn(u),e.isBlocked()||n.onBlock(t),e.blockWith(function(){return mO.remove(r,u)})},unblock:function(t,n,e){eO(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),OY=a1({fields:[rS("getRoot",tw.none),rw("focus",!0),ar("onBlock"),ar("onUnblock")],name:"blocking",apis:OX,state:Object.freeze({__proto__:null,init:function(){var t=cS();return ua({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),Oq=function(t){return fP.getCurrent(t).each(function(t){return a8(t.element)})},OK=function(t,n){var e="tabindex",o="data-mce-"+e;tw.from(t.iframeElement).map(nh.fromDom).each(function(t){n?(ek(t,e).each(function(n){return ex(t,o,n)}),ex(t,e,-1)):(eO(t,e),ek(t,o).each(function(n){ex(t,e,n),eO(t,o)}))})},OJ=function(t,n,e,o){var r=n.element;if(OK(t,e),e)OY.block(n,function(t,n){return{dom:{tag:"div",attributes:{"aria-label":o.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:gO('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}),eN(r,"display"),eO(r,"aria-hidden"),t.hasFocus()&&Oq(n);else{var i=fP.getCurrent(n).exists(function(t){return a7(t.element)});OY.unblock(n),eE(r,"display","none"),ex(r,"aria-hidden","true"),i&&t.focus()}},O$=function(t,n,e){var o=rO(!1),r=cO(),i=function(e){o.get()&&!("focusin"===e.type&&(e.composed?tJ(e.composedPath()):tw.from(e.target)).map(nh.fromDom).filter(ny).exists(function(t){return uE(t,"mce-pastebin")}))&&(e.preventDefault(),Oq(n()),t.editorManager.setActive(t))};t.inline||t.on("PreInit",function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)})});var u=function(r){r!==o.get()&&(o.set(r),OJ(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",function(n){if(r.on(gk.clearTimeout),te(n.time)){var e=gk.setEditorTimeout(t,function(){return u(n.state)},n.time);r.set(e)}else u(n.state),r.clear()})},OQ=function(t,n,e){return{within:t,extra:n,withinWidth:e}},OZ=function(t,n,e){var o,r=(o=function(t,n){var o=e(t);return tw.some({element:t,start:n,finish:n+o,width:o})},tP(t,function(t,n){return o(n,t.len).fold(tu(t),function(n){return{len:n.finish,list:t.list.concat([n])}})},{len:0,list:[]}).list),i=tR(r,function(t){return t.finish<=n}),u=tN(i,function(t,n){return t+n.width},0),a=r.slice(i.length);return{within:i,extra:a,withinWidth:u}},O0=function(t){return tB(t,function(t){return t.element})},O1=function(t,n,e){var o=OZ(n,t,e);return 0===o.extra.length?tw.some(o):tw.none()},O2=function(t,n,e,o){var r=O1(t,n,e).getOrThunk(function(){return OZ(n,t-e(o),e)}),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?OQ(O0(i.concat(u)),[],a):u.length>=1?OQ(O0(i).concat([o]),O0(u),a):OQ(O0(i),[],a)},O5=function(t,n){var e=tB(n,function(t){return ur(t)});CN.setGroups(t,e)},O3=function(t,n,e){var o=n.builtGroups.get();if(0!==o.length){var r=fy(t,n,"primary"),i=yj.getCoupled(t,"overflowGroup");eE(r.element,"visibility","hidden");var u=o.concat([i]),a=tZ(u,function(t){return cn(t.element).bind(function(n){return t.getSystem().getByDom(n).toOptional()})});e([]),O5(r,u);var c=O2(eK(r.element),n.builtGroups.get(),function(t){return eK(t.element)},i);0===c.extra.length?(mO.remove(r,i),e([])):(O5(r,c.within),e(c.extra)),eN(r.element,"visibility"),eP(r.element),a.each(mB.focus)}},O9=tu([lV("splitToolbarBehaviours",[yj]),o7("builtGroups",function(){return rO([])})]),O4=tu([ae(["overflowToggledClass"]),rm("getOverflowBounds"),rn("lazySink"),o7("overflowGroups",function(){return rO([])})].concat(O9())),O6=tu([fo({factory:CN,schema:CI(),name:"primary"}),fr({schema:CI(),name:"overflow"}),fr({name:"overflow-button"}),fr({name:"overflow-group"})]),O8=tu(function(t,n){e$(t,Math.floor(n))}),O7=tu([ae(["toggledClass"]),rn("lazySink"),ri("fetch"),rm("getBounds"),rp("fireDismissalEventInstead",[rh("event",iv())]),c0()]),_t=tu([fr({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:aZ([mU.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),fr({factory:CN,schema:CI(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:aZ([mx.config({mode:"cyclic",onEscape:function(n){return fb(n,t,"button").each(mB.focus),tw.none()}})])}}})]),_n=function(t,n){var e=yj.getCoupled(t,"toolbarSandbox");lx.isOpen(e)?lx.close(e):lx.open(e,n.toolbar())},_e=function(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),i=e.lazySink(t).getOrDie();s9.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:O8()}}},r)},_o=function(t,n,e,o,r){CN.setGroups(n,r),_e(t,n,e,o),mU.on(t)},_r=function(t,n,e){var o=u$();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:aZ([mx.config({mode:"special",onEscape:function(t){return lx.close(t),tw.some(!0)}}),lx.config({onOpen:function(r,i){e.fetch().get(function(r){_o(t,i,e,n.layouts,r),o.link(t.element),mx.focusIn(i)})},onClose:function(){mU.off(t),mB.focus(t),o.unlink(t.element)},isPartOf:function(n,e,o){return uQ(e,o)||uQ(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),a9.config({channels:tp(tp({},lO(tp({isExtraPart:td},e.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),lT({doReposition:function(){lx.getState(yj.getCoupled(t,"toolbarSandbox")).each(function(o){_e(t,o,e,n.layouts)})}}))})])}},_i=fI({name:"FloatingToolbarButton",factory:function(t,n,e,o){return tp(tp({},gC.sketch(tp(tp({},o.button()),{action:function(t){_n(t,o)},buttonBehaviours:lU.augment({dump:o.button().buttonBehaviours},[yj.config({others:{toolbarSandbox:function(n){return _r(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){lx.getState(yj.getCoupled(n,"toolbarSandbox")).each(function(r){_o(n,r,t,e.layouts,o)})},reposition:function(n){lx.getState(yj.getCoupled(n,"toolbarSandbox")).each(function(o){_e(n,o,t,e.layouts)})},toggle:function(t){_n(t,o)},getToolbar:function(t){return lx.getState(yj.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return lx.isOpen(yj.getCoupled(t,"toolbarSandbox"))}}})},configFields:O7(),partFields:_t(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),_u=tu([rn("items"),ae(["itemSelector"]),lV("tgroupBehaviours",[mx])]),_a=tu([fu({name:"items",unit:"item"})]),_c=fI({name:"ToolbarGroup",configFields:_u(),partFields:_a(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:lz(t.tgroupBehaviours,[mx.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),_s=function(t){return tB(t,function(t){return ur(t)})},_l=function(t,n,e){O3(t,e,function(o){e.overflowGroups.set(o),n.getOpt(t).each(function(t){_i.setGroups(t,_s(o))})})},_f=fI({name:"SplitFloatingToolbar",configFields:O4(),partFields:O6(),factory:function(t,n,e,o){var r=g_(_i.sketch({fetch:function(){return yM.nu(function(n){n(_s(t.overflowGroups.get()))})},layouts:{onLtr:function(){return[aI,aF]},onRtl:function(){return[aF,aI]},onBottomLtr:function(){return[aN,aR]},onBottomRtl:function(){return[aR,aN]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:lz(t.splitToolbarBehaviours,[yj.config({others:{overflowGroup:function(){return _c.sketch(tp(tp({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(tB(e,n.getSystem().build)),_l(n,r,t)},refresh:function(n){return _l(n,r,t)},toggle:function(t){r.getOpt(t).each(function(t){_i.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(_i.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){_i.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(_i.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),_d=tu([ae(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),ar("onOpened"),ar("onClosed")].concat(O9())),_m=tu([fo({factory:CN,schema:CI(),name:"primary"}),fo({factory:CN,schema:CI(),name:"overflow",overrides:function(t){return{toolbarBehaviours:aZ([OA.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){fb(n,t,"overflow-button").each(function(t){mU.off(t),mB.focus(t)}),t.onClosed(n)},onGrown:function(n){mx.focusIn(n),t.onOpened(n)},onStartGrow:function(n){fb(n,t,"overflow-button").each(mU.on)}}),mx.config({mode:"acyclic",onEscape:function(n){return fb(n,t,"overflow-button").each(mB.focus),tw.some(!0)}})])}}}),fr({name:"overflow-button",overrides:function(t){return{buttonBehaviours:aZ([mU.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),fr({name:"overflow-group"})]),_g=function(t,n){fb(t,n,"overflow-button").bind(function(){return fb(t,n,"overflow")}).each(function(e){_p(t,n),OA.toggleGrow(e)})},_p=function(t,n){fb(t,n,"overflow").each(function(e){O3(t,n,function(t){var n=tB(t,function(t){return ur(t)});CN.setGroups(e,n)}),fb(t,n,"overflow-button").each(function(t){OA.hasGrown(e)&&mU.on(t)}),OA.refresh(e)})},_h=fI({name:"SplitSlidingToolbar",configFields:_d(),partFields:_m(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle",i=function(n,e){var o=tB(e,n.getSystem().build);t.builtGroups.set(o)};return{uid:t.uid,dom:t.dom,components:n,behaviours:lz(t.splitToolbarBehaviours,[yj.config({others:{overflowGroup:function(t){return _c.sketch(tp(tp({},o["overflow-group"]()),{items:[gC.sketch(tp(tp({},o["overflow-button"]()),{action:function(n){iO(t,r)}}))]}))}}}),mT("toolbar-toggle-events",[iI(r,function(n){_g(n,t)})])]),apis:{setGroups:function(n,e){i(n,e),_p(n,t)},refresh:function(n){return _p(n,t)},toggle:function(n){return _g(n,t)},isOpen:function(n){return fb(n,t,"overflow").map(OA.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),_v=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:tp({tag:"div",classes:["tox-toolbar__group"]},n),components:[_c.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:aZ([yi.config({}),mB.config({})])}},_b=function(t){return _c.sketch(_v(t))},_y=function(t,n){var e=iz(function(n){var e=tB(t.initGroups,_b);CN.setGroups(n,e)});return aZ([vm.toolbarButton(t.providers.isDisabled),vd(),mx.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),mT("toolbar-events",[e])])},_x=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":_v({title:tw.none(),items:[]}),"overflow-button":SX({name:"more",icon:tw.some("more-drawer"),disabled:!1,tooltip:tw.some("More..."),primary:!1,borderless:!1},tw.none(),t.providers)},splitToolbarBehaviours:_y(t,n)}},_w=function(t){var n=_x(t),e=_f.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return _f.sketch(tp(tp({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=od(n),o=et(n),r=od(o),i=Math.max(o.dom.scrollHeight,r.height);return ol(e.x+4,r.y,e.width-8,i)},parts:tp(tp({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},_S=function(t){var n=_h.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=_h.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=_x(t);return _h.sketch(tp(tp({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([C6()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([C6()],{type:"closed"})}}))},_k=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return CN.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===R.scrolling?["tox-toolbar--scrolling"]:[])},components:[CN.parts.groups({})],toolbarBehaviours:_y(t,n)})},_C=fc.optional({factory:Op,name:"menubar",schema:[rn("backstage")]}),_O=fc.optional({factory:{sketch:function(t){return CF.sketch({uid:t.uid,dom:t.dom,listBehaviours:aZ([mx.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return _k({type:t.type,uid:iQ("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),tw.some(!0)}})},setupItem:function(t,n,e,o){CN.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[rn("dom"),rn("onEscape")]}),__=fc.optional({factory:{sketch:function(t){return(t.type===R.sliding?_S:t.type===R.floating?_w:_k)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),tw.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[rn("dom"),rn("onEscape"),rn("getSink")]}),_T=fc.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?Oc:CP;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:aZ(e(n,t.sharedBackstage))}}},name:"header",schema:[rn("dom")]}),_E=fc.optional({name:"socket",schema:[rn("dom")]}),_D=fc.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:aZ([yi.config({}),mB.config({}),OA.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){fP.getCurrent(t).each(ON.hideAllSlots),iO(t,OG)},onGrown:function(t){iO(t,OG)},onStartGrow:function(t){i_(t,OW,{width:eF(t.element,"width").getOr("")})},onStartShrink:function(t){i_(t,OW,{width:eK(t.element)+"px"})}}),mO.config({}),fP.config({find:function(t){return tJ(mO.contents(t))}})])}],behaviours:aZ([wF.childAt(0),mT("sidebar-sliding-events",[iI(OW,function(t,n){eE(t.element,"width",n.event.width)}),iI(OG,function(t,n){eN(t.element,"width")})])])}}},name:"sidebar",schema:[rn("dom")]}),_A=fc.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:aZ([mO.config({}),OY.config({focus:!1}),fP.config({find:function(t){return tJ(t.components())}})]),components:[]}}},name:"throbber",schema:[rn("dom")]}),_B=fI({name:"OuterContainer",factory:function(t,n,e){return{uid:t.uid,dom:t.dom,components:n,apis:{getSocket:function(n){return f_.getPart(n,t,"socket")},setSidebar:function(n,e){f_.getPart(n,t,"sidebar").each(function(t){return Oz(t,e)})},toggleSidebar:function(n,e){f_.getPart(n,t,"sidebar").each(function(t){return OU(t,e)})},whichSidebar:function(n){return f_.getPart(n,t,"sidebar").bind(Oj).getOrNull()},getHeader:function(n){return f_.getPart(n,t,"header")},getToolbar:function(n){return f_.getPart(n,t,"toolbar")},setToolbar:function(n,e){f_.getPart(n,t,"toolbar").each(function(t){t.getApis().setGroups(t,e)})},setToolbars:function(n,e){f_.getPart(n,t,"multiple-toolbar").each(function(t){CF.setItems(t,e)})},refreshToolbar:function(n){f_.getPart(n,t,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(n){f_.getPart(n,t,"toolbar").each(function(t){var n;null!=(n=t.getApis().toggle)?tw.some(n(t)):tw.none()})},isToolbarDrawerToggled:function(n){return f_.getPart(n,t,"toolbar").bind(function(t){return tw.from(t.getApis().isOpen).map(function(n){return n(t)})}).getOr(!1)},getThrobber:function(n){return f_.getPart(n,t,"throbber")},focusToolbar:function(n){f_.getPart(n,t,"toolbar").orThunk(function(){return f_.getPart(n,t,"multiple-toolbar")}).each(function(t){mx.focusIn(t)})},setMenubar:function(n,e){f_.getPart(n,t,"menubar").each(function(t){Op.setMenus(t,e)})},focusMenubar:function(n){f_.getPart(n,t,"menubar").each(function(t){Op.focus(t)})}},behaviours:t.behaviours}},configFields:[rn("dom"),rn("behaviours")],partFields:[_T,_C,__,_O,_E,_D,_A],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=tB(e,function(t){return _b(t)});t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=tB(e,function(t){return tB(t,_b)});t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),_M={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},_F=function(t,n,e){var o=e.getParam("removed_menuitems","").split(/[ ,]/);return{text:t.title,getItems:function(){return tU(t.items,function(t){var e=t.toLowerCase();return 0===e.trim().length||tE(o,function(t){return t===e})?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]})}}},_I=function(t){return"string"==typeof t?t.split(" "):t},_R=function(t,n){var e=tp(tp({},_M),n.menus),o=t0(n.menus).length>0,r=tB(tR(void 0===n.menubar||!0===n.menubar?_I("file edit view insert format tools table help"):_I(!1===n.menubar?"":n.menubar),function(t){var e=nt(_M,t);return o?e||t7(n.menus,t).exists(function(t){return nt(t,"items")}):e}),function(o){var r=e[o];return _F({title:r.title,items:_I(r.items)},n,t)});return tR(r,function(t){return t.getItems().length>0&&tE(t.getItems(),function(t){return"separator"!==t.type})})},_N=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},_P=function(t,n,e){return new pz(function(o,r){e.load(n,o,r),t.on("remove",function(){return e.unload(n)})})},_H=function(t,n){var e=h$(n);(e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1==(!1===n.getParam("skin"))&&Y(e))?pz.all([_P(n,e+"/skin.min.css",n.ui.styleSheetLoader),em(nh.fromDom(n.getElement())).isSome()?_P(n,e+"/skin.shadowdom.min.css",hK.DOM.styleSheetLoader):pz.resolve()]).then(_N(n),function(){return n.fire("SkinLoadError",{message:"Skin could not be loaded"})}):_N(n)()},_V=ts(_H,!1),_L=ts(_H,!0),_z=function(t,n){return function(e){var o=ck(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},_U=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)};return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},_j=function(t){return function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)})}}},_W=function(t,n){return function(){return t.execCommand(n)}},_G=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return tw.some({type:"separator",text:a});if("submenu"!==t.type)return tw.some(tp({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})));var c=tU(t.getStyleItems(),function(t){return r(t,o,u)});return 0===o&&c.length<=0?tw.none():tw.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return tU(t.getStyleItems(),function(t){return r(t,o,u)})}})},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return tU(t,function(t){return r(t,o,n)})};return{validateItems:i,getFetch:function(t,n){return function(e,o){o(SU(i(n()),he.CLOSE_ON_EXECUTE,t,!1))}}}},_X=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return tB(o.data,function(t){return k8(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:_G(t,n,e),getStyleItems:r}},_Y=function(t,n,e){var o=_X(t,n,e),r=o.items,i=o.getStyleItems,u=_U(t,"NodeChange",function(t){var n=t.getComponent();e.updateText(n)});return SN({text:e.icon.isSome()?tw.none():e.text,icon:e.icon,tooltip:tw.from(e.tooltip),role:tw.none(),fetch:r.getFetch(n,i),onSetup:u,getApi:function(t){return{getComponent:tu(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(C=z||(z={}))[C.SemiColon=0]="SemiColon",C[C.Space=1]="Space";var _q=function(t,n,e,o){var r;return{type:"basic",data:tB((r=t.getParam(n,e,"string"),o===z.SemiColon?r.replace(/;$/,"").split(";"):r.split(" ")),function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}})}},_K=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],_J=function(t){return{tooltip:"Align",text:tw.none(),icon:tw.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:tw.none,getPreviewFor:function(t){return tw.none},onAction:function(n){return function(){return tV(_K,function(t){return t.format===n.format}).each(function(n){return t.execCommand(n.command)})}},updateText:function(n){i_(n,SR,{icon:"align-"+tV(_K,function(n){return t.formatter.match(n.format)}).fold(tu("left"),function(t){return t.title.toLowerCase()})})},dataset:{type:"basic",data:_K},shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},_$=function(t,n){var e=_X(t,n,_J(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},_Q=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],_Z=function(t){return tB(t.split(/\s*,\s*/),function(t){return t.replace(/^['"]+|['"]+$/g,"")})},_0=function(t){var n;return 0===t.indexOf("-apple-system")&&(n=_Z(t.toLowerCase()),tj(_Q,function(t){return n.indexOf(t.toLowerCase())>-1}))},_1=function(t){var n="System Font",e=function(){var e=function(t){return t?_Z(t)[0]:""},r=t.queryCommandValue("FontName"),i=o.data,u=r?r.toLowerCase():"";return{matchOpt:tV(i,function(t){var n=t.format;return n.toLowerCase()===u||e(n).toLowerCase()===e(u).toLowerCase()}).orThunk(function(){return nu(_0(u),{title:n,format:u})}),font:r}},o=_q(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",z.SemiColon);return{tooltip:"Fonts",text:tw.some(n),icon:tw.none(),isSelectedFor:function(t){return function(n){return n.exists(function(n){return n.format===t})}},getCurrentValue:function(){return e().matchOpt},getPreviewFor:function(t){return function(){return tw.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("FontName",!1,n.format)})}},updateText:function(t){var n=e(),o=n.matchOpt,r=n.font;i_(t,SI,{text:o.fold(tu(r),function(t){return t.title})})},dataset:o,shouldHide:!1,isInvalid:td}},_2=function(t,n){var e=_X(t,n,_1(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},_5={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},_3={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},_9=function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e},_4=function(t){var n=function(){var n=tw.none(),e=o.data,r=t.queryCommandValue("FontSize");if(r)for(var i=3;n.isNone()&&i>=0;i--)!function(t){var o=/[0-9.]+px$/.test(r)?_9(72*parseInt(r,10)/96,t||0)+"pt":t7(_3,r).getOr(r),i=t7(_5,o).getOr("");n=tV(e,function(t){return t.format===r||t.format===o||t.format===i})}(i);return{matchOpt:n,size:r}},e=tu(tw.none),o=_q(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",z.Space);return{tooltip:"Font sizes",text:tw.some("12pt"),icon:tw.none(),isSelectedFor:function(t){return function(n){return n.exists(function(n){return n.format===t})}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("FontSize",!1,n.format)})}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size;i_(t,SI,{text:o.fold(tu(r),function(t){return t.title})})},dataset:o,shouldHide:!1,isInvalid:td}},_6=function(t,n){var e=_X(t,n,_4(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},_8=function(t,n){var e=n(),o=tB(e,function(t){return t.format});return tw.from(t.formatter.closest(o)).bind(function(t){return tV(e,function(n){return n.format===t})}).orThunk(function(){return nu(t.formatter.match("p"),{title:"Paragraph",format:"p"})})},_7=function(t){var n="Paragraph",e=_q(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",z.SemiColon);return{tooltip:"Blocks",text:tw.some(n),icon:tw.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:tw.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return tw.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:_j(t),updateText:function(o){i_(o,SI,{text:_8(t,function(){return e.data}).fold(tu(n),function(t){return t.title})})},dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},Tt=function(t,n){var e=_X(t,n,_7(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},Tn=function(t,n){var e="Paragraph";return{tooltip:"Formats",text:tw.some(e),icon:tw.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:tw.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?tw.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):tw.none()}},onAction:_j(t),updateText:function(n){var o=function(t){var n=t.items;return void 0!==n&&n.length>0?tU(n,o):[{title:t.title,format:t.format}]},r=tU(k6(t),o);i_(n,SI,{text:_8(t,tu(r)).fold(tu(e),function(t){return t.title})})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},Te=function(t,n){var e=tp({type:"advanced"},n.styleselect);return _Y(t,n,Tn(t,e))},To=function(t,n){var e=tp({type:"advanced"},n.styleselect),o=_X(t,n,Tn(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})},Tr=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each(function(t){var r=t(e,o);n.set(r)}),t.renderComponents.each(function(t){var r=tB(t(o,n.get()),e.getSystem().build);lt(e,r)})};return iB([iI(ie(),function(n,o){if(!o.universal){var r=t.channel;tT(o.channels,r)&&e(n,o.data)}}),iz(function(n,o){t.initialData.each(function(t){e(n,t)})})])}}),Ti=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),Tu=a1({fields:[rn("channel"),rs("renderComponents"),rs("updateState"),rs("initialData")],name:"reflecting",active:Tr,apis:Ti,state:Object.freeze({__proto__:null,init:function(){var t=rO(tw.none());return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(tw.none())}}}})}),Ta=tu([rn("toggleClass"),rn("fetch"),au("onExecute"),rh("getHotspot",tw.some),rh("getAnchorOverrides",tu({})),c0(),au("onItemExecute"),rs("lazySink"),rn("dom"),ar("onOpen"),lV("splitDropdownBehaviours",[yj,mx,mB]),rh("matchWidth",!1),rh("useMinWidth",!1),rh("eventOrder",{}),rs("role")].concat(y1())),Tc=tu([fo({factory:gC,schema:[rn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:aZ([mB.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(iT)},buttonBehaviours:aZ([mU.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),fo({factory:gC,schema:[rn("dom")],name:"button",defaults:function(){return{buttonBehaviours:aZ([mB.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(function(e){t.onExecute(e,n)})}}}}),fi({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[rn("text")],name:"aria-descriptor"}),fr({schema:[an()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each(function(o){t.onItemExecute(o,n,e)})}}}}),yG()]),Ts=fI({name:"SplitDropdown",configFields:Ta(),partFields:Tc(),factory:function(t,n,e,o){var r,i=function(t){fP.getCurrent(t).each(function(t){f4.highlightFirst(t),mx.focusIn(t)})},u=function(n){yK(t,ta,n,o,i,V.HighlightFirst).get(tr)},a=function(n){return iT(fy(n,t,"button")),tw.some(!0)},c=tp(tp({},iB([iz(function(n,e){fb(n,t,"aria-descriptor").each(function(t){var e=iQ("aria");ex(t.element,"id",e),ex(n.element,"aria-describedby",e)})})])),mW(tw.some(u)));return{uid:t.uid,dom:t.dom,components:n,apis:{repositionMenus:function(t){mU.isOn(t)&&y0(t)}},eventOrder:tp(tp({},t.eventOrder),((r={})[io()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:lz(t.splitDropdownBehaviours,[yj.config({others:{sandbox:function(n){var e=fy(n,t,"arrow");return yZ(t,n,{onOpen:function(){mU.on(e),mU.on(n)},onClose:function(){mU.off(e),mU.off(n)}})}}}),mx.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),tw.some(!0)}}),mB.config({}),mU.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Tl=function(t){return{isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)}}},Tf=function(t){return{setActive:function(n){mU.set(t,n)},isActive:function(){return mU.isOn(t)},isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)}}},Td=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},Tm=iQ("focus-button"),Tg=function(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:Td(e,i)},components:no([t.map(function(t){return SD(t,i.icons)}),n.map(function(t){return SB(t,"tox-tbtn",i)})]),eventOrder:((u={})[rW()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:aZ([vm.toolbarButton(i.isDisabled),vd(),mT("common-button-display-events",[iI(rW(),function(t,n){n.event.prevent(),iO(t,Tm)})])].concat(o.map(function(e){return Tu.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return no([t.icon.map(function(t){return SD(t,i.icons)}),t.text.map(function(t){return SB(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},Tp=function(t,n,e,o){var r=n.shared;return _i.sketch({lazySink:r.getSink,fetch:function(){return yM.nu(function(n){n(tB(e(t.items),_b))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:Tg(t.icon,t.text,t.tooltip,tw.none(),tw.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},Th=function(t,n,e){var o,r=rO(tr),i=Tg(t.icon,t.text,t.tooltip,tw.none(),tw.none(),e);return gC.sketch({dom:i.dom,components:i.components,eventOrder:SF,buttonBehaviours:aZ([mT("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},iW(function(t,n){vg(o,t)(function(n){i_(t,SM,{buttonApi:n}),o.onAction(n)})})),vp(n,r),vh(n,r)]),vm.toolbarButton(function(){return t.disabled||e.isDisabled()}),vd()].concat(n.toolbarButtonBehaviours))})},Tv=function(t,n,e){return Th(t,{toolbarButtonBehaviours:[].concat(e.length>0?[mT("toolbarButtonWith",e)]:[]),getApi:Tl,onSetup:t.onSetup},n)},Tb=function(t,n,e){return oC(Th(t,{toolbarButtonBehaviours:[mO.config({}),mU.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[mT("toolbarToggleButtonWith",e)]:[]),getApi:Tf,onSetup:t.onSetup},n))},Ty=function(t,n){var e,o,r=iQ("channel-update-split-dropdown-display"),i=function(t){return{isDisabled:function(){return fJ.isDisabled(t)},setDisabled:function(n){return fJ.set(t,n)},setIconFill:function(n,e){uK(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){ex(t,"fill",e)})},setIconStroke:function(n,e){uK(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){ex(t,"stroke",e)})},setActive:function(n){ex(t.element,"aria-pressed",n),uK(t.element,"span").each(function(e){t.getSystem().getByDom(e).each(function(t){return mU.set(t,n)})})},isActive:function(){return uK(t.element,"span").exists(function(n){return t.getSystem().getByDom(n).exists(mU.isOn)})}}},u=rO(tr),a={getApi:i,onSetup:t.onSetup};return Ts.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:tp({"aria-pressed":!1},Td(t.tooltip,n.providers))},onExecute:function(n){t.onAction(i(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:aZ([vm.splitButton(n.providers.isDisabled),vd(),mT("split-dropdown-events",[iI(Tm,mB.focus),vp(a,u),vh(a,u)]),y9.config({})]),eventOrder:((o={})[ip()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:(e=n.providers,function(n){return yM.nu(function(n){return t.fetch(n)}).map(function(o){return tw.from(bU(oC(bS(iQ("menu-value"),o,function(e){t.onItemAction(i(n),e)},t.columns,t.presets,he.CLOSE_ON_EXECUTE,t.select.getOr(td),e),{movement:bC(t.columns,t.presets),menuBehaviours:hz.unnamedEvents("auto"!==t.columns?[]:[iz(function(n,e){hV(n,4,hg(t.presets)).each(function(t){var e=t.numRows,o=t.numColumns;mx.setGridSize(n,e,o)})})])})))})}),parts:{menu:hy(!1,t.columns,t.presets)},components:[Ts.parts.button(Tg(t.icon,t.text,tw.none(),tw.some(r),tw.some([mU.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),Ts.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:pw("chevron-down",n.providers.icons)},buttonBehaviours:aZ([vm.splitButton(n.providers.isDisabled),vd(),pk()])}),Ts.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},Tx=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Tw=function(t,n){return function(e,o,r){return n(t(e).mapError(function(t){return o6(t)}).getOrDie(),o,r)}},TS={button:Tw(pQ,function(t,n){return Tv(t,n.backstage.shared.providers,[])}),togglebutton:Tw(p1,function(t,n){return Tb(t,n.backstage.shared.providers,[])}),menubutton:Tw(Om,function(t,n){return SW(t,"tox-tbtn",n.backstage,tw.none())}),splitbutton:Tw(function(t){return o3("SplitButton",Og,t)},function(t,n){return Ty(t,n.backstage.shared)}),grouptoolbarbutton:Tw(function(t){return o3("GroupToolbarButton",Ol,t)},function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[cQ]=n.backstage.shared.header.isPositionedAtTop()?M.TopToBottom:M.BottomToTop,o);if(h8(e)===R.floating)return Tp(t,n.backstage,function(t){return T_(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,tw.none())},i);throw Error("Toolbar groups are only supported when using floating toolbar mode")}),styleSelectButton:function(t,n){return Te(t,n.backstage)},fontsizeSelectButton:function(t,n){return _Y(t,n.backstage,_4(t))},fontSelectButton:function(t,n){return _Y(t,n.backstage,_1(t))},formatButton:function(t,n){return _Y(t,n.backstage,_7(t))},alignMenuButton:function(t,n){return _Y(t,n.backstage,_J(t))}},Tk={styleselect:TS.styleSelectButton,fontsizeselect:TS.fontsizeSelectButton,fontselect:TS.fontSelectButton,formatselect:TS.formatButton,align:TS.alignMenuButton},TC=function(t){var n=tB(Tx,function(n){var e=tR(n.items,function(n){return nt(t,n)||nt(Tk,n)});return{name:n.name,items:e}});return tR(n,function(t){return t.items.length>0})},TO=function(t){var n=t.toolbar,e=t.buttons;return!1===n?[]:void 0===n||!0===n?TC(e):Y(n)?tB(n.split("|"),function(t){return{items:t.trim().split(" ")}}):to(n,function(t){return nt(t,"name")&&nt(t,"items")})?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},T_=function(t,n,e,o){return tR(tB(TO(n),function(r){var i=tU(r.items,function(r){var i,u;return 0===r.trim().length?[]:(i=n.buttons,u=n.allowToolbarGroups,t7(i,r.toLowerCase()).orThunk(function(){return o.bind(function(t){return tZ(t,function(t){return t7(i,t+r.toLowerCase())})})}).fold(function(){return t7(Tk,r.toLowerCase()).map(function(n){return n(t,e)}).orThunk(function(){return tw.none()})},function(n){return"grouptoolbarbutton"!==n.type||u?t7(TS,n.type).fold(function(){return console.error("skipping button defined by",n),tw.none()},function(o){return tw.some(o(n,e,t))}):(console.warn("Ignoring the '"+r+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),tw.none())})).toArray()});return{title:tw.from(t.translate(r.name)),items:i}}),function(t){return t.items.length>0})},TT=function(t,n,e,o){var r=n.outerContainer,i=e.toolbar,u=e.buttons;if(to(i,Y)){var a=i.map(function(n){return T_(t,{toolbar:n,buttons:u,allowToolbarGroups:e.allowToolbarGroups},{backstage:o},tw.none())});_B.setToolbars(r,a)}else _B.setToolbar(r,T_(t,e,{backstage:o},tw.none()))},TE=n0(),TD=TE.os.isiOS()&&TE.os.version.major<=12,TA=function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=rO(ej(o.innerWidth,o.innerHeight)),u=rO(ej(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();(n.left!==o.innerWidth||n.top!==o.innerHeight)&&(i.set(ej(o.innerWidth,o.innerHeight)),v5(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();(e.left!==n.offsetWidth||e.top!==n.offsetHeight)&&(u.set(ej(n.offsetWidth,n.offsetHeight)),v5(t))},s=function(n){return t.fire("ScrollContent",n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var l=cT(nh.fromDom(t.getBody()),"load",c),f=n.uiMothership.element;t.on("hide",function(){eE(f,"display","none")}),t.on("show",function(){eN(f,"display")}),t.on("NodeChange",c),t.on("remove",function(){l.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null})},TB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=rO(0),u=n.outerContainer;_V(t);var a=nh.fromDom(r.targetNode),c=ed(ef(a));la(a,n.mothership),lu(c,n.uiMothership),t.on("PostRender",function(){TT(t,n,e,o),i.set(t.getWin().innerWidth),_B.setMenubar(u,_R(t,e)),_B.setSidebar(u,e.sidebar),TA(t,n)});var s=_B.getSocket(u).getOrDie("Could not find expected socket element");if(TD){eD(s.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var l=pD(function(){t.fire("ScrollContent")},20),f=c_(s.element,"scroll",l.throttle);t.on("remove",f.unbind)}vf(t,n),t.addCommand("ToggleSidebar",function(n,e){_B.toggleSidebar(u,e),t.fire("ToggleSidebar")}),t.addQueryValueHandler("ToggleSidebar",function(){return _B.whichSidebar(u)});var d=h8(t),m=function(){_B.refreshToolbar(n.outerContainer)};return(d===R.sliding||d===R.floating)&&t.on("ResizeWindow ResizeEditor ResizeContent",function(){var n=t.getWin().innerWidth;n!==i.get()&&(m(),i.set(n))}),{iframeContainer:s.element.dom,editorContainer:u.element.dom,api:{enable:function(){vl(n,!1)},disable:function(){vl(n,!0)},isDisabled:function(){return fJ.isDisabled(u)}}}}}),TM=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?tw.some(parseInt(""+t,10)):tw.none()},TF=function(t){return te(t)?t+"px":t},TI=function(t,n,e){var o=n.filter(function(n){return t<n}),r=e.filter(function(n){return t>n});return o.or(r).getOr(t)},TR=function(t){var n=hQ(t),e=h1(t),o=h5(t);return TM(n).map(function(t){return TI(t,e,o)})},TN=function(t){var n=hZ(t),e=h0(t),o=h2(t);return TM(n).map(function(t){return TI(t,e,o)})},TP=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=hK.DOM,c=ve(t),s=vi(t),l=h2(t).or(TN(t)),f=o.shared.header,d=f.isPositionedAtTop,m=h8(t),g=m===R.sliding||m===R.floating,p=rO(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold(tu(0),function(t){return t.components().length>1?eL(t.components()[1].element):0}):0},b=function(e){switch(h7(t)){case N.auto:var o=v(_B.getToolbar(u)),r=eL(e.element)-o,i=of(n);if(i.y>r)return"top";var a=et(n),c=Math.max(a.dom.scrollHeight,eL(a));if(i.bottom<c-r)return"bottom";return om().bottom<i.bottom-r?"bottom":"top";case N.bottom:return"bottom";case N.top:default:return"top"}},y=function(t){var n=r.get();C4.setModes(n,[t]),f.setDockingMode(t);var e=d()?M.TopToBottom:M.BottomToTop;ex(n.element,cQ,e)},x=function(){var t=l.getOrThunk(function(){var t=TM(eB(ev(),"margin-left")).getOr(0);return eK(ev())-eX(n).left+t});eE(r.get().element,"max-width",t+"px")},w=function(){var t=v(_B.getToolbar(u)),e=of(n),o=d()?Math.max(e.y-eL(r.get().element)+t,0):e.bottom;eD(u.element,{position:"absolute",top:Math.round(o)+"px",left:Math.round(e.x)+"px"})},S=function(){i.broadcastOn([lS()],{})},k=function(t){if(void 0===t&&(t=!1),h()){if(c||x(),g&&_B.refreshToolbar(u),c||w(),s){var n=r.get();t?C4.reset(n):C4.refresh(n)}S()}},C=function(t){if(void 0===t&&(t=!0),!c&&s&&h()){var n=f.getDockingMode(),e=b(r.get());e!==n&&(y(e),t&&k(!0))}};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),eE(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),eN(i.element,"display"),C(!1),k()},hide:function(){p.set(!1),e.outerContainer&&(eE(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),eE(i.element,"display","none")},update:k,updateMode:C,repositionPopups:S}},TH=function(t,n){var e=of(t);return{pos:n?e.y:e.bottom,bounds:e}},TV=function(t,n,e,o){var r=rO(TH(n,e.isPositionedAtTop())),i=function(o){var i=TH(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;r.set({pos:u,bounds:a}),f&&v5(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",function(){return e.update(!0)}),t.on("NodeChange keydown",function(t){gk.requestAnimationFrame(function(){return i(t)})}),t.on("ScrollWindow",function(){return e.updateMode()});var u=ck();u.set(cT(nh.fromDom(t.getBody()),"load",i)),t.on("remove",function(){u.clear()})},TL=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=rO(null),s=nh.fromDom(r.targetNode),l=TP(t,s,n,o,c),f=t.getParam("toolbar_persist",!1,"boolean");_L(t);var d=function(){if(c.get()){l.show();return}c.set(_B.getHeader(a).getOrDie());var r=vo(t);lu(r,i),lu(r,u),TT(t,n,e,o),_B.setMenubar(a,_R(t,e)),l.show(),TV(t,s,l,f),t.nodeChanged()};return t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",function(){(t.hasFocus()||f)&&d()}),vf(t,n),{editorContainer:a.element.dom,api:{show:function(){l.show()},hide:function(){l.hide()},enable:function(){vl(n,!1)},disable:function(){vl(n,!0)},isDisabled:function(){return fJ.isDisabled(a)}}}}}),Tz="contexttoolbar-hide",TU=function(t,n){return iI(SM,function(e,o){var r,i=(r=t.get(e),{hide:function(){return iO(r,ia())},getValue:function(){return lH.getValue(r)}});n.onAction(i,o.event.buttonApi)})},Tj=function(t,n,e){var o=n.original;o.primary;var r=th(o,["primary"]);return Tv(o9(pQ(tp(tp({},r),{type:"button",onAction:tr}))),e.backstage.shared.providers,[TU(t,n)])},TW=function(t,n,e){var o=n.original;o.primary;var r=th(o,["primary"]);return Tb(o9(p1(tp(tp({},r),{type:"togglebutton",onAction:tr}))),e.backstage.shared.providers,[TU(t,n)])},TG=function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?TW(t,n,o):Tj(t,n,o)},TX=function(t,n,e){var o=tB(n,function(n){return g_(TG(t,n,e))});return{asSpecs:function(){return tB(o,function(t){return t.asSpec()})},findPrimary:function(t){return tZ(n,function(n,e){return n.primary?tw.from(o[e]).bind(function(n){return n.getOpt(t)}).filter(tl(fJ.isDisabled)):tw.none()})}}},TY=function(t,n){var e=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),o=g_(yC.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:aZ([mx.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map(function(t){return iT(t),!0})},onLeft:function(t,n){return n.cut(),tw.none()},onRight:function(t,n){return n.cut(),tw.none()}})])})),r=TX(o,t.commands,n);return[{title:tw.none(),items:[o.asSpec()]},{title:tw.none(),items:r.asSpecs()}]},Tq={renderContextForm:function(t,n,e){return _k({type:t,uid:iQ("context-toolbar"),initGroups:TY(n,e),onEscape:tw.none,cyclicKeying:!0,providers:e})},buildInitGroups:TY},TK=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},TJ=function(t){var n=t.getBoundingClientRect();if(!(n.height<=0)||!(n.width<=0))return n;var e=ea(nh.fromDom(t.startContainer),t.startOffset).element;return(nx(e)?ee(e):tw.some(e)).filter(ny).map(function(t){return t.dom.getBoundingClientRect()}).getOr(n)},T$=function(t){var n=TJ(t.selection.getRng());if(t.inline){var e=on();return ol(e.left+n.left,e.top+n.top,n.width,n.height)}var o=od(nh.fromDom(t.getBody()));return ol(o.x+n.left,o.y+n.top,n.width,n.height)},TQ=function(t,n,e){var o=Math.max(t.x+e,n.x);return{x:o,width:Math.min(t.right-e,n.right)-o}},TZ=function(t,n,e,o,r,i){var u=nh.fromDom(t.getContainer()),a=of(uK(u,".tox-editor-header").getOr(u)),c=a.y>=n.bottom,s=o&&!c;if(t.inline&&s)return{y:Math.max(a.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!s)return{y:e.y,bottom:Math.min(a.y-i,e.bottom)};var l="line"===r?of(u):n;return s?{y:Math.max(a.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(a.y-i,e.bottom)}},T0=function(t,n,e,o){void 0===o&&(o=0);var r=oi(window),i=of(nh.fromDom(t.getContentAreaContainer())),u=h3(t)||h9(t)||h6(t),a=TQ(i,r,o),c=a.x,s=a.width;if(t.inline&&!u)return ol(c,r.y,s,r.height);var l=TZ(t,i,r,n.header.isPositionedAtTop(),e,o),f=l.y;return ol(c,f,s,l.bottom-f)},T1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},T2={maxHeightFunction:cj(),maxWidthFunction:O8()},T5=function(t,n){var e=t.selection.getRng(),o=ea(nh.fromDom(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&n9(o.element,n)},T3=function(t,n,e){var o=eF(t,"position");eE(t,"position",n);var r=e(t);return o.each(function(n){return eE(t,"position",n)}),r},T9=function(t){return"node"===t},T4=function(t,n,e,o,r){var i=T$(t),u=o.lastElement().exists(function(t){return n9(e,t)});return T5(t,e)?u?gx:gp:u?T3(n,o.getMode(),function(){return TK(i,of(n))&&!o.isReposition()?gS:gx}):("fixed"===o.getMode()?r.y+on().top:r.y)+(eL(n)+12)<=i.y?gp:gh},T6=function(t,n,e,o){var r=function(n){return T9(o)?[function(o,r,i,u,a){var c=T4(t,u,n,e,a),s=tp(tp({},o),{y:a.y,height:a.height});return tp(tp({},c(s,r,i,u,a)),{alwaysFit:!0})}]:[]};return n?{onLtr:function(t){return[aH,aF,aI,aR,aN,aP].concat(r(t))},onRtl:function(t){return[aH,aI,aF,aN,aR,aP].concat(r(t))}}:{onLtr:function(t){return[aP,aH,aR,aF,aN,aI].concat(r(t))},onRtl:function(t){return[aP,aH,aN,aI,aR,aF].concat(r(t))}}},T8=function(t,n){var e=tI(tR(n,function(n){return n.predicate(t.dom)}),function(t){return"contexttoolbar"===t.type});return{contextToolbars:e.pass,contextForms:e.fail}},T7=function(t){if(t.length<=1)return t;var n=function(n){return tE(t,function(t){return t.position===n})},e=function(n){return tR(t,function(t){return t.position===n})},o=n("selection"),r=n("node");if(!o&&!r)return e("line");if(!r||!o)return e(o?"selection":"node");var i=e("node"),u=tB(e("selection"),function(t){return tp(tp({},t),{position:"node"})});return i.concat(u)},Et=function(t){if(t.length<=1)return t;var n=function(n){return tV(t,function(t){return t.position===n})};return n("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position}).fold(function(){return[]},function(n){return tR(t,function(t){return t.position===n})})},En=function(t,n,e){var o=T8(t,n);if(o.contextForms.length>0)return tw.some({elem:t,toolbars:[o.contextForms[0]]});var r=T8(t,e);if(r.contextForms.length>0)return tw.some({elem:t,toolbars:[r.contextForms[0]]});if(!(o.contextToolbars.length>0)&&!(r.contextToolbars.length>0))return tw.none();var i=T7(o.contextToolbars.concat(r.contextToolbars));return tw.some({elem:t,toolbars:i})},Ee=function(t,n){var e=nh.fromDom(n.getBody()),o=function(t){return n9(t,e)},r=nh.fromDom(n.selection.getNode());return o(r)||n6(e,r)?En(r,t.inNodeScope,t.inEditorScope).orThunk(function(){return o(r)?tw.none():rR(r,function(n){if(!ny(n))return tw.none();var e=T8(n,t.inNodeScope),o=e.contextToolbars,r=e.contextForms,i=r.length>0?r:Et(o);return i.length>0?tw.some({elem:n,toolbars:i}):tw.none()},o)}):tw.none()},Eo=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=o9(o3("ContextForm",p8,a));e[t]=c,c.launch.map(function(e){i["form:"+t]=tp(tp({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})}),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){o3("ContextToolbar",p7,n).each(function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e})};return tM(t0(t),function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)}),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},Er=iQ("forward-slide"),Ei=iQ("backward-slide"),Eu=iQ("change-slide-event"),Ea="tox-pop--resizing",Ec=function(t){var n=rO([]);return go.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){n.set([]),go.getContent(t).each(function(t){eN(t.element,"visibility")}),uT(t.element,Ea),eN(t.element,"width")},inlineBehaviours:aZ([mT("context-toolbar-events",[iL(r5(),function(t,n){"width"===n.event.raw.propertyName&&(uT(t.element,Ea),eN(t.element,"width"))}),iI(Eu,function(t,n){var e=t.element;eN(e,"width");var o=eK(e);go.setContent(t,n.event.contents),uO(e,Ea);var r=eK(e);eE(e,"width",o+"px"),go.getContent(t).each(function(t){n.event.focus.bind(function(t){return a8(t),cn(e)}).orThunk(function(){return mx.focusIn(t),ct(ef(e))})}),gk.setTimeout(function(){eE(t.element,"width",r+"px")},0)}),iI(Er,function(t,e){go.getContent(t).each(function(e){n.set(n.get().concat([{bar:e,focus:ct(ef(t.element))}]))}),i_(t,Eu,{contents:e.event.forwardContents,focus:tw.none()})}),iI(Ei,function(t,e){t$(n.get()).each(function(e){n.set(n.get().slice(0,n.get().length-1)),i_(t,Eu,{contents:ur(e.bar),focus:e.focus})})})]),mx.config({mode:"special",onEscape:function(e){return t$(n.get()).fold(function(){return t.onEscape()},function(t){return iO(e,Ei),tw.some(!0)})}})]),lazySink:function(){return oh.value(t.sink)}})},Es="tox-pop--transition",El=function(t,n,e,o){var r=o.backstage,i=r.shared,u=n0().deviceType.isTouch,a=cO(),c=cO(),s=cO(),l=uU(Ec({sink:e,onEscape:function(){return t.focus(),tw.some(!0)}})),f=function(){var n=s.get().getOr("node"),e=T9(n)?1:0;return T0(t,i,n,e)},d=function(){return!t.removed&&!(u()&&r.isContextMenuOpen())},m=function(){if(!d())return!0;var n=f(),e=ne(s.get(),"node")?a.get().filter(eh).map(od).getOrThunk(function(){return T$(t)}):T$(t);return n.height<=0||!TK(e,n)},g=function(){a.clear(),c.clear(),s.clear(),go.hide(l)},p=function(){if(go.isOpen(l)){var t=l.element;eN(t,"display"),m()?eE(t,"display","none"):(c.set(0),go.reposition(l))}},h=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:aZ([mx.config({mode:"acyclic"}),mT("pop-dialog-wrap-events",[iz(function(n){t.shortcuts.add("ctrl+F9","focus statusbar",function(){return mx.focusIn(n)})}),iU(function(n){t.shortcuts.remove("ctrl+F9")})])])}},v=nk(function(){return Eo(n,function(t){i_(l,Er,{forwardContents:h(b([t]))})})}),b=function(n){var e=t.ui.registry.getAll().buttons,r=v(),u=tp(tp({},e),r.formNavigators),a=h8(t)===R.scrolling?R.scrolling:R.default,c=tz(tB(n,function(n){var e;return"contexttoolbar"===n.type?T_(t,{buttons:u,toolbar:n.items,allowToolbarGroups:!1},o,tw.some(["form:"])):(e=i.providers,Tq.buildInitGroups(n,e))}));return _k({type:a,uid:iQ("context-toolbar"),initGroups:c,onEscape:tw.none,cyclicKeying:!0,providers:i.providers})},y=function(n,o){var r,s;return oC("node"===n?i.anchors.node(o):i.anchors.cursor(),(r=u(),s={lastElement:a.get,isReposition:function(){return ne(c.get(),0)},getMode:function(){return s9.getMode(e)}},"line"===n?{bubble:cq(12,0,T1),layouts:{onLtr:function(){return[aV]},onRtl:function(){return[aL]}},overrides:T2}:{bubble:cq(0,12,T1,.08333333333333333),layouts:T6(t,r,s,n),overrides:T2}))},x=function(t,n){if(w.cancel(),d()){var o=b(t),r=t[0].position,i=y(r,n);s.set(r),c.set(1);var u=l.element;eN(u,"display"),ne(ni(n,a.get(),n9),!0)||(uT(u,Es),s9.reset(e,l)),go.showWithinBounds(l,h(o),{anchor:i,transition:{classes:[Es],mode:"placement"}},function(){return tw.some(f())}),n.fold(a.clear,a.set),m()&&eE(u,"display","none")}},w=pA(function(){t.hasFocus()&&!t.removed&&(uE(l.element,Es)?w.throttle():Ee(v(),t).fold(g,function(t){x(t.toolbars,tw.some(t.elem))}))},17);t.on("init",function(){t.on("remove",g),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",p),t.on("click keyup focus SetContent",w.throttle),t.on(Tz,g),t.on("contexttoolbar-show",function(n){t7(v().lookupTable,n.toolbarKey).each(function(e){x([e],nu(n.target!==t,n.target)),go.getContent(l).each(mx.focusIn)})}),t.on("focusout",function(n){gk.setEditorTimeout(t,function(){cn(e.element).isNone()&&cn(l.element).isNone()&&g()},0)}),t.on("SwitchMode",function(){t.mode.isReadOnly()&&g()}),t.on("AfterProgressState",function(n){n.state?g():t.hasFocus()&&w.throttle()}),t.on("NodeChange",function(t){cn(l.element).fold(w.throttle,tr)})})},Ef=function(t){tM([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:_W(t,n.cmd),onSetup:_z(t,n.name)})}),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:_W(t,"JustifyNone")})},Ed={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Em=(_="[eE][+-]?"+(O="[0-9]+"),RegExp("^([+-]?(?:"+["Infinity",O+"\\."+(T=function(t){return"(?:"+t+")?"})(O)+T(_),"\\."+O+T(_),O+T(_)].join("|")+"))(.*)$")),Eg=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=cO();return tB(e,function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on(function(t){return t.setActive(!1)}),r.set(i)),i.setActive(t)};u(ne(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}})};t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},Ep={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){var n,e;return(n=t,e=["fixed","relative","empty"],tw.from(Em.exec(n)).bind(function(t){var n=Number(t[1]),o=t[2];return tE(e,function(t){return tE(Ed[t],function(t){return o===t})})?tw.some({value:n,unit:o}):tw.none()}).map(function(t){return t.value+t.unit})).getOr(t)},display:ta,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return tw.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},Eh=function(t){Eg(t,Ep),tw.from(t.getParam("content_langs",void 0,"array")).map(function(n){return{name:"language",text:"Language",icon:"language",getOptions:tu(n),hash:function(t){return Q(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){return rN(nh.fromDom(t.selection.getNode()),function(t){return tw.some(t).filter(ny).bind(function(t){return ek(t,"lang").map(function(n){return{code:n,customCode:ek(t,"data-mce-lang").getOrUndefined(),title:""}})})})},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=ck();return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}}).each(function(n){return Eg(t,n)})},Ev=function(t,n){_$(t,n),_2(t,n),To(t,n),Tt(t,n),_6(t,n)},Eb=function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:_U(t,"NodeChange",function(n){n.setDisabled(!t.queryCommandState("outdent"))}),onAction:_W(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:_W(t,"indent")})},Ey=function(t){Eb(t)},Ex=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},Ew=function(t){wP.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:_z(t,n.name),onAction:Ex(t,n.name)})});for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:_z(t,e),onAction:Ex(t,e)})}},ES=function(t){wP.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:_W(t,n.action)})})},Ek=function(t){wP.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:_W(t,n.action),onSetup:_z(t,n.name)})})},EC=function(t){Ew(t),ES(t),Ek(t)},EO=function(t){wP.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:_W(t,n.action)})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:Ex(t,"code")})},E_=function(t){EC(t),EO(t)},ET=function(t,n){return _U(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())})},EE=function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:ET(t,"hasUndo"),onAction:_W(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:ET(t,"hasRedo"),onAction:_W(t,"redo")})},ED=function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:ET(t,"hasUndo"),onAction:_W(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:ET(t,"hasRedo"),onAction:_W(t,"redo")})},EA=function(t){EE(t),ED(t)},EB=function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:_U(t,"VisualAid",function(n){n.setActive(t.hasVisual)}),onAction:_W(t,"mceToggleVisualAid")})},EM=function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:_W(t,"mceToggleVisualAid")})},EF=function(t){EM(t),EB(t)},EI=function(t,n){Ef(t),E_(t),Ev(t,n),EA(t),bw(t),EF(t),Ey(t),Eh(t)},ER=function(t,n){return{type:"makeshift",x:t,y:n}},EN=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},EP=function(t){if(!EN(t))return ER(t.pageX,t.pageY);var n=t.touches[0];return ER(n.pageX,n.pageY)},EH=function(t){if(!EN(t))return ER(t.clientX,t.clientY);var n=t.touches[0];return ER(n.clientX,n.clientY)},EV=function(t,n){var e,o,r=hK.DOM.getPos(t);return e=r.x,o=r.y,ER(n.x+e,n.y+o)},EL=function(t){return{type:"selection",root:nh.fromDom(t.selection.getNode())}},Ez=function(t,n,e){switch(e){case"node":return{type:"node",node:tw.some(nh.fromDom(t.selection.getNode())),root:nh.fromDom(t.getBody())};case"point":return"contextmenu"!==n.type&&"longpress"!==n.type?EL(t):t.inline?EP(n):EV(t.getContentAreaContainer(),EH(n));case"selection":return EL(t)}},EU=function(t,n,e,o,r,i){var u=e(),a=Ez(t,n,i);SU(u,he.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),go.showMenuAt(r,{anchor:a},{menu:{markers:hh("normal")},data:t})})},Ej={onLtr:function(){return[aH,aF,aI,aR,aN,aP,gp,gh,gg,gd,gm,gf]},onRtl:function(){return[aH,aI,aF,aN,aR,aP,gp,gh,gm,gf,gg,gd]}},EW={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},EG=function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return sF(t.getWin(),sl.domRange(r)).exists(function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY})},EX=function(t){var n=t.selection.getRng(),e=function(){gk.setEditorTimeout(t,function(){t.selection.setRng(n)},10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}},EY=function(t,n,e){var o=Ez(t,n,e);return tp({bubble:cq(0,"point"===e?12:0,EW),layouts:Ej,overrides:{maxWidthFunction:O8(),maxHeightFunction:cj()}},o)},Eq=function(t,n,e,o,r,i,u){var a=EY(t,n,i);SU(e,he.CLOSE_ON_EXECUTE,o,!0).map(function(e){n.preventDefault(),go.showMenuWithinBounds(r,{anchor:a},{menu:{markers:hh("normal"),highlightImmediately:u},data:e,type:"horizontal"},function(){return tw.some(T0(t,o.shared,"node"===i?"node":"selection"))}),t.fire(Tz)})},EK=function(t,n,e,o,r,i){var u=n0(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),l=u.deviceType.isTouch(),f=function(){Eq(t,n,e(),o,r,i,!(s||a||c&&l))};if((c||a)&&"node"!==i){var d=function(){EX(t),f()};EG(t,n)?d():(t.once("selectionchange",d),t.once("touchend",function(){return t.off("selectionchange",d)}))}else f()},EJ=function(t){return"string"==typeof t?t.split(/[ ,]/):t},E$=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},EQ=function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return tw.from(t.getParam(n)).map(EJ).getOrThunk(function(){return tR(EJ(e),function(t){return nt(o,t)})})},EZ=function(t){return Y(t)?"|"===t:"separator"===t.type},E0={type:"separator"},E1=function(t){var n,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(Y(t))return t;switch(t.type){case"separator":return E0;case"submenu":return tp(tp({type:"nestedmenuitem"},e(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return Y(n)?n:tB(n,E1)}});default:return tp(tp({type:"menuitem"},e(t)),{onAction:(n=t.onAction,function(){return n()})})}},E2=function(t,n){if(0===n.length)return t;var e=t$(t).filter(function(t){return!EZ(t)}).fold(function(){return[]},function(t){return[E0]});return t.concat(e).concat(n).concat([E0])},E5=function(t,n,e){var o=tP(n,function(n,o){return t7(t,o.toLowerCase()).map(function(t){var o=t.update(e);return Y(o)?E2(n,o.split(" ")):o.length>0?E2(n,tB(o,E1)):n}).getOrThunk(function(){return n.concat([o])})},[]);return o.length>0&&EZ(o[o.length-1])&&o.pop(),o},E3=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},E9=function(t,n){return E3(t,n)?t.selection.getStart(!0):n.target},E4=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string"),o=E3(t,n)?"selection":"point";if(!nm(e))return o;var r=E9(t,n);return bG(nh.fromDom(r),e)?"node":o},E6=function(t,n,e){var o=n0().deviceType.isTouch,r=uU(go.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:aZ([mT("dismissContextMenu",[iI(iv(),function(n,e){lx.close(n),t.focus()})])])})),i=function(t){return go.hide(r)},u=function(n){if(E$(t)&&n.preventDefault(),(!n.ctrlKey||E$(t))&&!1!==t.getParam("contextmenu")){var i=E4(t,n);(o()?EK:EU)(t,n,function(){var e=E9(t,n),o=t.ui.registry.getAll(),r=EQ(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen");return E5(o.contextMenus,r,e)},e,r,i)}};t.on("init",function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,i),t.on("longpress contextmenu",u)})},E8=r_.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),E7=function(t){return function(n){return n.translate(-t.left,-t.top)}},Dt=function(t){return function(n){return n.translate(t.left,t.top)}},Dn=function(t){return function(n,e){return tP(t,function(t,n){return n(t)},ej(n,e))}},De=function(t,n,e){return t.fold(Dn([Dt(e),E7(n)]),Dn([E7(n)]),Dn([]))},Do=function(t,n,e){return t.fold(Dn([Dt(e)]),Dn([]),Dn([Dt(n)]))},Dr=function(t,n,e){return t.fold(Dn([]),Dn([E7(e)]),Dn([Dt(n),E7(e)]))},Di=function(t,n,e,o,r,i){var u=Do(t,r,i),a=Do(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o},Du=function(t,n,e,o,r,i){var u=Do(t,r,i),a=Do(n,r,i);return ej(Math.abs(u.left-a.left),Math.abs(u.top-a.top))},Da=function(t,n,e){var o=t.fold(function(t,n){return{position:tw.some("absolute"),left:tw.some(t+"px"),top:tw.some(n+"px")}},function(t,n){return{position:tw.some("absolute"),left:tw.some(t-e.left+"px"),top:tw.some(n-e.top+"px")}},function(t,n){return{position:tw.some("fixed"),left:tw.some(t+"px"),top:tw.some(n+"px")}});return tp({right:tw.none(),bottom:tw.none()},o)},Dc=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(Dr,Ds),r(Do,Dl),r(De,Df))},Ds=E8.offset,Dl=E8.absolute,Df=E8.fixed,Dd=function(t,n){var e=eS(t,n);return Q(e)?NaN:parseInt(e,10)},Dm=function(t,n){var e=t.element,o=Dd(e,n.leftAttr),r=Dd(e,n.topAttr);return isNaN(o)||isNaN(r)?tw.none():tw.some(ej(o,r))},Dg=function(t,n,e){var o=t.element;ex(o,n.leftAttr,e.left+"px"),ex(o,n.topAttr,e.top+"px")},Dp=function(t,n){var e=t.element;eO(e,n.leftAttr),eO(e,n.topAttr)},Dh=function(t,n,e,o,r,i){var u=Dm(t,n).fold(function(){return e},function(t){return Df(t.left+o.left,t.top+o.top)}),a=n.mustSnap?Dy(t,n,u,r,i):Dx(t,n,u,r,i),c=De(u,r,i);return Dg(t,n,c),a.fold(function(){return{coord:Df(c.left,c.top),extra:tw.none()}},function(t){return{coord:t.output,extra:t.extra}})},Dv=function(t,n){Dp(t,n)},Db=function(t,n,e,o){return tZ(t,function(t){return Di(n,t.sensor,t.range.left,t.range.top,e,o)?tw.some({output:Dc(t.output,n,e,o),extra:t.extra}):tw.none()})},Dy=function(t,n,e,o,r){var i=n.getSnapPoints(t);return Db(i,e,o,r).orThunk(function(){return tP(i,function(t,n){var i=Du(e,n.sensor,n.range.left,n.range.top,o,r);return t.deltas.fold(function(){return{deltas:tw.some(i),snap:tw.some(n)}},function(e){return(i.left+i.top)/2<=(e.left+e.top)/2?{deltas:tw.some(i),snap:tw.some(n)}:t})},{deltas:tw.none(),snap:tw.none()}).snap.map(function(t){return{output:Dc(t.output,e,o,r),extra:t.extra}})})},Dx=function(t,n,e,o,r){return Db(n.getSnapPoints(t),e,o,r)},Dw=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=on(n8(t.element)),u=CL(r);eA(r,Da({coord:Dc(o.output,o.output,i,u),extra:o.extra}.coord,i,u))}}}),DS="data-initial-z-index",Dk=function(t){ee(t.element).filter(ny).each(function(t){ek(t,DS).fold(function(){return eN(t,"z-index")},function(n){return eE(t,"z-index",n)}),eO(t,DS)})},DC=function(t){ee(t.element).filter(ny).each(function(n){eF(n,"z-index").each(function(t){ex(n,DS,t)}),eE(n,"z-index",eB(t.element,"z-index"))})},DO=function(t,n){t.getSystem().addToGui(n),DC(n)},D_=function(t){Dk(t),t.getSystem().removeFromGui(t)},DT=function(t,n,e){return t.getSystem().build(b7.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},DE=rp("snaps",[rn("getSnapPoints"),ar("onSensor"),rn("leftAttr"),rn("topAttr"),rh("lazyViewport",om),rh("mustSnap",!1)]),DD=[rh("useFixed",td),rn("blockerClass"),rh("getTarget",ta),rh("onDrag",tr),rh("repositionTarget",!0),rh("onDrop",tr),rS("getBounds",om),DE],DA=function(t){var n,e,o,r,i;return(n=eF(t,"left"),e=eF(t,"top"),o=eF(t,"position"),n.isSome()&&e.isSome()&&o.isSome()?tw.some((r=n.getOrDie(),i=e.getOrDie(),("fixed"===o.getOrDie()?Df:Ds)(parseInt(r,10),parseInt(i,10)))):tw.none()).getOrThunk(function(){var n=eX(t);return Dl(n.left,n.top)})},DB=function(t,n,e,o,r){var i=r.bounds,u=Do(n,e,o),a=Dl(aS(u.left,i.x,i.x+i.width-r.width),aS(u.top,i.y,i.y+i.height-r.height));return n.fold(function(){var t=Dr(a,e,o);return Ds(t.left,t.top)},tu(a),function(){var t=De(a,e,o);return Df(t.left,t.top)})},DM=function(t,n,e,o,r,i,u){var a=n.fold(function(){var t,n,u=De((t=i.left,n=i.top,e.fold(function(e,o){return Ds(e+t,o+n)},function(e,o){return Dl(e+t,o+n)},function(e,o){return Df(e+t,o+n)})),o,r);return Df(u.left,u.top)},function(n){var u=Dh(t,n,e,i,o,r);return u.extra.each(function(e){n.onSensor(t,e)}),u.coord});return DB(t,a,o,r,u)},DF=function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=on(n8(t.element)),u=CL(r),a=DA(r);eA(r,Da(DM(t,n.snaps,a,i,u,o,e),i,u))}n.onDrag(t,r,o)},DI=function(t,n){return{bounds:t.getBounds(),height:ez(n.element),width:eJ(n.element)}},DR=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk(function(){return DI(n,t)});i.each(function(e){DF(t,n,u,e)})},DN=function(t,n,e,o){n.each(D_),e.snaps.each(function(n){Dv(t,n)});var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},DP=function(t){return function(n,e){var o=function(t){e.setStartData(DI(n,t))};return iB(tv([iI(im(),function(t){e.getStartData().each(function(){return o(t)})})],t(n,e,o),!0))}},DH=Object.freeze({__proto__:null,getData:function(t){return tw.from(ej(t.x,t.y))},getDelta:function(t,n){return ej(n.left-t.left,n.top-t.top)}}),DV=function(t,n,e){return[iI(rW(),function(o,r){if(0===r.event.raw.button){r.stop();var i=function(){return DN(o,tw.some(c),t,n)},u=bX(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),DR(o,t,n,DH,e)}},c=DT(o,t.blockerClass,iB([iI(rW(),a.forceDrop),iI(rY(),a.drop),iI(rG(),function(t,n){a.move(n.event)}),iI(rX(),a.delayDrop)]));e(o),DO(o,c)}})]},DL=tv(tv([],DD,!0),[ac("dragger",{handlers:DP(DV)})],!1),Dz=function(t){var n=t[0];return tw.some(ej(n.clientX,n.clientY))},DU=Object.freeze({__proto__:null,getData:function(t){var n=t.raw.touches;return 1===n.length?Dz(n):tw.none()},getDelta:function(t,n){return ej(n.left-t.left,n.top-t.top)}}),Dj=function(t,n,e){var o=cO(),r=function(e){DN(e,o.get(),t,n),o.clear()};return[iI(rL(),function(i,u){u.stop();var a,c=function(){return r(i)},s=DT(i,t.blockerClass,(a={drop:c,delayDrop:tr,forceDrop:c,move:function(e){DR(i,t,n,DU,e)}},iB([iI(rL(),a.forceDrop),iI(rU(),a.drop),iI(rj(),a.drop),iI(rz(),function(t,n){a.move(n.event)})])));o.set(s),e(i),DO(i,s)}),iI(rz(),function(e,o){o.stop(),DR(e,t,n,DU,o.event)}),iI(rU(),function(t,n){n.stop(),r(t)}),iI(rj(),r)]},DW=a5({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:DL,touch:tv(tv([],DD,!0),[ac("dragger",{handlers:DP(Dj)})],!1),mouseOrTouch:tv(tv([],DD,!0),[ac("dragger",{handlers:DP(function(t,n,e){return tv(tv([],DV(t,n,e),!0),Dj(t,n,e),!0)})})],!1)}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:tw.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=tw.none(),n=tw.none(),e=function(n,e){var o=t.map(function(t){return n.getDelta(t,e)});return t=tw.some(e),o};return ua({readState:tu({}),reset:function(){t=tw.none(),n=tw.none()},update:function(t,n){return t.getData(n).bind(function(n){return e(t,n)})},getStartData:function(){return n},setStartData:function(t){n=tw.some(t)}})}}),apis:Dw}),DG=function(t,n,e,o,r,i){return t.fold(function(){return DW.snap({sensor:Dl(e-20,o-20),range:ej(r,i),output:Dl(tw.some(e),tw.some(o)),extra:{td:n}})},function(t){var r=t.element.dom.getBoundingClientRect();return DW.snap({sensor:Dl(e-20,o-20),range:ej(40,40),output:Dl(tw.some(e-r.width/2),tw.some(o-r.height/2)),extra:{td:n}})})},DX=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td;n.get().exists(function(t){return n9(t,r)})||(n.set(r),e(r))},mustSnap:!0}},DY=function(t){return g_(gC.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:aZ([DW.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),y9.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},Dq=function(t,n){var e=rO([]),o=rO([]),r=rO(!1),i=cO(),u=cO(),a=function(t){var e=od(t);return DG(f.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=od(t);return DG(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=DX(function(){return tB(e.get(),function(t){return a(t)})},i,function(n){u.get().each(function(e){t.fire("TableSelectorChange",{start:n,finish:e})})}),l=DX(function(){return tB(o.get(),function(t){return c(t)})},u,function(n){i.get().each(function(e){t.fire("TableSelectorChange",{start:e,finish:n})})}),f=DY(s),d=DY(l),m=uU(f.asSpec()),g=uU(d.asSpec()),p=function(n,e,o,r){var i=e.dom.getBoundingClientRect();eN(n.element,"display");var u=en(nh.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&eE(n.element,"display","none")},h=function(t,n,e,o){var r=e(n);DW.snapTo(t,r),p(t,n,function(t){return t[o]<0},function(t,n){return t[o]>n})},v=function(t){return h(m,t,a,"top")},b=function(t){return h(g,t,c,"bottom")};n0().deviceType.isTouch()&&(t.on("TableSelectionChange",function(t){r.get()||(ln(n,m),ln(n,g),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each(function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),v(t.start),b(t.finish)})}),t.on("ResizeEditor ResizeWindow ScrollContent",function(){i.get().each(v),u.get().each(b)}),t.on("TableSelectionClear",function(){r.get()&&(lr(m),lr(g),r.set(!1)),i.clear(),u.clear()}))},DK=function(t,n,e){n.delimiter||(n.delimiter="\xbb");var o=function(o){var r=tB(o||[],function(n,o){return gC.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:aZ([vm.button(e.isDisabled),vd()])})}),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}};return tP(r.slice(1),function(t,n){return t.push(i),t.push(n),t},[r[0]])},r=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o];if(1===r.nodeType&&!(1===r.nodeType&&("BR"===r.nodeName||r.getAttribute("data-mce-bogus")||"bookmark"===r.getAttribute("data-mce-type")))){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:aZ([mx.config({mode:"flow",selector:"div[role=button]"}),fJ.config({disabled:e.isDisabled}),vd(),yi.config({}),mO.config({}),mT("elementPathEvents",[iz(function(n,e){t.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return mx.focusIn(n)}),t.on("NodeChange",function(t){var e=r(t.parents);e.length>0?mO.set(n,o(e)):mO.set(n,[])})})])]),components:[]}};(E=U||(U={}))[E.None=0]="None",E[E.Both=1]="Both",E[E.Vertical=2]="Vertical";var DJ=function(t,n,e,o,r){var i={};return i.height=TI(o+n.top,h1(t),h5(t)),e===U.Both&&(i.width=TI(r+n.left,h0(t),h2(t))),i},D$=function(t,n,e){var o=nh.fromDom(t.getContainer());t2(DJ(t,n,e,eL(o),eK(o)),function(t,n){return eE(o,n,TF(t))}),t.fire("ResizeEditor")},DQ=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?U.None:"both"===e?U.Both:U.Vertical},DZ=function(t,n,e,o){return D$(t,ej(20*e,20*o),n),tw.some(!0)},D0=function(t,n){var e=DQ(t);return e===U.None?tw.none():tw.some(pO("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[DW.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return D$(t,r,e)},blockerClass:"tox-blocker"}),mx.config({mode:"special",onLeft:function(){return DZ(t,e,-1,0)},onRight:function(){return DZ(t,e,1,0)},onUp:function(){return DZ(t,e,0,-1)},onDown:function(){return DZ(t,e,0,1)}}),yi.config({}),mB.config({})]},n.icons))},D1=function(t,n){var e,o=function(t,e,o){return mO.set(t,[uL(n.translate(["{0} "+o,e[o]]))])};return gC.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:aZ([vm.button(n.isDisabled),vd(),yi.config({}),mO.config({}),lH.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),mT("wordcount-events",[iW(function(t){var n=lH.getValue(t),e="words"===n.mode?"characters":"words";lH.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)}),iz(function(n){t.on("wordCountUpdate",function(t){var e=lH.getValue(n).mode;lH.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)})})])]),eventOrder:((e={})[io()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})},D2=function(t,n){var e,o,r,i;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(e=[],t.getParam("elementpath",!0,"boolean")&&e.push(DK(t,{},n)),t.hasPlugin("wordcount")&&e.push(D1(t,n)),t.getParam("branding",!0,"boolean")&&e.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(i=pp.translate(["Powered by {0}","Tiny"]))+'">'+i+"</a>"}}),o=e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[],r=D0(t,n),o.concat(r.toArray()))}},D5=function(t){var n,e,o,r,i=t.inline,u=i?TL:TB,a=vi(t)?Os:CH,c=tw.none(),s=n0(),l=s.browser.isIE()?["tox-platform-ie"]:[],f=s.deviceType.isTouch()?["tox-platform-touch"]:[],d=vt(t),m=vo(t),g=pp.isRtl()?{attributes:{dir:"rtl"}}:{},p={attributes:((r={})[cQ]=d?M.BottomToTop:M.TopToBottom,r)},h=function(){return c.bind(_B.getHeader)},v=uU((n=n9(ev(),m)&&"grid"===eB(m,"display"),e={dom:tp({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(l).concat(f)},g),behaviours:aZ([s9.config({useFixed:function(){return a.isDocked(h)}})])},o={dom:{styles:{width:document.body.clientWidth+"px"}},events:iB([iI(ig(),function(){eE(U.element,"width",document.body.clientWidth+"px")})])},oC(e,n?o:{}))),b=function(){return oh.value(v)},y=g_({dom:{tag:"div",classes:["tox-anchorbar"]}}),x=function(){return c.bind(function(t){return _B.getThrobber(t)}).getOrDie("Could not find throbber element")},w=CD(v,t,function(){return c.bind(function(t){return y.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),S=_B.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:w,onEscape:function(){t.focus()}}),k=h8(t),C=_B.parts.toolbar(tp({dom:{tag:"div",classes:["tox-toolbar"]},getSink:b,providers:w.shared.providers,onEscape:function(){t.focus()},type:k,lazyToolbar:function(){return c.bind(function(t){return _B.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return h().getOrDie("Could not find header element")}},p)),O=_B.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:w.shared.providers,onEscape:function(){t.focus()},type:k}),_=_B.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),T=_B.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),E=_B.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:w}),D=t.getParam("statusbar",!0,"boolean")&&!i?tw.some(D2(t,w.shared.providers)):tw.none(),A=h6(t),B=h9(t),F=h3(t),I=_B.parts.header({dom:tp({tag:"div",classes:["tox-editor-header"]},p),components:tz([F?[S]:[],A?[O]:B?[C]:[],ve(t)?[]:[y.asSpec()]]),sticky:vi(t),editor:t,sharedBackstage:w.shared}),N=tz([d?[]:[I],i?[]:[{dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[_,T]}],d?[I]:[]]),P=tz([[{dom:{tag:"div",classes:["tox-editor-container"]},components:N}],i?[]:D.toArray(),[E]]),H=vr(t),V=tp(tp({role:"application"},pp.isRtl()?{dir:"rtl"}:{}),H?{"aria-hidden":"true"}:{}),L=uU(_B.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(i?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(f).concat(l),styles:tp({visibility:"hidden"},H?{opacity:"0",border:"0"}:{}),attributes:V},components:P,behaviours:aZ([vd(),fJ.config({disableClass:"tox-tinymce--disabled"}),mx.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));c=tw.some(L),t.shortcuts.add("alt+F9","focus menubar",function(){_B.focusMenubar(L)}),t.shortcuts.add("alt+F10","focus toolbar",function(){_B.focusToolbar(L)}),t.addCommand("ToggleToolbarDrawer",function(){_B.toggleToolbarDrawer(L)}),t.addQueryStateHandler("ToggleToolbarDrawer",function(){return _B.isToolbarDrawerToggled(L)});var z=yt(L),U=yt(v);CA(t,z,U);var j=function(){var n=TF(TR(t).getOr(hQ(t))),e=TF(TN(t).getOr(hZ(t)));return t.inline||(eR("div","width",e)&&eE(L.element,"width",e),eR("div","height",n)?eE(L.element,"height",n):eE(L.element,"height","200px")),n};return{mothership:z,uiMothership:U,backstage:w,renderUI:function(){a.setup(t,w.shared,h),EI(t,w),E6(t,b,w),OH(t),O$(t,x,w.shared),t5(t.getParam("toolbar_groups",{},"object"),function(n,e){t.ui.registry.addGroupToolbarButton(e,n)});var n=t.ui.registry.getAll(),e=n.buttons,o=n.menuItems,r=n.contextToolbars,i=n.sidebars,c=h4(t),s={menuItems:o,menus:vu(t),menubar:t.getParam("menubar"),toolbar:c.getOrThunk(function(){return t.getParam("toolbar",!0)}),allowToolbarGroups:k===R.floating,buttons:e,sidebar:i};El(t,r,v,{backstage:w}),Dq(t,v);var l=t.getElement(),f=j();return u.render(t,{mothership:z,uiMothership:U,outerContainer:L},s,w,{targetNode:l,height:f})},getUi:function(){return{channels:{broadcastAll:U.broadcast,broadcastOn:U.broadcastOn,register:tr}}}}},D3=function(t,n){var e=tw.from(eS(t,"id")).fold(function(){var t=iQ("dialog-describe");return ex(n,"id",t),t},ta);ex(t,"aria-describedby",e)},D9=function(t,n){var e=ek(t,"id").fold(function(){var t=iQ("dialog-label");return ex(n,"id",t),t},ta);ex(t,"aria-labelledby",e)},D4=tu([rn("lazySink"),rs("dragBlockClass"),rS("getBounds",om),rh("useTabstopAt",tm),rh("eventOrder",{}),lV("modalBehaviours",[mx]),ai("onExecute"),aa("onEscape")]),D6={sketch:ta},D8=tu([fi({name:"draghandle",overrides:function(t,n){return{behaviours:aZ([DW.config({mode:"mouse",getTarget:function(t){return uq(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),fo({schema:[rn("dom")],name:"title"}),fo({factory:D6,schema:[rn("dom")],name:"close"}),fo({factory:D6,schema:[rn("dom")],name:"body"}),fi({factory:D6,schema:[rn("dom")],name:"footer"}),fr({factory:{sketch:function(t,n){return tp(tp({},t),{dom:n.dom,components:n.components})}},schema:[rh("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),rh("components",[])],name:"blocker"})]),D7=fI({name:"ModalDialog",configFields:D4(),partFields:D8(),factory:function(t,n,e,o){var r,i=cO(),u=iQ("modal-events"),a=tp(tp({},t.eventOrder),((r={})[ip()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(tp(tp({},r),{components:r.components.concat([ur(n)]),behaviours:aZ([mB.config({}),mT("dialog-blocker-events",[iL(rK(),function(){mx.focusIn(n)})])])}));ln(e,u),mx.focusIn(n)},hide:function(t){i.clear(),ee(t.element).each(function(n){t.getSystem().getByDom(n).each(function(t){lr(t)})})},getBody:function(n){return fy(n,t,"body")},getFooter:function(n){return fy(n,t,"footer")},setIdle:function(t){OY.unblock(t)},setBusy:function(t,n){OY.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:lz(t.modalBehaviours,[mO.config({}),mx.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),OY.config({getRoot:i.get}),mT(u,[iz(function(n){D9(n.element,fy(n,t,"title").element),D3(n.element,fy(n,t,"body").element)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),At=oU([ro("type"),ro("name")].concat(hB)),An=[ow("name","name",oT(function(){return iQ("button-name")}),oK),rd("icon"),rx("align","end",["start","end"]),rw("primary",!1),rw("disabled",!1)],Ae=tv(tv([],An,!0),[ro("text")],!1),Ao=tv([rr("type",["submit","cancel","custom"])],Ae,!0),Ar=o8("type",{submit:Ao,cancel:Ao,custom:Ao,menu:tv([rr("type",["menu"]),rd("text"),rd("tooltip"),rd("icon"),rc("items",At)],An,!0)}),Ai=oU([ro("type"),ro("text"),rr("level",["info","warn","error","success"]),ro("icon"),rh("url","")]),Au=oU([ro("type"),ro("text"),rw("disabled",!1),rw("primary",!1),ow("name","name",oT(function(){return iQ("button-name")}),oK),rd("icon"),rw("borderless",!1)]),Aa=oU([ro("type"),ro("name"),ro("label"),rw("disabled",!1)]),Ac=[ro("type"),ro("name")],As=Ac.concat([rd("label")]),Al=oU(As.concat([rh("columns","auto")])),Af=oG([ro("value"),ro("text"),ro("icon")]),Ad=oU(As),Am=oU(As),Ag=Ac.concat([ry("tag","textarea"),ro("scriptId"),ro("scriptUrl"),rv("settings",void 0,oZ)]),Ap=Ac.concat([ry("tag","textarea"),ri("init")]),Ah=o1(function(t){return o3("customeditor.old",oz(Ap),t).orThunk(function(){return o3("customeditor.new",oz(Ag),t)})}),Av=oU(As),Ab=oj(oN),Ay=oU([ro("type"),ro("html"),rx("presets","presentation",["presentation","document"])]),Ax=oU(As.concat([rw("sandboxed",!0)])),Aw=As.concat([re("currentState",oU([rn("blob"),ro("url")]))]),AS=oU(Aw),Ak=oU(As.concat([rd("inputMode"),rd("placeholder"),rw("maximized",!1),rw("disabled",!1)])),AC=[ro("text"),ro("value")],AO=[ro("text"),rc("items",(n=nk(function(){return A_}),{extract:function(t,e){return n().extract(t,e)},toString:function(){return n().toString()}}))],A_=oW([oU(AC),oU(AO)]),AT=oU(As.concat([rc("items",A_),rw("disabled",!1)])),AE=oU(As.concat([ra("items",[ro("text"),ro("value")]),rb("size",1),rw("disabled",!1)])),AD=oU(As.concat([rw("constrain",!0),rw("disabled",!1)])),AA=oU([ro("width"),ro("height")]),AB=oU([ro("type"),rc("header",oK),rc("cells",oj(oK))]),AM=oU(As.concat([rd("placeholder"),rw("maximized",!1),rw("disabled",!1)])),AF=oU(As.concat([rx("filetype","file",["image","media","file"]),rh("disabled",!1)])),AI=oU([ro("value"),rh("meta",{})]),AR=function(t){return ow("items","items",o_(),oj(o1(function(n){return o3("Checking item of "+t,AN,n).fold(function(t){return oh.error(o6(t))},function(t){return oh.value(t)})})))},AN=oL(function(){var t,n,e;return o0("type",{alertbanner:Ai,bar:oU((t=AR("bar"),[ro("type"),t])),button:Au,checkbox:Aa,colorinput:Ad,colorpicker:Am,dropzone:Av,grid:oU((e=AR("grid"),[ro("type"),re("columns",oq),e])),iframe:Ax,input:Ak,listbox:AT,selectbox:AE,sizeinput:AD,textarea:AM,urlinput:AF,customeditor:Ah,htmlpanel:Ay,imagetools:AS,collection:Al,label:oU((n=AR("label"),[ro("type"),ro("label"),n])),table:AB,panel:AP})}),AP=oU([ro("type"),rh("classes",[]),rc("items",AN)]),AH=[ow("name","name",oT(function(){return iQ("tab-name")}),oK),ro("title"),rc("items",AN)],AV=oU([ro("type"),ra("tabs",AH)]),AL=oU([ro("title"),re("body",o0("type",{panel:AP,tabpanel:AV})),ry("size","normal"),rc("buttons",Ar),rh("initialData",{}),rS("onAction",tr),rS("onChange",tr),rS("onSubmit",tr),rS("onClose",tr),rS("onCancel",tr),rh("onTabChange",tr)]),Az=oU(tv([rr("type",["cancel","custom"])],Ae,!0)),AU=oU([ro("title"),ro("url"),rf("height"),rf("width"),rg("buttons",Az),rS("onAction",tr),rS("onCancel",tr),rS("onClose",tr),rS("onMessage",tr)]),Aj=function(t){return q(t)?[t].concat(tU(t8(t),Aj)):K(t)?tU(t,Aj):[]},AW=function(t){return Y(t.type)&&Y(t.name)},AG={checkbox:oJ,colorinput:oK,colorpicker:oK,dropzone:Ab,input:oK,iframe:oK,sizeinput:AA,selectbox:oK,listbox:oK,size:AA,textarea:oK,urlinput:AI,customeditor:oK,collection:Af,togglemenuitem:oJ},AX=function(t){return{internalDialog:o9(o3("dialog",AL,t)),dataValidator:oU(tU(tR(Aj(t),AW),function(t){return tw.from(AG[t.type]).fold(function(){return[]},function(n){return[re(t.name,n)]})})),initialData:t.initialData}},AY={open:function(t,n){var e=AX(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(o9(o3("dialog",AU,n)))},redial:function(t){return AX(t)}},Aq=function(t){var n=[],e={};return t2(t,function(t,o){t.fold(function(){n.push(o)},function(t){e[o]=t})}),n.length>0?oh.error(n):oh.value(e)},AK=function(t,n){var e=g_(w_.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:tB(t.items,function(t){return kQ(e,t,n)})}}));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:aZ([mx.config({mode:"acyclic",useTabstopAt:tl(wJ)}),wF.memento(e),wz.memento(e,{postprocess:function(t){return Aq(t).fold(function(t){return console.error(t),{}},ta)}})])}},AJ=fF({name:"TabButton",configFields:[rh("uid",void 0),rn("value"),ow("dom","dom",oA(function(){return{attributes:{role:"tab",id:iQ("aria"),"aria-selected":"false"}}}),oX()),rs("action"),rh("domModification",{}),lV("tabButtonBehaviours",[mB,mx,lH]),rn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:mW(t.action),behaviours:lz(t.tabButtonBehaviours,[mB.config({}),mx.config({mode:"execution",useSpace:!0,useEnter:!0}),lH.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),A$=tu([rn("tabs"),rn("dom"),rh("clickToDismiss",!1),lV("tabbarBehaviours",[f4,mx]),ae(["tabClass","selectedClass"])]),AQ=tu([fu({factory:AJ,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){f4.dehighlight(t,n),i_(t,iS(),{tabbar:t,button:n})},e=function(t,n){f4.highlight(t,n),i_(t,iw(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=f4.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?tr:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}})]),AZ=fI({name:"Tabbar",configFields:A$(),partFields:AQ(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:lz(t.tabbarBehaviours,[f4.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){ex(n.element,"aria-selected","true")},onDehighlight:function(t,n){ex(n.element,"aria-selected","false")}}),mx.config({mode:"flow",getInitial:function(t){return f4.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),A0=fF({name:"Tabview",configFields:[lV("tabviewBehaviours",[mO])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:lz(t.tabviewBehaviours,[mO.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),A1=tu([rh("selectFirst",!0),ar("onChangeTab"),ar("onDismissTab"),rh("tabs",[]),lV("tabSectionBehaviours",[])]),A2=tu([fo({factory:AZ,schema:[rn("dom"),ru("markers",[rn("tabClass"),rn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),fo({factory:A0,name:"tabview"})]),A5=fI({name:"TabSection",configFields:A1(),partFields:A2(),factory:function(t,n,e,o){var r=function(n){var e=lH.getValue(n);fb(n,t,"tabview").each(function(o){tV(t.tabs,function(t){return t.value===e}).each(function(e){var r=e.view();ek(n.element,"id").each(function(t){ex(o.element,"aria-labelledby",t)}),mO.set(o,r),t.onChangeTab(o,n,r)})})},i=function(n,e){fb(n,t,"tabbar").each(function(t){e(t).each(iT)})};return{uid:t.uid,dom:t.dom,components:n,behaviours:lL(t.tabSectionBehaviours),events:iB(tz([t.selectFirst?[iz(function(t,n){i(t,f4.getFirst)})]:[],[iI(iw(),function(t,n){r(n.event.button)}),iI(iS(),function(n,e){var o=e.event.button;t.onDismissTab(n,o)})]])),apis:{getViewItems:function(n){return fb(n,t,"tabview").map(function(t){return mO.contents(t)}).getOr([])},showTab:function(t,n){i(t,function(t){return tV(f4.getCandidates(t),function(t){return lH.getValue(t)===n}).filter(function(n){return!f4.isHighlighted(t,n)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),A3=function(t,n,e){var o,r=et(t).dom;o="fixed"===eB(uq(t,".tox-dialog-wrap").getOr(t),"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var i=eL(n),u=n.dom.offsetLeft>=e.dom.offsetLeft+eK(e)?Math.max(eL(e),i):i,a=parseInt(eB(t,"margin-top"),10)||0,c=parseInt(eB(t,"margin-bottom"),10)||0;return o-(eL(t)+a+c-u)},A9=function(t,n){tJ(t).each(function(t){return A5.showTab(n,t.value)})},A4=function(t,n){eE(t,"height",n+"px"),n0().browser.isIE()?eN(t,"flex-basis"):eE(t,"flex-basis",n+"px")},A6=function(t,n,e){uq(t,'[role="dialog"]').each(function(t){uK(t,'[role="tablist"]').each(function(o){e.get().map(function(e){return eE(n,"height","0"),eE(n,"flex-basis","0"),Math.min(e,A3(t,n,o))}).each(function(t){A4(n,t)})})})},A8=function(t){return uK(t,'[role="tabpanel"]')},A7=function(t){var n;return{smartTabHeight:(n=cO(),{extraEvents:[iz(function(e){var o=e.element;A8(o).each(function(r){eE(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each(function(e){tJ(tq(tB(t,function(n,o){mO.set(e,t[o].view());var i=r.dom.getBoundingClientRect();return mO.set(e,[]),i.height}),function(t,n){return t>n?-1:t<n?1:0})).fold(n.clear,n.set)}),A6(o,r,n),eN(r,"visibility"),A9(t,e),gk.requestAnimationFrame(function(){A6(o,r,n)})})}),iI(ig(),function(t){var e=t.element;A8(e).each(function(t){A6(e,t,n)})}),iI(yy,function(t,e){var o=t.element;A8(o).each(function(t){var e=ct(ef(t));eE(t,"visibility","hidden");var r=eF(t,"height").map(function(t){return parseInt(t,10)});eN(t,"height"),eN(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall(function(t){return i>t})?(n.set(i),A6(o,t,n)):r.each(function(n){A4(t,n)}),eN(t,"visibility"),e.each(a8)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},Bt="send-data-to-section",Bn="send-data-to-view",Be=function(t,n){var e=rO({}),o=function(t){var n=Aq(lH.getValue(t)).getOr({}),o=oC(e.get(),n);e.set(o)},r=function(t){var n=e.get();lH.setValue(t,n)},i=rO(null),u=tB(t.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[w_.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"]},components:tB(t.items,function(t){return kQ(e,t,n)}),formBehaviours:aZ([mx.config({mode:"acyclic",useTabstopAt:tl(wJ)}),mT("TabView.form.events",[iz(r),iU(o)]),a9.config({channels:rM([{key:Bt,value:{onReceive:o}},{key:Bn,value:{onReceive:r}}])})])}})]}}}),a=A7(u).smartTabHeight;return A5.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=lH.getValue(n);i_(t,yb,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[A5.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[AZ.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:aZ([yi.config({})])}),A5.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:aZ([mT("tabpanel",a.extraEvents),mx.config({mode:"acyclic"}),fP.config({find:function(t){return tJ(A5.getViewItems(t))}}),lH.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([Bt],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([Bn],{})}}})])})},Bo=iQ("update-dialog"),Br=iQ("update-title"),Bi=iQ("update-body"),Bu=iQ("update-footer"),Ba=iQ("body-send-message"),Bc=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:tp(tp({},n.map(function(t){return{id:t}}).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:aZ([wF.childAt(0),Tu.config({channel:Bi,updateState:function(t,n){return tw.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"===t.body.type?[Be(t.body,e)]:[AK(t.body,e)]},initialData:t})])}},Bs=function(t,n){var e=Bc(t,tw.none(),n,!1);return D7.parts.body(e)},Bl=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[wY({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:aZ([yi.config({}),mB.config({})])})]}],behaviours:aZ([mx.config({mode:"acyclic",useTabstopAt:tl(wJ)})])};return D7.parts.body(n)},Bf=vx.deviceType.isTouch(),Bd=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},Bm=function(t,n){return D7.parts.close(gC.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:aZ([yi.config({})])}))},Bg=function(){return D7.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},Bp=function(t,n){return D7.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:gO("<p>"+pg(n.translate(t))+"</p>")}]}]})},Bh=function(t){return D7.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},Bv=function(t,n){return[b7.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),b7.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},Bb=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return D7.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),tw.some(!0)},useTabstopAt:function(t){return!wJ(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:tp({position:"relative"},t.extraStyles)},components:tv([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:gO('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:Bf?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:aZ(tv([mB.config({}),mT("dialog-events",t.dialogEvents.concat([iL(rK(),function(t,n){mx.focusIn(t)})])),mT("scroll-lock",[iz(function(){uO(ev(),i)}),iU(function(){uT(ev(),i)})])],t.extraBehaviours,!0)),eventOrder:tp(((n={})[io()]=["dialog-events"],n[ip()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[ih()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},By=function(t){return gC.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[pO("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){iO(t,ym)}})},Bx=function(t,n,e){var o=function(t){return[uL(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:tp({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:aZ([Tu.config({channel:Br,renderComponents:o})])}},Bw=function(){return{dom:gO('<div class="tox-dialog__draghandle"></div>')}},BS=function(t,n){var e=D7.parts.title(Bx(t,tw.none(),n)),o=D7.parts.draghandle(Bw()),r=D7.parts.close(By(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return b7.sketch({dom:gO('<div class="tox-dialog__header"></div>'),components:i})},Bk=function(t,n){return BS({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},BC=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:gO('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},BO=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){D7.setBusy(t(),function(t,o){return BC(e.message,o,n)})},onUnblock:function(){D7.setIdle(t())}}},B_=function(t,n,e,o){var r;return uU(Bb(tp(tp({},t),{lazySink:o.shared.getSink,extraBehaviours:tv([Tu.config({channel:Bo,updateState:function(t,n){return tw.some(n)},initialData:n}),wz.memory({})],t.extraBehaviours,!0),onEscape:function(t){iO(t,ym)},dialogEvents:e,eventOrder:((r={})[ie()]=[Tu.name(),a9.name()],r[ip()]=["scroll-lock",Tu.name(),"messages","dialog-events","alloy.base.behaviour"],r[ih()]=["alloy.base.behaviour","dialog-events","messages",Tu.name(),"scroll-lock"],r)})))},BT=function(t){var n=function(t){var n=tB(t.items,function(t){var n=rO(!1);return tp(tp({},t),{storage:n})});return tp(tp({},t),{items:n})};return tB(t,function(t){return"menu"===t.type?n(t):t})},BE=function(t){return tP(t,function(t,n){return"menu"===n.type?tP(n.items,function(t,n){return t[n.name]=n.storage,t},t):t},{})},BD=function(t,n){return[iH(rK(),wK),t(yd,function(t,e){n.onClose(),e.onClose()}),t(ym,function(t,n,e,o){n.onCancel(t),iO(o,yd)}),iI(yv,function(t,e){return n.onUnblock()}),iI(yh,function(t,e){return n.onBlock(e.event)})]},BA={initUrlDialog:function(t,n){var e=function(n,e){return iI(n,function(n,r){o(n,function(o,i){e(t(),o,r.event,n)})})},o=function(t,n){Tu.getState(t).get().each(function(e){n(e,t)})};return tv(tv([],BD(e,n),!0),[e(yg,function(t,n,e){n.onAction(t,{name:e.name})})],!1)},initDialog:function(t,n,e){var o=function(n,e){return iI(n,function(n,o){r(n,function(r,i){e(t(),r,o.event,n)})})},r=function(t,n){Tu.getState(t).get().each(function(e){n(e.internalDialog,t)})};return tv(tv([],BD(o,n),!0),[o(yp,function(t,n){return n.onSubmit(t)}),o(yf,function(t,n,e){n.onChange(t,{name:e.name})}),o(yg,function(t,n,o,r){var i=function(){return mx.focusIn(r)},u=function(t){return eC(t,"disabled")||ek(t,"aria-disabled").exists(function(t){return"true"===t})},a=ef(r.element),c=ct(a);n.onAction(t,{name:o.name,value:o.value}),ct(a).fold(i,function(t){u(t)?i():c.exists(function(n){return n6(t,n)&&u(n)})?i():e().toOptional().filter(function(n){return!n6(n.element,t)}).each(i)})}),o(yb,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),iU(function(n){var e=t();lH.setValue(n,e.getData())})],!1)}},BB=function(t,n){var e=tI(n.map(function(t){return t.footerButtons}).getOr([]),function(t){return"start"===t.align}),o=function(t,n){return b7.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:tB(n,function(t){return t.memento.asSpec()})})};return[o("start",e.pass),o("end",e.fail)]},BM=function(t,n){return{dom:gO('<div class="tox-dialog__footer"></div>'),components:[],behaviours:aZ([Tu.config({channel:Bu,initialData:t,updateState:function(t,e){var o=tB(e.buttons,function(t){var e=g_(S$(t,t.type,n));return{name:t.name,align:t.align,memento:e}});return tw.some({lookupByName:function(t,n){return tV(o,function(t){return t.name===n}).bind(function(n){return n.memento.getOpt(t)})},footerButtons:o})},renderComponents:BB})])}},BF=function(t,n){return D7.parts.footer(BM(t,n))},BI=function(t,n){if(!t.getRoot().getSystem().isConnected())return tw.none();var e=fP.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return w_.getField(e,n).fold(function(){var o=t.getFooter();return Tu.getState(o).get().bind(function(t){return t.lookupByName(e,n)})},function(t){return tw.some(t)})},BR=function(t,n){var e=t.getRoot();return Tu.getState(e).get().map(function(t){return o9(o3("data",t.dataValidator,n))}).getOr(n)},BN=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=lH.getValue(o),i=t5(e,function(t){return t.get()});return tp(tp({},r),i)},setData:function(n){o(function(o){var i=r.getData(),u=tp(tp({},i),n),a=BR(t,u),c=t.getFormWrapper();lH.setValue(c,a),t2(e,function(t,n){nt(u,n)&&t.set(u[n])})})},disable:function(n){BI(t,n).each(fJ.disable)},enable:function(n){BI(t,n).each(fJ.enable)},focus:function(n){BI(t,n).each(mB.focus)},block:function(t){if(!Y(t))throw Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o(function(n){i_(n,yh,{message:t})})},unblock:function(){o(function(t){iO(t,yv)})},showTab:function(n){o(function(e){var o=t.getBody();Tu.getState(o).get().exists(function(t){return t.isTabPanel()})&&fP.getCurrent(o).each(function(t){A5.showTab(t,n)})})},redial:function(t){o(function(e){var o=n(t);e.getSystem().broadcastOn([Bo],o),e.getSystem().broadcastOn([Br],o.internalDialog),e.getSystem().broadcastOn([Bi],o.internalDialog),e.getSystem().broadcastOn([Bu],o.internalDialog),r.setData(o.initialData)})},close:function(){o(function(t){iO(t,yd)})}};return r},BP=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},BH=function(t,n,e){var o=Bk(t.internalDialog.title,e),r=Bs({body:t.internalDialog.body},e),i=BT(t.internalDialog.buttons),u=BE(i),a=BF({buttons:i},e),c=BA.initDialog(function(){return f},BO(function(){return l},e.shared.providers,n),e.shared.getSink),s=BP(t.internalDialog.size),l=B_({header:o,body:r,footer:tw.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},t,c,e),f=BN({getRoot:tu(l),getBody:function(){return D7.getBody(l)},getFooter:function(){return D7.getFooter(l)},getFormWrapper:function(){var t=D7.getBody(l);return fP.getCurrent(t).getOr(t)}},n.redial,u);return{dialog:l,instanceApi:f}},BV=function(t,n,e,o){var r,i,u,a,c=iQ("dialog-label"),s=iQ("dialog-content"),l=g_((r={title:t.internalDialog.title,draggable:!0},i=e.shared.providers,b7.sketch({dom:gO('<div class="tox-dialog__header"></div>'),components:[Bx(r,tw.some(c),i),Bw(),By(i)],containerBehaviours:aZ([DW.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return uJ(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),f=g_(Bc({body:t.internalDialog.body},tw.some(s),e,o)),d=BT(t.internalDialog.buttons),m=BE(d),g=g_(BM({buttons:d},e)),p=BA.initDialog(function(){return v},{onBlock:function(t){OY.block(h,function(n,o){return BC(t.message,o,e.shared.providers)})},onUnblock:function(){OY.unblock(h)},onClose:function(){return n.closeWindow()}},e.shared.getSink),h=uU({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((u={role:"dialog"})["aria-labelledby"]=c,u["aria-describedby"]=s,u)},eventOrder:((a={})[ie()]=[Tu.name(),a9.name()],a[io()]=["execute-on-form"],a[ip()]=["reflecting","execute-on-form"],a),behaviours:aZ([mx.config({mode:"cyclic",onEscape:function(t){return iO(t,yd),tw.some(!0)},useTabstopAt:function(t){return!wJ(t)&&("button"!==nv(t)||"disabled"!==eS(t,"disabled"))}}),Tu.config({channel:Bo,updateState:function(t,n){return tw.some(n)},initialData:t}),mB.config({}),mT("execute-on-form",p.concat([iL(rK(),function(t,n){mx.focusIn(t)})])),OY.config({getRoot:function(){return tw.some(h)}}),mO.config({}),wz.memory({})]),components:[l.asSpec(),f.asSpec(),g.asSpec()]}),v=BN({getRoot:tu(h),getFooter:function(){return g.get(h)},getBody:function(){return f.get(h)},getFormWrapper:function(){var t=f.get(h);return fP.getCurrent(t).getOr(t)}},n.redial,m);return{dialog:h,instanceApi:v}},BL=tinymce.util.Tools.resolve("tinymce.util.URI"),Bz=function(t){var n=function(n){t.getSystem().isConnected()&&n(t)};return{block:function(t){if(!Y(t))throw Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(function(n){i_(n,yh,{message:t})})},unblock:function(){n(function(t){iO(t,yv)})},close:function(){n(function(t){iO(t,yd)})},sendMessage:function(t){n(function(n){n.getSystem().broadcastOn([Ba],t)})}}},BU=["insertContent","setContent","execCommand","close","block","unblock"],Bj=function(t){return q(t)&&-1!==BU.indexOf(t.mceAction)},BW=function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!$(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}},BG=function(t,n,e,o){var r,i=Bk(t.title,o),u=Bl(t),a=t.buttons.bind(function(t){return 0===t.length?tw.none():tw.some(BF({buttons:t},o))}),c=BA.initUrlDialog(function(){return p},BO(function(){return g},o.shared.providers,n)),s=tp(tp({},t.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),t.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),l=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],f=new BL(t.url,{base_uri:new BL(window.location.href)}),d=f.protocol+"://"+f.host+(f.port?":"+f.port:""),m=ck(),g=B_({header:i,body:u,footer:a,extraClasses:l,extraBehaviours:[mT("messages",[iz(function(){var n=c_(nh.fromDom(window),"message",function(n){if(f.isSameOrigin(new BL(n.raw.origin))){var o=n.raw.data;Bj(o)?BW(e,p,o):!Bj(o)&&q(o)&&nt(o,"mceAction")&&t.onMessage(p,o)}});m.set(n)}),iU(m.clear)]),a9.config({channels:((r={})[Ba]={onReceive:function(t,n){uK(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(n,d)})}},r)})],extraStyles:s},t,c,o),p=Bz(g);return{dialog:g,instanceApi:p}},BX=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(){D7.hide(u),o()},i=g_(S$({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:tw.none()},"cancel",t.backstage)),u=uU(Bb({lazySink:function(){return n.getSink()},header:Bd(Bg(),Bm(r,n.providers)),body:Bp(e,n.providers),footer:tw.some(Bh(Bv([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[iI(ym,r)],eventOrder:{}}));D7.show(u);var a=i.get(u);mB.focus(a)}}},BY=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(t){D7.hide(a),o(t)},i=g_(S$({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:tw.none()},"submit",t.backstage)),u=S$({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:tw.none()},"cancel",t.backstage),a=uU(Bb({lazySink:function(){return n.getSink()},header:Bd(Bg(),Bm(function(){return r(!1)},n.providers)),body:Bp(e,n.providers),footer:tw.some(Bh(Bv([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[iI(ym,function(){return r(!1)}),iI(yp,function(){return r(!0)})],eventOrder:{}}));D7.show(a);var c=i.get(a);mB.focus(c)}}},Bq=function(t){var n=t.backstage,e=t.editor,o=vi(e),r=BX(t),i=BY(t),u=function(t,r,i,u){return AY.open(function(t,a,c){var s=o9(o3("data",c,a)),l=cO(),f=n.shared.header.isPositionedAtTop(),d=function(){return l.on(function(t){go.reposition(t),C4.refresh(t)})},m=BV({dataValidator:c,initialData:s,internalDialog:t},{redial:AY.redial,closeWindow:function(){l.on(go.hide),e.off("ResizeEditor",d),l.clear(),i(m.instanceApi)}},n,u),g=uU(go.sketch(tp(tp({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},f?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:aZ(tv([mT("window-manager-inline-events",[iI(iv(),function(t,n){iO(m.dialog,ym)})])],o&&f?[]:[C4.config({contextual:{lazyContext:function(){return tw.some(of(nh.fromDom(e.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})],!0)),isExtraPart:function(t,n){return bG(n,".tox-alert-dialog")||bG(n,".tox-confirm-dialog")}})));return l.set(g),go.showWithin(g,ur(m.dialog),{anchor:r},tw.some(ev())),o&&f||(C4.refresh(g),e.on("ResizeEditor",d)),m.instanceApi.setData(s),mx.focusIn(m.dialog),m.instanceApi},t)};return{open:function(t,e,o){return void 0!==e&&"toolbar"===e.inline?u(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?u(t,n.shared.anchors.cursor(),o,e.ariaAttrs):AY.open(function(t,e,r){var i=BH({dataValidator:r,initialData:e,internalDialog:t},{redial:AY.redial,closeWindow:function(){D7.hide(i.dialog),o(i.instanceApi)}},n);return D7.show(i.dialog),i.instanceApi.setData(e),i.instanceApi},t)},openUrl:function(t,o){return AY.openUrl(function(t){var r=BG(t,{closeWindow:function(){D7.hide(r.dialog),o(r.instanceApi)}},e,n);return D7.show(r.dialog),r.instanceApi},t)},alert:function(t,n){r.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){i.open(t,function(t){n(t)})}}};tg.add("silver",function(t){var n=D5(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;return bW.register(t,o.shared),{renderUI:r,getWindowManagerImpl:tu(Bq({editor:t,backstage:o})),getNotificationManagerImpl:function(){var n,r;return n=o.shared,r=function(t){switch(t){case"bc-bc":return gh;case"tc-tc":return gp;case"tc-bc":return aP;default:return aH}},{open:function(o,i){var u=!o.closeButton&&o.timeout&&(o.timeout>0||o.timeout<0),a=function(){i(),go.hide(s)},c=uU(pE.sketch({text:o.text,level:tT(["success","error","warning","warn","info"],o.type)?o.type:void 0,progress:!0===o.progressBar,icon:tw.from(o.icon),closeButton:!u,onAction:a,iconProvider:n.providers.icons,translationProvider:n.providers.translate})),s=uU(go.sketch(tp({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.getSink,fireDismissalEventInstead:{}},n.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));e.add(s),o.timeout>0&&gk.setTimeout(function(){a()},o.timeout);var l=function(){var n=of(nh.fromDom(t.getContentAreaContainer())),e=om(),o=aS(e.x,n.x,n.right),r=aS(e.y,n.y,n.bottom),i=Math.max(n.right,e.right),u=Math.max(n.bottom,e.bottom);return tw.some(ol(o,r,i-o,u-r))};return{close:a,moveTo:function(t,n){go.showAt(s,ur(c),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,e){var o=ur(c),i={maxHeightFunction:cj()};if("banner"!==e&&tt(t)){var u=r(e),a={type:"node",root:ev(),node:tw.some(nh.fromDom(t)),overrides:i,layouts:{onRtl:function(){return[u]},onLtr:function(){return[u]}}};go.showWithinBounds(s,o,{anchor:a},l)}else{var f=tp(tp({},n.anchors.banner()),{overrides:i});go.showWithinBounds(s,o,{anchor:f},l)}},text:function(t){pE.updateText(c,t)},settings:o,getEl:function(){return c.element.dom},progressBar:{value:function(t){pE.updateProgress(c,t)}}}},close:function(t){t.close()},reposition:function(t){t.length>0&&tM(t,function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")})},getArgs:function(t){return t.settings}}},ui:i()}})}();