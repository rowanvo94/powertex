!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i"),i=function(e){return/^[(\[{ \u00a0]$/.test(e)},o=function(e){return 3===e.nodeType},r=function(e){return 1===e.nodeType},a=function(e,t){if(t<0&&(t=0),o(e)){var n=e.data.length;t>n&&(t=n)}return t},f=function(e,t,n){!r(t)||t.hasChildNodes()?e.setStart(t,a(t,n)):e.setStartBefore(t)},d=function(e,t,n){!r(t)||t.hasChildNodes()?e.setEnd(t,a(t,n)):e.setEndAfter(t)},s=function(e,t){var r,a,s,l,u,c,g,h=e.getParam("autolink_pattern",n),C=e.getParam("default_link_target",!1);if(null===e.dom.getParent(e.selection.getNode(),"a[href]")){var m=e.selection.getRng().cloneRange();if(m.startOffset<5){if(!(u=m.endContainer.previousSibling)){if(!m.endContainer.firstChild||!m.endContainer.firstChild.nextSibling)return;u=m.endContainer.firstChild.nextSibling}if(c=u.length,f(m,u,c),d(m,u,c),m.endOffset<5)return;r=m.endOffset,a=u}else{if(!o(a=m.endContainer)&&a.firstChild){for(;!o(a)&&a.firstChild;)a=a.firstChild;o(a)&&(f(m,a,0),d(m,a,a.nodeValue.length))}r=1===m.endOffset?2:m.endOffset-1-t}var k=r;do f(m,a,r>=2?r-2:0),d(m,a,r>=1?r-1:0),r-=1,g=m.toString();while(!i(g)&&r-2>=0);i(m.toString())?(f(m,a,r),d(m,a,k),r+=1):(0===m.startOffset?f(m,a,0):f(m,a,r),d(m,a,k)),p=(l=m.toString()).charAt(l.length-1),/[?!,.;:]/.test(p)&&d(m,a,k-1);var w=(l=m.toString().trim()).match(h),y=e.getParam("link_default_protocol","http","string");if(w){var v,A,p,S,$=w[0];(v=$,""==(A="www.")||v.length>=A.length&&v.substr(0,0+A.length)===A)?$=y+"://"+$:-1===$.indexOf("@")||(S=$,/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(S))||($="mailto:"+$),s=e.selection.getBookmark(),e.selection.setRng(m),e.execCommand("createlink",!1,$),!1!==C&&e.dom.setAttrib(e.selection.getNode(),"target",C),e.selection.moveToBookmark(s),e.nodeChanged()}}},l=function(e){var n;if(e.on("keydown",function(t){if(13===t.keyCode)return s(e,-1)}),t.browser.isIE()){e.on("focus",function(){if(!n){n=!0;try{e.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}});return}e.on("keypress",function(t){if(41===t.keyCode||93===t.keyCode||125===t.keyCode)return s(e,-1)}),e.on("keyup",function(t){if(32===t.keyCode)return s(e,0)})};e.add("autolink",function(e){l(e)})}();