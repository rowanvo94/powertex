!function(){"use strict";function t(t){return function(e){var n;return n=typeof e,(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t}}function e(t){return function(e){return typeof e===t}}function n(){}function r(t){return function(){return t}}function o(t){return t}function i(t,e){return t===e}function u(){return h}var a=tinymce.util.Tools.resolve("tinymce.PluginManager"),l=tinymce.util.Tools.resolve("tinymce.util.VK"),c=t("string"),f=t("array"),s=e("boolean"),m=e("function"),g=r(!1),d=r(!0),h={fold:function(t,e){return t()},isSome:g,isNone:d,getOr:o,getOrThunk:p,getOrDie:function(t){throw Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:o,orThunk:p,map:u,each:n,bind:u,exists:g,forall:d,filter:function(){return h},toArray:function(){return[]},toString:r("none()")};function p(t){return t()}function v(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!f(t[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+t);tt.apply(e,t[n])}return e}function y(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return Y.none()}function k(t,e,n){return void 0===n&&(n=i),t.exists(function(t){return n(t,e)})}function x(t,e){return t?Y.some(e):Y.none()}function b(t){var e=t.getParam("link_assume_external_targets",!1);return s(e)&&e?1:c(e)&&("http"===e||"https"===e)?e:0}function O(t){return t.getParam("default_link_target")}function C(t){return t.getParam("target_list",!0)}function w(t){return t.getParam("rel_list",[],"array")}function N(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")}function A(t){return c(t.value)?t.value:""}function T(t){return void 0===t&&(t=A),function(e){return Y.from(e).map(function(e){return tn(e,t)})}}function P(t,e){return tu.call(t,e)}function S(t){return t&&"a"===t.nodeName.toLowerCase()}function _(t){return S(t)&&!!tc(t)}function R(t,e){if(t.collapsed)return[];for(var n=t.cloneContents(),r=new ta(n.firstChild,n),o=[],i=n.firstChild;e(i)&&o.push(i),i=r.next(););return o}function D(t){return/^\w+:/i.test(t)}function L(t,e){function n(t){return t.filter(function(t){return -1===te.inArray(o,t)})}var r,o=["noopener"],i=t?t.split(/\s+/):[],u=e?0<(r=n(r=i)).length?r.concat(o):o:n(i);return 0<u.length?te.trim(u.sort().join(" ")):""}function E(t,e){return tf(e=e||t.selection.getNode())?t.dom.select("a[href]",e)[0]:t.dom.getParent(e,"a[href]")}function M(t,e){return(e?e.innerText||e.textContent:t.getContent({format:"text"})).replace(/\uFEFF/g,"")}function U(t){return 0<te.grep(t,_).length}function B(t){var e=t.schema.getTextInlineElements();return 0===R(t.selection.getRng(),function(t){return 1===t.nodeType&&!S(t)&&!P(e,t.nodeName.toLowerCase())}).length}function I(t,e,r){var o,i,u,a,l,c,f,s,m,g,d,h,p=(a=r.href,to(to({},r),{href:tl.isDomSafe(a,"a",t.settings)?a:""}));t.hasPlugin("rtc",!0)?t.execCommand("createlink",!1,(f=p.class,s=p.href,m=p.rel,g=p.target,d=p.text,h=p.title,o={class:f.getOrNull(),href:s,rel:m.getOrNull(),target:g.getOrNull(),text:d.getOrNull(),title:h.getOrNull()},i=function(t,e){return!1==(null===t)},l=c={},u=function(t,e){l[e]=t},function(t){for(var e=ti(t),r=0,o=e.length;r<o;r++){var a=e[r];!function(t,e){(i(t,e)?u:n)(t,e)}(t[a],a)}}(o),c)):function(t,e,n){var r,o,i,u,a,l,c,f,s=t.selection.getNode(),m=E(t,s),g=(r=["title","rel","class","target"],o=function(t,e){return u[e].each(function(n){t[e]=0<n.length?n:null}),t},i={href:(u=n).href},function(t){for(var e,n=0,r=t.length;n<r;n++)e=t[n],i=o(i,e,n)}(r),f=to({},i),0<w(t).length||!1!==N(t)||(a=L(f.rel,"_blank"===f.target),f.rel=a||null),Y.from(f.target).isNone()&&!1===C(t)&&(f.target=O(t)),f.href=(l=f.href,"http"!==(c=b(t))&&"https"!==c||D(l)?l:c+"://"+l),f);t.undoManager.transact(function(){var r;n.href===e.href&&e.attach(),m?(t.focus(),n.text.each(function(t){P(m,"innerText")?m.innerText=t:m.textContent=t}),t.dom.setAttribs(m,g),t.selection.select(m)):(r=n.text,tf(s)?tm(t,s,g):r.fold(function(){t.execCommand("mceInsertLink",!1,g)},function(e){t.insertContent(t.dom.createHTML("a",g,t.dom.encode(e)))}))})}(t,e,p)}function K(t){t.hasPlugin("rtc",!0)?t.execCommand("unlink"):t.undoManager.transact(function(){var e,n,r,o,i,u,a=t.selection.getNode();tf(a)?ts(t,a):(e=t.dom,r=(n=t.selection).getBookmark(),o=n.getRng().cloneRange(),i=e.getParent(o.startContainer,"a[href]",t.getBody()),u=e.getParent(o.endContainer,"a[href]",t.getBody()),i&&o.setStartBefore(i),u&&o.setEndAfter(u),n.setRng(o),t.execCommand("unlink"),n.moveToBookmark(r)),t.focus()})}function z(t){var e=t.href;return 0<e.indexOf("@")&&-1===e.indexOf("/")&&-1===e.indexOf("mailto:")?Y.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return to(to({},t),{href:"mailto:"+e})}}):Y.none()}function j(t,e,n){var r=t.getAttrib(e,n);return null!==r&&0<r.length?Y.some(r):Y.none()}function V(t,e){return t.dom.getParent(e,"a[href]")}function q(t){return V(t,t.selection.getStart())}function F(t,e){var n,r,o,i,u;e&&(n=tc(e),/^#/.test(n)?(r=t.$(n)).length&&t.selection.scrollIntoView(r[0],!0):(o=e.href,(i=document.createElement("a")).target="_blank",i.href=o,i.rel="noreferrer noopener",(u=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(i),i.dispatchEvent(u),document.body.removeChild(i)))}function W(t){return function(){!function(t){var e=E(t);tx(t,e).then(function(e){var r,o=e.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),i=e.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],u=Y.from(O(t)),a=e.anchor,l={url:{value:r=a.url.getOr(""),meta:{original:{value:r}}},text:a.text.getOr(""),title:a.title.getOr(""),anchor:r,link:r,rel:a.rel.getOr(""),target:a.target.or(u).getOr(""),linkClass:a.linkClass.getOr("")},c=e.catalogs,f=td(l,c);return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:v([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],o,i,function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e}([c.anchor.map(tr.createUi("anchor","Anchors")),c.rels.map(tr.createUi("rel","Rel")),c.targets.map(tr.createUi("target","Open link in...")),c.link.map(tr.createUi("link","Link list")),c.classes.map(tr.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:l,onChange:function(t,e){var n=e.name;f.onChange(t.getData,{name:n}).each(function(e){t.setData(e)})},onSubmit:function(r){var o=r.getData();if(!o.url.value)return K(t),void r.close();function i(t){return Y.from(o[t]).filter(function(n){return!k(e.anchor[t],n)})}var u={href:o.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},a={href:o.url.value,attach:void 0!==o.url.meta&&o.url.meta.attach?o.url.meta.attach:n};tv(t,u).then(function(e){I(t,a,e)}),r.close()}}}).then(function(e){t.windowManager.open(e)})}(t)}}function H(t){return function(){F(t,q(t))}}function G(t,e){return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}function J(t){return function(e){function n(){return e.setActive(!t.mode.isReadOnly()&&null!==E(t,t.selection.getNode()))}return n(),G(t,n)}}function X(t){return function(e){function n(){return e.setDisabled(null===E(t,t.selection.getNode()))}return n(),G(t,n)}}function $(t){return function(e){function n(e){return U(e)||0<R(t.selection.getRng(),_).length}var r=t.dom.getParents(t.selection.getStart());return e.setDisabled(!n(r)),G(t,function(t){return e.setDisabled(!n(t.parents))})}}var Q=function(t){function e(){return i}function n(e){return e(t)}var o=r(t),i={fold:function(e,n){return n(t)},isSome:d,isNone:g,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return Q(e(t))},each:function(e){e(t)},bind:n,exists:n,forall:n,filter:function(e){return e(t)?i:h},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return i},Y={some:Q,none:u,from:function(t){return null==t?h:Q(t)}},Z=Array.prototype.indexOf,tt=Array.prototype.push,te=tinymce.util.Tools.resolve("tinymce.util.Tools"),tn=function(t,e){var n=[];return te.each(t,function(t){var r,o,i=c(t.text)?t.text:c(t.title)?t.title:"";void 0!==t.menu?(r=tn(t.menu,e),n.push({text:i,items:r})):(o=e(t),n.push({text:i,value:o}))}),n},tr={sanitize:function(t){return T(A)(t)},sanitizeWith:T,createUi:function(t,e){return function(n){return{name:t,type:"listbox",label:e,items:n}}},getValue:A},to=function(){return(to=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ti=Object.keys,tu=Object.hasOwnProperty,ta=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),tl=tinymce.util.Tools.resolve("tinymce.util.URI"),tc=function(t){return t.getAttribute("data-mce-href")||t.getAttribute("href")},tf=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},ts=function(t,e){var n,r=t.dom.select("img",e)[0];!r||(n=t.dom.getParents(r,"a[href]",e)[0])&&(n.parentNode.insertBefore(r,n),t.dom.remove(n))},tm=function(t,e,n){var r,o=t.dom.select("img",e)[0];o&&(r=t.dom.create("a",n),o.parentNode.insertBefore(r,o),r.appendChild(o))},tg=function(t,e){return y(e,function(e){return P(e,"items")&&void 0!==e.items&&null!==e.items?tg(t,e.items):x(e.value===t,e)})},td=function(t,e){var r={text:t.text,title:t.title};return{onChange:function(t,o){var i,u,a,l,c,f,s,m,g,d,h,p,v=o.name;return"url"===v?(g=(m=t()).url,h=x(r.text.length<=0,Y.from(g.meta.text).getOr(g.value)),d=m.url,p=x(r.title.length<=0,Y.from(d.meta.title).getOr("")),h.isSome()||p.isSome()?Y.some(to(to({},h.map(function(t){return{text:t}}).getOr({})),p.map(function(t){return{title:t}}).getOr({}))):Y.none()):(s=["anchor","link"],-1<Z.call(s,v)?(i=t(),f=("link"===(u=o.name)?e.link:"anchor"===u?e.anchor:Y.none()).getOr([]),a=r.text,l=i[o.name],c=0<a.length,void 0!==l?tg(l,f).map(function(t){return{url:{value:t.value,meta:{text:c?a:t.text,attach:n}},text:c?a:t.text}}):Y.none()):("text"!==v&&"title"!==v||(r[v]=t()[v]),Y.none()))}}},th=tinymce.util.Tools.resolve("tinymce.util.Delay"),tp=tinymce.util.Tools.resolve("tinymce.util.Promise"),tv=function(t,e){var n,r;return y([z,(n=b(t),r=t.getParam("link_default_protocol","http","string"),function(t){var e=t.href;return 1===n&&!D(e)||0===n&&/^\s*www(\.|\d\.)/i.test(e)?Y.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(t){return to(to({},t),{href:r+"://"+e})}}):Y.none()})],function(t){return t(e)}).fold(function(){return tp.resolve(e)},function(n){return new tp(function(r){var o=n.message,i=function(t){r(t?n.preprocess(e):e)},u=t.selection.getRng();th.setEditorTimeout(t,function(){t.windowManager.confirm(o,function(e){t.selection.setRng(u),i(e)})})})})},ty=tinymce.util.Tools.resolve("tinymce.util.XHR"),tk=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],tx=function(t,e){var n;return n=t.getParam("link_list"),new tp(function(t){c(n)?ty.send({url:n,success:function(e){return t(function(t){try{return Y.some(JSON.parse(t))}catch(t){return Y.none()}}(e))},error:function(e){return t(Y.none())}}):m(n)?n(function(e){return t(Y.some(e))}):t(Y.from(n))}).then(function(t){return t.bind(tr.sanitizeWith(r)).map(function(t){return 0<t.length?[{text:"None",value:""}].concat(t):t})}).then(function(n){var r,o,i,u,a,l,c,s,m,g=(o=t.dom,i=B(t)?Y.some(M(t.selection,e)):Y.none(),u=e?Y.some(o.getAttrib(e,"href")):Y.none(),a=e?Y.from(o.getAttrib(e,"target")):Y.none(),l=j(o,e,"rel"),c=j(o,e,"class"),{url:u,text:i,title:j(o,e,"title"),target:a,rel:l,linkClass:c});return{anchor:g,catalogs:{targets:f(m=C(t))?tr.sanitize(m).orThunk(function(){return Y.some(tk)}):!1===m?Y.none():Y.some(tk),rels:function(t,e){var n=w(t);if(0<n.length){var r=k(e,"_blank");return(!1===N(t)?tr.sanitizeWith(function(t){return L(tr.getValue(t),r)}):tr.sanitize)(n)}return Y.none()}(t,g.target),classes:0<(s=t.getParam("link_class_list",[],"array")).length?tr.sanitize(s):Y.none(),anchor:0<(r=v(function(t,e){for(var n=t.length,r=Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r}(t.dom.select("a:not([href])"),function(t){var e=t.name||t.id;return e?[{text:e,value:"#"+e}]:[]}))).length?Y.some([{text:"None",value:""}].concat(r)):Y.none(),link:n},optNode:Y.from(e),flags:{titleEnabled:t.getParam("link_title",!0,"boolean")}}});function r(e){return t.convertURL(e.value||e.url,"href")}};a.add("link",function(t){var e;function r(t){var r=e.selection.getNode();return t.setDisabled(!E(e,r)),n}t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:W(t),onSetup:J(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:H(t),onSetup:X(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return K(t)},onSetup:$(t)}),t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:H(t),onSetup:X(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:W(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return K(t)},onSetup:$(t)}),t.ui.registry.addContextMenu("link",{update:function(e){return U(t.dom.getParents(e,"a"))?"link unlink openlink":"link"}}),(e=t).ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:J(e)},label:"Link",predicate:function(t){return!!E(e,t)&&e.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var t=E(e);return t?tc(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var n=e.selection.getNode();return t.setActive(!!E(e,n)),J(e)(t)},onAction:function(t){var r=t.getValue(),o=function(t){var n=E(e),r=B(e);if(n||!r)return Y.none();var o=M(e.selection,n);return Y.some(0<o.length?o:t)}(r);I(e,{href:r,attach:n},{href:r,text:o,title:Y.none(),rel:Y.none(),target:Y.none(),class:Y.none()}),e.selection.collapse(!1),t.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:r,onAction:function(t){K(e),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:r,onAction:function(t){H(e)(),t.hide()}}]}),t.on("click",function(e){var n=V(t,e.target);n&&l.metaKeyPressed(e)&&(e.preventDefault(),F(t,n))}),t.on("keydown",function(e){var n=q(t);n&&13===e.keyCode&&!0===e.altKey&&!1===e.shiftKey&&!1===e.ctrlKey&&!1===e.metaKey&&(e.preventDefault(),F(t,n))}),t.addCommand("mceLink",function(){t.getParam("link_quicklink",!1,"boolean")?t.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):W(t)()}),t.addShortcut("Meta+K","",function(){t.execCommand("mceLink")})})}();