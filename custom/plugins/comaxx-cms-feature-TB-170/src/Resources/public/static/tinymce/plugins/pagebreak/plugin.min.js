!function(){"use strict";function e(e){return e.getParam("pagebreak_split_block",!1)}function a(e){var a='<img src="'+n.transparentSrc+'" class="'+r+'" data-mce-resize="false" data-mce-placeholder />';return e?"<p>"+a+"</p>":a}var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.Env"),r="mce-pagebreak";t.add("pagebreak",function(t){var n,o,i;function c(){return n.execCommand("mcePageBreak")}t.addCommand("mcePageBreak",function(){t.insertContent(a(e(t)))}),(n=t).ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:c}),n.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:c}),i=RegExp((o=t.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")).replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),t.on("BeforeSetContent",function(n){n.content=n.content.replace(i,a(e(t)))}),t.on("PreInit",function(){t.serializer.addNodeFilter("img",function(a){for(var n,i,c,g=a.length;g--;)(c=(i=a[g]).attr("class"))&&-1!==c.indexOf(r)&&(n=i.parent,t.schema.getBlockElements()[n.name]&&e(t)?(n.type=3,n.value=o,n.raw=!0,i.remove()):(i.type=3,i.value=o,i.raw=!0))})}),t.on("ResolveName",function(e){"IMG"===e.target.nodeName&&t.dom.hasClass(e.target,r)&&(e.name="pagebreak")})})}();