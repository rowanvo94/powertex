!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=tinymce.util.Tools.resolve("tinymce.util.Tools");e.add("preview",function(e){var i;function o(){return i.execCommand("mcePreview")}e.addCommand("mcePreview",function(){var i,o,a,r,s,c,d,l,m,y,u,v,g;o="",a=e.dom.encode,r=e.getParam("content_style","","string"),o+='<base href="'+a(e.documentBaseURI.getURI())+'">',s=e.getParam("content_css_cors",!1,"boolean")?' crossorigin="anonymous"':"",n.each(e.contentCSS,function(t){o+='<link type="text/css" rel="stylesheet" href="'+a(e.documentBaseURI.toAbsolute(t))+'"'+s+">"}),r&&(o+='<style type="text/css">'+r+"</style>"),m=-1===(d=e.getParam("body_id","tinymce","string")).indexOf("=")?d:(c=e.getParam("body_id","","hash"))[e.id]||c,y=-1===(l=e.getParam("body_class","","string")).indexOf("=")?l:e.getParam("body_class","","hash")[e.id]||"",u='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(t.mac?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);<\/script> ",g=(v=e.getBody().dir)?' dir="'+a(v)+'"':"",i="<!DOCTYPE html><html><head>"+o+'</head><body id="'+a(m)+'" class="mce-content-body '+a(y)+'"'+g+">"+e.getContent()+u+"</body></html>",e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:i}}).focus("close")}),(i=e).ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:o}),i.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:o})})}();