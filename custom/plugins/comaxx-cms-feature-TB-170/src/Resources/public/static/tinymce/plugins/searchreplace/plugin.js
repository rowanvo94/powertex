!function(){"use strict";var e,t,n,r,o=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},u=function(e){return function(t){return c(t)===e}},l=function(e){return function(t){return typeof t===e}},f=u("string"),s=u("array"),d=l("boolean"),m=l("number"),g=function(){},h=function(e){return function(){return e}},p=function(e){return e},v=h(!1),y=h(!0),x=h("[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"),b=function(){return w},w={fold:function(e,t){return e()},isSome:v,isNone:y,getOr:p,getOrThunk:e=function(e){return e()},getOrDie:function(e){throw Error(e||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:p,orThunk:e,map:b,each:g,bind:b,exists:v,forall:y,filter:function(){return b()},toArray:function(){return[]},toString:h("none()")},O=function(e){var t=h(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:y,isNone:v,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return O(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:w},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},C={some:O,none:b,from:function(e){return null==e?w:O(e)}},k=tinymce.util.Tools.resolve("tinymce.Env"),E=tinymce.util.Tools.resolve("tinymce.util.Tools"),S=Array.prototype.slice,T=Array.prototype.push,N=function(e,t){for(var n=e.length,r=Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},A=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},D=function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n)},B=function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],u=t(c);u!==n&&(r.push(o),o=[]),n=u,o.push(c)}return 0!==o.length&&r.push(o),r},F=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!s(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);T.apply(t,e[n])}return t},I=function(e,t){return F(N(e,t))},M=function(e,t){var n=S.call(e,0);return n.sort(t),n},R=Object.hasOwnProperty,P=function(e,t){return R.call(e,t)};"undefined"!=typeof window?window:Function("return this;")();var W=function(e,t,n){if(f(n)||d(n)||m(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),Error("Attribute value was not simple")},j=function(e,t,n){W(e.dom,t,n)},V=function(e,t){var n;return n=Node.DOCUMENT_POSITION_PRECEDING,(e.compareDocumentPosition(t)&n)!=0},U={fromDom:function(e){if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}}},$=function(e,t){var n=void 0===t?document:t.dom;return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount?[]:N(n.querySelectorAll(e),U.fromDom)},_=function(e,t){return{element:e,offset:t}},z=function(e,t){var n=N(e.dom.childNodes,U.fromDom);return n.length>0&&t<n.length?_(n[t],0):_(e,t)},q=function(e,t){C.from(e.dom.parentNode).map(U.fromDom).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},G=function(e,t){e.dom.appendChild(t.dom)},K=function(e,t){q(e,t),G(t,e)},H=(t=function(e){return 3===e.dom.nodeType},n="text",{get:function(e){if(!t(e))throw Error("Can only get "+n+" value of a "+n+" node");return r(e).getOr("")},getOption:r=function(e){return t(e)?C.from(e.dom.nodeValue):C.none()},set:function(e,r){if(!t(e))throw Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=r}}),J=function(e){return H.get(e)},L=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Q=function(e,t){return e.isBlock(t)||P(e.schema.getShortEndedElements(),t.nodeName)},X=function(e,t){return"false"===e.getContentEditable(t)},Y=function(e,t){return!e.isBlock(t)&&P(e.schema.getWhiteSpaceElements(),t.nodeName)},Z=function(){return{sOffset:0,fOffset:0,elements:[]}},ee=function(e,t){return z(U.fromDom(e),t)},et=function(e,t,n,r,o,i){void 0===i&&(i=!0);for(var a=i?t(!1):n;a;){var c=X(e,a);if(c||Y(e,a)){if(c?r.cef(a):r.boundary(a))break;a=t(!0);continue}if(Q(e,a)){if(r.boundary(a))break}else 3===a.nodeType&&r.text(a);if(a===o)break;a=t(!1)}},en=function(e,t,n,r,o){var i,a;if(!(Q(i=e,a=n)||X(i,a)||Y(i,a)||"true"===i.getContentEditable(a)&&"false"===i.getContentEditableParent(a.parentNode))){var c=new L(n,e.getParent(r,e.isBlock));et(e,o?c.next.bind(c):c.prev.bind(c),n,{boundary:y,cef:y,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(U.fromDom(e))}})}},er=function(e,t,n,r,o,i){void 0===i&&(i=!0);var a=new L(n,t),c=[],u=Z();en(e,u,n,t,!1);var l=function(){return u.elements.length>0&&(c.push(u),u=Z()),!1};return et(e,a.next.bind(a),n,{boundary:l,cef:function(e){return l(),o&&c.push.apply(c,o.cef(e)),!1},text:function(e){u.elements.push(U.fromDom(e)),o&&o.text(e,u)}},r,i),r&&en(e,u,r,t,!0),l(),c},eo=function(e,t){var n=ee(t.startContainer,t.startOffset),r=n.element.dom,o=ee(t.endContainer,t.endOffset),i=o.element.dom;return er(e,t.commonAncestorContainer,r,i,{text:function(e,t){e===i?t.fOffset+=e.length-o.offset:e===r&&(t.sOffset+=n.offset)},cef:function(t){return M(I($("*[contenteditable=true]",U.fromDom(t)),function(t){var n=t.dom;return er(e,n,n)}),function(e,t){return V(e.elements[0].dom,t.elements[0].dom)?1:-1})}},!1)},ei=function(e,t){return t.collapsed?[]:eo(e,t)},ea=function(e,t){var n=e.createRng();return n.selectNode(t),ei(e,n)},ec=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=e.length);var o,i=t.regex;i.lastIndex=n;for(var a=[];o=i.exec(e);){var c=o[t.matchIndex],u=o.index+o[0].indexOf(c),l=u+c.length;if(l>r)break;a.push({start:u,finish:l}),i.lastIndex=l}return a},eu=function(e,t){var n,r;return B((n=function(e,n){var r=J(n),o=e.last,i=o+r.length,a=I(t,function(e,t){return e.start<i&&e.finish>o?[{element:n,start:Math.max(o,e.start)-o,finish:Math.min(i,e.finish)-o,matchId:t}]:[]});return{results:e.results.concat(a),last:i}},r={results:[],last:0},A(e,function(e,t){r=n(r,e,t)}),r).results,function(e){return e.matchId})},el=function(e,t){return I(t,function(t){var n=t.elements,r=N(n,J).join("");return eu(n,ec(r,e,t.sOffset,r.length-t.fOffset))})},ef=function(e,t){D(e,function(e,n){D(e,function(e){var r=U.fromDom(t.cloneNode(!1));j(r,"data-mce-index",n);var o=e.element.dom;if(o.length===e.finish&&0===e.start)K(e.element,r);else{o.length!==e.finish&&o.splitText(e.finish);var i=o.splitText(e.start);K(U.fromDom(i),r)}})})},es=function(e,t,n,r){var o=el(t,ea(e,n));return ef(o,r),o.length},ed=function(e,t,n,r){var o=n.getBookmark(),i=e.select("td[data-mce-selected],th[data-mce-selected]"),a=el(t,i.length>0?I(i,function(t){return ea(e,t)}):ei(e,n.getRng()));return ef(a,r),n.moveToBookmark(o),a.length},em=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},eg=function(e,t,n,r){var o=e.dom.create("span",{"data-mce-bogus":1});o.className="mce-match-marker";var i=e.getBody();return(eE(e,t,!1),r)?ed(e.dom,n,e.selection,o):es(e.dom,n,i,o)},eh=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},ep=function(e,t){var n=[],r=E.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(var o=0;o<r.length;o++){var i=em(r[o]);null!==i&&i.length&&i===t.toString()&&n.push(r[o])}return n},ev=function(e,t,n){var r=t.get(),o=r.index,i=e.dom;(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,i.removeClass(ep(e,r.index),"mce-match-marker-selected");var a=ep(e,o);return a.length?(i.addClass(ep(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(a[0]),o):-1},ey=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},ex=function(e,t){var n="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")";return t?"(?:^|\\s|"+x()+")"+n+"(?=$|\\s|"+x()+")":n},eb=function(e,t,n,r,o,i){var a=e.selection,c=ex(n,o),u=a.isForward(),l=eg(e,t,{regex:new RegExp(c,r?"g":"gi"),matchIndex:1},i);if(k.browser.isSafari()&&a.setRng(a.getRng(),u),l){var f=ev(e,t,!0);t.set({index:f,count:l,text:n,matchCase:r,wholeWord:o,inSelection:i})}return l},ew=function(e,t){var n=ev(e,t,!0);t.set(a(a({},t.get()),{index:n}))},eO=function(e,t){var n=ev(e,t,!1);t.set(a(a({},t.get()),{index:n}))},eC=function(e){var t=em(e);return null!==t&&t.length>0},ek=function(e,t,n,r,o){var i,c=t.get(),u=c.index,l=u;r=!1!==r;for(var f=e.getBody(),s=E.grep(E.toArray(f.getElementsByTagName("span")),eC),d=0;d<s.length;d++){var m=i=parseInt(em(s[d]),10);if(o||m===c.index){for(n.length?(s[d].firstChild.nodeValue=n,eh(s[d])):ey(e.dom,s[d]);s[++d];)if((m=parseInt(em(s[d]),10))===i)ey(e.dom,s[d]);else{d--;break}r&&l--}else i>u&&s[d].setAttribute("data-mce-index",String(i-1))}return t.set(a(a({},c),{count:o?0:c.count-1,index:l})),r?ew(e,t):eO(e,t),!o&&t.get().count>0},eE=function(e,t,n){for(var r,o,i=t.get(),c=E.toArray(e.getBody().getElementsByTagName("span")),u=0;u<c.length;u++){var l=em(c[u]);null!==l&&l.length&&(l===i.index.toString()&&(r||(r=c[u].firstChild),o=c[u].firstChild),eh(c[u]))}if(t.set(a(a({},i),{index:-1,count:0,text:""})),r&&o){var f=e.dom.createRng();return f.setStart(r,0),f.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(f),f}},eS=function(e){var t=o(C.none()),n=function(){return t.get().each(e)};return{clear:function(){n(),t.set(C.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(C.some(e))}}},eT=function(){var e=eS(g);return a(a({},e),{on:function(t){return e.get().each(t)}})},eN=function(e,t){var n=eT();e.undoManager.add();var r=E.trim(e.selection.getContent({format:"text"})),o=function(e){(t.get().count>1?e.enable:e.disable)("next"),(t.get().count>1?e.enable:e.disable)("prev")},i=function(e){var n=e.getData(),r=t.get();t.set(a(a({},r),{matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection}))},c=function(e,t){A(["replace","replaceall","prev","next"],t?e.disable:e.enable)},u=function(t){e.windowManager.alert("Could not find the specified string.",function(){t.focus("findtext")})},l=function(e,t){k.browser.isSafari()&&k.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},f=function(n){eE(e,t,!1),c(n,!0),o(n)},s=function(n){var r=n.getData(),i=t.get();if(!r.findtext.length){f(n);return}if(i.text===r.findtext&&i.matchCase===r.matchcase&&i.wholeWord===r.wholewords)ew(e,t);else{var a=eb(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);a<=0&&u(n),c(n,0===a)}o(n)},d=t.get(),m={findtext:r,replacetext:"",wholewords:d.wholeWord,matchcase:d.matchCase,inselection:d.inSelection};n.set(e.windowManager.open({title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace all",disabled:!0}],initialData:m,onChange:function(e,n){"findtext"===n.name&&t.get().count>0&&f(e)},onAction:function(n,r){var a=n.getData();switch(r.name){case"find":s(n);break;case"replace":ek(e,t,a.replacetext)?o(n):f(n);break;case"replaceall":ek(e,t,a.replacetext,!0,!0),f(n);break;case"prev":eO(e,t),o(n);break;case"next":ew(e,t),o(n);break;case"matchcase":case"wholewords":case"inselection":i(n),f(n)}l(n,r.name)},onSubmit:function(e){s(e),l(e,"find")},onClose:function(){e.focus(),eE(e,t),e.undoManager.add()}},{inline:"toolbar"}))},eA=function(e,t){e.addCommand("SearchReplace",function(){eN(e,t)})},eD=function(e,t){return function(){eN(e,t)}},eB=function(e,t){e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:eD(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:eD(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",eD(e,t))};i.add("searchreplace",function(e){var t=o({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return eA(e,t),eB(e,t),{done:function(n){return eE(e,t,n)},find:function(n,r,o,i){return void 0===i&&(i=!1),eb(e,t,n,r,o,i)},next:function(){return ew(e,t)},prev:function(){return eO(e,t)},replace:function(n,r,o){return ek(e,t,n,r,o)}}})}();