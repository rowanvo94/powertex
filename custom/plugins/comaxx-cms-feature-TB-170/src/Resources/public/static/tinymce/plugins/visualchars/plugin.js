!function(){"use strict";var n,t,o=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},r=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},i=function(n){return function(t){return typeof t===n}},u=i("boolean"),c=i("number"),a=function(n){return function(){return n}},s=function(n){return n},f=a(!1),l=a(!0),d=function(){return m},m={fold:function(n,t){return n()},isSome:f,isNone:l,getOr:s,getOrThunk:n=function(n){return n()},getOrDie:function(n){throw Error(n||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:s,orThunk:n,map:d,each:function(){},bind:d,exists:f,forall:l,filter:function(){return d()},toArray:function(){return[]},toString:a("none()")},v=function(n,t){for(var o=n.length,r=Array(o),e=0;e<o;e++){var i=n[e];r[e]=t(i,e)}return r},g=function(n,t){for(var o=0,r=n.length;o<r;o++)t(n[o],o)},h=function(n,t){for(var o=[],r=0,e=n.length;r<e;r++){var i=n[r];t(i,r)&&o.push(i)}return o},p=Object.keys,y=function(n,t){for(var o=p(n),r=0,e=o.length;r<e;r++){var i=o[r];t(n[i],i)}};"undefined"!=typeof window?window:Function("return this;")();var b=function(n){return n.dom.nodeValue},k=function(n,t,o){if("string"===e(o)||u(o)||c(o))n.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",n),Error("Attribute value was not simple")},A=function(n,t,o){k(n.dom,t,o)},w=function(n,t){var o=n.dom.getAttribute(t);return null===o?void 0:o},C=function(n,t){n.dom.removeAttribute(t)},N=function(n,t){var o=w(n,t);return void 0===o||""===o?[]:o.split(" ")},O=function(n,t,o){var r=N(n,t).concat([o]);return A(n,t,r.join(" ")),!0},T=function(n,t,o){var r=h(N(n,t),function(n){return n!==o});return r.length>0?A(n,t,r.join(" ")):C(n,t),!1},D=function(n){return void 0!==n.dom.classList},S=function(n,t){D(n)?n.dom.classList.add(t):O(n,"class",t)},B=function(n){0===(D(n)?n.dom.classList:N(n,"class")).length&&C(n,"class")},V=function(n,t){D(n)?n.dom.classList.remove(t):T(n,"class",t),B(n)},E={fromDom:function(n){if(null==n)throw Error("Node cannot be null or undefined");return{dom:n}}},L={"\xa0":"nbsp","\xad":"shy"},j=function(n,t){var o="";return y(n,function(n,t){o+=t}),RegExp("["+o+"]",t?"g":"")},P=j(L),x=j(L,!0),_=(t="",y(L,function(n){t&&(t+=","),t+="span.mce-"+n}),t),I="mce-nbsp",M=function(n){return'<span data-mce-bogus="1" class="mce-'+L[n]+'">'+n+"</span>"},F=function(n){var t=b(n);return 3===n.dom.nodeType&&void 0!==t&&P.test(t)},K=function(n,t){var o=[];return g(v(n.dom.childNodes,E.fromDom),function(n){t(n)&&(o=o.concat([n])),o=o.concat(K(n,t))}),o},R=function(n,t){for(;n.parentNode;){if(n.parentNode===t)return n;n=n.parentNode}},U=function(n){return"span"===n.nodeName.toLowerCase()&&n.classList.contains("mce-nbsp-wrap")},q=function(n,t){g(K(E.fromDom(t),F),function(t){var o=t.dom.parentNode;if(U(o))S(E.fromDom(o),I);else{for(var r=n.dom.encode(b(t)).replace(x,M),e=n.dom.create("div",null,r),i=void 0;i=e.lastChild;)n.dom.insertAfter(i,t.dom);n.dom.remove(t.dom)}})},z=function(n,t){g(n.dom.select(_,t),function(t){U(t)?V(E.fromDom(t),I):n.dom.remove(t,!0)})},G=function(n){var t=n.getBody(),o=n.selection.getBookmark(),r=R(n.selection.getNode(),t);z(n,r=void 0!==r?r:t),q(n,r),n.selection.moveToBookmark(o)},H=function(n,t){o=t.get(),n.fire("VisualChars",{state:o});var o,r=n.getBody();!0===t.get()?q(n,r):z(n,r)},J=function(n,t){t.set(!t.get());var o=n.selection.getBookmark();H(n,t),n.selection.moveToBookmark(o)},Q=function(n,t){n.addCommand("mceVisualChars",function(){J(n,t)})},W=function(n,t){n.on("init",function(){H(n,t)})},X=tinymce.util.Tools.resolve("tinymce.util.Delay"),Y=function(n,t){var o=X.debounce(function(){G(n)},300);!1!==n.getParam("forced_root_block")&&n.on("keydown",function(r){!0===t.get()&&(13===r.keyCode?G(n):o())}),n.on("remove",o.stop)},Z=function(n,t){return function(o){o.setActive(t.get());var r=function(n){return o.setActive(n.state)};return n.on("VisualChars",r),function(){return n.off("VisualChars",r)}}},$=function(n,t){var o=function(){return n.execCommand("mceVisualChars")};n.ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:o,onSetup:Z(n,t)}),n.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:o,onSetup:Z(n,t)})};r.add("visualchars",function(n){var t=o(n.getParam("visualchars_default_state",!1));return Q(n,t),$(n,t),Y(n,t),W(n,t),{isEnabled:function(){return t.get()}}})}();