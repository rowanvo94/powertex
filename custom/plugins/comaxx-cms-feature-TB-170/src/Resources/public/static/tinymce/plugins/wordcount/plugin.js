!function(){"use strict";var t,n=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(t){return t},r=function(){return(r=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},o=function(t,n){for(var e=t.length,r=Array(e),o=0;o<e;o++){var u=t[o];r[o]=n(u,o)}return r},u={ALETTER:0,MIDNUMLET:1,MIDLETTER:2,MIDNUM:3,NUMERIC:4,CR:5,LF:6,NEWLINE:7,EXTEND:8,FORMAT:9,KATAKANA:10,EXTENDNUMLET:11,AT:12,OTHER:13},c=[RegExp("[A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-׳ؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆༀཀ-ཇཉ-ཬྈ-ྌႠ-Ⴥა-ჺჼᄀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᨀ-ᨖᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᯀ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⒶ-ⓩⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⴀ-ⴥⴰ-ⵥⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〻〼ㄅ-ㄭㄱ-ㆎㆠ-ㆺꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐꞑꞠ-ꞩꟺ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),RegExp("[-'\\.‘’․﹒＇．]"),RegExp("[:\xb7\xb7״‧︓﹕：]"),RegExp("[\xb1+*/,;;։،؍٬߸⁄︐︔﹐﹔，；]"),RegExp("[0-9٠-٩٫۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꩐-꩙꯰-꯹]"),RegExp("\\r"),RegExp("\\n"),RegExp("[\v\f\x85\u2028\u2029]"),RegExp("[̀-ͯ҃-҉֑-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ऀ-ःऺ-़ा-ॏ॑-ॗॢॣঁ-ঃ়া-ৄেৈো-্ৗৢৣਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑੰੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣஂா-ூெ-ைொ-்ௗఁ-ఃా-ౄె-ైొ-్ౕౖౢౣಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣംഃാ-ൄെ-ൈൊ-്ൗൢൣංඃ්ා-ුූෘ-ෟෲෳัิ-ฺ็-๎ັິ-ູົຼ່-ໍ༹༘༙༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳា-៓៝᠋-᠍ᢩᤠ-ᤫᤰ-᤻ᦰ-ᧀᧈᧉᨗ-ᨛᩕ-ᩞ᩠-᩿᩼ᬀ-ᬄ᬴-᭄᭫-᭳ᮀ-ᮂᮡ-᯦᮪-᯳ᰤ-᰷᳐-᳔᳒-᳨᳭ᳲ᷀-ᷦ᷼-᷿‌‍⃐-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯-꙲꙼꙽꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣠-꣱ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀ꨩ-ꨶꩃꩌꩍꩻꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꯣ-ꯪ꯬꯭ﬞ︀-️︠-︦ﾞﾟ]"),RegExp("[\xad؀-؃۝܏឴឵‎‏‪-‮⁠-⁤⁪-⁯\uFEFF￹-￻]"),RegExp("[〱-〵゛゜゠-ヺー-ヿㇰ-ㇿ㋐-㋾㌀-㍗ｦ-ﾝ]"),RegExp("[=_‿⁀⁔︳︴﹍-﹏＿∀-⋿<>]"),RegExp("@")],i=RegExp("^[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]$"),a=u.OTHER,E=function(t){for(var n=a,e=c.length,r=0;r<e;++r){var o=c[r];if(o&&o.test(t)){n=r;break}}return n},s=function(t){var n={};return function(e){if(n[e])return n[e];var r=t(e);return n[e]=r,r}},T=function(t,n){var e=t[n],r=t[n+1];if(n<0||n>t.length-1&&0!==n||e===u.ALETTER&&r===u.ALETTER)return!1;var o=t[n+2];if(e===u.ALETTER&&(r===u.MIDLETTER||r===u.MIDNUMLET||r===u.AT)&&o===u.ALETTER)return!1;var c=t[n-1];return(e!==u.MIDLETTER&&e!==u.MIDNUMLET&&r!==u.AT||r!==u.ALETTER||c!==u.ALETTER)&&(e!==u.NUMERIC&&e!==u.ALETTER||r!==u.NUMERIC&&r!==u.ALETTER)&&(e!==u.MIDNUM&&e!==u.MIDNUMLET||r!==u.NUMERIC||c!==u.NUMERIC)&&(e!==u.NUMERIC||r!==u.MIDNUM&&r!==u.MIDNUMLET||o!==u.NUMERIC)&&e!==u.EXTEND&&e!==u.FORMAT&&c!==u.EXTEND&&c!==u.FORMAT&&r!==u.EXTEND&&r!==u.FORMAT&&(e!==u.CR||r!==u.LF)&&(e===u.NEWLINE||e===u.CR||e===u.LF||r===u.NEWLINE||r===u.CR||r===u.LF||(e!==u.KATAKANA||r!==u.KATAKANA)&&(r!==u.EXTENDNUMLET||e!==u.ALETTER&&e!==u.NUMERIC&&e!==u.KATAKANA&&e!==u.EXTENDNUMLET)&&(e!==u.EXTENDNUMLET||r!==u.ALETTER&&r!==u.NUMERIC&&r!==u.KATAKANA)&&e!==u.AT)},g=/^\s+$/,l=function(t,n){var e;for(e=n;e<t.length&&!g.test(t[e]);e++);return e},d=function(t,n){var e=l(t,n+1);return"://"===t.slice(n+1,e).join("").substr(0,3)?e:n},p=function(t,n,e,r){for(var o=[],u=[],c=0;c<e.length;++c)if(u.push(t[c]),T(e,c)){var a=n[c];if((r.includeWhitespace||!g.test(a))&&(r.includePunctuation||!i.test(a))){var E,s=c-u.length+1,l=c+1;if("http"===(E=n.slice(s,l).join(""))||"https"===E){var p=d(n,c),f=t.slice(l,p);Array.prototype.push.apply(u,f),c=p}o.push(u)}u=[]}return o},f=function(t,n,e){e=r(r({},{includeWhitespace:!1,includePunctuation:!1}),e);for(var u=[],c=[],i=0;i<t.length;i++){var a=n(t[i]);"\uFEFF"!==a&&(u.push(t[i]),c.push(a))}var T=o(c,s(E));return p(u,c,T,e)},C=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),h=function(t,n){for(var e,r=n.getBlockElements(),o=n.getShortEndedElements(),u=[],c="",i=new C(t,t);t=i.next();)3===t.nodeType?c+=t.data.replace(/\uFEFF/g,""):(r[(e=t).nodeName]||o[e.nodeName])&&c.length&&(u.push(c),c="");return c.length&&u.push(c),u},R=function(t){return t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},A=function(t,n){return f(h(t,n).join("\n").replace(/\u200B/g,"").split(""),e).length},N=function(t,n){return R(h(t,n).join(""))},M=function(t,n){return R(h(t,n).join("").replace(/\s/g,""))},y=function(t,n){return function(){return n(t.getBody(),t.schema)}},v=function(t,n){return function(){return n(t.selection.getRng().cloneContents(),t.schema)}},L=function(t){return y(t,A)},m=function(t,n){t.windowManager.open({title:"Word Count",body:{type:"panel",items:[{type:"table",header:["Count","Document","Selection"],cells:[["Words",String(n.body.getWordCount()),String(n.selection.getWordCount())],["Characters (no spaces)",String(n.body.getCharacterCountWithoutSpaces()),String(n.selection.getCharacterCountWithoutSpaces())],["Characters",String(n.body.getCharacterCount()),String(n.selection.getCharacterCount())]]}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}]})},D=function(t,n){t.addCommand("mceWordCount",function(){return m(t,n)})},U=tinymce.util.Tools.resolve("tinymce.util.Delay"),I=function(t,n){t.fire("wordCountUpdate",{wordCount:{words:n.body.getWordCount(),characters:n.body.getCharacterCount(),charactersWithoutSpaces:n.body.getCharacterCountWithoutSpaces()}})},W=function(t,n){I(t,n)},F=function(t,n,e){var r=U.debounce(function(){return W(t,n)},e);t.on("init",function(){W(t,n),U.setEditorTimeout(t,function(){t.on("SetContent BeforeAddUndo Undo Redo ViewUpdate keyup",r)},0)})},x=function(t){var n=function(){return t.execCommand("mceWordCount")};t.ui.registry.addButton("wordcount",{tooltip:"Word count",icon:"character-count",onAction:n}),t.ui.registry.addMenuItem("wordcount",{text:"Word count",icon:"character-count",onAction:n})};void 0===t&&(t=300),n.add("wordcount",function(n){var e={body:{getWordCount:L(n),getCharacterCount:y(n,N),getCharacterCountWithoutSpaces:y(n,M)},selection:{getWordCount:v(n,A),getCharacterCount:v(n,N),getCharacterCountWithoutSpaces:v(n,M)},getCount:L(n)};return D(n,e),x(n),F(n,e,t),e})}();