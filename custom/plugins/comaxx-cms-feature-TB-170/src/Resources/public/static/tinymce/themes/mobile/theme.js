!function(){"use strict";var n,e,t,r,o,i,u,c,a,f,s,l,d,m,g,p,h,v,b,y,x,S,w=function(){return(w=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function O(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&0>e.indexOf(r)&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)0>e.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function k(n,e,t){if(t||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return n.concat(r||Array.prototype.slice.call(e))}var T=function(n){var e=typeof n;return null===n?"null":"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e},E=function(n){return function(e){return T(e)===n}},C=function(n){return function(e){return typeof e===n}},D=function(n){return function(e){return n===e}},M=E("string"),_=E("object"),R=E("array"),F=D(null),I=C("boolean"),V=D(void 0),B=function(n){return null!=n},A=C("function"),H=C("number"),N=function(){},z=function(n,e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n(e.apply(null,t))}},P=function(n){return function(){return n}},j=function(n){return n},L=function(n,e){return n===e};function $(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}var G=function(n){return function(e){return!n(e)}},U=function(n){return function(){throw Error(n)}},W=function(n){return n()},X=P(!1),q=P(!0),K=function(){return Y},Y={fold:function(n,e){return n()},isSome:X,isNone:q,getOr:j,getOrThunk:c=function(n){return n()},getOrDie:function(n){throw Error(n||"error: getOrDie called on none.")},getOrNull:P(null),getOrUndefined:P(void 0),or:j,orThunk:c,map:K,each:N,bind:K,exists:X,forall:q,filter:function(){return K()},toArray:function(){return[]},toString:P("none()")},J=function(n){var e=P(n),t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},isSome:q,isNone:X,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return J(e(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?o:Y},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},Q={some:J,none:K,from:function(n){return null==n?Y:J(n)}},Z=function(n){var e,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,e=n.apply(null,r)),e}},nn=function(n,e,t,r){var o=n.isiOS()&&!0===/ipad/i.test(t),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||r("(pointer:coarse)"),a=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!a,s=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(t);return{isiPad:P(o),isiPhone:P(i),isTablet:P(a),isPhone:P(f),isTouch:P(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:P(s),isDesktop:P(!f&&!a&&!s)}},ne=Array.prototype.slice,nt=Array.prototype.indexOf,nr=Array.prototype.push,no=function(n,e){return nt.call(n,e)>-1},ni=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1},nu=function(n,e){for(var t=n.length,r=Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o)}return r},nc=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},na=function(n,e){for(var t=n.length-1;t>=0;t--)e(n[t],t)},nf=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r)&&t.push(i)}return t},ns=function(n,e,t){return na(n,function(n,r){t=e(t,n,r)}),t},nl=function(n,e,t){return nc(n,function(n,r){t=e(t,n,r)}),t},nd=function(n,e,t){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(e(i,r))return Q.some(i);if(t(i,r))break}return Q.none()},nm=function(n,e){return nd(n,e,X)},ng=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return Q.some(t);return Q.none()},np=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!R(n[t]))throw Error("Arr.flatten item "+t+" was not an array, input: "+n);nr.apply(e,n[t])}return e},nh=function(n,e){return np(nu(n,e))},nv=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0},nb=function(n){var e=ne.call(n,0);return e.reverse(),e},ny=function(n,e){return nf(n,function(n){return!no(e,n)})},nx=function(n){return[n]},nS=function(n,e){var t=ne.call(n,0);return t.sort(e),t},nw=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return Q.none()},nO=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}},nk=function(n,e){var t=nO(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return nE(r(1),r(2))},nT=function(){return nE(0,0)},nE=function(n,e){return{major:n,minor:e}},nC=function(n,e){var t=String(e).toLowerCase();return 0===n.length?nT():nk(n,t)},nD=function(n,e){var t=String(e).toLowerCase();return nm(n,function(n){return n.search(t)})},nM=function(n,e){var t=function(n){var e=typeof n;return"string"===e||"number"===e};return n.replace(/\$\{([^{}]*)\}/g,function(n,r){var o=e[r];return t(o)?o.toString():n})},n_=function(n,e){return -1!==n.indexOf(e)},nR=function(n,e){var t;return t=n.length-e.length,""===e||n.length>=e.length&&n.substr(t,t+e.length)===e},nF=(a=/^\s+|\s+$/g,function(n){return n.replace(a,"")}),nI=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,nV=function(n){return function(e){return n_(e,n)}},nB=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return n_(n,"edge/")&&n_(n,"chrome")&&n_(n,"safari")&&n_(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nI],search:function(n){return n_(n,"chrome")&&!n_(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return n_(n,"msie")||n_(n,"trident")}},{name:"Opera",versionRegexes:[nI,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:nV("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:nV("firefox")},{name:"Safari",versionRegexes:[nI,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(n_(n,"safari")||n_(n,"mobile/"))&&n_(n,"applewebkit")}}],nA=[{name:"Windows",search:nV("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return n_(n,"iphone")||n_(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:nV("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:nV("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:nV("linux"),versionRegexes:[]},{name:"Solaris",search:nV("sunos"),versionRegexes:[]},{name:"FreeBSD",search:nV("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:nV("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],nH={browsers:P(nB),oses:P(nA)},nN="Edge",nz="Chrome",nP="Opera",nj="Firefox",nL="Safari",n$=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:r(nN),isChrome:r(nz),isIE:r("IE"),isOpera:r(nP),isFirefox:r(nj),isSafari:r(nL)}},nG={unknown:function(){return n$({current:void 0,version:nT()})},nu:n$,edge:P(nN),chrome:P(nz),ie:P("IE"),opera:P(nP),firefox:P(nj),safari:P(nL)},nU="Windows",nW="Android",nX="Linux",nq="Solaris",nK="FreeBSD",nY="ChromeOS",nJ=function(n){var e=n.current,t=n.version,r=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:r(nU),isiOS:r("iOS"),isAndroid:r(nW),isOSX:r("OSX"),isLinux:r(nX),isSolaris:r(nq),isFreeBSD:r(nK),isChromeOS:r(nY)}},nQ={unknown:function(){return nJ({current:void 0,version:nT()})},nu:nJ,windows:P(nU),ios:P("iOS"),android:P(nW),linux:P(nX),osx:P("OSX"),solaris:P(nq),freebsd:P(nK),chromeos:P(nY)},nZ=function(n,e,t){var r=nH.browsers(),o=nH.oses(),i=e.bind(function(n){return nw(n.brands,function(n){var e=n.brand.toLowerCase();return nm(r,function(n){var t;return e===(null===(t=n.brand)||void 0===t?void 0:t.toLowerCase())}).map(function(e){return{current:e.name,version:nE(parseInt(n.version,10),0)}})})}).orThunk(function(){return nD(r,n).map(function(e){var t=nC(e.versionRegexes,n);return{current:e.name,version:t}})}).fold(nG.unknown,nG.nu),u=nD(o,n).map(function(e){var t=nC(e.versionRegexes,n);return{current:e.name,version:t}}).fold(nQ.unknown,nQ.nu),c=nn(u,i,n,t);return{browser:i,os:u,deviceType:c}},n0=function(n){return window.matchMedia(n).matches},n1=Z(function(){return nZ(navigator.userAgent,Q.from(navigator.userAgentData),n0)}),n2=function(){return n1()},n9=P("touchstart"),n3=P("touchmove"),n5=P("touchend"),n4=P("mousedown"),n6=P("mousemove"),n8=P("mouseup"),n7=P("mouseover"),en=P("keydown"),ee=P("keyup"),et=P("input"),er=P("change"),eo=P("click"),ei=P("transitionend"),eu=P("selectstart"),ec=function(n){return P("alloy."+n)},ea={tap:ec("tap")},ef=ec("focus"),es=ec("blur.post"),el=ec("paste.post"),ed=ec("receive"),em=ec("execute"),eg=ec("focus.item"),ep=ea.tap,eh=ec("longpress"),ev=ec("system.init"),eb=ec("system.attached"),ey=ec("system.detached"),ex=ec("focusmanager.shifted"),eS=ec("highlight"),ew=ec("dehighlight"),eO=function(n,e){eC(n,n.element,e,{})},ek=function(n,e,t){eC(n,n.element,e,t)},eT=function(n){eO(n,em())},eE=function(n,e,t){eC(n,e,t,{})},eC=function(n,e,t,r){var o=w({target:e},r);n.getSystem().triggerEvent(t,e,o)},eD=function(n,e,t,r){n.getSystem().triggerEvent(t,e,r.event)},eM=function(n,e){n.getSystem().triggerFocus(e,n.element)},e_=function(n){if(null==n)throw Error("Node cannot be null or undefined");return{dom:n}},eR={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||t.childNodes.length>1)throw console.error("HTML does not have a single root node",n),Error("HTML must have a single root node");return e_(t.childNodes[0])},fromTag:function(n,e){return e_((e||document).createElement(n))},fromText:function(n,e){return e_((e||document).createTextNode(n))},fromDom:e_},eF=function(n,e){var t=n.dom;if(1!==t.nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw Error("Browser lacks native selectors")},eI=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},eV=function(n,e){var t=void 0===e?document:e.dom;return eI(t)?[]:nu(t.querySelectorAll(n),eR.fromDom)},eB=function(n,e){var t=void 0===e?document:e.dom;return eI(t)?Q.none():Q.from(t.querySelector(n)).map(eR.fromDom)},eA=function(n,e){return n.dom===e.dom};"undefined"!=typeof window?window:Function("return this;")();var eH=function(n){return n.dom.nodeName.toLowerCase()},eN=function(n){return function(e){return e.dom.nodeType===n}},ez=eN(1),eP=eN(3),ej=eN(9),eL=eN(11),e$=function(n){return eR.fromDom(n.dom.ownerDocument)},eG=function(n){return ej(n)?n:e$(n)},eU=function(n){return Q.from(n.dom.parentNode).map(eR.fromDom)},eW=function(n,e){for(var t=A(e)?e:X,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=eR.fromDom(i);if(o.push(u),!0===t(u))break;r=i}return o},eX=function(n){return nu(n.dom.childNodes,eR.fromDom)},eq=function(n,e){var t=n.dom.childNodes;return Q.from(t[e]).map(eR.fromDom)},eK=function(n,e){eU(n).each(function(t){t.dom.insertBefore(e.dom,n.dom)})},eY=function(n,e){Q.from(n.dom.nextSibling).map(eR.fromDom).fold(function(){eU(n).each(function(n){eQ(n,e)})},function(n){eK(n,e)})},eJ=function(n,e){eq(n,0).fold(function(){eQ(n,e)},function(t){n.dom.insertBefore(e.dom,t.dom)})},eQ=function(n,e){n.dom.appendChild(e.dom)},eZ=function(n,e,t){eq(n,t).fold(function(){eQ(n,e)},function(n){eK(n,e)})},e0=function(n,e){nc(e,function(e){eQ(n,e)})},e1=function(n){n.dom.textContent="",nc(eX(n),function(n){e2(n)})},e2=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},e9=function(n){return eL(n)&&B(n.dom.host)},e3=A(Element.prototype.attachShadow)&&A(Node.prototype.getRootNode),e5=P(e3),e4=e3?function(n){return eR.fromDom(n.dom.getRootNode())}:eG,e6=function(n){var e=e4(n);return e9(e)?Q.some(e):Q.none()},e8=function(n){if(e5()&&B(n.target)){var e=eR.fromDom(n.target);if(ez(e)&&e7(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return 0<t.length?Q.some(t[0]):Q.none()}}return Q.from(n.target)},e7=function(n){return B(n.dom.shadowRoot)},tn=function(n){var e=eP(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t=e.ownerDocument;return e6(eR.fromDom(e)).fold(function(){return t.body.contains(e)},function(n){return tn(eR.fromDom(n.dom.host))})},te=function(){return tt(eR.fromDom(document))},tt=function(n){var e=n.dom.body;if(null==e)throw Error("Body is not available yet");return eR.fromDom(e)},tr=function(n){eO(n,ey()),nc(n.components(),tr)},to=function(n){nc(n.components(),to),eO(n,eb())},ti=function(n,e){eQ(n.element,e.element)},tu=function(n){nc(n.components(),function(n){return e2(n.element)}),e1(n.element),n.syncComponents()},tc=function(n,e){var t=n.components();tu(n),nc(ny(t,e),function(e){tr(e),n.getSystem().removeFromWorld(e)}),nc(e,function(e){e.getSystem().isConnected()?ti(n,e):(n.getSystem().addToWorld(e),ti(n,e),tn(n.element)&&to(e)),n.syncComponents()})},ta=function(n,e){tf(n,e,eQ)},tf=function(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),tn(n.element)&&to(e),n.syncComponents()},ts=function(n){tr(n),e2(n.element),n.getSystem().removeFromWorld(n)},tl=function(n){var e=eU(n.element).bind(function(e){return n.getSystem().getByDom(e).toOptional()});ts(n),e.each(function(n){n.syncComponents()})},td=function(n,e){tm(n,e,eY)},tm=function(n,e,t){t(n,e.element),nc(eX(e.element),function(n){e.getByDom(n).each(to)})},tg=function(n){nc(eX(n.element),function(e){n.getByDom(e).each(tr)}),e2(n.element)},tp=Object.keys,th=Object.hasOwnProperty,tv=function(n,e){for(var t=tp(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i)}},tb=function(n,e){return ty(n,function(n,t){return{k:t,v:e(n,t)}})},ty=function(n,e){var t={};return tv(n,function(n,r){var o=e(n,r);t[o.k]=o.v}),t},tx=function(n,e){var t,r={};return t=function(n,e){r[e]=n},tv(n,function(n,r){(e(n,r)?t:N)(n,r)}),r},tS=function(n,e){var t=[];return tv(n,function(n,r){t.push(e(n,r))}),t},tw=function(n,e){for(var t=tp(n),r=0,o=t.length;r<o;r++){var i=t[r],u=n[i];if(e(u,i,n))return Q.some(u)}return Q.none()},tO=function(n,e){return tk(n,e)?Q.from(n[e]):Q.none()},tk=function(n,e){return th.call(n,e)},tT=function(n,e){return tk(n,e)&&void 0!==n[e]&&null!==n[e]},tE=function(n,e,t){if(M(t)||I(t)||H(t))n.setAttribute(e,t+"");else throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),Error("Attribute value was not simple")},tC=function(n,e,t){tE(n.dom,e,t)},tD=function(n,e){var t=n.dom;tv(e,function(n,e){tE(t,e,n)})},tM=function(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t},t_=function(n,e){return Q.from(tM(n,e))},tR=function(n,e){var t=n.dom;return!!t&&!!t.hasAttribute&&t.hasAttribute(e)},tF=function(n,e){n.dom.removeAttribute(e)},tI=function(n,e){var t=tM(n,e);return void 0===t||""===t?[]:t.split(" ")},tV=function(n,e,t){var r=tI(n,e).concat([t]);return tC(n,e,r.join(" ")),!0},tB=function(n,e,t){var r=nf(tI(n,e),function(n){return n!==t});return r.length>0?tC(n,e,r.join(" ")):tF(n,e),!1},tA=function(n){return void 0!==n.dom.classList},tH=function(n,e){tA(n)?n.dom.classList.add(e):tV(n,"class",e)},tN=function(n){0===(tA(n)?n.dom.classList:tI(n,"class")).length&&tF(n,"class")},tz=function(n,e){tA(n)?n.dom.classList.remove(e):tB(n,"class",e),tN(n)},tP=function(n,e){return tA(n)&&n.dom.classList.contains(e)},tj=function(n,e,t){tz(n,t),tH(n,e)},tL=Object.freeze({__proto__:null,toAlpha:function(n,e,t){tj(n.element,e.alpha,e.omega)},toOmega:function(n,e,t){tj(n.element,e.omega,e.alpha)},isAlpha:function(n,e,t){return tP(n.element,e.alpha)},isOmega:function(n,e,t){return tP(n.element,e.omega)},clear:function(n,e,t){tz(n.element,e.alpha),tz(n.element,e.omega)}}),t$=function(n){return{isValue:q,isError:X,getOr:P(n),getOrThunk:P(n),getOrDie:P(n),or:function(e){return t$(n)},orThunk:function(e){return t$(n)},fold:function(e,t){return t(n)},map:function(e){return t$(e(n))},mapError:function(e){return t$(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return Q.some(n)}}},tG=function(n){return{isValue:X,isError:q,getOr:j,getOrThunk:function(n){return n()},getOrDie:function(){return U(String(n))()},or:j,orThunk:function(n){return n()},fold:function(e,t){return e(n)},map:function(e){return tG(n)},mapError:function(e){return tG(e(n))},each:N,bind:function(e){return tG(n)},exists:X,forall:q,toOptional:Q.none}},tU={value:t$,error:tG};(f=b||(b={}))[f.Error=0]="Error",f[f.Value=1]="Value";var tW=function(n,e,t){return n.stype===b.Error?e(n.serror):t(n.svalue)},tX=function(n){return{stype:b.Value,svalue:n}},tq=function(n){return{stype:b.Error,serror:n}},tK={fromResult:function(n){return n.fold(tq,tX)},toResult:function(n){return tW(n,tU.error,tU.value)},svalue:tX,partition:function(n){var e=[],t=[];return nc(n,function(n){tW(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},serror:tq,bind:function(n,e){return n.stype===b.Value?e(n.svalue):n},bindError:function(n,e){return n.stype===b.Error?e(n.serror):n},map:function(n,e){return n.stype===b.Value?{stype:b.Value,svalue:e(n.svalue)}:n},mapError:function(n,e){return n.stype===b.Error?{stype:b.Error,serror:e(n.serror)}:n},fold:tW},tY=function(n,e,t,r){return{tag:"field",key:n,newKey:e,presence:t,prop:r}},tJ=function(n,e,t){switch(n.tag){case"field":return e(n.key,n.newKey,n.presence,n.prop);case"custom":return t(n.newKey,n.instantiator)}},tQ=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)tk(i,u)&&(r[u]=n(r[u],i[u]))}return r}},tZ=tQ(function(n,e){return _(n)&&_(e)?tZ(n,e):e}),t0=tQ(function(n,e){return e}),t1=function(){return{tag:"required",process:{}}},t2=function(n){return{tag:"defaultedThunk",process:n}},t9=function(n){return t2(P(n))},t3=function(){return{tag:"option",process:{}}},t5=function(n){return{tag:"mergeWithThunk",process:n}},t4=function(n){var e,t=tK.partition(n);return t.errors.length>0?(e=t.errors,z(tK.serror,np)(e)):tK.svalue(t.values)},t6=function(n){return _(n)&&tp(n).length>100?" removed due to size":JSON.stringify(n,null,2)},t8=function(n,e){return tK.serror([{path:n,getErrorInfo:e}])},t7=function(n){return{extract:function(e,t){return tK.bindError(n(t),function(n){return t8(e,P(n))})},toString:P("val")}},rn=t7(tK.svalue),re=function(n,e,t,r){return r(tO(n,e).getOrThunk(function(){return t(n)}))},rt=function(n,e,t,r,o){var i,u=function(n){return o.extract(e.concat([r]),n)},c=function(n){return n.fold(function(){return tK.svalue(Q.none())},function(n){var t=o.extract(e.concat([r]),n);return tK.map(t,Q.some)})};switch(n.tag){case"required":return tO(t,r).fold(function(){return t8(e,function(){return'Could not find valid *required* value for "'+r+'" in '+t6(t)})},u);case"defaultedThunk":return re(t,r,n.process,u);case"option":return c(tO(t,r));case"defaultedOptionThunk":return i=n.process,c(tO(t,r).map(function(n){return!0===n?i(t):n}));case"mergeWithThunk":return re(t,r,P({}),function(e){return u(tZ(n.process(t),e))})}},rr=function(n,e,t){for(var r={},o=[],i=0;i<t.length;i++)tJ(t[i],function(t,i,u,c){var a=rt(u,n,e,t,c);tK.fold(a,function(n){o.push.apply(o,n)},function(n){r[i]=n})},function(n,t){r[n]=t(e)});return o.length>0?tK.serror(o):tK.svalue(r)},ro=function(n){var e=ri(n),t=ns(n,function(n,e){return tJ(e,function(e){var t;return tZ(n,((t={})[e]=!0,t))},P(n))},{});return{extract:function(n,r){var o=nf(I(r)?[]:tp(tx(r,B)),function(n){return!tT(t,n)});return 0===o.length?e.extract(n,r):t8(n,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"})},toString:e.toString}},ri=function(n){return{extract:function(e,t){return rr(e,t,n)},toString:function(){return"obj{\n"+nu(n,function(n){return tJ(n,function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},ru=function(n,e){var t=function(e,t){var r;return(r=t7(n),{extract:function(n,e){return t4(nu(e,function(e,t){return r.extract(n.concat(["["+t+"]"]),e)}))},toString:function(){return"array("+r.toString()+")"}}).extract(e,t)};return{extract:function(n,r){var o=t(n,tp(r));return tK.bind(o,function(t){return ri(nu(t,function(n){return tY(n,n,t1(),e)})).extract(n,r)})},toString:function(){return"setOf("+e.toString()+")"}}},rc=P(rn),ra=t7(function(n){var e=typeof n;return A(n)?tK.svalue(n):tK.serror("Expected type: function but got: "+e)}),rf=function(n){return t7(function(e){return n(e).fold(tK.serror,tK.svalue)})},rs=function(n,e){return ru(function(e){return tK.fromResult(n(e))},e)},rl=function(n,e,t){var r=e.extract([n],t);return tK.mapError(r,function(n){return{input:t,errors:n}})},rd=function(n,e,t){return tK.toResult(rl(n,e,t))},rm=function(n){return n.fold(function(n){throw Error(rp(n))},j)},rg=function(n,e,t){return rm(rd(n,e,t))},rp=function(n){var e;return"Errors: \n"+nu((e=n.errors).length>10?e.slice(0,10).concat([{path:[],getErrorInfo:P("... (only showing first ten failures)")}]):e,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}).join("\n")+"\n\nInput object: "+t6(n.input)},rh=function(n,e){var t;return t=tb(e,ri),{extract:function(e,r){return tO(r,n).fold(function(){return t8(e,function(){return'Choice schema did not contain choice key: "'+n+'"'})},function(n){return tO(t,n).fold(function(){return t8(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+t6(t)})},function(t){return t.extract(e.concat(["branch: "+n]),r)})})},toString:function(){return"chooseOn("+n+"). Possible values: "+tp(t)}}},rv=function(n,e){return{tag:"custom",newKey:n,instantiator:e}},rb=function(n){return tY(n,n,t1(),rc())},ry=function(n,e){return tY(n,n,t1(),e)},rx=function(n,e){return tY(n,n,t1(),ri(e))},rS=function(n){return tY(n,n,t3(),rc())},rw=function(n,e){return tY(n,n,t3(),e)},rO=function(n,e){return rw(n,ri(e))},rk=function(n,e){return rw(n,ro(e))},rT=function(n,e){return tY(n,n,t9(e),rc())},rE=function(n,e,t){return tY(n,n,t9(e),t)},rC=[rb("alpha"),rb("omega")],rD=function(n){if(!R(n))throw Error("cases must be an array");if(0===n.length)throw Error("there must be at least one case");var e=[],t={};return nc(n,function(r,o){var i=tp(r);if(1!==i.length)throw Error("one and only one name per case");var u=i[0],c=r[u];if(void 0!==t[u])throw Error("duplicate key detected:"+u);if("cata"===u)throw Error("cannot have a case named cata (sorry)");if(!R(c))throw Error("case arguments must be an array");e.push(u),t[u]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t.length;if(i!==c.length)throw Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);return{fold:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length!==n.length)throw Error("Wrong number of arguments to fold. Expected "+n.length+", got "+e.length);return e[o].apply(null,t)},match:function(n){var r=tp(n);if(e.length!==r.length)throw Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+r.join(","));if(!nv(e,function(n){return no(r,n)}))throw Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+e.join(", "));return n[u].apply(null,t)},log:function(n){console.log(n,{constructors:e,constructor:u,params:t})}}}}),t};rD([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var rM=function(n){var e=[],t=[];return nc(n,function(n){n.fold(function(n){e.push(n)},function(n){t.push(n)})}),{errors:e,values:t}},r_=function(n,e){var t={};return tv(n,function(n,r){no(e,r)||(t[r]=n)}),t},rR=function(n,e){var t;return(t={})[n]=e,t},rF=function(n){var e={};return nc(n,function(n){e[n.key]=n.value}),e},rI=function(n,e){return rR(n,e)},rV=function(n){return rF(n)},rB=function(n,e){var t,r,o=rM(n);return o.errors.length>0?(t=o.errors,tU.error(np(t))):0===(r=o.values).length?tU.value(e):tU.value(tZ(e,t0.apply(void 0,r)))},rA=function(n,e,t){return void 0===t&&(t=L),n.exists(function(n){return t(n,e)})},rH=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},rN=function(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.isSome())return Q.none();e.push(r.getOrDie())}return Q.some(e)},rz=function(n){return A(n)?n:X},rP=function(n,e,t){for(var r=n.dom,o=rz(t);r.parentNode;){r=r.parentNode;var i=eR.fromDom(r),u=e(i);if(u.isSome())return u;if(o(i))break}return Q.none()},rj=function(n,e,t){var r=e(n),o=rz(t);return r.orThunk(function(){return o(n)?Q.none():rP(n,e,o)})},rL=function(n,e){return eA(n.element,e.event.target)},r$={can:q,abort:X,run:N},rG=function(n){if(!tT(n,"can")&&!tT(n,"abort")&&!tT(n,"run"))throw Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return w(w({},r$),n)},rU=function(n){return rV(n)},rW=function(n,e){return{key:n,value:rG({abort:e})}},rX=function(n,e){return{key:n,value:rG({run:e})}},rq=function(n,e,t){return{key:n,value:rG({run:function(n,r){e.apply(void 0,[n,r].concat(t))}})}},rK=function(n){return function(e){return{key:n,value:rG({run:function(n,t){rL(n,t)&&e(n,t)}})}}},rY=function(n,e,t){var r=e.partUids[t];return rX(n,function(e,t){e.getSystem().getByUid(r).each(function(e){eD(e,e.element,n,t)})})},rJ=function(n){return rX(n,function(n,e){e.cut()})},rQ=rK(eb()),rZ=rK(ey()),r0=rK(ev()),r1=(s=em(),function(n){return rX(s,n)}),r2=function(n,e,t){var r=t.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:r9(u.slice(0,1).concat(u.slice(3)))}},n},r9=function(n){return nu(n,function(n){return nR(n,"/*")?n.substring(0,n.length-2):n})},r3=function(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:r9(i)}},n},r5=function(n,e){var t=e.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:r9(i.slice(1))}},n},r4=function(n){return{classes:V(n.classes)?[]:n.classes,attributes:V(n.attributes)?{}:n.attributes,styles:V(n.styles)?{}:n.styles}},r6=function(n,e,t){return r0(function(r,o){t(r,n,e)})},r8=function(n){return{key:n,value:void 0}},r7=function(n,e,t,r,o,i,u){var c=function(n){return tT(n,t)?n[t]():Q.none()},a=tb(o,function(n,e){var r;return r2(function(e){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var u=[e].concat(o);return e.config({name:P(t)}).fold(function(){throw Error("We could not find any behaviour configuration for: "+t+". Using API: "+r)},function(t){var r=Array.prototype.slice.call(u,1);return n.apply(void 0,[e,t.config,t.state].concat(r))})},r=e,n)}),f=tb(i,function(n,e){return r3(n,e)}),s=w(w(w({},f),a),{revoke:$(r8,t),config:function(e){var r=rg(t+"-config",n,e);return{key:t,value:{config:r,me:s,configAsRaw:Z(function(){return rg(t+"-config",n,e)}),initialConfig:e,state:u}}},schema:P(e),exhibit:function(n,e){var t,o,i;return(t=c(n),o=tO(r,"exhibit"),t.isSome()&&o.isSome()?Q.some((i=t.getOrDie(),o.getOrDie()(e,i.config,i.state))):Q.none()).getOrThunk(function(){return r4({})})},name:P(t),handlers:function(n){return c(n).map(function(n){return tO(r,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return s},on={init:function(){return oe({readState:P("No State required")})}},oe=function(n){return n},ot=function(n){return rV(n)},or=ro([rb("fields"),rb("name"),rT("active",{}),rT("apis",{}),rT("state",on),rT("extra",{})]),oo=function(n){var e,t,r,o,i,u,c=rg("Creating behaviour: "+n.name,or,n);return e=c.fields,t=c.name,r=c.active,o=c.apis,i=c.extra,u=c.state,r7(ro(e),rO(t,[rk("config",e)]),t,r,o,i,u)},oi=ro([rb("branchKey"),rb("branches"),rb("name"),rT("active",{}),rT("apis",{}),rT("state",on),rT("extra",{})]),ou=P(void 0),oc=oo({fields:rC,name:"swapping",apis:tL}),oa=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},of=function(n){return n.dom.focus()},os=function(n){return n.dom.blur()},ol=function(n){var e=e4(n).dom;return n.dom===e.activeElement},od=function(n){return void 0===n&&(n=eR.fromDom(document)),Q.from(n.dom.activeElement).map(eR.fromDom)},om=function(n){return od(e4(n)).filter(function(e){return n.dom.contains(e.dom)})},og=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),op=tinymce.util.Tools.resolve("tinymce.ThemeManager"),oh=function(n){var e=document.createElement("a");e.target="_blank",e.href=n.href,e.rel="noreferrer noopener";var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(t),document.body.removeChild(e)},ov=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],ob=["undo","bold","italic","link","image","bullist","styleselect"],oy="formatChanged",ox="orientationChanged",oS="dropupDismissed",ow=function(n,e){var t=(e||document).createElement("div");return t.innerHTML=n,eX(eR.fromDom(t))},oO=function(n){return n.dom.innerHTML},ok=function(n,e){var t=e$(n).dom,r=eR.fromDom(t.createDocumentFragment());e0(r,ow(e,t)),e1(n),eQ(n,r)},oT=function(n){var e=eR.fromTag("div");return eQ(e,eR.fromDom(n.dom.cloneNode(!0))),oO(e)},oE=function(n){return e9(n)?"#shadow-root":oT(eR.fromDom(n.dom.cloneNode(!1)))},oC=Object.freeze({__proto__:null,events:function(n){return rU([rX(ed(),function(e,t){var r=n.channels,o=tp(r);nc(t.universal?o:nf(o,function(n){return no(t.channels,n)}),function(n){var o=r[n],i=o.schema,u=rg("channel["+n+"] data\nReceiver: "+oE(e.element),i,t.data);o.onReceive(e,u)})})])}}),oD="unknown";(l=y||(y={}))[l.STOP=0]="STOP",l[l.NORMAL=1]="NORMAL",l[l.LOGGING=2]="LOGGING";var oM=oa({}),o_=function(n,e){var t=[],r=new Date().getTime();return{logEventCut:function(n,e,r){t.push({outcome:"cut",target:e,purpose:r})},logEventStopped:function(n,e,r){t.push({outcome:"stopped",target:e,purpose:r})},logNoParent:function(n,e,r){t.push({outcome:"no-parent",target:e,purpose:r})},logEventNoHandlers:function(n,e){t.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,r){t.push({outcome:"response",purpose:r,target:e})},write:function(){var o=new Date().getTime();no(["mousemove","mouseover","mouseout",ev()],n)||console.log(n,{event:n,time:o-r,target:e.dom,sequence:nu(t,function(n){return no(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+oE(n.target)+")":n.outcome})})}}},oR=function(n,e,t){switch(tO(oM.get(),n).orThunk(function(){return nw(tp(oM.get()),function(e){return n.indexOf(e)>-1?Q.some(oM.get()[e]):Q.none()})}).getOr(y.NORMAL)){case y.NORMAL:return t(oB());case y.LOGGING:var r=o_(n,e),o=t(r);return r.write(),o;case y.STOP:return!0}},oF=["alloy/data/Fields","alloy/debugging/Debugging"],oI=function(){var n=Error();return void 0!==n.stack?nm(n.stack.split("\n"),function(n){return n.indexOf("alloy")>0&&!ni(oF,function(e){return n.indexOf(e)>-1})}).getOr(oD):oD},oV=function(n,e,t){return oR(n,e,t)},oB=P({logEventCut:N,logEventStopped:N,logNoParent:N,logEventNoHandlers:N,logEventResponse:N,write:N}),oA=P([rb("menu"),rb("selectedMenu")]),oH=P([rb("item"),rb("selectedItem")]);P(ri(oH().concat(oA())));var oN=P(ri(oH())),oz=rx("initSize",[rb("numColumns"),rb("numRows")]),oP=function(n,e,t){return oI(),tY(e,e,t,rf(function(n){return tU.value(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)})}))},oj=function(n){return oP("onHandler",n,t9(N))},oL=function(n){return oP("onKeyboardHandler",n,t9(Q.none))},o$=function(n){return oP("onHandler",n,t1())},oG=function(n){return oP("onKeyboardHandler",n,t1())},oU=function(n,e){return rv(n,P(e))},oW=function(n){return rv(n,j)},oX=P(oz),oq=oo({fields:[ry("channels",rs(tU.value,ro([o$("onReceive"),rT("schema",rc())])))],name:"receiving",active:oC}),oK=function(n,e,t){var r=e.aria;r.update(n,r,t.get())},oY=function(n,e,t){e.toggleClass.each(function(e){t.get()?tH(n.element,e):tz(n.element,e)})},oJ=function(n,e,t){o0(n,e,t,!t.get())},oQ=function(n,e,t){t.set(!0),oY(n,e,t),oK(n,e,t)},oZ=function(n,e,t){t.set(!1),oY(n,e,t),oK(n,e,t)},o0=function(n,e,t,r){(r?oQ:oZ)(n,e,t)},o1=function(n,e,t){o0(n,e,t,e.selected)},o2=Object.freeze({__proto__:null,onLoad:o1,toggle:oJ,isOn:function(n,e,t){return t.get()},on:oQ,off:oZ,set:o0}),o9=Object.freeze({__proto__:null,exhibit:function(){return r4({})},events:function(n,e){var t=r1(function(t){oJ(t,n,e)}),r=r6(n,e,o1);return rU(np([n.toggleOnExecute?[t]:[],[r]]))}}),o3=function(n,e,t){tC(n.element,"aria-expanded",t)},o5=oo({fields:[rT("selected",!1),rS("toggleClass"),rT("toggleOnExecute",!0),rE("aria",{mode:"none"},rh("mode",{pressed:[rT("syncWithExpanded",!1),oU("update",function(n,e,t){tC(n.element,"aria-pressed",t),e.syncWithExpanded&&o3(n,e,t)})],checked:[oU("update",function(n,e,t){tC(n.element,"aria-checked",t)})],expanded:[oU("update",o3)],selected:[oU("update",function(n,e,t){tC(n.element,"aria-selected",t)})],none:[oU("update",N)]}))],name:"toggling",active:o9,apis:o2,state:{init:function(){var n=oa(!1);return{get:function(){return n.get()},set:function(e){return n.set(e)},clear:function(){return n.set(!1)},readState:function(){return n.get()}}}}}),o4=function(n,e){return oq.config({channels:rI(oy,{onReceive:function(t,r){r.command===n&&e(t,r.state)}})})},o6=function(n){return oq.config({channels:rI(ox,{onReceive:n})})},o8=function(n,e){return{key:n,value:{onReceive:e}}},o7="tinymce-mobile",ie=function(n){return o7+"-"+n},it=function(){var n=function(n,e){e.stop(),eT(n)};return[rX(eo(),n),rX(ep(),n),rJ(n9()),rJ(n4())]},ir=function(n,e){e.ignore||(of(n.element),e.onFocus(n))},io=Object.freeze({__proto__:null,focus:ir,blur:function(n,e){e.ignore||os(n.element)},isFocused:function(n){return ol(n.element)}}),ii=Object.freeze({__proto__:null,exhibit:function(n,e){return r4(e.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(n){return rU([rX(ef(),function(e,t){ir(e,n),t.stop()})].concat(n.stopMousedown?[rX(n4(),function(n,e){e.event.prevent()})]:[]))}}),iu=oo({fields:[oj("onFocus"),rT("stopMousedown",!1),rT("ignore",!1)],name:"focusing",active:ii,apis:io}),ic=function(n){return void 0!==n.style&&A(n.style.getPropertyValue)},ia=function(n,e,t){if(!M(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),Error("CSS value must be a string: "+t);ic(n)&&n.style.setProperty(e,t)},is=function(n,e){ic(n)&&n.style.removeProperty(e)},il=function(n,e,t){ia(n.dom,e,t)},id=function(n,e){var t=n.dom;tv(e,function(n,e){ia(t,e,n)})},im=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||tn(n)?r:ig(t,e)},ig=function(n,e){return ic(n)?n.style.getPropertyValue(e):""},ip=function(n,e){var t=ig(n.dom,e);return Q.from(t).filter(function(n){return n.length>0})},ih=function(n,e){is(n.dom,e),rA(t_(n,"style").map(nF),"")&&tF(n,"style")},iv=function(n){return n.dom.offsetWidth},ib=function(n,e){var t=function(t){var r=e(t);return r<=0||null===r?parseFloat(im(t,n))||0:r},r=function(n,e){return nl(e,function(e,t){var r=im(n,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:function(e,t){if(!H(t)&&!t.match(/^[0-9]+$/))throw Error(n+".set accepts only positive integer values. Value was "+t);var r=e.dom;ic(r)&&(r.style[n]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(n,e,t){var o=r(n,t);return e>o?e-o:0}}},iy=ib("height",function(n){var e=n.dom;return tn(n)?e.getBoundingClientRect().height:e.offsetHeight}),ix=function(n){return iy.get(n)},iS=function(n,e){return eV(e,n)};function iw(n,e,t,r,o){return n(t,r)?Q.some(t):A(o)&&o(t)?Q.none():e(t,r,o)}var iO=function(n,e,t){for(var r=n.dom,o=A(t)?t:X;r.parentNode;){r=r.parentNode;var i=eR.fromDom(r);if(e(i))return Q.some(i);if(o(i))break}return Q.none()},ik=function(n,e){var t=function(n){for(var r=0;r<n.childNodes.length;r++){var o=eR.fromDom(n.childNodes[r]);if(e(o))return Q.some(o);var i=t(n.childNodes[r]);if(i.isSome())return i}return Q.none()};return t(n.dom)},iT=function(n){return eB(n)},iE=function(n,e,t){return iO(n,function(n){return eF(n,e)},t)},iC=function(n,e){return eB(e,n)},iD=function(n,e,t){return iw(function(n,e){return eF(n,e)},iE,n,e,t)},iM=[9],i_=[13],iR=[27],iF=[32],iI=[37],iV=[38],iB=[39],iA=[40],iH=function(n,e,t){var r=nb(n.slice(0,e)),o=nb(n.slice(e+1));return nm(r.concat(o),t)},iN=function(n,e,t){return nm(nb(n.slice(0,e)),t)},iz=function(n,e,t){var r=n.slice(0,e);return nm(n.slice(e+1).concat(r),t)},iP=function(n,e,t){return nm(n.slice(e+1),t)},ij=function(n){return function(e){return no(n,e.raw.which)}},iL=function(n){return function(e){return nv(n,function(n){return n(e)})}},i$=function(n){return!0===n.raw.shiftKey},iG=function(n){return!0===n.raw.ctrlKey},iU=G(i$),iW=function(n,e){return{matches:n,classification:e}},iX=function(n,e,t,r){var o=n+e;return o>r?t:o<t?r:o},iq=function(n,e,t){return Math.min(Math.max(n,e),t)},iK=function(n,e,t,r){nc(iS(n.element,"."+e.highlightClass),function(t){ni(r,function(n){return n.element===t})||(tz(t,e.highlightClass),n.getSystem().getByDom(t).each(function(t){e.onDehighlight(n,t),eO(t,ew())}))})},iY=function(n,e,t,r){iK(n,e,t,[r]),iJ(n,e,t,r)||(tH(r.element,e.highlightClass),e.onHighlight(n,r),eO(r,eS()))},iJ=function(n,e,t,r){return tP(r.element,e.highlightClass)},iQ=function(n,e,t,r){var o=iS(n.element,"."+e.itemClass);return Q.from(o[r]).fold(function(){return tU.error(Error("No element found with index "+r))},n.getSystem().getByDom)},iZ=function(n,e,t){return iC(n.element,"."+e.itemClass).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},i0=function(n,e,t){var r=iS(n.element,"."+e.itemClass);return(r.length>0?Q.some(r[r.length-1]):Q.none()).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},i1=function(n,e,t,r){var o=iS(n.element,"."+e.itemClass);return ng(o,function(n){return tP(n,e.highlightClass)}).bind(function(e){var t=iX(e,r,0,o.length-1);return n.getSystem().getByDom(o[t]).toOptional()})},i2=function(n,e,t){return rH(nu(iS(n.element,"."+e.itemClass),function(e){return n.getSystem().getByDom(e).toOptional()}))},i9=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return iK(n,e,t,[])},dehighlight:function(n,e,t,r){iJ(n,e,t,r)&&(tz(r.element,e.highlightClass),e.onDehighlight(n,r),eO(r,ew()))},highlight:iY,highlightFirst:function(n,e,t){iZ(n,e).each(function(r){iY(n,e,t,r)})},highlightLast:function(n,e,t){i0(n,e).each(function(r){iY(n,e,t,r)})},highlightAt:function(n,e,t,r){iQ(n,e,t,r).fold(function(n){throw n},function(r){iY(n,e,t,r)})},highlightBy:function(n,e,t,r){nm(i2(n,e),r).each(function(r){iY(n,e,t,r)})},isHighlighted:iJ,getHighlighted:function(n,e,t){return iC(n.element,"."+e.highlightClass).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},getFirst:iZ,getLast:i0,getPrevious:function(n,e,t){return i1(n,e,t,-1)},getNext:function(n,e,t){return i1(n,e,t,1)},getCandidates:i2}),i3=oo({fields:[rb("highlightClass"),rb("itemClass"),oj("onHighlight"),oj("onDehighlight")],name:"highlighting",apis:i9}),i5=function(n,e,t){e.exists(function(n){return t.exists(function(e){return eA(e,n)})})||ek(n,ex(),{prevFocus:e,newFocus:t})},i4=function(){var n=function(n){return om(n.element)};return{get:n,set:function(e,t){var r=n(e);e.getSystem().triggerFocus(t,e.element);var o=n(e);i5(e,r,o)}}},i6=function(){var n=function(n){return i3.getHighlighted(n).map(function(n){return n.element})};return{get:n,set:function(e,t){var r=n(e);e.getSystem().getByDom(t).fold(N,function(n){i3.highlight(e,n)});var o=n(e);i5(e,r,o)}}};(d=x||(x={})).OnFocusMode="onFocus",d.OnEnterOrSpaceMode="onEnterOrSpace",d.OnApiMode="onApi";var i8=function(n,e,t,r,o){var i=function(n,e,t,r,o){var i,u;return(i=t(n,e,r,o),u=e.event,nm(i,function(n){return n.matches(u)}).map(function(n){return n.classification})).bind(function(t){return t(n,e,r,o)})},u={schema:function(){return n.concat([rT("focusManager",i4()),rE("focusInside","onFocus",rf(function(n){return no(["onFocus","onEnterOrSpace","onApi"],n)?tU.value(n):tU.error("Invalid value for focusInside")})),oU("handler",u),oU("state",e),oU("sendFocusIn",o)])},processKey:i,toEvents:function(n,e){var u=n.focusInside!==x.OnFocusMode?Q.none():o(n).map(function(t){return rX(ef(),function(r,o){t(r,n,e),o.stop()})}),c=function(t,r){var i=ij(iF.concat(i_))(r.event);n.focusInside===x.OnEnterOrSpaceMode&&i&&rL(t,r)&&o(n).each(function(o){o(t,n,e),r.stop()})},a=[rX(en(),function(r,o){i(r,o,t,n,e).fold(function(){c(r,o)},function(n){o.stop()})}),rX(ee(),function(t,o){i(t,o,r,n,e).each(function(n){o.stop()})})];return rU(u.toArray().concat(a))}};return u},i7=function(n){var e=[rS("onEscape"),rS("onEnter"),rT("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),rT("firstTabstop",0),rT("useTabstopAt",q),rS("visibilitySelector")].concat([n]),t=function(n,e){return ix(n.visibilitySelector.bind(function(n){return iD(e,n)}).getOr(e))>0},r=function(n,e){var r=nf(iS(n.element,e.selector),function(n){return t(e,n)});return Q.from(r[e.firstTabstop])},o=function(n,e,t){r(n,e).each(function(t){e.focusManager.set(n,t)})},i=function(n,e,r,o){var i=iS(n.element,r.selector);return r.focusManager.get(n).bind(function(n){return iD(n,r.selector)}).bind(function(e){return ng(i,$(eA,e)).bind(function(e){return o(i,e,function(n){return t(r,n)&&r.useTabstopAt(n)}).fold(function(){return r.cyclic?Q.some(!0):Q.none()},function(e){return r.focusManager.set(n,e),Q.some(!0)})})})},u=P([iW(iL([i$,ij(iM)]),function(n,e,t){var r=t.cyclic?iH:iN;return i(n,e,t,r)}),iW(ij(iM),function(n,e,t){var r=t.cyclic?iz:iP;return i(n,e,t,r)}),iW(ij(iR),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),iW(iL([iU,ij(i_)]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),c=P([]);return i8(e,on.init,u,c,function(){return Q.some(o)})},un=i7(rv("cyclic",X)),ue=i7(rv("cyclic",q)),ut=function(n){return"input"===eH(n)&&"radio"!==tM(n,"type")||"textarea"===eH(n)},ur=function(n,e,t){return ut(t)&&ij(iF)(e.event)?Q.none():(eE(n,t,em()),Q.some(!0))},uo=function(n,e){return Q.some(!0)},ui=[rT("execute",ur),rT("useSpace",!1),rT("useEnter",!0),rT("useControlEnter",!1),rT("useDown",!1)],uu=function(n,e,t){return t.execute(n,e,n.element)},uc=i8(ui,on.init,function(n,e,t,r){var o=t.useSpace&&!ut(n.element)?iF:[],i=t.useEnter?i_:[],u=t.useDown?iA:[];return[iW(ij(o.concat(i).concat(u)),uu)].concat(t.useControlEnter?[iW(iL([iG,ij(i_)]),uu)]:[])},function(n,e,t,r){return t.useSpace&&!ut(n.element)?[iW(ij(iF),uo)]:[]},function(){return Q.none()}),ua=function(n){var e=oa(Q.none()),t=function(){return e.get().each(n)};return{clear:function(){t(),e.set(Q.none())},isSet:function(){return e.get().isSome()},get:function(){return e.get()},set:function(n){t(),e.set(Q.some(n))}}},uf=function(){var n=ua(function(n){return n.destroy()});return w(w({},n),{run:function(e){return n.get().each(e)}})},us=function(){var n=ua(N);return w(w({},n),{on:function(e){return n.get().each(e)}})},ul=function(){var n=us();return oe({readState:function(){return n.get().map(function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,t){n.set({numRows:e,numColumns:t})},getNumRows:function(){return n.get().map(function(n){return n.numRows})},getNumColumns:function(){return n.get().map(function(n){return n.numColumns})}})},ud=Object.freeze({__proto__:null,flatgrid:ul,init:function(n){return n.state(n)}}),um=function(n,e){return function(t){return"rtl"===ug(t)?e:n}},ug=function(n){return"rtl"===im(n,"direction")?"rtl":"ltr"},up=function(n){return function(e,t,r,o){return uy(n(e.element),e,t,r,o)}},uh=function(n,e){return up(um(n,e))},uv=function(n,e){return up(um(e,n))},ub=function(n){return function(e,t,r,o){return uy(n,e,t,r,o)}},uy=function(n,e,t,r,o){return r.focusManager.get(e).bind(function(t){return n(e.element,t,r,o)}).map(function(n){return r.focusManager.set(e,n),!0})},ux=function(n){var e;return!((e=n.dom).offsetWidth<=0&&e.offsetHeight<=0)},uS=function(n,e,t){var r;return ng(r=nf(iS(n,t),ux),function(n){return eA(n,e)}).map(function(n){return{index:n,candidates:r}})},uw=function(n,e){return ng(n,function(n){return eA(e,n)})},uO=function(n,e,t,r){return r(Math.floor(e/t),e%t).bind(function(e){var r=e.row*t+e.column;return r>=0&&r<n.length?Q.some(n[r]):Q.none()})},uk=function(n,e,t,r,o){return uO(n,e,r,function(e,i){var u=iX(i,o,0,(e===t-1?n.length-e*r:r)-1);return Q.some({row:e,column:u})})},uT=function(n,e,t,r,o){return uO(n,e,r,function(e,i){var u=iX(e,o,0,t-1),c=iq(i,0,(u===t-1?n.length-u*r:r)-1);return Q.some({row:u,column:c})})},uE=[rb("selector"),rT("execute",ur),oL("onEscape"),rT("captureTab",!1),oX()],uC=function(n,e,t){iC(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},uD=function(n){return function(e,t,r,o){return uS(e,t,r.selector).bind(function(e){return n(e.candidates,e.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}},uM=function(n,e,t){return t.captureTab?Q.some(!0):Q.none()},u_=uD(function(n,e,t,r){return uk(n,e,t,r,-1)}),uR=uD(function(n,e,t,r){return uk(n,e,t,r,1)}),uF=uD(function(n,e,t,r){return uT(n,e,t,r,-1)}),uI=uD(function(n,e,t,r){return uT(n,e,t,r,1)}),uV=i8(uE,ul,P([iW(ij(iI),uh(u_,uR)),iW(ij(iB),uv(u_,uR)),iW(ij(iV),ub(uF)),iW(ij(iA),ub(uI)),iW(iL([i$,ij(iM)]),uM),iW(iL([iU,ij(iM)]),uM),iW(ij(iR),function(n,e,t){return t.onEscape(n,e)}),iW(ij(iF.concat(i_)),function(n,e,t,r){return t.focusManager.get(n).bind(function(n){return iD(n,t.selector)}).bind(function(r){return t.execute(n,e,r)})})]),P([iW(ij(iF),uo)]),function(){return Q.some(uC)}),uB=function(n,e,t,r){var o=function(n,e,t){var i,u=iX(e,r,0,t.length-1);return u===n?Q.none():"button"===eH(i=t[u])&&"disabled"===tM(i,"disabled")?o(n,u,t):Q.from(t[u])};return uS(n,t,e).bind(function(n){var e=n.index;return o(e,e,n.candidates)})},uA=[rb("selector"),rT("getInitial",Q.none),rT("execute",ur),oL("onEscape"),rT("executeOnMove",!1),rT("allowVertical",!0)],uH=function(n,e,t){return t.focusManager.get(n).bind(function(n){return iD(n,t.selector)}).bind(function(r){return t.execute(n,e,r)})},uN=function(n,e,t){e.getInitial(n).orThunk(function(){return iC(n.element,e.selector)}).each(function(t){e.focusManager.set(n,t)})},uz=function(n,e,t){return uB(n,t.selector,e,-1)},uP=function(n,e,t){return uB(n,t.selector,e,1)},uj=function(n){return function(e,t,r,o){return n(e,t,r,o).bind(function(){return r.executeOnMove?uH(e,t,r):Q.some(!0)})}},uL=function(n,e,t){return t.onEscape(n,e)},u$=P([iW(ij(iF),uo)]),uG=i8(uA,on.init,function(n,e,t,r){var o=iI.concat(t.allowVertical?iV:[]),i=iB.concat(t.allowVertical?iA:[]);return[iW(ij(o),uj(uh(uz,uP))),iW(ij(i),uj(uv(uz,uP))),iW(ij(i_),uH),iW(ij(iF),uH),iW(ij(iR),uL)]},u$,function(){return Q.some(uN)}),uU=function(n,e,t){return Q.from(n[e]).bind(function(n){return Q.from(n[t]).map(function(n){return{rowIndex:e,columnIndex:t,cell:n}})})},uW=function(n,e,t,r){var o=iX(t,r,0,n[e].length-1);return uU(n,e,o)},uX=function(n,e,t,r){var o=iX(t,r,0,n.length-1),i=iq(e,0,n[o].length-1);return uU(n,o,i)},uq=function(n,e,t,r){var o=iq(t+r,0,n[e].length-1);return uU(n,e,o)},uK=function(n,e,t,r){var o=iq(t+r,0,n.length-1),i=iq(e,0,n[o].length-1);return uU(n,o,i)},uY=[rx("selectors",[rb("row"),rb("cell")]),rT("cycles",!0),rT("previousSelector",Q.none),rT("execute",ur)],uJ=function(n,e,t){e.previousSelector(n).orThunk(function(){var t=e.selectors;return iC(n.element,t.cell)}).each(function(t){e.focusManager.set(n,t)})},uQ=function(n,e){return function(t,r,o){var i=o.cycles?n:e;return iD(r,o.selectors.row).bind(function(n){return uw(iS(n,o.selectors.cell),r).bind(function(e){var r=iS(t,o.selectors.row);return uw(r,n).bind(function(n){return i(nu(r,function(n){return iS(n,o.selectors.cell)}),n,e).map(function(n){return n.cell})})})})}},uZ=uQ(function(n,e,t){return uW(n,e,t,-1)},function(n,e,t){return uq(n,e,t,-1)}),u0=uQ(function(n,e,t){return uW(n,e,t,1)},function(n,e,t){return uq(n,e,t,1)}),u1=uQ(function(n,e,t){return uX(n,t,e,-1)},function(n,e,t){return uK(n,t,e,-1)}),u2=uQ(function(n,e,t){return uX(n,t,e,1)},function(n,e,t){return uK(n,t,e,1)}),u9=P([iW(ij(iI),uh(uZ,u0)),iW(ij(iB),uv(uZ,u0)),iW(ij(iV),ub(u1)),iW(ij(iA),ub(u2)),iW(ij(iF.concat(i_)),function(n,e,t){return om(n.element).bind(function(r){return t.execute(n,e,r)})})]),u3=P([iW(ij(iF),uo)]),u5=i8(uY,on.init,u9,u3,function(){return Q.some(uJ)}),u4=[rb("selector"),rT("execute",ur),rT("moveOnTab",!1)],u6=function(n,e,t){return t.focusManager.get(n).bind(function(r){return t.execute(n,e,r)})},u8=function(n,e,t){iC(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},u7=function(n,e,t){return uB(n,t.selector,e,-1)},cn=function(n,e,t){return uB(n,t.selector,e,1)},ce=P([iW(ij(iV),ub(u7)),iW(ij(iA),ub(cn)),iW(iL([i$,ij(iM)]),function(n,e,t,r){return t.moveOnTab?ub(u7)(n,e,t,r):Q.none()}),iW(iL([iU,ij(iM)]),function(n,e,t,r){return t.moveOnTab?ub(cn)(n,e,t,r):Q.none()}),iW(ij(i_),u6),iW(ij(iF),u6)]),ct=P([iW(ij(iF),uo)]),cr=i8(u4,on.init,ce,ct,function(){return Q.some(u8)}),co=i8([oL("onSpace"),oL("onEnter"),oL("onShiftEnter"),oL("onLeft"),oL("onRight"),oL("onTab"),oL("onShiftTab"),oL("onUp"),oL("onDown"),oL("onEscape"),rT("stopSpaceKeyup",!1),rS("focusIn")],on.init,function(n,e,t){return[iW(ij(iF),t.onSpace),iW(iL([iU,ij(i_)]),t.onEnter),iW(iL([i$,ij(i_)]),t.onShiftEnter),iW(iL([i$,ij(iM)]),t.onShiftTab),iW(iL([iU,ij(iM)]),t.onTab),iW(ij(iV),t.onUp),iW(ij(iA),t.onDown),iW(ij(iI),t.onLeft),iW(ij(iB),t.onRight),iW(ij(iF),t.onSpace),iW(ij(iR),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[iW(ij(iF),uo)]:[]},function(n){return n.focusIn}),ci=(n=rh((g=rg("Creating behaviour: "+(m={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:un.schema(),cyclic:ue.schema(),flow:uG.schema(),flatgrid:uV.schema(),matrix:u5.schema(),execution:uc.schema(),menu:cr.schema(),special:co.schema()}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(n,e,t){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(r){r(n,e,t)})},setGridSize:function(n,e,t,r,o){tT(t,"setGridSize")?t.setGridSize(r,o):console.error("Layout does not support setGridSize")}},state:ud}).name,oi,m)).branchKey,g.branches),e=g.name,t=g.active,r=g.apis,o=g.extra,i=g.state,u=rO(e,[rw("config",n)]),r7(n,u,e,t,r,o,i)),cu=function(n,e){return rE(n,{},ri(nu(e,function(e){var t,r;return t=e.name(),r="Cannot configure "+e.name()+" for "+n,tY(t,t,t3(),t7(function(n){return tK.serror("The field: "+t+" is forbidden. "+r)}))}).concat([rv("dump",j)])))},cc=function(n,e){return w(w({},ot(e)),n.dump)},ca="placeholder",cf=rD([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),cs=function(n){return tk(n,"uiType")},cl=function(n,e,t,r){return(cs(t)&&t.uiType===ca?n.exists(function(n){return n!==t.owner})?cf.single(!0,P(t)):tO(r,t.name).fold(function(){throw Error("Unknown placeholder component: "+t.name+"\nKnown: ["+tp(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(t,null,2))},function(n){return n.replace()}):cf.single(!1,P(t))).fold(function(o,i){var u=cs(t)?i(e,t.config,t.validated):i(e),c=nh(tO(u,"components").getOr([]),function(t){return cl(n,e,t,r)});return[w(w({},u),{components:c})]},function(n,r){if(!cs(t))return r(e);var o=r(e,t.config,t.validated);return t.validated.preprocess.getOr(j)(o)})},cd=function(n,e){var t=!1;return{name:P(n),required:function(){return e.fold(function(n,e){return n},function(n,e){return n})},used:function(){return t},replace:function(){if(t)throw Error("Trying to use the same placeholder more than once: "+n);return t=!0,e}}},cm=function(n,e,t,r){var o=tb(r,function(n,e){return cd(e,n)}),i=nh(t,function(t){return cl(n,e,t,o)});return tv(o,function(t){if(!1===t.used()&&t.required())throw Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),i},cg=cf.single,cp=cf.multiple,ch=P(ca),cv=0,cb=function(n){var e=new Date().getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++cv+String(e)},cy=rD([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),cx=rT("factory",{sketch:j}),cS=rT("schema",[]),cw=rb("name"),cO=tY("pname","pname",t2(function(n){return"<alloy."+cb(n.name)+">"}),rc()),ck=rv("schema",function(){return[rS("preprocess")]}),cT=rT("defaults",P({})),cE=rT("overrides",P({})),cC=ri([cx,cS,cw,cO,cT,cE]),cD=ri([cx,cS,cw,cT,cE]),cM=ri([cx,cS,cw,cO,cT,cE]),c_=ri([cx,ck,cw,rb("unit"),cO,cT,cE]),cR=function(n){var e=function(n){return n.name};return n.fold(e,e,e,e)},cF=function(n,e){return function(t){return n(rg("Converting part type",e,t))}},cI=cF(cy.required,cC);cF(cy.external,cD);var cV=cF(cy.optional,cM),cB=cF(cy.group,c_),cA=P("entirety"),cH=function(n,e,t,r){return tZ(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))},cN=function(n,e,t){var r={},o={};return nc(t,function(n){n.fold(function(n){r[n.pname]=cg(!0,function(e,t,r){return n.factory.sketch(cH(e,n,t,r))})},function(n){var t=e.parts[n.name];o[n.name]=P(n.factory.sketch(cH(e,n,t[cA()]),t))},function(n){r[n.pname]=cg(!1,function(e,t,r){return n.factory.sketch(cH(e,n,t,r))})},function(n){r[n.pname]=cp(!0,function(e,t,r){return nu(e[n.name],function(t){return n.factory.sketch(tZ(n.defaults(e,t,r),t,n.overrides(e,t)))})})})}),{internals:P(r),externals:P(o)}},cz=function(n,e){var t={};return nc(e,function(e){e.fold(Q.some,Q.none,Q.some,Q.some).each(function(e){var r=cP(n,e.pname);t[e.name]=function(t){var o=rg("Part: "+e.name+" in "+n,ri(e.schema),t);return w(w({},r),{config:t,validated:o})}})}),t},cP=function(n,e){return{uiType:ch(),owner:n,name:e}},cj=function(n,e,t){return cN(n,e,t)},cL=function(n,e,t){return cm(Q.some(n),e,e.components,t)},c$=function(n,e,t){var r=e.partUids[t];return n.getSystem().getByUid(r).toOptional()},cG=function(n,e,t){return c$(n,e,t).getOrDie("Could not find part: "+t)},cU=function(n,e){var t=n.getSystem();return tb(e.partUids,function(n,e){return P(t.getByUid(n))})},cW=function(n,e){var t=nu(e,cR);return rV(nu(t,function(e){return{key:e,value:n+"-"+e}}))},cX=function(n){return tY("partUids","partUids",t5(function(e){return cW(e.uid,n)}),rc())},cq=cb("alloy-premade"),cK=function(n){return rI(cq,n)},cY=function(n){return r5(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return n.apply(void 0,k([e.getApis(),e],t,!1))},n)},cJ=P("alloy-id-"),cQ=P("data-alloy-id"),cZ=cJ(),c0=cQ(),c1=function(n,e){var t=cb(cZ+n);return c2(e,t),t},c2=function(n,e){Object.defineProperty(n.dom,c0,{value:e,writable:!0})},c9=function(n){var e=ez(n)?n.dom[c0]:null;return Q.from(e)},c3=function(n){return cb(n)},c5=function(n,e,t,r,o){return rg(n+" [SpecSchema]",ro((r.length>0?[rx("parts",r)]:[]).concat([rb("uid"),rT("dom",{}),rT("components",[]),oW("originalSpec"),rT("debug.sketcher",{})]).concat(o).concat(e)),t)},c4=function(n,e,t,r){var o=c8(r);return t(c5(n,e,o,[],[]),o)},c6=function(n,e,t,r,o){var i=c8(o),u=c5(n,e,i,nh(t,function(n){return n.fold(Q.none,Q.some,Q.none,Q.none).map(function(n){return rx(n.name,n.schema.concat([oW(cA())]))}).toArray()}),[cX(t)]),c=cj(n,u,t),a=cL(n,u,c.internals());return r(u,a,i,c.externals())},c8=function(n){return tk(n,"uid")?n:w(w({},n),{uid:c3("uid")})},c7=ro([rb("name"),rb("factory"),rb("configFields"),rT("apis",{}),rT("extraApis",{})]),an=ro([rb("name"),rb("factory"),rb("configFields"),rb("partFields"),rT("apis",{}),rT("extraApis",{})]),ae=function(n){var e=rg("Sketcher for "+n.name,c7,n),t=tb(e.apis,cY),r=tb(e.extraApis,function(n,e){return r3(n,e)});return w(w({name:e.name,configFields:e.configFields,sketch:function(n){return c4(e.name,e.configFields,e.factory,n)}},t),r)},at=function(n){var e=rg("Sketcher for "+n.name,an,n),t=cz(e.name,e.partFields),r=tb(e.apis,cY),o=tb(e.extraApis,function(n,e){return r3(n,e)});return w(w({name:e.name,partFields:e.partFields,configFields:e.configFields,sketch:function(n){return c6(e.name,e.configFields,e.partFields,e.factory,n)},parts:t},r),o)},ar=ae({name:"Button",factory:function(n){var e=rU(np([n.action.map(function(n){return r1(function(e,t){n(e),t.stop()})}).toArray(),it()])),t=n.dom.tag,r=function(e){return tO(n.dom,"attributes").bind(function(n){return tO(n,e)})};return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:cc(n.buttonBehaviours,[iu.config({}),ci.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==t)return{role:r("role").getOr("button")};var n=r("type").getOr("button"),e=r("role").map(function(n){return{role:n}}).getOr({});return w({type:n},e)}()},eventOrder:n.eventOrder}},configFields:[rT("uid",void 0),rb("dom"),rT("components",[]),cu("buttonBehaviours",[iu,ci]),rS("action"),rS("role"),rT("eventOrder",{})]}),ao=oo({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return rU([rW(eu(),q)])},exhibit:function(){return r4({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),ai=function(n){var e=eR.fromHtml(n),t=eX(e),r=nl(void 0!==e.dom.attributes?e.dom.attributes:[],function(n,e){var t;return"class"===e.name?n:w(w({},n),((t={})[e.name]=e.value,t))},{}),o=Array.prototype.slice.call(e.dom.classList,0),i=0===t.length?{}:{innerHtml:oO(e)};return w({tag:eH(e),classes:o,attributes:r},i)},au=function(n){return ai(nM(n,{prefix:o7}))},ac=function(n){return{dom:au(n)}},aa=function(n){return ot([o5.config({toggleClass:ie("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),o4(n,function(n,e){(e?o5.on:o5.off)(n)})])},af=function(n,e){var t=aa(e);return ad(e,function(){n.execCommand(e)},t,n)},as=function(n,e,t,r){return ad(e,r,aa(t),n)},al=function(n,e){var t=e.ui.registry.getAll().icons;return Q.from(t[n]).fold(function(){return au('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return au('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})},ad=function(n,e,t,r){return ar.sketch({dom:al(n,r),action:e,buttonBehaviours:tZ(ot([ao.config({})]),t)})},am=cV({schema:[rb("dom")],name:"label"}),ag=function(n){return cV({name:""+n+"-edge",overrides:function(e){return e.model.manager.edgeActions[n].fold(function(){return{}},function(n){return{events:rU([rq(n9(),function(e,t,r){return n(e,r)},[e]),rq(n4(),function(e,t,r){return n(e,r)},[e]),rq(n6(),function(e,t,r){r.mouseIsDown.get()&&n(e,r)},[e])])}})}})},ap=ag("top-left"),ah=ag("top"),av=ag("top-right"),ab=ag("right"),ay=ag("bottom-right"),ax=ag("bottom"),aS=ag("bottom-left"),aw=ag("left"),aO=cI({name:"thumb",defaults:P({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:rU([rY(n9(),n,"spectrum"),rY(n3(),n,"spectrum"),rY(n5(),n,"spectrum"),rY(n4(),n,"spectrum"),rY(n6(),n,"spectrum"),rY(n8(),n,"spectrum")])}}}),ak=cI({schema:[rv("mouseIsDown",function(){return oa(!1)})],name:"spectrum",overrides:function(n){var e=n.model.manager,t=function(t,r){return e.getValueFromEvent(r).map(function(r){return e.setValueFrom(t,n,r)})};return{behaviours:ot([ci.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),iu.config({})]),events:rU([rX(n9(),t),rX(n3(),t),rX(n4(),t),rX(n6(),function(e,r){n.mouseIsDown.get()&&t(e,r)})])}}}),aT=function(n,e,t){e.store.manager.onLoad(n,e,t)},aE=function(n,e,t){e.store.manager.onUnload(n,e,t)},aC=Object.freeze({__proto__:null,onLoad:aT,onUnload:aE,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),aD=Object.freeze({__proto__:null,events:function(n,e){return rU(n.resetOnDom?[rQ(function(t,r){aT(t,n,e)}),rZ(function(t,r){aE(t,n,e)})]:[r6(n,e,aT)])}}),aM=function(){var n=oa(null);return oe({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},a_=function(){var n=oa({}),e=oa({});return oe({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:e.get()}},lookup:function(t){return tO(n.get(),t).orThunk(function(){return tO(e.get(),t)})},update:function(t){var r=n.get(),o=e.get(),i={},u={};nc(t,function(n){i[n.value]=n,tO(n,"meta").each(function(e){tO(e,"text").each(function(e){u[e]=n})})}),n.set(w(w({},r),i)),e.set(w(w({},o),u))},clear:function(){n.set({}),e.set({})}})},aR=Object.freeze({__proto__:null,memory:aM,dataset:a_,manual:function(){return oe({readState:N})},init:function(n){return n.store.manager.state(n)}}),aF=function(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)},aI=[rS("initialValue"),rb("getFallbackEntry"),rb("getDataKey"),rb("setValue"),oU("manager",{setValue:aF,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).getOrThunk(function(){return r.getFallbackEntry(o)})},onLoad:function(n,e,t){e.store.initialValue.each(function(r){aF(n,e,t,r)})},onUnload:function(n,e,t){t.clear()},state:a_})],aV=[rb("getValue"),rT("setValue",N),rS("initialValue"),oU("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(n,e,t){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:N,state:on.init})],aB=oo({fields:[rE("store",{mode:"memory"},rh("mode",{memory:[rS("initialValue"),oU("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:aM})],manual:aV,dataset:aI})),oj("onSetValue"),rT("resetOnDom",!1)],name:"representing",active:aD,apis:aC,extra:{setValueFrom:function(n,e){var t=aB.getValue(e);aB.setValue(n,t)}},state:aR}),aA=ib("width",function(n){return n.dom.offsetWidth}),aH=function(n,e){return aA.set(n,e)},aN=function(n){return aA.get(n)},az=function(n,e){return{left:n,top:e,translate:function(t,r){return az(n+t,e+r)}}},aP=P("slider.change.value"),aj=function(n){var e=n.event.raw;return -1!==e.type.indexOf("touch")?void 0!==e.touches&&1===e.touches.length?Q.some(e.touches[0]).map(function(n){return az(n.clientX,n.clientY)}):Q.none():void 0!==e.clientX?Q.some(e).map(function(n){return az(n.clientX,n.clientY)}):Q.none()},aL=function(n){return n.model.minX},a$=function(n){return n.model.minY},aG=function(n){return n.model.minX-1},aU=function(n){return n.model.minY-1},aW=function(n){return n.model.maxX},aX=function(n){return n.model.maxY},aq=function(n){return n.model.maxX+1},aK=function(n){return n.model.maxY+1},aY=function(n,e,t){return e(n)-t(n)},aJ=function(n){return aY(n,aW,aL)},aQ=function(n){return aY(n,aX,a$)},aZ=function(n){return aJ(n)/2},a0=function(n){return aQ(n)/2},a1=function(n){return n.stepSize},a2=function(n){return n.snapToGrid},a9=function(n){return n.snapStart},a3=function(n){return n.rounded},a5=function(n,e){return void 0!==n[e+"-edge"]},a4=function(n){return a5(n,"left")},a6=function(n){return a5(n,"right")},a8=function(n){return a5(n,"top")},a7=function(n){return a5(n,"bottom")},fn=function(n){return n.model.value.get()},fe=function(n){return{x:n}},ft=function(n){return{y:n}},fr=function(n,e){return{x:n,y:e}},fo=function(n,e){ek(n,aP(),{value:e})},fi=function(n,e,t,r){return n<e?n:n>t?t:n===e?e-1:Math.max(e,n-r)},fu=function(n,e,t,r){return n>t?n:n<e?e:n===t?t+1:Math.min(t,n+r)},fc=function(n,e,t){return Math.max(e,Math.min(t,n))},fa=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?e-1:e,p=s?t+1:t;if(o<l)return g;if(o>d)return p;var h=fc((Math.min(d,Math.max(o,l))-l)/m*r+e,g,p);return u&&h>=e&&h<=t?c.fold(function(){return fc(e+Math.round((h-e)/i)*i,e-1,t+1)},function(n){return Math.max(n,n+Math.min(Math.floor((t-n)/i),Math.floor((h-n)/i)+Math.round((h-n)%i/i))*i)}):a?Math.round(h):h},ff=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<e?i?0:f:o>t?u?c:s:(o-e)/r*a},fs="right",fl="bottom",fd="left",fm=function(n){return n.element.dom.getBoundingClientRect()},fg=function(n,e){return n[e]},fp=function(n){return fg(fm(n),fd)},fh=function(n){return fg(fm(n),fs)},fv=function(n){return fg(fm(n),"top")},fb=function(n){return fg(fm(n),fl)},fy=function(n){return fg(fm(n),"width")},fx=function(n){return fg(fm(n),"height")},fS=function(n,e,t){return(n+e)/2-t},fw=function(n,e){var t=fm(n),r=fm(e);return fS(fg(t,fd),fg(t,fs),fg(r,fd))},fO=function(n,e){var t=fm(n),r=fm(e);return fS(fg(t,"top"),fg(t,fl),fg(r,"top"))},fk=function(n,e){ek(n,aP(),{value:e})},fT=function(n){return{x:n}},fE=function(n,e,t){return fa({min:aL(e),max:aW(e),range:aJ(e),value:t,step:a1(e),snap:a2(e),snapStart:a9(e),rounded:a3(e),hasMinEdge:a4(e),hasMaxEdge:a6(e),minBound:fp(n),maxBound:fh(n),screenRange:fy(n)})},fC=function(n,e,t){var r=(n>0?fu:fi)(fn(t).x,aL(t),aW(t),a1(t));return fk(e,fT(r)),Q.some(r)},fD=function(n){return function(e,t){return fC(n,e,t).map(q)}},fM=function(n,e,t,r,o){var i=fy(n),u=r.bind(function(e){return Q.some(fw(e,n))}).getOr(0),c=o.bind(function(e){return Q.some(fw(e,n))}).getOr(i);return ff({min:aL(e),max:aW(e),range:aJ(e),value:t,hasMinEdge:a4(e),hasMaxEdge:a6(e),minBound:fp(n),minOffset:0,maxBound:fh(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c})},f_=function(n,e,t,r,o,i){var u=fM(e,i,t,r,o);return fp(e)-fp(n)+u},fR=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=fE(n,e,t);return fk(n,fT(r)),r},setToMin:function(n,e){fk(n,fT(aL(e)))},setToMax:function(n,e){fk(n,fT(aW(e)))},findValueOfOffset:fE,getValueFromEvent:function(n){return aj(n).map(function(n){return n.left})},findPositionOfValue:f_,setPositionFromValue:function(n,e,t,r){var o=fn(t),i=f_(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),t),u=aN(e.element)/2;il(e.element,"left",i-u+"px")},onLeft:fD(-1),onRight:fD(1),onUp:Q.none,onDown:Q.none,edgeActions:{"top-left":Q.none(),top:Q.none(),"top-right":Q.none(),right:Q.some(function(n,e){fo(n,fe(aq(e)))}),"bottom-right":Q.none(),bottom:Q.none(),"bottom-left":Q.none(),left:Q.some(function(n,e){fo(n,fe(aG(e)))})}}),fF=function(n,e){ek(n,aP(),{value:e})},fI=function(n){return{y:n}},fV=function(n,e,t){return fa({min:a$(e),max:aX(e),range:aQ(e),value:t,step:a1(e),snap:a2(e),snapStart:a9(e),rounded:a3(e),hasMinEdge:a8(e),hasMaxEdge:a7(e),minBound:fv(n),maxBound:fb(n),screenRange:fx(n)})},fB=function(n,e,t){var r=(n>0?fu:fi)(fn(t).y,a$(t),aX(t),a1(t));return fF(e,fI(r)),Q.some(r)},fA=function(n){return function(e,t){return fB(n,e,t).map(q)}},fH=function(n,e,t,r,o){var i=fx(n),u=r.bind(function(e){return Q.some(fO(e,n))}).getOr(0),c=o.bind(function(e){return Q.some(fO(e,n))}).getOr(i);return ff({min:a$(e),max:aX(e),range:aQ(e),value:t,hasMinEdge:a8(e),hasMaxEdge:a7(e),minBound:fv(n),minOffset:0,maxBound:fb(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c})},fN=function(n,e,t,r,o,i){var u=fH(e,i,t,r,o);return fv(e)-fv(n)+u},fz=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=fV(n,e,t);return fF(n,fI(r)),r},setToMin:function(n,e){fF(n,fI(a$(e)))},setToMax:function(n,e){fF(n,fI(aX(e)))},findValueOfOffset:fV,getValueFromEvent:function(n){return aj(n).map(function(n){return n.top})},findPositionOfValue:fN,setPositionFromValue:function(n,e,t,r){var o=fn(t),i=fN(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),t),u=ix(e.element)/2;il(e.element,"top",i-u+"px")},onLeft:Q.none,onRight:Q.none,onUp:fA(-1),onDown:fA(1),edgeActions:{"top-left":Q.none(),top:Q.some(function(n,e){fo(n,ft(aU(e)))}),"top-right":Q.none(),right:Q.none(),"bottom-right":Q.none(),bottom:Q.some(function(n,e){fo(n,ft(aK(e)))}),"bottom-left":Q.none(),left:Q.none()}}),fP=function(n,e){ek(n,aP(),{value:e})},fj=function(n,e){return{x:n,y:e}},fL=function(n,e,t,r){var o=n>0?fu:fi,i=e?fn(r).x:o(fn(r).x,aL(r),aW(r),a1(r));return fP(t,fj(i,e?o(fn(r).y,a$(r),aX(r),a1(r)):fn(r).y)),Q.some(i)},f$=function(n,e){return function(t,r){return fL(n,e,t,r).map(q)}},fG=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var r=fj(fE(n,e,t.left),fV(n,e,t.top));return fP(n,r),r},setToMin:function(n,e){fP(n,fj(aL(e),a$(e)))},setToMax:function(n,e){fP(n,fj(aW(e),aX(e)))},getValueFromEvent:function(n){return aj(n)},setPositionFromValue:function(n,e,t,r){var o=fn(t),i=f_(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),t),u=fN(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),t),c=aN(e.element)/2,a=ix(e.element)/2;il(e.element,"left",i-c+"px"),il(e.element,"top",u-a+"px")},onLeft:f$(-1,!1),onRight:f$(1,!1),onUp:f$(-1,!0),onDown:f$(1,!0),edgeActions:{"top-left":Q.some(function(n,e){fo(n,fr(aG(e),aU(e)))}),top:Q.some(function(n,e){fo(n,fr(aZ(e),aU(e)))}),"top-right":Q.some(function(n,e){fo(n,fr(aq(e),aU(e)))}),right:Q.some(function(n,e){fo(n,fr(aq(e),a0(e)))}),"bottom-right":Q.some(function(n,e){fo(n,fr(aq(e),aK(e)))}),bottom:Q.some(function(n,e){fo(n,fr(aZ(e),aK(e)))}),"bottom-left":Q.some(function(n,e){fo(n,fr(aG(e),aK(e)))}),left:Q.some(function(n,e){fo(n,fr(aG(e),a0(e)))})}}),fU=[rT("stepSize",1),rT("onChange",N),rT("onChoose",N),rT("onInit",N),rT("onDragStart",N),rT("onDragEnd",N),rT("snapToGrid",!1),rT("rounded",!0),rS("snapStart"),ry("model",rh("mode",{x:[rT("minX",0),rT("maxX",100),rv("value",function(n){return oa(n.mode.minX)}),rb("getInitialValue"),oU("manager",fR)],y:[rT("minY",0),rT("maxY",100),rv("value",function(n){return oa(n.mode.minY)}),rb("getInitialValue"),oU("manager",fz)],xy:[rT("minX",0),rT("maxX",100),rT("minY",0),rT("maxY",100),rv("value",function(n){return oa({x:n.mode.minX,y:n.mode.minY})}),rb("getInitialValue"),oU("manager",fG)]})),cu("sliderBehaviours",[ci,aB]),rv("mouseIsDown",function(){return oa(!1)})],fW=P("mouse.released"),fX=at({name:"Slider",configFields:fU,partFields:[am,aw,ab,ah,ax,ap,av,aS,ay,aO,ak],factory:function(n,e,t,r){var o,i=function(e){return cG(e,n,"thumb")},u=function(e){return cG(e,n,"spectrum")},c=function(e){return c$(e,n,"left-edge")},a=function(e){return c$(e,n,"right-edge")},f=function(e){return c$(e,n,"top-edge")},s=function(e){return c$(e,n,"bottom-edge")},l=n.model,d=l.manager,m=function(e,t){d.setPositionFromValue(e,t,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:f,getBottomEdge:s,getSpectrum:u})},g=function(n,e){l.value.set(e);var t=i(n);m(n,t)},p=function(e,t){g(e,t);var r=i(e);return n.onChange(e,r,t),Q.some(!0)},h=function(e){var t=n.mouseIsDown.get();n.mouseIsDown.set(!1),t&&c$(e,n,"thumb").each(function(t){var r=l.value.get();n.onChoose(e,t,r)})},v=function(e,t){t.stop(),n.mouseIsDown.set(!0),n.onDragStart(e,i(e))},b=function(e,t){t.stop(),n.onDragEnd(e,i(e)),h(e)};return{uid:n.uid,dom:n.dom,components:e,behaviours:cc(n.sliderBehaviours,[ci.config({mode:"special",focusIn:function(e){return c$(e,n,"spectrum").map(ci.focusIn).map(q)}}),aB.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),oq.config({channels:((o={})[fW()]={onReceive:h},o)})]),events:rU([rX(aP(),function(n,e){p(n,e.event.value)}),rQ(function(e,t){var r=l.getInitialValue();l.value.set(r);var o=i(e);m(e,o);var c=u(e);n.onInit(e,o,c,l.value.get())}),rX(n9(),v),rX(n5(),b),rX(n4(),v),rX(n8(),b)]),apis:{resetToMin:function(e){d.setToMin(e,n)},resetToMax:function(e){d.setToMax(e,n)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(n,e,t){n.setValue(e,t)},resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),fq=function(n,e,t,r){return ad(e,function(){var r=t();n.setContextToolbar([{label:e+" group",items:r}])},{},r)},fK=function(n){var e=function(n){return n<0?"black":n>360?"white":"hsl("+n+", 100%, 50%)"};return fX.sketch({dom:au('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[fX.parts["left-edge"](ac('<div class="${prefix}-hue-slider-black"></div>')),fX.parts.spectrum({dom:au('<div class="${prefix}-slider-gradient-container"></div>'),components:[ac('<div class="${prefix}-slider-gradient"></div>')],behaviours:ot([o5.config({toggleClass:ie("thumb-active")})])}),fX.parts["right-edge"](ac('<div class="${prefix}-hue-slider-white"></div>')),fX.parts.thumb({dom:au('<div class="${prefix}-slider-thumb"></div>'),behaviours:ot([o5.config({toggleClass:ie("thumb-active")})])})],onChange:function(t,r,o){var i=e(o.x());il(r.element,"background-color",i),n.onChange(t,r,i)},onDragStart:function(n,e){o5.on(e)},onDragEnd:function(n,e){o5.off(e)},onInit:function(n,t,r,o){var i=e(o.x());il(t.element,"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:n.getInitialValue()}}},sliderBehaviours:ot([o6(fX.refresh)])})},fY=function(n,e){var t={onChange:function(n,t,r){e.undoManager.transact(function(){e.formatter.apply("forecolor",{value:r}),e.nodeChanged()})},getInitialValue:P(-1)};return fq(n,"color-levels",function(){return[fK(t)]},e)},fJ=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],fQ=function(n){var e,t=n.selection.getStart(),r=eR.fromDom(t),o=eR.fromDom(n.getBody()),i=(e=function(n){return eA(o,n)},(ez(r)?Q.some(r):eU(r).filter(ez)).map(function(n){return iw(function(n,e){return e(n)},iO,n,function(n){return ip(n,"font-size").isSome()},e).bind(function(n){return ip(n,"font-size")}).getOrThunk(function(){return im(n,"font-size")})}).getOr(""));return nm(fJ,function(n){return i===n}).getOr("medium")},fZ=function(n,e){fQ(n)!==e&&n.execCommand("fontSize",!1,e)},f0=function(n){var e;return(e=fQ(n),ng(fJ,function(n){return n===e})).getOr(2)},f1=function(n,e){Q.from(fJ[e]).each(function(e){fZ(n,e)})},f2=P(fJ),f9=ro([rb("getInitialValue"),rb("onChange"),rb("category"),rb("sizes")]),f3=function(n){var e=rg("SizeSlider",f9,n);return fX.sketch({dom:{tag:"div",classes:[ie("slider-"+e.category+"-size-container"),ie("slider"),ie("slider-size-container")]},onChange:function(n,t,r){var o=r.x();o>=0&&o<e.sizes.length&&e.onChange(o)},onDragStart:function(n,e){o5.on(e)},onDragEnd:function(n,e){o5.off(e)},model:{mode:"x",minX:0,maxX:e.sizes.length-1,getInitialValue:function(){return{x:e.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:ot([o6(fX.refresh)]),components:[fX.parts.spectrum({dom:au('<div class="${prefix}-slider-size-container"></div>'),components:[ac('<div class="${prefix}-slider-size-line"></div>')]}),fX.parts.thumb({dom:au('<div class="${prefix}-slider-thumb"></div>'),behaviours:ot([o5.config({toggleClass:ie("thumb-active")})])})]})},f5=f2(),f4=function(n,e){var t=function(n){f1(e,n)},r=function(){return f0(e)};return fq(n,"font-size",function(){return[ac('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),f3({onChange:t,sizes:f5,category:"font",getInitialValue:r}),ac('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]},e)},f6=function(n){var e=void 0!==n.uid&&tT(n,"uid")?n.uid:c3("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return w(w({},n),{uid:e})}}},f8={},f7={exports:f8};!function(n,e,t,r){var o,i;o=this,i=function(){var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={exports:{}};(function(e){(function(n){var t=setTimeout;function r(){}function o(n){if("object"!=typeof this)throw TypeError("Promises must be constructed via new");if("function"!=typeof n)throw TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function i(n,e){for(;3===n._state;)n=n._value;if(0===n._state){n._deferreds.push(e);return}n._handled=!0,o._immediateFn(function(){var t,r=1===n._state?e.onFulfilled:e.onRejected;if(null===r){(1===n._state?u:c)(e.promise,n._value);return}try{t=r(n._value)}catch(n){c(e.promise,n);return}u(e.promise,t)})}function u(n,e){try{if(e===n)throw TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof o){n._state=3,n._value=e,a(n);return}if("function"==typeof t){s(function(){t.apply(e,arguments)},n);return}}n._state=1,n._value=e,a(n)}catch(e){c(n,e)}}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&o._immediateFn(function(){n._handled||o._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)i(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function s(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}o.prototype.catch=function(n){return this.then(null,n)},o.prototype.then=function(n,e){var t=new this.constructor(r);return i(this,new f(n,e,t)),t},o.all=function(n){var e=Array.prototype.slice.call(n);return new o(function(n,t){if(0===e.length)return n([]);for(var r=e.length,o=0;o<e.length;o++)!function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c){c.call(u,function(n){o(i,n)},t);return}}e[i]=u,0==--r&&n(e)}catch(n){t(n)}}(o,e[o])})},o.resolve=function(n){return n&&"object"==typeof n&&n.constructor===o?n:new o(function(e){e(n)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(n){return new o(function(e,t){for(var r=0,o=n.length;r<o;r++)n[r].then(e,t)})},o._immediateFn="function"==typeof setImmediate?function(n){setImmediate(n)}:function(n){t(n,0)},o._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},o._setImmediateFn=function(n){o._immediateFn=n},o._setUnhandledRejectionFn=function(n){o._unhandledRejectionFn=n},e.exports?e.exports=o:n.Promise||(n.Promise=o)})(n)})(e);var t=e.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||t}},"object"==typeof e&&void 0!==t?t.exports=i():"function"==typeof n&&n.amd?n(i):(o="undefined"!=typeof globalThis?globalThis:o||self).EphoxContactWrapper=i()}(void 0,f8,f7);var sn=f7.exports.boltExport,se=function(n,e){new sn(function(n){var t=new FileReader;t.onloadend=function(){n(t.result)},t.readAsDataURL(e)}).then(function(n){return n.split(",")[1]}).then(function(t){n.undoManager.transact(function(){var r=n.editorUpload.blobCache,o=r.create(cb("mceu"),e,t);r.add(o);var i=n.dom.createHTML("img",{src:o.blobUri()});n.insertContent(i)})})},st=function(n){var e=n.event.raw,t=e.target.files||e.dataTransfer.files;return Q.from(t[0])},sr=function(n){var e=f6({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:rU([rJ(eo()),rX(er(),function(e,t){st(t).each(function(e){se(n,e)})})])});return ar.sketch({dom:al("image",n),components:[e.asSpec()],action:function(n){e.get(n).element.dom.click()}})},so=function(n){return n.dom.textContent},si=function(n,e){n.dom.textContent=e},su=function(n){return n.length>0},sc=function(n){return null==n?"":n},sa=function(n){var e=so(n),t=tM(n,"href"),r=tM(n,"title"),o=tM(n,"target");return{url:sc(t),text:e!==t?sc(e):"",title:sc(r),target:sc(o),link:Q.some(n)}},sf=function(n,e){e.link.bind(j).each(function(e){n.execCommand("unlink")})},ss=function(n,e){var t={};return t.href=n,e.title.toOptional().filter(su).each(function(n){t.title=n}),e.target.toOptional().filter(su).each(function(n){t.target=n}),t},sl=function(n,e){e.url.toOptional().filter(su).fold(function(){sf(n,e)},function(t){var r=ss(t,e);e.link.bind(j).fold(function(){var o=e.text.toOptional().filter(su).getOr(t);n.insertContent(n.dom.createHTML("a",r,n.dom.encode(o)))},function(n){var o=e.text.toOptional().filter(su).fold(function(){return tM(n,"href")===so(n)?Q.some(t):Q.none()},Q.some);tD(n,r),o.each(function(e){si(n,e)})})})},sd=function(n){return iD(eR.fromDom(n.selection.getStart()),"a")},sm=n2(),sg=function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)},sp=function(n,e){(sm.os.isAndroid()?sg:W)(e,n)},sh=function(n,e){var t=rU(e);return oo({fields:[rb("enabled")],name:n,active:{events:P(t)}})},sv=function(n,e){var t=sh(n,e);return{key:n,value:{config:{},me:t,configAsRaw:P({}),initialConfig:{},state:on}}},sb=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),sy=oo({fields:[rb("find")],name:"composing",apis:sb}),sx=ae({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,r=O(e,["attributes"]);return{uid:n.uid,dom:w({tag:"div",attributes:w({role:"presentation"},t)},r),components:n.components,behaviours:n.containerBehaviours.dump,events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[rT("components",[]),cu("containerBehaviours",[]),rT("events",{}),rT("domModification",{}),rT("eventOrder",{})]}),sS=ae({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:cc(n.dataBehaviours,[aB.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),sy.config({find:Q.some})]),events:rU([rQ(function(e,t){aB.setValue(e,n.getInitialValue())})])}},configFields:[rb("uid"),rb("dom"),rb("getInitialValue"),cu("dataBehaviours",[aB,sy])]}),sw=function(n){return n.dom.value},sO=function(n,e){if(void 0===e)throw Error("Value.set was undefined");n.dom.value=e},sk=ae({name:"Input",configFields:P([rS("data"),rT("inputAttributes",{}),rT("inputStyles",{}),rT("tag","input"),rT("inputClasses",[]),oj("onSetValue"),rT("styles",{}),rT("eventOrder",{}),cu("inputBehaviours",[aB,iu]),rT("selectOnFocus",!0)])(),factory:function(n,e){return{uid:n.uid,dom:{tag:n.tag,attributes:w({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses},components:[],behaviours:w(w({},ot([iu.config({onFocus:n.selectOnFocus?function(n){var e=n.element,t=sw(e);e.dom.setSelectionRange(0,t.length)}:N})])),cc(n.inputBehaviours,[aB.config({store:w(w({mode:"manual"},n.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return sw(n.element)},setValue:function(n,e){sw(n.element)!==e&&sO(n.element,e)}}),onSetValue:n.onSetValue})])),eventOrder:n.eventOrder}}}),sT=Object.freeze({__proto__:null,exhibit:function(n,e){return r4({attributes:rV([{key:e.tabAttr,value:"true"}])})}}),sE=oo({fields:[rT("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:sT}),sC=tinymce.util.Tools.resolve("tinymce.util.I18n"),sD=function(n,e){var t=f6(sk.sketch({inputAttributes:{placeholder:sC.translate(e)},onSetValue:function(n,e){eO(n,et())},inputBehaviours:ot([sy.config({find:Q.some}),sE.config({}),ci.config({mode:"execution"})]),selectOnFocus:!1})),r=f6(ar.sketch({dom:au('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var e=t.get(n);aB.setValue(e,"")}}));return{name:n,spec:sx.sketch({dom:au('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),r.asSpec()],containerBehaviours:ot([o5.config({toggleClass:ie("input-container-empty")}),sy.config({find:function(n){return Q.some(t.get(n))}}),sv("input-clearing",[rX(et(),function(n){var e=t.get(n);(aB.getValue(e).length>0?o5.off:o5.on)(n)})])])})}},sM=["input","button","textarea","select"],s_=function(n,e,t){(e.disabled()?sA:sH)(n,e)},sR=function(n,e){return!0===e.useNative&&no(sM,eH(n.element))},sF=function(n){tC(n.element,"disabled","disabled")},sI=function(n){tF(n.element,"disabled")},sV=function(n){tC(n.element,"aria-disabled","true")},sB=function(n){tC(n.element,"aria-disabled","false")},sA=function(n,e,t){e.disableClass.each(function(e){tH(n.element,e)}),(sR(n,e)?sF:sV)(n),e.onDisabled(n)},sH=function(n,e,t){e.disableClass.each(function(e){tz(n.element,e)}),(sR(n,e)?sI:sB)(n),e.onEnabled(n)},sN=function(n,e){return sR(n,e)?tR(n.element,"disabled"):"true"===tM(n.element,"aria-disabled")},sz=Object.freeze({__proto__:null,enable:sH,disable:sA,isDisabled:sN,onLoad:s_,set:function(n,e,t,r){(r?sA:sH)(n,e)}}),sP=Object.freeze({__proto__:null,exhibit:function(n,e){return r4({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(n,e){return rU([rW(em(),function(e,t){return sN(e,n)}),r6(n,e,s_)])}}),sj=oo({fields:[rE("disabled",X,ra),rT("useNative",!0),rS("disableClass"),oj("onDisabled"),oj("onEnabled")],name:"disabling",active:sP,apis:sz}),sL="form",s$=[cu("formBehaviours",[aB])],sG=function(n){return"<alloy.field."+n+">"},sU=function(n,e){return{uid:n.uid,dom:n.dom,components:e,behaviours:cc(n.formBehaviours,[aB.config({store:{mode:"manual",getValue:function(e){return tb(cU(e,n),function(n,e){return n().bind(function(n){var t,r;return t=sy.getCurrent(n),r=Error("Cannot find a current component to extract the value from for form part '"+e+"': "+oE(n.element)),t.fold(function(){return tU.error(r)},tU.value)}).map(aB.getValue)})},setValue:function(e,t){tv(t,function(t,r){c$(e,n,r).each(function(n){sy.getCurrent(n).each(function(n){aB.setValue(n,t)})})})}}})]),apis:{getField:function(e,t){return c$(e,n,t).bind(sy.getCurrent)}}}},sW={getField:cY(function(n,e,t){return n.getField(e,t)}),sketch:function(n){var e,t={field:function(n,t){var r;return e.push(n),r=sG(n),{uiType:ch(),owner:sL,name:r,config:t,validated:{}}},record:P(e=[])},r=n(t);return c6(sL,s$,nu(t.record(),function(n){return cI({name:n,pname:sG(n)})}),sU,r)}},sX=function(n,e){if(e===n.xValue)return n;var t=e-n.xValue>0?1:-1;return{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([{direction:t,xValue:e}])}},sq=function(n){if(0===n.points.length)return 0;var e=n.points[0].direction,t=n.points[n.points.length-1].direction;return -1===e&&-1===t?-1:1===e&&1===t?1:0},sK=function(n){var e="navigateEvent",t=rg("SerialisedDialog",ri([rb("fields"),rT("maxFieldIndex",n.fields.length-1),rb("onExecute"),rb("getInitialValue"),rv("state",function(){return{dialogSwipeState:us(),currentScreen:oa(0)}})]),n),r=function(n,t,r){return ar.sketch({dom:au('<span class="${prefix}-icon-'+t+' ${prefix}-icon"></span>'),action:function(t){ek(t,e,{direction:n})},buttonBehaviours:ot([sj.config({disableClass:ie("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},o=function(n,e){iC(n.element,"."+ie("serialised-dialog-chain")).each(function(n){il(n,"left",-t.state.currentScreen.get()*e.width+"px")})},i=function(n,e){var r=iS(n.element,"."+ie("serialised-dialog-screen"));iC(n.element,"."+ie("serialised-dialog-chain")).each(function(n){t.state.currentScreen.get()+e>=0&&t.state.currentScreen.get()+e<r.length&&(ip(n,"left").each(function(t){il(n,"left",parseInt(t,10)-e*aN(r[0])+"px")}),t.state.currentScreen.set(t.state.currentScreen.get()+e))})},u=function(n){var e=iS(n.element,"input");Q.from(e[t.state.currentScreen.get()]).each(function(e){n.getSystem().getByDom(e).each(function(e){eM(n,e.element)})});var r=f.get(n);i3.highlightAt(r,t.state.currentScreen.get())},c=function(){t.state.currentScreen.set(0),t.state.dialogSwipeState.clear()},a=f6(sW.sketch(function(n){return{dom:au('<div class="${prefix}-serialised-dialog"></div>'),components:[sx.sketch({dom:au('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:nu(t.fields,function(e,o){return o<=t.maxFieldIndex?sx.sketch({dom:au('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[r(-1,"previous",o>0),n.field(e.name,e.spec),r(1,"next",o<t.maxFieldIndex)]}):n.field(e.name,e.spec)})})],formBehaviours:ot([o6(function(n,e){o(n,e)}),ci.config({mode:"special",focusIn:function(n,e){u(n)},onTab:function(n,e){return i(n,1),Q.some(!0)},onShiftTab:function(n,e){return i(n,-1),Q.some(!0)}}),sv("form-events",[rQ(function(n,e){c();var r=f.get(n);i3.highlightFirst(r),t.getInitialValue(n).each(function(e){aB.setValue(n,e)})}),r1(t.onExecute),rX(ei(),function(n,e){"left"===e.event.raw.propertyName&&u(n)}),rX(e,function(n,e){i(n,e.event.direction)})])])}})),f=f6({dom:au('<div class="${prefix}-dot-container"></div>'),behaviours:ot([i3.config({highlightClass:ie("dot-active"),itemClass:ie("dot-item")})]),components:nh(t.fields,function(n,e){return e<=t.maxFieldIndex?[ac('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:au('<div class="${prefix}-serializer-wrapper"></div>'),components:[a.asSpec(),f.asSpec()],behaviours:ot([ci.config({mode:"special",focusIn:function(n){var e=a.get(n);ci.focusIn(e)}}),sv("serializer-wrapper-events",[rX(n9(),function(n,e){var r=e.event;t.state.dialogSwipeState.set({xValue:r.raw.touches[0].clientX,points:[]})}),rX(n3(),function(n,e){var r=e.event;t.state.dialogSwipeState.on(function(n){e.event.prevent(),t.state.dialogSwipeState.set(sX(n,r.raw.touches[0].clientX))})}),rX(n5(),function(n,e){t.state.dialogSwipeState.on(function(e){i(a.get(n),-1*sq(e))})})])])}},sY=Z(function(n,e){return[{label:"the link group",items:[sK({fields:[sD("url","Type or paste URL"),sD("text","Link text"),sD("title","Link title"),sD("target","Link target"),{name:"link",spec:sS.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return Q.none()}})}],maxFieldIndex:3,getInitialValue:function(){return Q.some(sd(e).fold(function(){return{url:"",text:e.selection.getContent({format:"text"}),title:"",target:"",link:Q.none()}},function(n){return sa(n)}))},onExecute:function(t,r){sl(e,aB.getValue(t)),n.restoreToolbar(),e.focus()}})]}]}),sJ=Object.freeze({__proto__:null,events:rU([{key:ef(),value:rG({can:function(n,e){var t=e.event,r=t.originator,o=t.target;return!eA(r,n.element)||!!eA(r,o)||(console.warn(ef()+" did not get interpreted by the desired target. \nOriginator: "+oE(r)+"\nTarget: "+oE(o)+"\nCheck the "+ef()+" event handlers"),!1)}})}])}),sQ=function(n){var e=function(e){return"The component must be in a context to execute: "+e+(n?"\n"+oE(n().element)+" is not in context.":"")},t=function(n){return function(){throw Error(e(n))}},r=function(n){return function(){console.warn(e(n))}};return{debugInfo:P("fake"),triggerEvent:r("triggerEvent"),triggerFocus:r("triggerFocus"),triggerEscape:r("triggerEscape"),broadcast:r("broadcast"),broadcastOn:r("broadcastOn"),broadcastEvent:r("broadcastEvent"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:X}},sZ=sQ(),s0=function(n,e){var t=rd("component.behaviours",ri(nu(e,function(n){return rO(n.name(),[rb("config"),rT("state",on)])})),n.behaviours).fold(function(e){throw Error(rp(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},j);return{list:e,data:tb(t,function(n){return P(n.map(function(n){return{config:n.config,state:n.state.init(n.config)}}))})}},s1=function(n,e){var t={};return tv(n,function(n,r){tv(n,function(n,o){var i=tO(t,o).getOr([]);t[o]=i.concat([e(r,n)])})}),t},s2=function(n,e,t,r){var o=w({},e);nc(t,function(e){o[e.name()]=e.exhibit(n,r)});var i=s1(o,function(n,e){return{name:n,modification:e}}),u=function(n){return ns(n,function(n,e){return w(w({},e.modification),n)},{})};return r4({classes:ns(i.classes,function(n,e){return e.modification.concat(n)},[]),attributes:u(i.attributes),styles:u(i.styles)})},s9=function(n,e,t,r){try{var o=nS(t,function(t,o){var i=t[e],u=o[e],c=r.indexOf(i),a=r.indexOf(u);if(-1===c)throw Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===a)throw Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return c<a?-1:a<c?1:0});return tU.value(o)}catch(n){return tU.error([n])}},s3=function(n){return n.cHandler},s5=function(n,e){return{name:n,handler:e}},s4=function(n,e){var t={};return nc(n,function(n){t[n.name()]=n.handlers(e)}),t},s6=function(n){var e=A(n)?{can:q,abort:X,run:n}:n;return function(n,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,t].concat(r);e.abort.apply(void 0,i)?t.stop():e.can.apply(void 0,i)&&e.run.apply(void 0,i)}},s8=function(n,e,t){var r=e[t];return r?s9("Event: "+t,"name",n,r).map(function(n){var e;return e=nu(n,function(n){return n.handler}),{can:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return nl(e,function(e,t){return e&&t.can.apply(void 0,n)},!0)},abort:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return nl(e,function(e,t){return e||t.abort.apply(void 0,n)},!1)},run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];nc(e,function(e){e.run.apply(void 0,n)})}}}):tU.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(nu(n,function(n){return n.name}),null,2)])},s7="alloy.base.behaviour",ln=ri([tY("dom","dom",t1(),ri([rb("tag"),rT("styles",{}),rT("classes",[]),rT("attributes",{}),rS("value"),rS("innerHtml")])),rb("components"),rb("uid"),rT("events",{}),rT("apis",{}),tY("eventOrder","eventOrder",t5(P(((S={})[em()]=["disabling",s7,"toggling","typeaheadevents"],S[ef()]=[s7,"focusing","keying"],S[ev()]=[s7,"disabling","toggling","representing"],S[et()]=[s7,"representing","streaming","invalidating"],S[ey()]=[s7,"representing","item-events","tooltipping"],S[n4()]=["focusing",s7,"item-type-events"],S[n9()]=["focusing",s7,"item-type-events"],S[n7()]=["item-type-events","tooltipping"],S[ed()]=["receiving","reflecting","tooltipping"],S))),rc()),rS("domModification")]),le=function(n,e){nc(e,function(e){tH(n,e)})},lt=function(n,e){nc(e,function(e){tz(n,e)})},lr=function(n){var e=eR.fromTag(n.tag);return tD(e,n.attributes),le(e,n.classes),id(e,n.styles),n.innerHtml.each(function(n){return ok(e,n)}),e0(e,n.domChildren),n.value.each(function(n){sO(e,n)}),n.uid,c2(e,n.uid),e},lo=function(n){var e=tO(n,"behaviours").getOr({});return nh(tp(e),function(n){var t=e[n];return B(t)?[t.me]:[]})},li=function(n){var e=lo(n);return s0(n,e)},lu=function(n,e,t){var r=w(w({},n.dom),{uid:n.uid,domChildren:nu(n.components,function(n){return n.element})}),o=n.domModification.fold(function(){return r4({})},r4),i=e.length>0?s2(t,{"alloy.base.modification":o},e,r):o;return w(w({},r),{attributes:w(w({},r.attributes),i.attributes),styles:w(w({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},lc=function(n,e,t){var r,o={"alloy.base.behaviour":n.events};return(r=n.eventOrder,rB(tS(s1(w(w({},o),s4(e,t)),s5),function(n,e){return(1===n.length?tU.value(n[0].handler):s8(n,r,e)).map(function(t){var o=s6(t),i=n.length>1?nf(r[e],function(e){return ni(n,function(n){return n.name===e})}).join(" > "):n[0].name;return rI(e,{handler:o,purpose:i})})}),{})).getOrDie()},la=function(n){var e=function(){return s},t=oa(sZ),r=rm(rd("custom.definition",ln,n)),o=li(n),i=o.list,u=o.data,c=lr(lu(r,i,u)),a=lc(r,i,u),f=oa(r.components),s={uid:n.uid,getSystem:t.get,config:function(e){return(A(u[e.name()])?u[e.name()]:function(){throw Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return A(u[n.name()])},spec:n,readState:function(n){return u[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(n){t.set(n)},disconnect:function(){t.set(sQ(e))},element:c,syncComponents:function(){var n=nh(eX(c),function(n){return t.get().getByDom(n).fold(function(){return[]},nx)});f.set(n)},components:f.get,events:a};return s},lf=function(n){var e=j(n),t=e.events,r=O(e,["events"]),o=nu(tO(r,"components").getOr([]),ld),i=w(w({},r),{events:w(w({},sJ),t),components:o});return tU.value(la(i))},ls=function(n){return ll({element:eR.fromText(n)})},ll=function(n){var e=rg("external.component",ro([rb("element"),rS("uid")]),n),t=oa(sQ()),r=e.uid.getOrThunk(function(){return c3("external")});c2(e.element,r);var o={uid:r,getSystem:t.get,config:Q.none,hasConfigured:X,connect:function(n){t.set(n)},disconnect:function(){t.set(sQ(function(){return o}))},getApis:function(){return{}},element:e.element,spec:n,readState:P("No state"),syncComponents:N,components:P([]),events:{}};return cK(o)},ld=function(n){return tO(n,cq).getOrThunk(function(){return lf(tk(n,"uid")?n:w({uid:c3("")},n)).getOrDie()})},lm="alloy.item-hover",lg="alloy.item-focus",lp=function(n){(om(n.element).isNone()||iu.isFocused(n))&&(iu.isFocused(n)||iu.focus(n),ek(n,lm,{item:n}))},lh=function(n){ek(n,lg,{item:n})},lv=P(lm),lb=P(lg),ly=[rb("data"),rb("components"),rb("dom"),rT("hasSubmenu",!1),rS("toggling"),cu("itemBehaviours",[o5,iu,ci,aB]),rT("ignoreFocus",!1),rT("domModification",{}),oU("builder",function(n){return{dom:n.dom,domModification:w(w({},n.domModification),{attributes:w(w(w({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:cc(n.itemBehaviours,[n.toggling.fold(o5.revoke,function(n){return o5.config(w({aria:{mode:"checked"}},n))}),iu.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){lh(n)}}),ci.config({mode:"execution"}),aB.config({store:{mode:"memory",initialValue:n.data}}),sv("item-type-events",k(k([],it(),!0),[rX(n7(),lp),rX(eg(),iu.focus)],!1))]),components:n.components,eventOrder:n.eventOrder}}),rT("eventOrder",{})],lx=[rb("dom"),rb("components"),oU("builder",function(n){return{dom:n.dom,components:n.components,events:rU([rX(eg(),function(n,e){e.stop()})])}})],lS=P("item-widget"),lw=P([cI({name:"widget",overrides:function(n){return{behaviours:ot([aB.config({store:{mode:"manual",getValue:function(e){return n.data},setValue:N}})])}}})]),lO=rh("type",{widget:[rb("uid"),rb("data"),rb("components"),rb("dom"),rT("autofocus",!1),rT("ignoreFocus",!1),cu("widgetBehaviours",[aB,iu,ci]),rT("domModification",{}),cX(lw()),oU("builder",function(n){var e=cj(lS(),n,lw()),t=cL(lS(),n,e.internals()),r=function(e){return c$(e,n,"widget").map(function(n){return ci.focusIn(n),n})},o=function(e,t){return ut(t.event.target)||n.autofocus&&t.setSource(e.element),Q.none()};return{dom:n.dom,components:t,domModification:n.domModification,events:rU([r1(function(n,e){r(n).each(function(n){e.stop()})}),rX(n7(),lp),rX(eg(),function(e,t){n.autofocus?r(e):iu.focus(e)})]),behaviours:cc(n.widgetBehaviours,[aB.config({store:{mode:"memory",initialValue:n.data}}),iu.config({ignore:n.ignoreFocus,onFocus:function(n){lh(n)}}),ci.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:ou(),onLeft:o,onRight:o,onEscape:function(e,t){return iu.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element),Q.none()):(iu.focus(e),Q.some(!0))}})])}})],item:ly,separator:lx}),lk=P([cB({factory:{sketch:function(n){var e=rg("menu.spec item",lO,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,e){return tk(e,"uid")?e:w(w({},e),{uid:c3("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),lT=P([rb("value"),rb("items"),rb("dom"),rb("components"),rT("eventOrder",{}),cu("menuBehaviours",[i3,aB,sy,ci]),rE("movement",{mode:"menu",moveOnTab:!0},rh("mode",{grid:[oX(),oU("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[oU("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),rb("rowSelector")],menu:[rT("moveOnTab",!0),oU("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),ry("markers",oN()),rT("fakeFocus",!1),rT("focusManager",i4()),oj("onHighlight")]),lE=P("alloy.menu-focus"),lC=at({name:"Menu",configFields:lT(),partFields:lk(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:cc(n.menuBehaviours,[i3.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),aB.config({store:{mode:"memory",initialValue:n.value}}),sy.config({find:Q.some}),ci.config(n.movement.config(n,n.movement))]),events:rU([rX(lb(),function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each(function(t){i3.highlight(n,t),e.stop(),ek(n,lE(),{menu:n,item:t})})}),rX(lv(),function(n,e){var t=e.event.item;i3.highlight(n,t)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),lD=function(n,e){var t=e4(e),r=od(t).bind(function(n){var t=function(e){return eA(n,e)};return t(e)?Q.some(e):ik(e,t)}),o=n(e);return r.each(function(n){od(t).filter(function(e){return eA(e,n)}).fold(function(){of(n)},N)}),o},lM=function(n,e,t,r){var o=n.getSystem().build(r);tf(n,o,t)},l_=function(n,e,t,r){nm(lR(n),function(n){return eA(r.element,n.element)}).each(tl)},lR=function(n,e){return n.components()},lF=function(n,e,t,r,o){var i=lR(n);return Q.from(i[r]).map(function(i){return l_(n,e,t,i),o.each(function(t){lM(n,e,function(n,e){eZ(n,e,r)},t)}),i})},lI=oo({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,r){lM(n,e,eQ,r)},prepend:function(n,e,t,r){lM(n,e,eJ,r)},remove:l_,replaceAt:lF,replaceBy:function(n,e,t,r,o){return ng(lR(n),r).bind(function(r){return lF(n,e,t,r,o)})},set:function(n,e,t,r){lD(function(){var e=nu(r,n.getSystem().build);tc(n,e)},n.element)},contents:lR})}),lV=function(n,e,t,r){return tO(t,r).bind(function(r){return tO(n,r).bind(function(r){var o=lV(n,e,t,r);return Q.some([r].concat(o))})}).getOr([])},lB=function(n,e){var t={};tv(n,function(n,e){nc(n,function(n){t[n]=e})});var r=ty(e,function(n,e){return{k:n,v:e}}),o=tb(r,function(n,o){return[o].concat(lV(t,e,r,o))});return tb(t,function(n){return tO(o,n).getOr([n])})},lA=function(n){return"prepared"===n.type?Q.some(n.menu):Q.none()},lH=function(){var n=oa({}),e=oa({}),t=oa({}),r=us(),o=oa({}),i=function(n){return u(n).bind(lA)},u=function(n){return tO(e.get(),n)},c=function(e){return tO(n.get(),e)};return{setMenuBuilt:function(n,t){var r;e.set(w(w({},e.get()),((r={})[n]={type:"prepared",menu:t},r)))},setContents:function(i,u,c,a){r.set(i),n.set(c),e.set(u),o.set(a);var f=lB(a,c);t.set(f)},expand:function(e){return tO(n.get(),e).map(function(n){return[n].concat(tO(t.get(),e).getOr([]))})},refresh:function(n){return tO(t.get(),n)},collapse:function(n){return tO(t.get(),n).bind(function(n){return n.length>1?Q.some(n.slice(1)):Q.none()})},lookupMenu:u,lookupItem:c,otherMenus:function(n){return ny(tp(o.get()),n)},getPrimary:function(){return r.get().bind(i)},getMenus:function(){return e.get()},clear:function(){n.set({}),e.set({}),t.set({}),r.clear()},isClear:function(){return r.get().isNone()},getTriggeringPath:function(e,o){var u=nf(c(e).toArray(),function(n){return i(n).isSome()});return tO(t.get(),e).bind(function(e){var t=nb(u.concat(e));return rN(nh(t,function(e,u){var c;return(c=t.slice(0,u+1),i(e).bind(function(t){return tw(n.get(),function(n,t){return n===e}).bind(function(n){return o(n).map(function(n){return{triggeredMenu:t,triggeringItem:n,triggeringPath:c}})})})).fold(function(){return rA(r.get(),e)?[]:[Q.none()]},function(n){return[Q.some(n)]})}))})}}},lN=P("collapse-item"),lz=ae({name:"TieredMenu",configFields:[oG("onExecute"),oG("onEscape"),o$("onOpenMenu"),o$("onOpenSubmenu"),oj("onRepositionMenu"),oj("onCollapseMenu"),rT("highlightImmediately",!0),rx("data",[rb("primary"),rb("menus"),rb("expansions")]),rT("fakeFocus",!1),oj("onHighlight"),oj("onHover"),rx("markers",[rb("backgroundMenu")].concat(oA()).concat(oH())),rb("dom"),rT("navigateOnHover",!0),rT("stayInDom",!1),cu("tmenuBehaviours",[ci,i3,sy,lI]),rT("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(n,e){var t,r,o=us(),i=lH(),u=function(e){var t,r=(t=n.data.primary,tb(n.data.menus,function(r,o){var i=function(){return lC.sketch(w(w({},r),{value:o,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?i6():i4()}))};return o===t?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})),o=a();return i.setContents(n.data.primary,r,n.data.expansions,o),i.getPrimary()},c=function(n){return aB.getValue(n).value},a=function(e){return tb(n.data.menus,function(n,e){return nh(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})},f=function(n,e){i3.highlight(n,e),i3.getHighlighted(e).orThunk(function(){return i3.getFirst(e)}).each(function(e){eE(n,e.element,eg())})},s=function(n,e){return rH(nu(e,function(e){return n.lookupMenu(e).bind(function(n){return"prepared"===n.type?Q.some(n.menu):Q.none()})}))},l=function(e,t,r){nc(s(t,t.otherMenus(r)),function(t){lt(t.element,[n.markers.backgroundMenu]),n.stayInDom||lI.remove(e,t)})},d=function(e,t){tv(o.get().getOrThunk(function(){var t={};return nc(nf(iS(e.element,"."+n.markers.item),function(n){return"true"===tM(n,"aria-haspopup")}),function(n){e.getSystem().getByDom(n).each(function(n){t[c(n)]=n})}),o.set(t),t}),function(n,e){var r=no(t,e);tC(n.element,"aria-expanded",r)})},m=function(e,t,r){return Q.from(r[0]).bind(function(o){return t.lookupMenu(o).bind(function(o){if("notbuilt"===o.type)return Q.none();var i=o.menu;return nc(s(t,r.slice(1)),function(e){tH(e.element,n.markers.backgroundMenu)}),tn(i.element)||lI.append(e,cK(i)),lt(i.element,[n.markers.backgroundMenu]),f(e,i),l(e,t,r),Q.some(i)})})};(t=r||(r={}))[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent";var g=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return i.setMenuBuilt(e,r),r},p=function(e,t,o){if(void 0===o&&(o=r.HighlightSubmenu),t.hasConfigured(sj)&&sj.isDisabled(t))return Q.some(t);var u=c(t);return i.expand(u).bind(function(u){return d(e,u),Q.from(u[0]).bind(function(c){return i.lookupMenu(c).bind(function(a){var f=g(e,c,a);return(tn(f.element)||lI.append(e,cK(f)),n.onOpenSubmenu(e,t,f,nb(u)),o===r.HighlightSubmenu)?(i3.highlightFirst(f),m(e,i,u)):(i3.dehighlightAll(f),Q.some(t))})})})},h=function(e,t){var r=c(t);return i.collapse(r).bind(function(r){return d(e,r),m(e,i,r).map(function(r){return n.onCollapseMenu(e,t,r),r})})},v=function(n,e){var t=c(e);return i.refresh(t).bind(function(e){return d(n,e),m(n,i,e)})},b=function(e){return function(t,r){return iD(r.getSource(),"."+n.markers.item).bind(function(n){return t.getSystem().getByDom(n).toOptional().bind(function(n){return e(t,n).map(q)})})}},y=rU([rX(lE(),function(n,e){var t=e.event.item;i.lookupItem(c(t)).each(function(){var t=e.event.menu;i3.highlight(n,t);var r=c(e.event.item);i.refresh(r).each(function(e){return l(n,i,e)})})}),r1(function(e,t){var o=t.event.target;e.getSystem().getByDom(o).each(function(t){0===c(t).indexOf("collapse-item")&&h(e,t),p(e,t,r.HighlightSubmenu).fold(function(){n.onExecute(e,t)},N)})}),rQ(function(e,t){u(e).each(function(t){lI.append(e,cK(t)),n.onOpenMenu(e,t),n.highlightImmediately&&f(e,t)})})].concat(n.navigateOnHover?[rX(lv(),function(e,t){var o=t.event.item;v(e,o),p(e,o,r.HighlightParent),n.onHover(e,o)})]:[])),x=function(n){return i3.getHighlighted(n).bind(i3.getHighlighted)};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:cc(n.tmenuBehaviours,[ci.config({mode:"special",onRight:b(function(n,e){return ut(e.element)?Q.none():p(n,e,r.HighlightSubmenu)}),onLeft:b(function(n,e){return ut(e.element)?Q.none():h(n,e)}),onEscape:b(function(e,t){return h(e,t).orThunk(function(){return n.onEscape(e,t).map(function(){return e})})}),focusIn:function(n,e){i.getPrimary().each(function(e){eE(n,e.element,eg())})}}),i3.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),sy.config({find:function(n){return i3.getHighlighted(n)}}),lI.config({})]),eventOrder:n.eventOrder,apis:{collapseMenu:function(n){x(n).each(function(e){h(n,e)})},highlightPrimary:function(n){i.getPrimary().each(function(e){f(n,e)})},repositionMenus:function(e){i.getPrimary().bind(function(n){return x(e).bind(function(n){var e=c(n),t=rH(nu(tS(i.getMenus(),j),lA));return i.getTriggeringPath(e,function(n){return nw(t,function(e){return e.getSystem().isConnected()?nm(i3.getCandidates(e),function(e){return c(e)===n}):Q.none()})})}).map(function(e){return{primary:n,triggeringPath:e}})}).fold(function(){Q.from(e.components()[0]).filter(function(n){return"menu"===tM(n.element,"role")}).each(function(t){n.onRepositionMenu(e,t,[])})},function(t){var r=t.primary,o=t.triggeringPath;n.onRepositionMenu(e,r,o)})}},events:y}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:rI(n,e),expansions:{}}},collapseItem:function(n){return{value:cb(lN()),meta:{text:n}}}}}),lP=function(n,e,t,r){return tO(e.routes,r.start).bind(function(n){return tO(n,r.destination)})},lj=function(n,e,t,r){return lP(n,e,t,r).bind(function(n){return n.transition.map(function(e){return{transition:e,route:n}})})},lL=function(n,e,t){l$(n,e).bind(function(r){return lj(n,e,t,r)}).each(function(t){var r=t.transition;tz(n.element,r.transitionClass),tF(n.element,e.destinationAttr)})},l$=function(n,e,t){return t_(n.element,e.destinationAttr).map(function(t){return{start:tM(n.element,e.stateAttr),destination:t}})},lG=function(n,e,t,r){lL(n,e,t),tR(n.element,e.stateAttr)&&tM(n.element,e.stateAttr)!==r&&e.onFinish(n,r),tC(n.element,e.stateAttr,r)},lU=function(n,e,t,r){tR(n.element,e.destinationAttr)&&(t_(n.element,e.destinationAttr).each(function(t){tC(n.element,e.stateAttr,t)}),tF(n.element,e.destinationAttr))},lW=Object.freeze({__proto__:null,findRoute:lP,disableTransition:lL,getCurrentRoute:l$,jumpTo:lG,progressTo:function(n,e,t,r){lU(n,e);var o={start:tM(n.element,e.stateAttr),destination:r};lj(n,e,t,o).fold(function(){lG(n,e,t,r)},function(o){lL(n,e,t);var i=o.transition;tH(n.element,i.transitionClass),tC(n.element,e.destinationAttr,r)})},getState:function(n,e,t){return t_(n.element,e.stateAttr)}}),lX=Object.freeze({__proto__:null,events:function(n,e){return rU([rX(ei(),function(t,r){var o=r.event.raw;l$(t,n).each(function(r){lP(t,n,e,r).each(function(i){i.transition.each(function(i){o.propertyName===i.property&&(lG(t,n,e,r.destination),n.onTransition(t,r))})})})}),rQ(function(t,r){lG(t,n,e,n.initialState)})])}}),lq=oo({fields:[rT("destinationAttr","data-transitioning-destination"),rT("stateAttr","data-transitioning-state"),rb("initialState"),oj("onTransition"),oj("onFinish"),ry("routes",rs(tU.value,rs(tU.value,ro([rk("transition",[rb("property"),rb("transitionClass")])]))))],name:"transitioning",active:lX,apis:lW,extra:{createRoutes:function(n){var e={};return tv(n,function(n,t){var r=t.split("<->");e[r[0]]=rI(r[1],n),e[r[1]]=rI(r[0],n)}),e},createBistate:function(n,e,t){return rV([{key:n,value:rI(e,t)},{key:e,value:rI(n,t)}])},createTristate:function(n,e,t,r){return rV([{key:n,value:rV([{key:e,value:r},{key:t,value:r}])},{key:e,value:rV([{key:n,value:r},{key:t,value:r}])},{key:t,value:rV([{key:n,value:r},{key:e,value:r}])}])}}}),lK=ie("scrollable"),lY=function(n){tH(n,lK)},lJ=function(n){tz(n,lK)},lQ=function(n){return tO(n,"format").getOr(n.title)},lZ=function(n,e){var t=l1("Styles",[].concat(nu(n.items,function(e){return l0(lQ(e),e.title,e.isSelected(),e.getPreview(),tT(n.expansions,lQ(e)))})),e,!1),r=tZ(tb(n.menus,function(t,r){return l1(r,nu(t,function(e){return l0(lQ(e),e.title,void 0!==e.isSelected&&e.isSelected(),void 0!==e.getPreview?e.getPreview():"",tT(n.expansions,lQ(e)))}),e,!0)}),rI("styles",t));return{tmenu:lz.tieredData("styles",r,n.expansions)}},l0=function(n,e,t,r,o){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:o?[ie("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:ie("format-matches"),selected:t},itemBehaviours:ot(o?[]:[o4(n,function(n,e){(e?o5.on:o5.off)(n)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:e}}]}},l1=function(n,e,t,r){return{value:n,dom:{tag:"div"},components:[ar.sketch({dom:{tag:"div",classes:[ie("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[ie("styles-collapse-icon")]}},ls(n)]:[ls(n)],action:function(n){if(r){var e=t().get(n);lz.collapseMenu(e)}}}),{dom:{tag:"div",classes:[ie("styles-menu-items-container")]},components:[lC.parts.items({})],behaviours:ot([sv("adhoc-scrollable-menu",[rQ(function(n,e){il(n.element,"overflow-y","auto"),il(n.element,"-webkit-overflow-scrolling","touch"),lY(n.element)}),rZ(function(n){ih(n.element,"overflow-y"),ih(n.element,"-webkit-overflow-scrolling"),lJ(n.element)})])])}],items:e,menuBehaviours:ot([lq.config({initialState:"after",routes:lq.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},l2=function(n){var e=lZ(n.formats,function(){return t}),t=f6(lz.sketch({dom:{tag:"div",classes:[ie("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(e,t){var r=aB.getValue(t);return n.handle(t,r.value),Q.none()},onEscape:function(){return Q.none()},onOpenMenu:function(n,e){var t=aN(n.element);aH(e.element,t),lq.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var r=aN(n.element),o=iE(e.element,'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();aH(t.element,r),lq.progressTo(i,"before"),lq.jumpTo(t,"after"),lq.progressTo(t,"current")},onCollapseMenu:function(n,e,t){var r=iE(e.element,'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();lq.progressTo(o,"after"),lq.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:e.tmenu,markers:{backgroundMenu:ie("styles-background-menu"),menu:ie("styles-menu"),selectedMenu:ie("styles-selected-menu"),item:ie("styles-item"),selectedItem:ie("styles-selected-item")}}));return t.asSpec()},l9=function(n){var e=tZ(r_(n,["items"]),{menu:!0}),t=l3(n.items);return{item:e,menus:tZ(t.menus,rI(n.title,t.items)),expansions:tZ(t.expansions,rI(n.title,n.title))}},l3=function(n){return ns(n,function(n,e){var t=tT(e,"items")?l9(e):{item:e,menus:{},expansions:{}};return{menus:tZ(n.menus,t.menus),items:[t.item].concat(n.items),expansions:tZ(n.expansions,t.expansions)}},{menus:{},expansions:{},items:[]})},l5=function(n){var e=function(e){return function(){return n.formatter.match(e)}},t=function(e){return function(){return n.formatter.getCssText(e)}},r=function(r){var o=cb(r.title),i=tZ(r,{format:o,isSelected:e(o),getPreview:t(o)});return n.formatter.register(o,i),i},o=function(n){return nu(n,function(n){if(tT(n,"items")){var i=o(n.items);return tZ(tZ(n,{isSelected:X,getPreview:P("")}),{items:i})}return tT(n,"format")?tZ(n,{isSelected:e(n.format),getPreview:t(n.format)}):r(n)})};return o(n.getParam("style_formats",ov,"array"))},l4=function(n,e){var t=function(e){return nh(e,function(e){return void 0!==e.items?t(e.items).length>0?[e]:[]:!tT(e,"format")||n.formatter.canApply(e.format)?[e]:[]})};return l3(t(e))},l6=function(n){var e=n.replace(/\|/g," ").trim();return e.length>0?e.split(/\s+/):[]},l8=function(n){return nh(n,function(n){return R(n)?l8(n):l6(n)})},l7=function(n){var e=n.getParam("toolbar",ob,"array");return R(e)?l8(e):l6(e)},dn=function(n,e){var t=function(n){return function(){return ad(n,function(){e.execCommand(n)},{},e)}},r=function(n){return function(){return af(e,n)}},o=function(n,t,r){return function(){return as(e,n,t,r)}},i=t("undo"),u=t("redo"),c=r("bold"),a=r("italic"),f=r("underline"),s=t("removeformat"),l=o("unlink","link",function(){e.execCommand("unlink",null,!1)}),d=o("unordered-list","ul",function(){e.execCommand("InsertUnorderedList",null,!1)}),m=o("ordered-list","ol",function(){e.execCommand("InsertOrderedList",null,!1)}),g=l5(e),p=function(){var n;return n=function(){e.fire("scrollIntoView")},l2({formats:l4(e,g),handle:function(t,r){e.undoManager.transact(function(){o5.isOn(t)?e.formatter.remove(r):e.formatter.apply(r)}),n()}})},h=function(n,t){return{isSupported:function(){var t=e.ui.registry.getAll().buttons;return n.forall(function(n){return tT(t,n)})},sketch:t}};return{undo:h(Q.none(),i),redo:h(Q.none(),u),bold:h(Q.none(),c),italic:h(Q.none(),a),underline:h(Q.none(),f),removeformat:h(Q.none(),s),link:h(Q.none(),function(){return as(e,"link","link",function(){var t=sY(n,e);n.setContextToolbar(t),sp(e,function(){n.focusToolbar()}),sd(e).each(function(n){e.selection.select(n.dom)})})}),unlink:h(Q.none(),l),image:h(Q.none(),function(){return sr(e)}),bullist:h(Q.some("bullist"),d),numlist:h(Q.some("numlist"),m),fontsizeselect:h(Q.none(),function(){return f4(n,e)}),forecolor:h(Q.none(),function(){return fY(n,e)}),styleselect:h(Q.none(),function(){return ad("style-formats",function(t){e.fire("toReading"),n.dropup.appear(p,o5.on,t)},ot([o5.config({toggleClass:ie("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),oq.config({channels:rV([o8(ox,o5.off),o8(oS,o5.off)])})]),e)})}},de=function(n,e){var t=l7(n),r={};return nh(t,function(n){var t=!tT(r,n)&&tT(e,n)&&e[n].isSupported()?[e[n].sketch()]:[];return r[n]=!0,t})},dt=function(n){var e=eR.fromDom(e8(n).getOr(n.target)),t=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},o=z(r,t);return{target:e,x:n.clientX,y:n.clientY,stop:t,prevent:r,kill:o,raw:n}},dr=function(n,e,t,r,o){var i=function(n){t(n)&&r(dt(n))};return n.dom.addEventListener(e,i,o),{unbind:$(di,n,e,i,o)}},di=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},du=function(n,e,t){return dr(n,e,q,t,!1)},dc=function(n,e,t){return dr(n,e,q,t,!0)},da=tinymce.util.Tools.resolve("tinymce.util.Delay"),df=function(n){return{isPortrait:P(n.matchMedia("(orientation: portrait)").matches)}},ds=function(n){var e=n2().os.isiOS(),t=df(n).isPortrait();return e&&!t?n.screen.height:n.screen.width},dl=function(n,e){var t=eR.fromDom(n),r=null,o=du(t,"orientationchange",function(){da.clearInterval(r);var t=df(n);e.onChange(t),i(function(){e.onReady(t)})}),i=function(e){da.clearInterval(r);var t=n.innerHeight,o=0;r=da.setInterval(function(){t!==n.innerHeight?(da.clearInterval(r),e(Q.some(n.innerHeight))):o>20&&(da.clearInterval(r),e(Q.none())),o++},50)};return{onAdjustment:i,destroy:function(){o.unbind()}}},dd=function(n,e){e.fold(function(e){n.setStartBefore(e.dom)},function(e,t){n.setStart(e.dom,t)},function(e){n.setStartAfter(e.dom)})},dm=function(n,e){e.fold(function(e){n.setEndBefore(e.dom)},function(e,t){n.setEnd(e.dom,t)},function(e){n.setEndAfter(e.dom)})},dg=function(n,e,t){var r=n.document.createRange();return dd(r,e),dm(r,t),r},dp=function(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom,t),i.setEnd(r.dom,o),i},dh=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},dv=function(n){var e=n.getClientRects(),t=e.length>0?e[0]:n.getBoundingClientRect();return t.width>0||t.height>0?Q.some(t).map(dh):Q.none()},db=rD([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),dy=function(n,e,t){return e(eR.fromDom(t.startContainer),t.startOffset,eR.fromDom(t.endContainer),t.endOffset)},dx=function(n,e){var t=e.ltr();return t.collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return db.rtl(eR.fromDom(n.endContainer),n.endOffset,eR.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return dy(n,db.ltr,t)}):dy(n,db.ltr,t)},dS=function(n,e){var t=e.match({domRange:function(n){return{ltr:P(n),rtl:Q.none}},relative:function(e,t){return{ltr:Z(function(){return dg(n,e,t)}),rtl:Z(function(){return Q.some(dg(n,t,e))})}},exact:function(e,t,r,o){return{ltr:Z(function(){return dp(n,e,t,r,o)}),rtl:Z(function(){return Q.some(dp(n,r,o,e,t))})}}});return dx(n,t)};db.ltr,db.rtl;var dw={create:function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}}},dO=(p="text",{get:function(n){if(!eP(n))throw Error("Can only get "+p+" value of a "+p+" node");return h(n).getOr("")},getOption:h=function(n){return eP(n)?Q.from(n.dom.nodeValue):Q.none()},set:function(n,e){if(!eP(n))throw Error("Can only set raw "+p+" value of a "+p+" node");n.dom.nodeValue=e}}),dk=rD([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),dT={before:dk.before,on:dk.on,after:dk.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(j,j,j)}},dE=rD([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),dC={domRange:dE.domRange,relative:dE.relative,exact:dE.exact,exactFromRange:function(n){return dE.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e;return e=n.match({domRange:function(n){return eR.fromDom(n.startContainer)},relative:function(n,e){return dT.getStart(n)},exact:function(n,e,t,r){return n}}),eR.fromDom(eG(e).dom.defaultView)},range:dw.create},dD=function(n,e){var t=eH(n);return"input"===t?dT.after(n):no(["br","img"],t)?0===e?dT.before(n):dT.after(n):dT.on(n,e)},dM=function(n,e,t,r){var o=dD(n,e),i=dD(t,r);return dC.relative(o,i)},d_=function(n,e,t,r){var o=e$(n).dom.createRange();return o.setStart(n.dom,e),o.setEnd(t.dom,r),o},dR=function(n,e,t,r){var o=d_(n,e,t,r),i=eA(n,t)&&e===r;return o.collapsed&&!i},dF=function(n){return Q.from(n.getSelection())},dI=function(n,e){dF(n).each(function(n){n.removeAllRanges(),n.addRange(e)})},dV=function(n,e,t,r,o){var i=dp(n,e,t,r,o);dI(n,i)},dB=function(n,e,t,r,o,i){e.collapse(t.dom,r),e.extend(o.dom,i)},dA=function(n,e,t,r,o){dS(n,dM(e,t,r,o)).match({ltr:function(e,t,r,o){dV(n,e,t,r,o)},rtl:function(e,t,r,o){dF(n).each(function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom,t,r.dom,o);else if(i.extend)try{dB(n,i,e,t,r,o)}catch(i){dV(n,r,o,e,t)}else dV(n,r,o,e,t)})}})},dH=function(n){if(!(n.rangeCount>0))return Q.none();var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return Q.some(dw.create(eR.fromDom(e.startContainer),e.startOffset,eR.fromDom(t.endContainer),t.endOffset))},dN=function(n){if(null===n.anchorNode||null===n.focusNode)return dH(n);var e=eR.fromDom(n.anchorNode),t=eR.fromDom(n.focusNode);return dR(e,n.anchorOffset,t,n.focusOffset)?Q.some(dw.create(e,n.anchorOffset,t,n.focusOffset)):dH(n)},dz=function(n){return dF(n).filter(function(n){return n.rangeCount>0}).bind(dN)},dP=function(n,e){return dv(dS(n,e).match({ltr:function(e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom,t),i.setEnd(r.dom,o),i},rtl:function(e,t,r,o){var i=n.document.createRange();return i.setStart(r.dom,o),i.setEnd(e.dom,t),i}}))},dj=function(n){dF(n).each(function(n){return n.removeAllRanges()})},dL=function(n){return Q.from(n.dom.contentWindow)},d$=function(n){return dL(n).bind(dz)},dG=function(n){return n.getFrame()},dU=function(n,e,t,r){return n[t].getOrThunk(function(){return function(n){return du(e,r,n)}})},dW=function(n){var e=dG(n);return Q.some(eR.fromDom(e.dom.contentWindow.document.body)).bind(function(t){return Q.some(eR.fromDom(e.dom.contentWindow.document)).bind(function(r){return dL(e).map(function(o){var i=eR.fromDom(r.dom.documentElement),u=n.getCursorBox.getOrThunk(function(){return function(){return dz(o).map(function(n){return dC.exact(n.start,n.soffset,n.finish,n.foffset)}).bind(function(n){return dP(o,n).orThunk(function(){return dz(o).filter(function(n){return eA(n.start,n.finish)&&n.soffset===n.foffset}).bind(function(n){var e=n.start.dom.getBoundingClientRect();return e.width>0||e.height>0?Q.some(e):Q.none()})})})}}),c=n.setSelection.getOrThunk(function(){return function(n,e,t,r){dA(o,n,e,t,r)}}),a=n.clearSelection.getOrThunk(function(){return function(){dj(o)}});return{body:t,doc:r,win:o,html:i,getSelection:$(d$,e),setSelection:c,clearSelection:a,frame:e,onKeyup:dU(n,r,"onKeyup","keyup"),onNodeChanged:dU(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:u}})})})},dX=function(){var n=iT("head").getOrDie(),e=iT('meta[name="viewport"]').getOrThunk(function(){var e=eR.fromTag("meta");return tC(e,"name","viewport"),eQ(n,e),e}),t=tM(e,"content");return{maximize:function(){tC(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=t&&t.length>0?tC(e,"content",t):tC(e,"content","user-scalable=yes")}}},dq="data-ephox-mobile-fullscreen-style",dK="position:absolute!important;",dY="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",dJ=n2().os.isAndroid(),dQ=function(n){var e=im(n,"background-color");return void 0!==e&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;"},dZ=function(n,e){var t=function(n){return function(e){var t=tM(e,"style"),r=void 0===t?"no-styles":t.trim();r!==n&&(tC(e,dq,r),tC(e,"style",n))}},r=nf(eW(n,void 0),function(n){return eF(n,"*")}),o=nh(r,function(n){var e;return e=function(n){return eF(n,"*")},nf(eU(n).map(eX).map(function(e){return nf(e,function(e){return!eA(n,e)})}).getOr([]),e)}),i=dQ(e);nc(o,t("display:none!important;")),nc(r,t(dK+dY+i)),t((!0===dJ?"":dK)+dY+i)(n)},d0=function(){nc(eV("["+dq+"]"),function(n){var e=tM(n,dq);"no-styles"!==e?tC(n,"style",e):tF(n,"style"),tF(n,dq)})},d1=function(n,e){var t=null;return{cancel:function(){null!==t&&(clearTimeout(t),t=null)},schedule:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];t=setTimeout(function(){n.apply(null,r),t=null},e)}}},d2=function(n){var e=n.raw;return void 0===e.touches||1!==e.touches.length?Q.none():Q.some(e.touches[0])},d9=function(n,e){var t=Math.abs(n.clientX-e.x),r=Math.abs(n.clientY-e.y);return t>5||r>5},d3=function(n){var e=us(),t=oa(!1),r=d1(function(e){n.triggerEvent(eh(),e),t.set(!0)},400),o=rV([{key:n9(),value:function(n){return d2(n).each(function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:n.target};r.schedule(n),t.set(!1),e.set(i)}),Q.none()}},{key:n3(),value:function(n){return r.cancel(),d2(n).each(function(n){e.on(function(t){d9(n,t)&&e.clear()})}),Q.none()}},{key:n5(),value:function(o){return r.cancel(),e.get().filter(function(n){return eA(n.target,o.target)}).map(function(e){return t.get()?(o.prevent(),!1):n.triggerEvent(ep(),o)})}}]);return{fireIfReady:function(n,e){return tO(o,e).bind(function(e){return e(n)})}}},d5=function(n){var e=d3({triggerEvent:function(e,t){n.onTapContent(t)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return du(n.body,"touchend",function(n){e.fireIfReady(n,"touchend")})},onTouchmove:function(){return du(n.body,"touchmove",function(n){e.fireIfReady(n,"touchmove")})}}},d4=n2().os.version.major>=6,d6=function(n,e,t){var r=d5(n),o=e$(e),i=function(n){return!eA(n.start,n.finish)||n.soffset!==n.foffset},u=function(){var r=n.doc.dom.hasFocus()&&n.getSelection().exists(i);t.getByDom(e).each((r||od(o).filter(function(n){return"input"===eH(n)}).exists(function(n){return n.dom.selectionStart!==n.dom.selectionEnd}))===!0?o5.on:o5.off)},c=[du(n.body,"touchstart",function(e){n.onTouchContent(),r.fireTouchstart(e)}),r.onTouchmove(),r.onTouchend(),du(e,"touchstart",function(e){n.onTouchToolstrip()}),n.onToReading(function(){os(n.body)}),n.onToEditing(N),n.onScrollToCursor(function(e){e.preventDefault(),n.getCursorBox().each(function(e){var t=n.win,r=e.top>t.innerHeight||e.bottom>t.innerHeight?e.bottom-t.innerHeight+50:0;0!==r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)})})].concat(!0===d4?[]:[du(eR.fromDom(n.win),"blur",function(){t.getByDom(e).each(o5.off)}),du(o,"select",u),du(n.doc,"selectionchange",u)]);return{destroy:function(){nc(c,function(n){n.unbind()})}}},d8=function(n,e){var t=parseInt(tM(n,e),10);return isNaN(t)?0:t},d7=function(n){return w(w({},n),{width:2})},mn=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},me=function(n){if(!n.collapsed)return nu(n.getClientRects(),mn);var e=eR.fromDom(n.startContainer);return eU(e).bind(function(t){var r=dC.exact(e,n.startOffset,t,"img"===eH(t)?1:dO.getOption(t).fold(function(){return eX(t).length},function(n){return n.length}));return dP(n.startContainer.ownerDocument.defaultView,r).map(d7).map(nx)}).getOr([])},mt=function(n){var e=n.getSelection();return void 0!==e&&e.rangeCount>0?me(e.getRangeAt(0)):[]},mr=function(n){n.focus();var e=eR.fromDom(n.document.body);(od().exists(function(n){return no(["input","textarea"],eH(n))})?function(n){da.setTimeout(function(){n()},0)}:W)(function(){od().each(os),of(e)})},mo="data-"+ie("last-outer-height"),mi=function(n,e){tC(n,mo,e)},mu=function(n){return{top:n.top,bottom:n.top+n.height}},mc=function(n){var e=mt(n);return e.length>0?Q.some(e[0]).map(mu):Q.none()},ma=function(n,e){var t=d8(e,mo),r=n.innerHeight;return t>r?Q.some(t-r):Q.none()},mf=function(n,e){var t=eR.fromDom(e.document.body),r=du(eR.fromDom(n),"resize",function(){ma(n,t).each(function(n){mc(e).each(function(t){var r=t.top>e.innerHeight||t.bottom>e.innerHeight?Math.min(n,t.bottom-e.innerHeight+50):0;0!==r&&e.scrollTo(e.pageXOffset,e.pageYOffset+r)})}),mi(t,n.innerHeight)});return mi(t,n.innerHeight),{toEditing:function(){mr(e)},destroy:function(){r.unbind()}}},ms=function(n,e){var t=dX(),r=uf(),o=uf();return{enter:function(){var i;e.hide(),tH(n.container,ie("fullscreen-maximized")),tH(n.container,ie("android-maximized")),t.maximize(),tH(n.body,ie("android-scroll-reload")),r.set(mf(n.win,(i=n.editor).getWin.getOrThunk(function(){var n=dG(i);return function(){return dL(n)}})().getOrDie("no"))),dW(n.editor).each(function(e){dZ(n.container,e.body),o.set(d6(e,n.toolstrip,n.alloy))})},exit:function(){t.restore(),e.show(),tz(n.container,ie("fullscreen-maximized")),tz(n.container,ie("android-maximized")),d0(),tz(n.body,ie("android-scroll-reload")),o.clear(),r.clear()}}},ml=function(n,e){var t=null;return{cancel:function(){F(t)||(clearTimeout(t),t=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];F(t)&&(t=setTimeout(function(){t=null,n.apply(null,r)},e))}}},md=function(n,e){var t=null,r=function(){F(t)||(clearTimeout(t),t=null)};return{cancel:r,throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r(),t=setTimeout(function(){t=null,n.apply(null,o)},e)}}},mm=function(n,e){var t=f6(sx.sketch({dom:au('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:ot([o5.config({toggleClass:ie("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=ml(n,200);return sx.sketch({dom:au('<div class="${prefix}-disabled-mask"></div>'),components:[sx.sketch({dom:au('<div class="${prefix}-content-container"></div>'),components:[ar.sketch({dom:au('<div class="${prefix}-content-tap-section"></div>'),components:[t.asSpec()],action:function(n){r.throttle()},buttonBehaviours:ot([o5.config({toggleClass:ie("mask-tap-icon-selected")})])})]})]})},mg=P({unbind:N}),mp=ri([rx("editor",[rb("getFrame"),rS("getBody"),rS("getDoc"),rS("getWin"),rS("getSelection"),rS("setSelection"),rS("clearSelection"),rS("cursorSaver"),rS("onKeyup"),rS("onNodeChanged"),rS("getCursorBox"),rb("onDomChanged"),rT("onTouchContent",N),rT("onTapContent",N),rT("onTouchToolstrip",N),rT("onScrollToCursor",mg),rT("onScrollToElement",mg),rT("onToEditing",mg),rT("onToReading",mg),rT("onToolbarScrollStart",j)]),rb("socket"),rb("toolstrip"),rb("dropup"),rb("toolbar"),rb("container"),rb("alloy"),rv("win",function(n){return e$(n.socket).dom.defaultView}),rv("body",function(n){return eR.fromDom(n.socket.dom.ownerDocument.body)}),rT("translate",j),rT("setReadOnly",N),rT("readOnlyOnInit",q)]),mh=function(n){var e=rg("Getting AndroidWebapp schema",mp,n);il(e.toolstrip,"width","100%");var t=ld(mm(function(){e.setReadOnly(e.readOnlyOnInit()),r.enter()},e.translate));e.alloy.add(t),eQ(e.container,t.element);var r=ms(e,{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}});return{setReadOnly:e.setReadOnly,refreshStructure:N,enter:r.enter,exit:r.exit,destroy:N}},mv=P([rb("dom"),rT("shell",!0),cu("toolbarBehaviours",[lI])]),mb=P([cV({name:"groups",overrides:function(){return{behaviours:ot([lI.config({})])}}})]),my=at({name:"Toolbar",configFields:mv(),partFields:mb(),factory:function(n,e,t,r){var o=n.shell?{behaviours:[lI.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:o.components,behaviours:cc(n.toolbarBehaviours,o.behaviours),apis:{setGroups:function(e,t){(n.shell?Q.some(e):c$(e,n,"groups")).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){lI.set(n,t)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),mx=P([rb("items"),rx("markers",nu(["itemSelector"],rb)),cu("tgroupBehaviours",[ci])]),mS=P([cB({name:"items",unit:"item"})]),mw=at({name:"ToolbarGroup",configFields:mx(),partFields:mS(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,components:e,behaviours:cc(n.tgroupBehaviours,[ci.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),mO="data-"+ie("horizontal-scroll"),mk=function(n){n.dom.scrollTop=1;var e=0!==n.dom.scrollTop;return n.dom.scrollTop=0,e},mT=function(n){n.dom.scrollLeft=1;var e=0!==n.dom.scrollLeft;return n.dom.scrollLeft=0,e},mE=function(n){tC(n,mO,"true")},mC=function(n){return"true"===tM(n,mO)?n.dom.scrollLeft>0||mT(n):n.dom.scrollTop>0||mk(n)},mD=function(){var n=function(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:au('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:ot([sv("adhoc-scrollable-toolbar",!0===n.scrollable?[r0(function(n,e){il(n.element,"overflow-x","auto"),mE(n.element),lY(n.element)})]:[])]),components:[sx.sketch({components:[mw.parts.items({})]})],markers:{itemSelector:"."+ie("toolbar-group-item")},items:n.items}},e=ld(my.sketch({dom:au('<div class="${prefix}-toolbar"></div>'),components:[my.parts.groups({})],toolbarBehaviours:ot([o5.config({toggleClass:ie("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),ci.config({mode:"cyclic"})]),shell:!0})),t=ld(sx.sketch({dom:{classes:[ie("toolstrip")]},components:[cK(e)],containerBehaviours:ot([o5.config({toggleClass:ie("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){my.setGroups(e,o.get()),o5.off(e)},o=oa([]);return{wrapper:t,toolbar:e,createGroups:function(e){return nu(e,z(mw.sketch,n))},setGroups:function(n){o.set(n),r()},setContextToolbar:function(n){o5.on(e),my.setGroups(e,n)},restoreToolbar:function(){o5.isOn(e)&&r()},refresh:function(){},focus:function(){ci.focusIn(e)}}},mM=function(n){return ld(ar.sketch({dom:au('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))},m_=function(){return ld(sx.sketch({dom:au('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:ot([lI.config({})])}))},mR=function(n,e){lI.append(n,cK(e))},mF=function(n,e){lI.remove(n,e)},mI=function(n,e,t,r){(!0===t?oc.toAlpha:oc.toOmega)(r),(t?mR:mF)(n,e)},mV=function(n,e){return e.getAnimationRoot.fold(function(){return n.element},function(e){return e(n)})},mB=function(n){return n.dimension.property},mA=function(n,e){return n.dimension.getDimension(e)},mH=function(n,e){lt(mV(n,e),[e.shrinkingClass,e.growingClass])},mN=function(n,e){tz(n.element,e.openClass),tH(n.element,e.closedClass),il(n.element,mB(e),"0px"),iv(n.element)},mz=function(n,e){tz(n.element,e.closedClass),tH(n.element,e.openClass),ih(n.element,mB(e))},mP=function(n,e,t,r){t.setCollapsed(),il(n.element,mB(e),mA(e,n.element)),iv(n.element),mH(n,e),mN(n,e),e.onStartShrink(n),e.onShrunk(n)},mj=function(n,e,t,r){var o=r.getOrThunk(function(){return mA(e,n.element)});t.setCollapsed(),il(n.element,mB(e),o),iv(n.element);var i=mV(n,e);tz(i,e.growingClass),tH(i,e.shrinkingClass),mN(n,e),e.onStartShrink(n)},mL=function(n,e,t){var r=mA(e,n.element);("0px"===r?mP:mj)(n,e,t,Q.some(r))},m$=function(n,e,t){var r=mV(n,e),o=tP(r,e.shrinkingClass),i=mA(e,n.element);mz(n,e);var u=mA(e,n.element);(o?function(){il(n.element,mB(e),i),iv(n.element)}:function(){mN(n,e)})(),tz(r,e.shrinkingClass),tH(r,e.growingClass),mz(n,e),il(n.element,mB(e),u),t.setExpanded(),e.onStartGrow(n)},mG=function(n,e,t){return!0===tP(mV(n,e),e.growingClass)},mU=function(n,e,t){return!0===tP(mV(n,e),e.shrinkingClass)},mW=Object.freeze({__proto__:null,refresh:function(n,e,t){if(t.isExpanded()){ih(n.element,mB(e));var r=mA(e,n.element);il(n.element,mB(e),r)}},grow:function(n,e,t){t.isExpanded()||m$(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&mL(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&mP(n,e,t)},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:mG,isShrinking:mU,isTransitioning:function(n,e,t){return mG(n,e)||mU(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?mL:m$)(n,e,t)},disableTransitions:mH}),mX=Object.freeze({__proto__:null,exhibit:function(n,e,t){return e.expanded?r4({classes:[e.openClass],styles:{}}):r4({classes:[e.closedClass],styles:rI(e.dimension.property,"0px")})},events:function(n,e){return rU([rK(ei())(function(t,r){r.event.raw.propertyName===n.dimension.property&&(mH(t,n),e.isExpanded()&&ih(t.element,n.dimension.property),(e.isExpanded()?n.onGrown:n.onShrunk)(t))})])}}),mq=oo({fields:[rb("closedClass"),rb("openClass"),rb("shrinkingClass"),rb("growingClass"),rS("getAnimationRoot"),oj("onShrunk"),oj("onStartShrink"),oj("onGrown"),oj("onStartGrow"),rT("expanded",!1),ry("dimension",rh("property",{width:[oU("property","width"),oU("getDimension",function(n){return aN(n)+"px"})],height:[oU("property","height"),oU("getDimension",function(n){return ix(n)+"px"})]}))],name:"sliding",active:mX,apis:mW,state:Object.freeze({__proto__:null,init:function(n){var e=oa(n.expanded);return oe({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:$(e.set,!1),setExpanded:$(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),mK=function(n,e){var t=ld(sx.sketch({dom:{tag:"div",classes:[ie("dropup")]},components:[],containerBehaviours:ot([lI.config({}),mq.config({closedClass:ie("dropup-closed"),openClass:ie("dropup-open"),shrinkingClass:ie("dropup-shrinking"),growingClass:ie("dropup-growing"),dimension:{property:"height"},onShrunk:function(t){n(),e(),lI.set(t,[])},onGrown:function(t){n(),e()}}),o6(function(n,e){r(N)})])})),r=function(n){window.requestAnimationFrame(function(){n(),mq.shrink(t)})};return{appear:function(n,e,r){!0===mq.hasShrunk(t)&&!1===mq.isTransitioning(t)&&window.requestAnimationFrame(function(){e(r),lI.set(t,[n()]),mq.grow(t)})},disappear:r,component:t,element:t.element}},mY=function(){return n2().browser.isFirefox()},mJ=function(n,e){var t,r,o=w({stopBackspace:!0},e),i=d3(o),u=nu(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(e){return du(n,e,function(n){i.fireIfReady(n,e).each(function(e){e&&n.kill()}),o.triggerEvent(e,n)&&n.kill()})}),c=us(),a=du(n,"paste",function(n){i.fireIfReady(n,"paste").each(function(e){e&&n.kill()}),o.triggerEvent("paste",n)&&n.kill(),c.set(setTimeout(function(){o.triggerEvent(el(),n)},0))}),f=du(n,"keydown",function(n){var e;o.triggerEvent("keydown",n)?n.kill():!o.stopBackspace||8!==(e=n).raw.which||no(["input","textarea"],eH(e.target))||iD(e.target,'[contenteditable="true"]',void 0).isSome()||n.prevent()}),s=(t=function(n){o.triggerEvent("focusin",n)&&n.kill()},mY()?dc(n,"focus",t):du(n,"focusin",t)),l=us(),d=(r=function(n){o.triggerEvent("focusout",n)&&n.kill(),l.set(setTimeout(function(){o.triggerEvent(es(),n)},0))},mY()?dc(n,"blur",r):du(n,"focusout",r));return{unbind:function(){nc(u,function(n){n.unbind()}),f.unbind(),s.unbind(),d.unbind(),a.unbind(),c.on(clearTimeout),l.on(clearTimeout)}}},mQ=function(n,e){return oa(tO(n,"target").getOr(e))},mZ=function(n,e){var t=oa(!1),r=oa(!1);return{stop:function(){t.set(!0)},cut:function(){r.set(!0)},isStopped:t.get,isCut:r.get,event:n,setSource:e.set,getSource:e.get}},m0=function(n){var e=oa(!1);return{stop:function(){e.set(!0)},cut:N,isStopped:e.get,isCut:X,event:n,setSource:U("Cannot set source of a broadcasted event"),getSource:U("Cannot get source of a broadcasted event")}},m1=rD([{stopped:[]},{resume:["element"]},{complete:[]}]),m2=function(n,e,t,r,o,i){var u=n(e,r),c=mZ(t,o);return u.fold(function(){return i.logEventNoHandlers(e,r),m1.complete()},function(n){var t=n.descHandler;return(s3(t)(c),c.isStopped())?(i.logEventStopped(e,n.element,t.purpose),m1.stopped()):c.isCut()?(i.logEventCut(e,n.element,t.purpose),m1.complete()):eU(n.element).fold(function(){return i.logNoParent(e,n.element,t.purpose),m1.complete()},function(r){return i.logEventResponse(e,n.element,t.purpose),m1.resume(r)})})},m9=function(n,e,t,r,o,i){return m2(n,e,t,r,o,i).fold(q,function(r){return m9(n,e,t,r,o,i)},X)},m3=function(n,e,t,r,o){var i=mQ(t,r);return m2(n,e,t,r,i,o)},m5=function(n,e,t){var r=m0(e);return nc(n,function(n){s3(n.descHandler)(r)}),r.isStopped()},m4=function(n,e,t,r,o){var i=mQ(t,r);return m9(n,e,t,r,i,o)},m6=function(){var n={};return{registerId:function(e,t,r){tv(r,function(r,o){var i=void 0!==n[o]?n[o]:{};i[t]={cHandler:$.apply(void 0,[r.handler].concat(e)),purpose:r.purpose},n[o]=i})},unregisterId:function(e){tv(n,function(n,t){tk(n,e)&&delete n[e]})},filterByType:function(e){return tO(n,e).map(function(n){return tS(n,function(n,e){return{id:e,descHandler:n}})}).getOr([])},find:function(e,t,r){return tO(n,t).bind(function(n){return rj(r,function(e){return c9(e).bind(function(e){return tO(n,e)}).map(function(n){return{element:e,descHandler:n}})},e)})}}},m8=function(){var n=m6(),e={},t=function(n,t){var o=e[t];if(o===n)r(n);else throw Error('The tagId "'+t+'" is already used by: '+oE(o.element)+"\nCannot use it for: "+oE(n.element)+"\nThe conflicting element is"+(tn(o.element)?" ":" not ")+"already in the DOM")},r=function(t){c9(t.element).each(function(t){delete e[t],n.unregisterId(t)})};return{find:function(e,t,r){return n.find(e,t,r)},filter:function(e){return n.filterByType(e)},register:function(r){var o=c9(r.element).getOrThunk(function(){return c1("uid-",r.element)});tT(e,o)&&t(r,o);var i=[r];n.registerId(i,o,r.events),e[o]=r},unregister:r,getById:function(n){return tO(e,n)}}},m7=function(n){var e=function(e){return eU(n.element).fold(q,function(n){return eA(e,n)})},t=m8(),r=function(n,r){return t.find(e,n,r)},o=mJ(n.element,{triggerEvent:function(n,e){return oV(n,e.target,function(t){return m4(r,n,e,e.target,t)})}}),i={debugInfo:P("real"),triggerEvent:function(n,e,t){oV(n,e,function(o){return m4(r,n,t,e,o)})},triggerFocus:function(n,e){c9(n).fold(function(){of(n)},function(t){oV(ef(),n,function(t){return m3(r,ef(),{originator:e,kill:N,prevent:N,target:n},n,t),!1})})},triggerEscape:function(n,e){i.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:ld,addToGui:function(n){a(n)},removeFromGui:function(n){f(n)},addToWorld:function(n){u(n)},removeFromWorld:function(n){c(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:q},u=function(n){n.connect(i),eP(n.element)||(t.register(n),nc(n.components(),u),i.triggerEvent(ev(),n.element,{target:n.element}))},c=function(n){eP(n.element)||(nc(n.components(),c),t.unregister(n)),n.disconnect()},a=function(e){ta(n,e)},f=function(n){tl(n)},s=function(n){nc(t.filter(ed()),function(e){s3(e.descHandler)(n)})},l=function(n){s({universal:!0,data:n})},d=function(n,e){s({universal:!1,channels:n,data:e})},m=function(n,e){return m5(t.filter(n),e)},g=function(n){return t.getById(n).fold(function(){return tU.error(Error('Could not find component with uid: "'+n+'" in system.'))},tU.value)},p=function(n){return g(c9(n).getOr("not found"))};return u(n),{root:n,element:n.element,destroy:function(){o.unbind(),e2(n.element)},add:a,remove:f,getByUid:g,getByDom:p,addToWorld:u,removeFromWorld:c,broadcast:l,broadcastOn:d,broadcastEvent:m}},gn=ie("readonly-mode"),ge=ie("edit-mode");function gt(n){return m7(ld(sx.sketch({dom:{classes:[ie("outer-container")].concat(n.classes)},containerBehaviours:ot([oc.config({alpha:gn,omega:ge})])})))}var gr=function(n,e){var t=eR.fromTag("input");id(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),eQ(n,t),of(t),e(t),e2(t)},go=function(n){var e=n.getSelection();if(e.rangeCount>0){var t=e.getRangeAt(0),r=n.document.createRange();r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(r)}},gi=function(n,e){od().each(function(n){eA(n,e)||os(n)}),n.focus(),of(eR.fromDom(n.document.body)),go(n)},gu=function(n,e,t,r){var o=function(){gi(e,r)},i=du(t,"keydown",function(n){no(["input","textarea"],eH(n.target))||o()});return{toReading:function(){gr(n,os)},toEditing:o,onToolbarTouch:N,destroy:function(){i.unbind()}}},gc=function(n,e,t,r,o){var i=function(){e.run(function(n){n.highlightSelection()})},u=function(){e.run(function(n){n.refreshSelection()})},c=function(n,t){var o=n-r.dom.scrollTop;e.run(function(n){n.scrollIntoView(o,o+t)})},a=function(n){c(e,r)},f=function(){n.getCursorBox().each(function(n){c(n.top,n.height)})},s=function(){e.run(function(n){n.clearSelection()})},l=function(){f(),e.run(function(n){n.syncHeight()})},d=function(){var n=ix(t);e.run(function(e){e.setViewportOffset(n)}),u(),l()},m=function(n){e.run(function(e){e.onToolbarTouch(n)})},g=d5(n),p=md(l,300),h=[n.onKeyup(function(){s(),p.throttle()}),n.onNodeChanged(u),n.onDomChanged(p.throttle),n.onDomChanged(u),n.onScrollToCursor(function(n){n.preventDefault(),p.throttle()}),n.onScrollToElement(function(n){a(n.element)}),n.onToEditing(function(){e.run(function(n){n.toEditing()})}),n.onToReading(function(){e.run(function(n){n.toReading()})}),du(n.doc,"touchend",function(e){eA(n.html,e.target)||eA(n.body,e.target)}),du(t,"transitionend",function(n){"height"===n.raw.propertyName&&d()}),dc(t,"touchstart",function(e){i(),m(e),n.onTouchToolstrip()}),du(n.body,"touchstart",function(e){s(),n.onTouchContent(),g.fireTouchstart(e)}),g.onTouchmove(),g.onTouchend(),du(n.body,"click",function(n){n.kill()}),du(t,"touchmove",function(){n.onToolbarScrollStart()})];return{destroy:function(){nc(h,function(n){n.unbind()})}}},ga=function(n){var e=Q.none(),t=[],r=function(n){o()?u(n):t.push(n)},o=function(){return e.isSome()},i=function(n){nc(n,u)},u=function(n){e.each(function(e){setTimeout(function(){n(e)},0)})};return n(function(n){o()||(e=Q.some(n),i(t),t=[])}),{get:r,map:function(n){return ga(function(e){r(function(t){e(n(t))})})},isReady:o}},gf=function(n){setTimeout(function(){throw n},0)},gs=function(n){var e=function(e){n().then(e,gf)};return{map:function(e){return gs(function(){return n().then(e)})},bind:function(e){return gs(function(){return n().then(function(n){return e(n).toPromise()})})},anonBind:function(e){return gs(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return ga(e)},toCached:function(){var e=null;return gs(function(){return null===e&&(e=n()),e})},toPromise:n,get:e}},gl=function(n){return gs(function(){return new sn(n)})},gd=function(n){var e,t;return e=n.screen.width,t=n.screen.height,nw([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){var r,o;return r=e<=n.width&&t<=n.height,o=n.keyboard,r?Q.some(o):Q.none()}).getOr({portrait:t/5,landscape:e/4})},gm=function(n){var e=df(n).isPortrait(),t=gd(n),r=e?t.portrait:t.landscape;return(e?n.screen.height:n.screen.width)-n.innerHeight>r?0:r},gg=function(n,e){var t=e$(n).dom.defaultView;return ix(n)+ix(e)-gm(t)},gp=function(n,e,t){var r=gg(e,t);il(n,"padding-bottom",ix(e)+ix(t)-r+"px")},gh=rD([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),gv="data-"+ie("position-y-fixed"),gb="data-"+ie("y-property"),gy="data-"+ie("scrolling"),gx="data-"+ie("last-window-height"),gS=function(n){return d8(n,gv)},gw=function(n,e){var t=tM(n,gb);return gh.fixed(n,t,e)},gO=function(n){var e=gS(n);return("true"===tM(n,gy)?function(n,e){return gh.scroller(n,e)}:gw)(n,e)},gk=function(n){var e=tM(n,"style");return id(n,{position:"absolute",top:"0px"}),tC(n,gv,"0px"),tC(n,gb,"top"),{restore:function(){tC(n,"style",e||""),tF(n,gv),tF(n,gb)}}},gT=function(n,e,t){var r=tM(t,"style");return lY(t),id(t,{position:"absolute",height:e+"px",width:"100%",top:n+"px"}),tC(t,gv,n+"px"),tC(t,gy,"true"),tC(t,gb,"top"),{restore:function(){lJ(t),tC(t,"style",r||""),tF(t,gv),tF(t,gy),tF(t,gb)}}},gE=function(n){var e=tM(n,"style");return id(n,{position:"absolute",bottom:"0px"}),tC(n,gv,"0px"),tC(n,gb,"bottom"),{restore:function(){tC(n,"style",e||""),tF(n,gv),tF(n,gb)}}},gC=function(n,e,t){var r=e$(n).dom.defaultView.innerHeight;return tC(n,gx,r+"px"),r-e-t},gD=function(n,e,t,r){var o=e$(n).dom.defaultView,i=gk(t),u=ix(t),c=gC(n,u,ix(r)),a=gT(u,c,n),f=gE(r),s=!0,l=function(){return o.innerHeight>d8(n,gx)},d=function(){if(s){var o=ix(t),i=gC(n,o,ix(r));tC(n,gv,o+"px"),il(n,"height",i+"px"),gp(e,n,r)}};return gp(e,n,r),{setViewportOffset:function(e){tC(n,gv,e+"px"),d()},isExpanding:l,isShrinking:G(l),refresh:d,restore:function(){s=!1,i.restore(),a.restore(),f.restore()}}},gM=(v=null,{animate:function(n,e,t,r,o,i){var u=!1,c=function(n){u=!0,o(n)};da.clearInterval(v);var a=function(n){da.clearInterval(v),c(n)};v=da.setInterval(function(){var o=n();(Math.abs(o-e)<=t?Q.none():o<e?Q.some(o+t):Q.some(o-t)).fold(function(){da.clearInterval(v),c(e)},function(t){if(r(t,a),!u){var i=n();(i!==t||Math.abs(i-e)>Math.abs(o-e))&&(da.clearInterval(v),c(e))}})},i)}}),g_="data-"+ie("last-scroll-top"),gR=function(n){return parseInt(ip(n,"top").getOr("0"),10)},gF=function(n){return parseInt(n.dom.scrollTop,10)},gI=function(n,e){return gl(function(t){var r=$(gF,n);tC(n,g_,r());var o=Math.abs(e-r());gM.animate(r,e,Math.ceil(o/10),function(e,t){d8(n,g_)!==n.dom.scrollTop?t(n.dom.scrollTop):(n.dom.scrollTop=e,tC(n,g_,e))},function(){n.dom.scrollTop=e,tC(n,g_,e),t(e)},10)})},gV=function(n,e){var t=e+gS(n)+"px";il(n,"top",t)},gB=function(n,e,t){var r=e$(n).dom.defaultView;return gl(function(o){gV(n,t),gV(e,t),r.scrollTo(0,t),o(t)})},gA=function(n,e,t,r,o){var i=gg(e,t),u=$(go,n);r>i||o>i?gI(e,e.dom.scrollTop-i+o).get(u):r<0&&gI(e,e.dom.scrollTop+r).get(u)},gH=function(n,e,t){var r=e+t,o=r-parseInt(ip(n,"top").getOr(t),10),i=n.dom.scrollTop+o;return gl(function(e){var t=$(gF,n);gM.animate(t,i,15,function(e){n.dom.scrollTop=e,il(n,"top",gR(n)+15+"px")},function(){n.dom.scrollTop=i,il(n,"top",r+"px"),e(i)},10)})},gN=function(n,e){var t,r=nu(iS(n,"["+gv+"]"),gO);return t=nu(r,function(n){return n.fold(function(n,t,r){return il(n,t,e+r+"px"),gs(function(){return sn.resolve(r)})},function(n,t){return gH(n,e,t)})}),gl(function(n){var e=[],r=0;0===t.length?n([]):nc(t,function(o,i){o.get(function(o){e[i]=o,++r>=t.length&&n(e)})})})},gz=function(n,e,t,r,o,i){var u,c,a=(c=oa((u={},ga(function(n){n(u)}))),{start:function(t){var r=ga(function(r){return gB(n,e,t).get(r)});c.set(r)},idle:function(n){c.get().get(function(){n()})}}),f=function(){var n=mt(i);return Q.from(n[0]).bind(function(n){var t=n.top-e.dom.scrollTop;return t>r.innerHeight+5||t<-5?Q.some({top:t,bottom:t+n.height}):Q.none()})},s=md(function(){a.idle(function(){gN(t,r.pageYOffset).get(function(){f().each(function(n){e.dom.scrollTop=e.dom.scrollTop+n.top}),a.start(0),o.refresh()})})},1e3),l=du(eR.fromDom(r),"scroll",function(){r.pageYOffset<0||s.throttle()});return gN(t,r.pageYOffset).get(j),{unbind:l.unbind}},gP=function(n){var e,t,r,o,i,u=n.cWin,c=n.ceBody,a=n.socket,f=n.toolstrip,s=n.contentElement,l=n.keyboardType,d=n.outerWindow,m=n.dropup,g=n.outerBody,p=gD(a,c,f,m),h=l(g,u,te(),s),v=dl(d,{onChange:N,onReady:p.refresh});v.onAdjustment(function(){p.refresh()});var b=du(eR.fromDom(d),"resize",function(){p.isExpanding()&&p.refresh()}),y=gz(f,a,g,d,p,u),x=(e=u.document,tH(t=eR.fromTag("div"),ie("unfocused-selections")),eQ(eR.fromDom(e.documentElement),t),r=du(t,"touchstart",function(n){n.prevent(),gi(u,s),i()}),o=function(n){var e=eR.fromTag("span");return le(e,[ie("layer-editor"),ie("unfocused-selection")]),id(e,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),e},{update:function(){i(),e0(t,nu(mt(u),o))},isActive:function(){return eX(t).length>0},destroy:function(){r.unbind(),e2(t)},clear:i=function(){e1(t)}}),S=function(){x.clear()};return{toEditing:function(){h.toEditing(),S()},toReading:function(){h.toReading()},onToolbarTouch:function(n){h.onToolbarTouch()},refreshSelection:function(){x.isActive()&&x.update()},clearSelection:S,highlightSelection:function(){x.update()},scrollIntoView:function(n,e){gA(u,a,m,n,e)},updateToolbarPadding:N,setViewportOffset:function(n){p.setViewportOffset(n),gl(function(e){var t=$(gR,a),r=function(n){il(a,"top",n+"px")},o=Math.abs(n-t());gM.animate(t,n,Math.ceil(o/10),r,function(){r(n),e(n)},10)}).get(j)},syncHeight:function(){il(s,"height",s.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:p.refresh,destroy:function(){p.restore(),v.destroy(),y.unbind(),b.unbind(),h.destroy(),x.destroy(),gr(te(),os)}}},gj=function(n,e){var t=dX(),r=us(),o=us(),i=uf(),u=uf();return{enter:function(){e.hide();var c=eR.fromDom(document);dW(n.editor).each(function(e){var a;r.set({socketHeight:ip(n.socket,"height"),iframeHeight:ip(e.frame,"height"),outerScroll:document.body.scrollTop}),o.set({exclusives:(a="."+lK,du(c,"touchmove",function(n){iD(n.target,a).filter(mC).fold(function(){n.prevent()},N)}))}),tH(n.container,ie("fullscreen-maximized")),dZ(n.container,e.body),t.maximize(),il(n.socket,"overflow","scroll"),il(n.socket,"-webkit-overflow-scrolling","touch"),of(e.body),i.set(gP({cWin:e.win,ceBody:e.body,socket:n.socket,toolstrip:n.toolstrip,dropup:n.dropup.element,contentElement:e.frame,outerBody:n.body,outerWindow:n.win,keyboardType:gu})),i.run(function(n){n.syncHeight()}),u.set(gc(e,i,n.toolstrip,n.socket,n.dropup))})},refreshStructure:function(){i.run(function(n){n.refreshStructure()})},exit:function(){t.restore(),u.clear(),i.clear(),e.show(),r.on(function(e){e.socketHeight.each(function(e){il(n.socket,"height",e)}),e.iframeHeight.each(function(e){il(n.editor.getFrame(),"height",e)}),document.body.scrollTop=e.scrollTop}),r.clear(),o.on(function(n){n.exclusives.unbind()}),o.clear(),tz(n.container,ie("fullscreen-maximized")),d0(),lJ(n.toolbar),ih(n.socket,"overflow"),ih(n.socket,"-webkit-overflow-scrolling"),os(n.editor.getFrame()),dW(n.editor).each(function(n){n.clearSelection()})}}},gL=function(n){var e=rg("Getting IosWebapp schema",mp,n);il(e.toolstrip,"width","100%"),il(e.container,"position","relative");var t=ld(mm(function(){e.setReadOnly(e.readOnlyOnInit()),r.enter()},e.translate));e.alloy.add(t);var r=gj(e,{show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}});return{setReadOnly:e.setReadOnly,refreshStructure:r.refreshStructure,enter:r.enter,exit:r.exit,destroy:N}},g$=tinymce.util.Tools.resolve("tinymce.EditorManager"),gG=function(n){var e=Q.from(n.getParam("skin_url")).getOrThunk(function(){return g$.baseURL+"/skins/ui/oxide"});return{content:e+"/content.mobile.min.css",ui:e+"/skin.mobile.min.css"}},gU=function(n,e,t){n.system.broadcastOn([oy],{command:e,state:t})},gW=function(n,e){nc(tp(e.formatter.get()),function(t){e.formatter.formatChanged(t,function(e){gU(n,t,e)})}),nc(["ul","ol"],function(t){e.selection.selectorChanged(t,function(e,r){gU(n,t,e)})})},gX=function(n){return function(){var e=function(){n._skinLoaded=!0,n.fire("SkinLoaded")};n.initialized?e():n.on("init",e)}},gq="toReading",gK="toEditing";op.add("mobile",function(n){return{getNotificationManagerImpl:function(){return{open:P({progressBar:{value:N},close:N,text:N,getEl:P(null),moveTo:N,moveRel:N,settings:{}}),close:N,reposition:N,getArgs:P({})}},renderUI:function(){var e,t,r,o,i,u,c,a,f,s,l,d,m=n.getElement(),g=gG(n);if(!1==(!1===n.getParam("skin"))){var p=og.DOM.styleSheetLoader;n.contentCSS.push(g.content),p.load(g.ui,gX(n)),n.on("remove",function(){return p.unload(g.ui)})}else gX(n)();var h=function(){n.fire("ScrollIntoView")},v=n2().os.isAndroid()?(e=gt({classes:[ie("android-container")]}),t=mD(),o=mM(r=uf()),i=m_(),u=mK(N,h),e.add(t.wrapper),e.add(i),e.add(u.component),{system:e,element:e.element,init:function(n){r.set(mh(n))},exit:function(){r.run(function(n){n.exit(),lI.remove(i,o)})},setToolbarGroups:function(n){var e=t.createGroups(n);t.setGroups(e)},setContextToolbar:function(n){var e=t.createGroups(n);t.setContextToolbar(e)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){mI(i,o,n,e.root)},socket:i,dropup:u}):(c=gt({classes:[ie("ios-container")]}),a=mD(),s=mM(f=uf()),l=m_(),d=mK(function(){f.run(function(n){n.refreshStructure()})},h),c.add(a.wrapper),c.add(l),c.add(d.component),{system:c,element:c.element,init:function(n){f.set(gL(n))},exit:function(){f.run(function(n){lI.remove(l,s),n.exit()})},setToolbarGroups:function(n){var e=a.createGroups(n);a.setGroups(e)},setContextToolbar:function(n){var e=a.createGroups(n);a.setContextToolbar(e)},focusToolbar:function(){a.focus()},restoreToolbar:function(){a.restoreToolbar()},updateMode:function(n){mI(l,s,n,c.root)},socket:l,dropup:d});td(eR.fromDom(m),v.system);var b=m.ownerDocument.defaultView,y=dl(b,{onChange:function(){v.system.broadcastOn([ox],{width:ds(b)})},onReady:N}),x=function(e,t,r,o){!1===o&&n.selection.collapse();var i=S(e,t,r);v.setToolbarGroups(!0===o?i.readOnly:i.main),n.setMode(!0===o?"readonly":"design"),n.fire(!0===o?gq:gK),v.updateMode(o)},S=function(n,e,t){var r=n.get();return{readOnly:r.backToMask.concat(e.get()),main:r.backToMask.concat(t.get())}},w=function(e,t){return n.on(e,t),{unbind:function(){n.off(e)}}};return n.on("init",function(){v.init({editor:{getFrame:function(){return eR.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:N}},onToReading:function(n){return w(gq,n)},onToEditing:function(n){return w(gK,n)},onScrollToCursor:function(e){return n.on("ScrollIntoView",function(n){e(n)}),{unbind:function(){n.off("ScrollIntoView"),y.destroy()}}},onTouchToolstrip:function(){e()},onTouchContent:function(){om(eR.fromDom(n.editorContainer.querySelector("."+ie("toolbar")))).bind(function(n){return v.system.getByDom(n).toOptional()}).each(eT),v.restoreToolbar(),e()},onTapContent:function(e){var t=e.target;"img"===eH(t)?(n.selection.select(t.dom),e.kill()):"a"===eH(t)&&v.system.getByDom(eR.fromDom(n.editorContainer)).each(function(n){oc.isAlpha(n)&&oh(t.dom)})}},container:eR.fromDom(n.editorContainer),socket:eR.fromDom(n.contentAreaContainer),toolstrip:eR.fromDom(n.editorContainer.querySelector("."+ie("toolstrip"))),toolbar:eR.fromDom(n.editorContainer.querySelector("."+ie("toolbar"))),dropup:v.dropup,alloy:v.system,translate:N,setReadOnly:function(n){x(f,a,c,n)},readOnlyOnInit:function(){return!1}});var e=function(){v.dropup.disappear(function(){v.system.broadcastOn([oS],{})})},t={label:"The first group",scrollable:!1,items:[ad("back",function(){n.selection.collapse(),v.exit()},{},n)]},r={label:"Back to read only",scrollable:!1,items:[ad("readonly-back",function(){x(f,a,c,!0)},{},n)]},o=dn(v,n),i=de(n,o),u={label:"The extra group",scrollable:!1,items:[]},c=oa([{label:"the action group",scrollable:!0,items:i},u]),a=oa([{label:"The read only mode group",scrollable:!0,items:[]},u]),f=oa({backToMask:[t],backToReadOnly:[r]});gW(v,n)}),n.on("remove",function(){v.exit()}),n.on("detach",function(){tg(v.system),v.system.destroy()}),{iframeContainer:v.socket.element.dom,editorContainer:v.element.dom}}}})}();