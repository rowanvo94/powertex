{% sw_extends '@Storefront/storefront/component/listing/filter/filter-multi-select.html.twig' %}

{% set manufacturerExpanded = theme_config('comaxx-expand-manufacturer-filter') %}

{% set pageHasSidebar = isInSidebar %}

{% set isExpanded = (property.customFields.comaxx_property_collapsed ?? false) and pageHasSidebar %}
{% set isManufacturerExpanded = (name == 'manufacturer') and (manufacturerExpanded == '1') and pageHasSidebar %}

{% block component_filter_multi_select_toggle %}
	<button class="filter-panel-item-toggle btn" aria-expanded="{{ (isExpanded or isManufacturerExpanded) ? 'true' : 'false' }}" {% if ariaLabel %} aria-label="{{ ariaLabel }}" {% endif %} {% if sidebar %} data-bs-toggle="collapse" data-bs-target="#{{ filterItemId }}" {% else %} data-bs-toggle="dropdown" data-boundary="viewport" data-bs-offset="0,8" aria-haspopup="true" {% endif %}>

		{% block component_filter_multi_select_display_name %}
			{{ parent() }}
		{% endblock %}

		{% block component_filter_multi_select_count %}
			{{ parent() }}
		{% endblock %}

		{% block component_filter_multi_select_toggle_icon %}
			{{ parent() }}
		{% endblock %}
	</button>
{% endblock %}

{% block component_filter_multi_select_dropdown %}
	<div class="filter-multi-select-dropdown filter-panel-item-dropdown{% if sidebar %} collapse{% else %} dropdown-menu{% endif %}{% if isExpanded or isManufacturerExpanded %} show{% endif %}" id="{{ filterItemId }}">
		{% block component_filter_multi_select_list %}
			{{ parent() }}
		{% endblock %}
	</div>
{% endblock %}
